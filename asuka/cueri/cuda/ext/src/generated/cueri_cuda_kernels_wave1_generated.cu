// Generated by asuka/cueri/cuda/tools/gen_cuda_kernels.py
// Wave 1 specialized quartet kernels.

#include <cuda_runtime.h>

#include <cmath>
#include <cstdint>

#include "cueri_cuda_kernels_api.h"
#include "cueri_cuda_rys_device.cuh"

namespace {

constexpr double kPi = 3.141592653589793238462643383279502884;
constexpr double kTwoPiToFiveHalves = 2.0 * kPi * kPi * 1.772453850905516027298167483341145182;  // 2*pi^(5/2)

template <int STRIDE, int NMAX, int MMAX>
__device__ __forceinline__ void compute_G_stride_fixed(
    double* G,
    double C,
    double Cp,
    double B0,
    double B1,
    double B1p) {
  G[0] = 1.0;
  if constexpr (NMAX > 0) G[1 * STRIDE + 0] = C;
  if constexpr (MMAX > 0) G[0 * STRIDE + 1] = Cp;
  if constexpr (NMAX >= 2) {
    #pragma unroll
    for (int a = 2; a <= NMAX; ++a) {
      G[a * STRIDE + 0] = B1 * static_cast<double>(a - 1) * G[(a - 2) * STRIDE + 0] + C * G[(a - 1) * STRIDE + 0];
    }
  }
  if constexpr (MMAX >= 2) {
    #pragma unroll
    for (int b = 2; b <= MMAX; ++b) {
      G[0 * STRIDE + b] = B1p * static_cast<double>(b - 1) * G[0 * STRIDE + (b - 2)] + Cp * G[0 * STRIDE + (b - 1)];
    }
  }
  if constexpr (NMAX > 0 && MMAX > 0) {
    #pragma unroll
    for (int a = 1; a <= NMAX; ++a) {
      G[a * STRIDE + 1] = static_cast<double>(a) * B0 * G[(a - 1) * STRIDE + 0] + Cp * G[a * STRIDE + 0];
      if constexpr (MMAX >= 2) {
        #pragma unroll
        for (int b = 2; b <= MMAX; ++b) {
          G[a * STRIDE + b] =
              B1p * static_cast<double>(b - 1) * G[a * STRIDE + (b - 2)] +
              static_cast<double>(a) * B0 * G[(a - 1) * STRIDE + (b - 1)] +
              Cp * G[a * STRIDE + (b - 1)];
        }
      }
    }
  }
}

__device__ __forceinline__ double eval_psds_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[9];
    case 1: return G[8];
    case 2: return G[8];
    case 3: return G[7];
    case 4: return G[7];
    case 5: return G[7];
    case 6: return G[2];
    case 7: return G[1];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[1];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_psds_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[7];
    case 7: return G[8];
    case 8: return G[7];
    case 9: return G[9];
    case 10: return G[8];
    case 11: return G[7];
    case 12: return G[0];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[2];
    case 16: return G[1];
    case 17: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_psds_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[0];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[1];
    case 11: return G[2];
    case 12: return G[7];
    case 13: return G[7];
    case 14: return G[8];
    case 15: return G[7];
    case 16: return G[8];
    case 17: return G[9];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_psds_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 18;
  constexpr int kNMax = 1;
  constexpr int kMMax = 2;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_psds_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_psds_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_psds_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ppds_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[9] * xij + G[16];
    case 1: return G[8] * xij + G[15];
    case 2: return G[8] * xij + G[15];
    case 3: return G[7] * xij + G[14];
    case 4: return G[7] * xij + G[14];
    case 5: return G[7] * xij + G[14];
    case 6: return G[9];
    case 7: return G[8];
    case 8: return G[8];
    case 9: return G[7];
    case 10: return G[7];
    case 11: return G[7];
    case 12: return G[9];
    case 13: return G[8];
    case 14: return G[8];
    case 15: return G[7];
    case 16: return G[7];
    case 17: return G[7];
    case 18: return G[2] * xij + G[9];
    case 19: return G[1] * xij + G[8];
    case 20: return G[1] * xij + G[8];
    case 21: return G[0] * xij + G[7];
    case 22: return G[0] * xij + G[7];
    case 23: return G[0] * xij + G[7];
    case 24: return G[2];
    case 25: return G[1];
    case 26: return G[1];
    case 27: return G[0];
    case 28: return G[0];
    case 29: return G[0];
    case 30: return G[2];
    case 31: return G[1];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[0];
    case 35: return G[0];
    case 36: return G[2] * xij + G[9];
    case 37: return G[1] * xij + G[8];
    case 38: return G[1] * xij + G[8];
    case 39: return G[0] * xij + G[7];
    case 40: return G[0] * xij + G[7];
    case 41: return G[0] * xij + G[7];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[1];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[0];
    case 48: return G[2];
    case 49: return G[1];
    case 50: return G[1];
    case 51: return G[0];
    case 52: return G[0];
    case 53: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ppds_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[0] * yij + G[7];
    case 7: return G[1] * yij + G[8];
    case 8: return G[0] * yij + G[7];
    case 9: return G[2] * yij + G[9];
    case 10: return G[1] * yij + G[8];
    case 11: return G[0] * yij + G[7];
    case 12: return G[0];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[2];
    case 16: return G[1];
    case 17: return G[0];
    case 18: return G[7];
    case 19: return G[8];
    case 20: return G[7];
    case 21: return G[9];
    case 22: return G[8];
    case 23: return G[7];
    case 24: return G[7] * yij + G[14];
    case 25: return G[8] * yij + G[15];
    case 26: return G[7] * yij + G[14];
    case 27: return G[9] * yij + G[16];
    case 28: return G[8] * yij + G[15];
    case 29: return G[7] * yij + G[14];
    case 30: return G[7];
    case 31: return G[8];
    case 32: return G[7];
    case 33: return G[9];
    case 34: return G[8];
    case 35: return G[7];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[0];
    case 39: return G[2];
    case 40: return G[1];
    case 41: return G[0];
    case 42: return G[0] * yij + G[7];
    case 43: return G[1] * yij + G[8];
    case 44: return G[0] * yij + G[7];
    case 45: return G[2] * yij + G[9];
    case 46: return G[1] * yij + G[8];
    case 47: return G[0] * yij + G[7];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[0];
    case 51: return G[2];
    case 52: return G[1];
    case 53: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ppds_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[0];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[1];
    case 11: return G[2];
    case 12: return G[0] * zij + G[7];
    case 13: return G[0] * zij + G[7];
    case 14: return G[1] * zij + G[8];
    case 15: return G[0] * zij + G[7];
    case 16: return G[1] * zij + G[8];
    case 17: return G[2] * zij + G[9];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[1];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[0];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[0];
    case 28: return G[1];
    case 29: return G[2];
    case 30: return G[0] * zij + G[7];
    case 31: return G[0] * zij + G[7];
    case 32: return G[1] * zij + G[8];
    case 33: return G[0] * zij + G[7];
    case 34: return G[1] * zij + G[8];
    case 35: return G[2] * zij + G[9];
    case 36: return G[7];
    case 37: return G[7];
    case 38: return G[8];
    case 39: return G[7];
    case 40: return G[8];
    case 41: return G[9];
    case 42: return G[7];
    case 43: return G[7];
    case 44: return G[8];
    case 45: return G[7];
    case 46: return G[8];
    case 47: return G[9];
    case 48: return G[7] * zij + G[14];
    case 49: return G[7] * zij + G[14];
    case 50: return G[8] * zij + G[15];
    case 51: return G[7] * zij + G[14];
    case 52: return G[8] * zij + G[15];
    case 53: return G[9] * zij + G[16];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ppds_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 54;
  constexpr int kNMax = 2;
  constexpr int kMMax = 2;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ppds_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ppds_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ppds_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_dsds_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[16];
    case 1: return G[15];
    case 2: return G[15];
    case 3: return G[14];
    case 4: return G[14];
    case 5: return G[14];
    case 6: return G[9];
    case 7: return G[8];
    case 8: return G[8];
    case 9: return G[7];
    case 10: return G[7];
    case 11: return G[7];
    case 12: return G[9];
    case 13: return G[8];
    case 14: return G[8];
    case 15: return G[7];
    case 16: return G[7];
    case 17: return G[7];
    case 18: return G[2];
    case 19: return G[1];
    case 20: return G[1];
    case 21: return G[0];
    case 22: return G[0];
    case 23: return G[0];
    case 24: return G[2];
    case 25: return G[1];
    case 26: return G[1];
    case 27: return G[0];
    case 28: return G[0];
    case 29: return G[0];
    case 30: return G[2];
    case 31: return G[1];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[0];
    case 35: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsds_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[7];
    case 7: return G[8];
    case 8: return G[7];
    case 9: return G[9];
    case 10: return G[8];
    case 11: return G[7];
    case 12: return G[0];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[2];
    case 16: return G[1];
    case 17: return G[0];
    case 18: return G[14];
    case 19: return G[15];
    case 20: return G[14];
    case 21: return G[16];
    case 22: return G[15];
    case 23: return G[14];
    case 24: return G[7];
    case 25: return G[8];
    case 26: return G[7];
    case 27: return G[9];
    case 28: return G[8];
    case 29: return G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsds_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[0];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[1];
    case 11: return G[2];
    case 12: return G[7];
    case 13: return G[7];
    case 14: return G[8];
    case 15: return G[7];
    case 16: return G[8];
    case 17: return G[9];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[1];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[7];
    case 25: return G[7];
    case 26: return G[8];
    case 27: return G[7];
    case 28: return G[8];
    case 29: return G[9];
    case 30: return G[14];
    case 31: return G[14];
    case 32: return G[15];
    case 33: return G[14];
    case 34: return G[15];
    case 35: return G[16];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_dsds_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 36;
  constexpr int kNMax = 2;
  constexpr int kMMax = 2;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_dsds_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_dsds_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_dsds_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_dsdp_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[16] * xkl + G[17];
    case 1: return G[16];
    case 2: return G[16];
    case 3: return G[15] * xkl + G[16];
    case 4: return G[15];
    case 5: return G[15];
    case 6: return G[15] * xkl + G[16];
    case 7: return G[15];
    case 8: return G[15];
    case 9: return G[14] * xkl + G[15];
    case 10: return G[14];
    case 11: return G[14];
    case 12: return G[14] * xkl + G[15];
    case 13: return G[14];
    case 14: return G[14];
    case 15: return G[14] * xkl + G[15];
    case 16: return G[14];
    case 17: return G[14];
    case 18: return G[9] * xkl + G[10];
    case 19: return G[9];
    case 20: return G[9];
    case 21: return G[8] * xkl + G[9];
    case 22: return G[8];
    case 23: return G[8];
    case 24: return G[8] * xkl + G[9];
    case 25: return G[8];
    case 26: return G[8];
    case 27: return G[7] * xkl + G[8];
    case 28: return G[7];
    case 29: return G[7];
    case 30: return G[7] * xkl + G[8];
    case 31: return G[7];
    case 32: return G[7];
    case 33: return G[7] * xkl + G[8];
    case 34: return G[7];
    case 35: return G[7];
    case 36: return G[9] * xkl + G[10];
    case 37: return G[9];
    case 38: return G[9];
    case 39: return G[8] * xkl + G[9];
    case 40: return G[8];
    case 41: return G[8];
    case 42: return G[8] * xkl + G[9];
    case 43: return G[8];
    case 44: return G[8];
    case 45: return G[7] * xkl + G[8];
    case 46: return G[7];
    case 47: return G[7];
    case 48: return G[7] * xkl + G[8];
    case 49: return G[7];
    case 50: return G[7];
    case 51: return G[7] * xkl + G[8];
    case 52: return G[7];
    case 53: return G[7];
    case 54: return G[2] * xkl + G[3];
    case 55: return G[2];
    case 56: return G[2];
    case 57: return G[1] * xkl + G[2];
    case 58: return G[1];
    case 59: return G[1];
    case 60: return G[1] * xkl + G[2];
    case 61: return G[1];
    case 62: return G[1];
    case 63: return G[0] * xkl + G[1];
    case 64: return G[0];
    case 65: return G[0];
    case 66: return G[0] * xkl + G[1];
    case 67: return G[0];
    case 68: return G[0];
    case 69: return G[0] * xkl + G[1];
    case 70: return G[0];
    case 71: return G[0];
    case 72: return G[2] * xkl + G[3];
    case 73: return G[2];
    case 74: return G[2];
    case 75: return G[1] * xkl + G[2];
    case 76: return G[1];
    case 77: return G[1];
    case 78: return G[1] * xkl + G[2];
    case 79: return G[1];
    case 80: return G[1];
    case 81: return G[0] * xkl + G[1];
    case 82: return G[0];
    case 83: return G[0];
    case 84: return G[0] * xkl + G[1];
    case 85: return G[0];
    case 86: return G[0];
    case 87: return G[0] * xkl + G[1];
    case 88: return G[0];
    case 89: return G[0];
    case 90: return G[2] * xkl + G[3];
    case 91: return G[2];
    case 92: return G[2];
    case 93: return G[1] * xkl + G[2];
    case 94: return G[1];
    case 95: return G[1];
    case 96: return G[1] * xkl + G[2];
    case 97: return G[1];
    case 98: return G[1];
    case 99: return G[0] * xkl + G[1];
    case 100: return G[0];
    case 101: return G[0];
    case 102: return G[0] * xkl + G[1];
    case 103: return G[0];
    case 104: return G[0];
    case 105: return G[0] * xkl + G[1];
    case 106: return G[0];
    case 107: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsdp_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0] * ykl + G[1];
    case 2: return G[0];
    case 3: return G[1];
    case 4: return G[1] * ykl + G[2];
    case 5: return G[1];
    case 6: return G[0];
    case 7: return G[0] * ykl + G[1];
    case 8: return G[0];
    case 9: return G[2];
    case 10: return G[2] * ykl + G[3];
    case 11: return G[2];
    case 12: return G[1];
    case 13: return G[1] * ykl + G[2];
    case 14: return G[1];
    case 15: return G[0];
    case 16: return G[0] * ykl + G[1];
    case 17: return G[0];
    case 18: return G[7];
    case 19: return G[7] * ykl + G[8];
    case 20: return G[7];
    case 21: return G[8];
    case 22: return G[8] * ykl + G[9];
    case 23: return G[8];
    case 24: return G[7];
    case 25: return G[7] * ykl + G[8];
    case 26: return G[7];
    case 27: return G[9];
    case 28: return G[9] * ykl + G[10];
    case 29: return G[9];
    case 30: return G[8];
    case 31: return G[8] * ykl + G[9];
    case 32: return G[8];
    case 33: return G[7];
    case 34: return G[7] * ykl + G[8];
    case 35: return G[7];
    case 36: return G[0];
    case 37: return G[0] * ykl + G[1];
    case 38: return G[0];
    case 39: return G[1];
    case 40: return G[1] * ykl + G[2];
    case 41: return G[1];
    case 42: return G[0];
    case 43: return G[0] * ykl + G[1];
    case 44: return G[0];
    case 45: return G[2];
    case 46: return G[2] * ykl + G[3];
    case 47: return G[2];
    case 48: return G[1];
    case 49: return G[1] * ykl + G[2];
    case 50: return G[1];
    case 51: return G[0];
    case 52: return G[0] * ykl + G[1];
    case 53: return G[0];
    case 54: return G[14];
    case 55: return G[14] * ykl + G[15];
    case 56: return G[14];
    case 57: return G[15];
    case 58: return G[15] * ykl + G[16];
    case 59: return G[15];
    case 60: return G[14];
    case 61: return G[14] * ykl + G[15];
    case 62: return G[14];
    case 63: return G[16];
    case 64: return G[16] * ykl + G[17];
    case 65: return G[16];
    case 66: return G[15];
    case 67: return G[15] * ykl + G[16];
    case 68: return G[15];
    case 69: return G[14];
    case 70: return G[14] * ykl + G[15];
    case 71: return G[14];
    case 72: return G[7];
    case 73: return G[7] * ykl + G[8];
    case 74: return G[7];
    case 75: return G[8];
    case 76: return G[8] * ykl + G[9];
    case 77: return G[8];
    case 78: return G[7];
    case 79: return G[7] * ykl + G[8];
    case 80: return G[7];
    case 81: return G[9];
    case 82: return G[9] * ykl + G[10];
    case 83: return G[9];
    case 84: return G[8];
    case 85: return G[8] * ykl + G[9];
    case 86: return G[8];
    case 87: return G[7];
    case 88: return G[7] * ykl + G[8];
    case 89: return G[7];
    case 90: return G[0];
    case 91: return G[0] * ykl + G[1];
    case 92: return G[0];
    case 93: return G[1];
    case 94: return G[1] * ykl + G[2];
    case 95: return G[1];
    case 96: return G[0];
    case 97: return G[0] * ykl + G[1];
    case 98: return G[0];
    case 99: return G[2];
    case 100: return G[2] * ykl + G[3];
    case 101: return G[2];
    case 102: return G[1];
    case 103: return G[1] * ykl + G[2];
    case 104: return G[1];
    case 105: return G[0];
    case 106: return G[0] * ykl + G[1];
    case 107: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsdp_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[0] * zkl + G[1];
    case 3: return G[0];
    case 4: return G[0];
    case 5: return G[0] * zkl + G[1];
    case 6: return G[1];
    case 7: return G[1];
    case 8: return G[1] * zkl + G[2];
    case 9: return G[0];
    case 10: return G[0];
    case 11: return G[0] * zkl + G[1];
    case 12: return G[1];
    case 13: return G[1];
    case 14: return G[1] * zkl + G[2];
    case 15: return G[2];
    case 16: return G[2];
    case 17: return G[2] * zkl + G[3];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[0] * zkl + G[1];
    case 21: return G[0];
    case 22: return G[0];
    case 23: return G[0] * zkl + G[1];
    case 24: return G[1];
    case 25: return G[1];
    case 26: return G[1] * zkl + G[2];
    case 27: return G[0];
    case 28: return G[0];
    case 29: return G[0] * zkl + G[1];
    case 30: return G[1];
    case 31: return G[1];
    case 32: return G[1] * zkl + G[2];
    case 33: return G[2];
    case 34: return G[2];
    case 35: return G[2] * zkl + G[3];
    case 36: return G[7];
    case 37: return G[7];
    case 38: return G[7] * zkl + G[8];
    case 39: return G[7];
    case 40: return G[7];
    case 41: return G[7] * zkl + G[8];
    case 42: return G[8];
    case 43: return G[8];
    case 44: return G[8] * zkl + G[9];
    case 45: return G[7];
    case 46: return G[7];
    case 47: return G[7] * zkl + G[8];
    case 48: return G[8];
    case 49: return G[8];
    case 50: return G[8] * zkl + G[9];
    case 51: return G[9];
    case 52: return G[9];
    case 53: return G[9] * zkl + G[10];
    case 54: return G[0];
    case 55: return G[0];
    case 56: return G[0] * zkl + G[1];
    case 57: return G[0];
    case 58: return G[0];
    case 59: return G[0] * zkl + G[1];
    case 60: return G[1];
    case 61: return G[1];
    case 62: return G[1] * zkl + G[2];
    case 63: return G[0];
    case 64: return G[0];
    case 65: return G[0] * zkl + G[1];
    case 66: return G[1];
    case 67: return G[1];
    case 68: return G[1] * zkl + G[2];
    case 69: return G[2];
    case 70: return G[2];
    case 71: return G[2] * zkl + G[3];
    case 72: return G[7];
    case 73: return G[7];
    case 74: return G[7] * zkl + G[8];
    case 75: return G[7];
    case 76: return G[7];
    case 77: return G[7] * zkl + G[8];
    case 78: return G[8];
    case 79: return G[8];
    case 80: return G[8] * zkl + G[9];
    case 81: return G[7];
    case 82: return G[7];
    case 83: return G[7] * zkl + G[8];
    case 84: return G[8];
    case 85: return G[8];
    case 86: return G[8] * zkl + G[9];
    case 87: return G[9];
    case 88: return G[9];
    case 89: return G[9] * zkl + G[10];
    case 90: return G[14];
    case 91: return G[14];
    case 92: return G[14] * zkl + G[15];
    case 93: return G[14];
    case 94: return G[14];
    case 95: return G[14] * zkl + G[15];
    case 96: return G[15];
    case 97: return G[15];
    case 98: return G[15] * zkl + G[16];
    case 99: return G[14];
    case 100: return G[14];
    case 101: return G[14] * zkl + G[15];
    case 102: return G[15];
    case 103: return G[15];
    case 104: return G[15] * zkl + G[16];
    case 105: return G[16];
    case 106: return G[16];
    case 107: return G[16] * zkl + G[17];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_dsdp_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 108;
  constexpr int kNMax = 2;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_dsdp_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_dsdp_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_dsdp_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_dsdd_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[16] * xkl2 + 2.0 * (G[17] * xkl) + G[18];
    case 1: return G[16] * xkl + G[17];
    case 2: return G[16] * xkl + G[17];
    case 3: return G[16];
    case 4: return G[16];
    case 5: return G[16];
    case 6: return G[15] * xkl2 + 2.0 * (G[16] * xkl) + G[17];
    case 7: return G[15] * xkl + G[16];
    case 8: return G[15] * xkl + G[16];
    case 9: return G[15];
    case 10: return G[15];
    case 11: return G[15];
    case 12: return G[15] * xkl2 + 2.0 * (G[16] * xkl) + G[17];
    case 13: return G[15] * xkl + G[16];
    case 14: return G[15] * xkl + G[16];
    case 15: return G[15];
    case 16: return G[15];
    case 17: return G[15];
    case 18: return G[14] * xkl2 + 2.0 * (G[15] * xkl) + G[16];
    case 19: return G[14] * xkl + G[15];
    case 20: return G[14] * xkl + G[15];
    case 21: return G[14];
    case 22: return G[14];
    case 23: return G[14];
    case 24: return G[14] * xkl2 + 2.0 * (G[15] * xkl) + G[16];
    case 25: return G[14] * xkl + G[15];
    case 26: return G[14] * xkl + G[15];
    case 27: return G[14];
    case 28: return G[14];
    case 29: return G[14];
    case 30: return G[14] * xkl2 + 2.0 * (G[15] * xkl) + G[16];
    case 31: return G[14] * xkl + G[15];
    case 32: return G[14] * xkl + G[15];
    case 33: return G[14];
    case 34: return G[14];
    case 35: return G[14];
    case 36: return G[9] * xkl2 + 2.0 * (G[10] * xkl) + G[11];
    case 37: return G[9] * xkl + G[10];
    case 38: return G[9] * xkl + G[10];
    case 39: return G[9];
    case 40: return G[9];
    case 41: return G[9];
    case 42: return G[8] * xkl2 + 2.0 * (G[9] * xkl) + G[10];
    case 43: return G[8] * xkl + G[9];
    case 44: return G[8] * xkl + G[9];
    case 45: return G[8];
    case 46: return G[8];
    case 47: return G[8];
    case 48: return G[8] * xkl2 + 2.0 * (G[9] * xkl) + G[10];
    case 49: return G[8] * xkl + G[9];
    case 50: return G[8] * xkl + G[9];
    case 51: return G[8];
    case 52: return G[8];
    case 53: return G[8];
    case 54: return G[7] * xkl2 + 2.0 * (G[8] * xkl) + G[9];
    case 55: return G[7] * xkl + G[8];
    case 56: return G[7] * xkl + G[8];
    case 57: return G[7];
    case 58: return G[7];
    case 59: return G[7];
    case 60: return G[7] * xkl2 + 2.0 * (G[8] * xkl) + G[9];
    case 61: return G[7] * xkl + G[8];
    case 62: return G[7] * xkl + G[8];
    case 63: return G[7];
    case 64: return G[7];
    case 65: return G[7];
    case 66: return G[7] * xkl2 + 2.0 * (G[8] * xkl) + G[9];
    case 67: return G[7] * xkl + G[8];
    case 68: return G[7] * xkl + G[8];
    case 69: return G[7];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[9] * xkl2 + 2.0 * (G[10] * xkl) + G[11];
    case 73: return G[9] * xkl + G[10];
    case 74: return G[9] * xkl + G[10];
    case 75: return G[9];
    case 76: return G[9];
    case 77: return G[9];
    case 78: return G[8] * xkl2 + 2.0 * (G[9] * xkl) + G[10];
    case 79: return G[8] * xkl + G[9];
    case 80: return G[8] * xkl + G[9];
    case 81: return G[8];
    case 82: return G[8];
    case 83: return G[8];
    case 84: return G[8] * xkl2 + 2.0 * (G[9] * xkl) + G[10];
    case 85: return G[8] * xkl + G[9];
    case 86: return G[8] * xkl + G[9];
    case 87: return G[8];
    case 88: return G[8];
    case 89: return G[8];
    case 90: return G[7] * xkl2 + 2.0 * (G[8] * xkl) + G[9];
    case 91: return G[7] * xkl + G[8];
    case 92: return G[7] * xkl + G[8];
    case 93: return G[7];
    case 94: return G[7];
    case 95: return G[7];
    case 96: return G[7] * xkl2 + 2.0 * (G[8] * xkl) + G[9];
    case 97: return G[7] * xkl + G[8];
    case 98: return G[7] * xkl + G[8];
    case 99: return G[7];
    case 100: return G[7];
    case 101: return G[7];
    case 102: return G[7] * xkl2 + 2.0 * (G[8] * xkl) + G[9];
    case 103: return G[7] * xkl + G[8];
    case 104: return G[7] * xkl + G[8];
    case 105: return G[7];
    case 106: return G[7];
    case 107: return G[7];
    case 108: return G[2] * xkl2 + 2.0 * (G[3] * xkl) + G[4];
    case 109: return G[2] * xkl + G[3];
    case 110: return G[2] * xkl + G[3];
    case 111: return G[2];
    case 112: return G[2];
    case 113: return G[2];
    case 114: return G[1] * xkl2 + 2.0 * (G[2] * xkl) + G[3];
    case 115: return G[1] * xkl + G[2];
    case 116: return G[1] * xkl + G[2];
    case 117: return G[1];
    case 118: return G[1];
    case 119: return G[1];
    case 120: return G[1] * xkl2 + 2.0 * (G[2] * xkl) + G[3];
    case 121: return G[1] * xkl + G[2];
    case 122: return G[1] * xkl + G[2];
    case 123: return G[1];
    case 124: return G[1];
    case 125: return G[1];
    case 126: return G[0] * xkl2 + 2.0 * (G[1] * xkl) + G[2];
    case 127: return G[0] * xkl + G[1];
    case 128: return G[0] * xkl + G[1];
    case 129: return G[0];
    case 130: return G[0];
    case 131: return G[0];
    case 132: return G[0] * xkl2 + 2.0 * (G[1] * xkl) + G[2];
    case 133: return G[0] * xkl + G[1];
    case 134: return G[0] * xkl + G[1];
    case 135: return G[0];
    case 136: return G[0];
    case 137: return G[0];
    case 138: return G[0] * xkl2 + 2.0 * (G[1] * xkl) + G[2];
    case 139: return G[0] * xkl + G[1];
    case 140: return G[0] * xkl + G[1];
    case 141: return G[0];
    case 142: return G[0];
    case 143: return G[0];
    case 144: return G[2] * xkl2 + 2.0 * (G[3] * xkl) + G[4];
    case 145: return G[2] * xkl + G[3];
    case 146: return G[2] * xkl + G[3];
    case 147: return G[2];
    case 148: return G[2];
    case 149: return G[2];
    case 150: return G[1] * xkl2 + 2.0 * (G[2] * xkl) + G[3];
    case 151: return G[1] * xkl + G[2];
    case 152: return G[1] * xkl + G[2];
    case 153: return G[1];
    case 154: return G[1];
    case 155: return G[1];
    case 156: return G[1] * xkl2 + 2.0 * (G[2] * xkl) + G[3];
    case 157: return G[1] * xkl + G[2];
    case 158: return G[1] * xkl + G[2];
    case 159: return G[1];
    case 160: return G[1];
    case 161: return G[1];
    case 162: return G[0] * xkl2 + 2.0 * (G[1] * xkl) + G[2];
    case 163: return G[0] * xkl + G[1];
    case 164: return G[0] * xkl + G[1];
    case 165: return G[0];
    case 166: return G[0];
    case 167: return G[0];
    case 168: return G[0] * xkl2 + 2.0 * (G[1] * xkl) + G[2];
    case 169: return G[0] * xkl + G[1];
    case 170: return G[0] * xkl + G[1];
    case 171: return G[0];
    case 172: return G[0];
    case 173: return G[0];
    case 174: return G[0] * xkl2 + 2.0 * (G[1] * xkl) + G[2];
    case 175: return G[0] * xkl + G[1];
    case 176: return G[0] * xkl + G[1];
    case 177: return G[0];
    case 178: return G[0];
    case 179: return G[0];
    case 180: return G[2] * xkl2 + 2.0 * (G[3] * xkl) + G[4];
    case 181: return G[2] * xkl + G[3];
    case 182: return G[2] * xkl + G[3];
    case 183: return G[2];
    case 184: return G[2];
    case 185: return G[2];
    case 186: return G[1] * xkl2 + 2.0 * (G[2] * xkl) + G[3];
    case 187: return G[1] * xkl + G[2];
    case 188: return G[1] * xkl + G[2];
    case 189: return G[1];
    case 190: return G[1];
    case 191: return G[1];
    case 192: return G[1] * xkl2 + 2.0 * (G[2] * xkl) + G[3];
    case 193: return G[1] * xkl + G[2];
    case 194: return G[1] * xkl + G[2];
    case 195: return G[1];
    case 196: return G[1];
    case 197: return G[1];
    case 198: return G[0] * xkl2 + 2.0 * (G[1] * xkl) + G[2];
    case 199: return G[0] * xkl + G[1];
    case 200: return G[0] * xkl + G[1];
    case 201: return G[0];
    case 202: return G[0];
    case 203: return G[0];
    case 204: return G[0] * xkl2 + 2.0 * (G[1] * xkl) + G[2];
    case 205: return G[0] * xkl + G[1];
    case 206: return G[0] * xkl + G[1];
    case 207: return G[0];
    case 208: return G[0];
    case 209: return G[0];
    case 210: return G[0] * xkl2 + 2.0 * (G[1] * xkl) + G[2];
    case 211: return G[0] * xkl + G[1];
    case 212: return G[0] * xkl + G[1];
    case 213: return G[0];
    case 214: return G[0];
    case 215: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsdd_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0] * ykl + G[1];
    case 2: return G[0];
    case 3: return G[0] * ykl2 + 2.0 * (G[1] * ykl) + G[2];
    case 4: return G[0] * ykl + G[1];
    case 5: return G[0];
    case 6: return G[1];
    case 7: return G[1] * ykl + G[2];
    case 8: return G[1];
    case 9: return G[1] * ykl2 + 2.0 * (G[2] * ykl) + G[3];
    case 10: return G[1] * ykl + G[2];
    case 11: return G[1];
    case 12: return G[0];
    case 13: return G[0] * ykl + G[1];
    case 14: return G[0];
    case 15: return G[0] * ykl2 + 2.0 * (G[1] * ykl) + G[2];
    case 16: return G[0] * ykl + G[1];
    case 17: return G[0];
    case 18: return G[2];
    case 19: return G[2] * ykl + G[3];
    case 20: return G[2];
    case 21: return G[2] * ykl2 + 2.0 * (G[3] * ykl) + G[4];
    case 22: return G[2] * ykl + G[3];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[1] * ykl + G[2];
    case 26: return G[1];
    case 27: return G[1] * ykl2 + 2.0 * (G[2] * ykl) + G[3];
    case 28: return G[1] * ykl + G[2];
    case 29: return G[1];
    case 30: return G[0];
    case 31: return G[0] * ykl + G[1];
    case 32: return G[0];
    case 33: return G[0] * ykl2 + 2.0 * (G[1] * ykl) + G[2];
    case 34: return G[0] * ykl + G[1];
    case 35: return G[0];
    case 36: return G[7];
    case 37: return G[7] * ykl + G[8];
    case 38: return G[7];
    case 39: return G[7] * ykl2 + 2.0 * (G[8] * ykl) + G[9];
    case 40: return G[7] * ykl + G[8];
    case 41: return G[7];
    case 42: return G[8];
    case 43: return G[8] * ykl + G[9];
    case 44: return G[8];
    case 45: return G[8] * ykl2 + 2.0 * (G[9] * ykl) + G[10];
    case 46: return G[8] * ykl + G[9];
    case 47: return G[8];
    case 48: return G[7];
    case 49: return G[7] * ykl + G[8];
    case 50: return G[7];
    case 51: return G[7] * ykl2 + 2.0 * (G[8] * ykl) + G[9];
    case 52: return G[7] * ykl + G[8];
    case 53: return G[7];
    case 54: return G[9];
    case 55: return G[9] * ykl + G[10];
    case 56: return G[9];
    case 57: return G[9] * ykl2 + 2.0 * (G[10] * ykl) + G[11];
    case 58: return G[9] * ykl + G[10];
    case 59: return G[9];
    case 60: return G[8];
    case 61: return G[8] * ykl + G[9];
    case 62: return G[8];
    case 63: return G[8] * ykl2 + 2.0 * (G[9] * ykl) + G[10];
    case 64: return G[8] * ykl + G[9];
    case 65: return G[8];
    case 66: return G[7];
    case 67: return G[7] * ykl + G[8];
    case 68: return G[7];
    case 69: return G[7] * ykl2 + 2.0 * (G[8] * ykl) + G[9];
    case 70: return G[7] * ykl + G[8];
    case 71: return G[7];
    case 72: return G[0];
    case 73: return G[0] * ykl + G[1];
    case 74: return G[0];
    case 75: return G[0] * ykl2 + 2.0 * (G[1] * ykl) + G[2];
    case 76: return G[0] * ykl + G[1];
    case 77: return G[0];
    case 78: return G[1];
    case 79: return G[1] * ykl + G[2];
    case 80: return G[1];
    case 81: return G[1] * ykl2 + 2.0 * (G[2] * ykl) + G[3];
    case 82: return G[1] * ykl + G[2];
    case 83: return G[1];
    case 84: return G[0];
    case 85: return G[0] * ykl + G[1];
    case 86: return G[0];
    case 87: return G[0] * ykl2 + 2.0 * (G[1] * ykl) + G[2];
    case 88: return G[0] * ykl + G[1];
    case 89: return G[0];
    case 90: return G[2];
    case 91: return G[2] * ykl + G[3];
    case 92: return G[2];
    case 93: return G[2] * ykl2 + 2.0 * (G[3] * ykl) + G[4];
    case 94: return G[2] * ykl + G[3];
    case 95: return G[2];
    case 96: return G[1];
    case 97: return G[1] * ykl + G[2];
    case 98: return G[1];
    case 99: return G[1] * ykl2 + 2.0 * (G[2] * ykl) + G[3];
    case 100: return G[1] * ykl + G[2];
    case 101: return G[1];
    case 102: return G[0];
    case 103: return G[0] * ykl + G[1];
    case 104: return G[0];
    case 105: return G[0] * ykl2 + 2.0 * (G[1] * ykl) + G[2];
    case 106: return G[0] * ykl + G[1];
    case 107: return G[0];
    case 108: return G[14];
    case 109: return G[14] * ykl + G[15];
    case 110: return G[14];
    case 111: return G[14] * ykl2 + 2.0 * (G[15] * ykl) + G[16];
    case 112: return G[14] * ykl + G[15];
    case 113: return G[14];
    case 114: return G[15];
    case 115: return G[15] * ykl + G[16];
    case 116: return G[15];
    case 117: return G[15] * ykl2 + 2.0 * (G[16] * ykl) + G[17];
    case 118: return G[15] * ykl + G[16];
    case 119: return G[15];
    case 120: return G[14];
    case 121: return G[14] * ykl + G[15];
    case 122: return G[14];
    case 123: return G[14] * ykl2 + 2.0 * (G[15] * ykl) + G[16];
    case 124: return G[14] * ykl + G[15];
    case 125: return G[14];
    case 126: return G[16];
    case 127: return G[16] * ykl + G[17];
    case 128: return G[16];
    case 129: return G[16] * ykl2 + 2.0 * (G[17] * ykl) + G[18];
    case 130: return G[16] * ykl + G[17];
    case 131: return G[16];
    case 132: return G[15];
    case 133: return G[15] * ykl + G[16];
    case 134: return G[15];
    case 135: return G[15] * ykl2 + 2.0 * (G[16] * ykl) + G[17];
    case 136: return G[15] * ykl + G[16];
    case 137: return G[15];
    case 138: return G[14];
    case 139: return G[14] * ykl + G[15];
    case 140: return G[14];
    case 141: return G[14] * ykl2 + 2.0 * (G[15] * ykl) + G[16];
    case 142: return G[14] * ykl + G[15];
    case 143: return G[14];
    case 144: return G[7];
    case 145: return G[7] * ykl + G[8];
    case 146: return G[7];
    case 147: return G[7] * ykl2 + 2.0 * (G[8] * ykl) + G[9];
    case 148: return G[7] * ykl + G[8];
    case 149: return G[7];
    case 150: return G[8];
    case 151: return G[8] * ykl + G[9];
    case 152: return G[8];
    case 153: return G[8] * ykl2 + 2.0 * (G[9] * ykl) + G[10];
    case 154: return G[8] * ykl + G[9];
    case 155: return G[8];
    case 156: return G[7];
    case 157: return G[7] * ykl + G[8];
    case 158: return G[7];
    case 159: return G[7] * ykl2 + 2.0 * (G[8] * ykl) + G[9];
    case 160: return G[7] * ykl + G[8];
    case 161: return G[7];
    case 162: return G[9];
    case 163: return G[9] * ykl + G[10];
    case 164: return G[9];
    case 165: return G[9] * ykl2 + 2.0 * (G[10] * ykl) + G[11];
    case 166: return G[9] * ykl + G[10];
    case 167: return G[9];
    case 168: return G[8];
    case 169: return G[8] * ykl + G[9];
    case 170: return G[8];
    case 171: return G[8] * ykl2 + 2.0 * (G[9] * ykl) + G[10];
    case 172: return G[8] * ykl + G[9];
    case 173: return G[8];
    case 174: return G[7];
    case 175: return G[7] * ykl + G[8];
    case 176: return G[7];
    case 177: return G[7] * ykl2 + 2.0 * (G[8] * ykl) + G[9];
    case 178: return G[7] * ykl + G[8];
    case 179: return G[7];
    case 180: return G[0];
    case 181: return G[0] * ykl + G[1];
    case 182: return G[0];
    case 183: return G[0] * ykl2 + 2.0 * (G[1] * ykl) + G[2];
    case 184: return G[0] * ykl + G[1];
    case 185: return G[0];
    case 186: return G[1];
    case 187: return G[1] * ykl + G[2];
    case 188: return G[1];
    case 189: return G[1] * ykl2 + 2.0 * (G[2] * ykl) + G[3];
    case 190: return G[1] * ykl + G[2];
    case 191: return G[1];
    case 192: return G[0];
    case 193: return G[0] * ykl + G[1];
    case 194: return G[0];
    case 195: return G[0] * ykl2 + 2.0 * (G[1] * ykl) + G[2];
    case 196: return G[0] * ykl + G[1];
    case 197: return G[0];
    case 198: return G[2];
    case 199: return G[2] * ykl + G[3];
    case 200: return G[2];
    case 201: return G[2] * ykl2 + 2.0 * (G[3] * ykl) + G[4];
    case 202: return G[2] * ykl + G[3];
    case 203: return G[2];
    case 204: return G[1];
    case 205: return G[1] * ykl + G[2];
    case 206: return G[1];
    case 207: return G[1] * ykl2 + 2.0 * (G[2] * ykl) + G[3];
    case 208: return G[1] * ykl + G[2];
    case 209: return G[1];
    case 210: return G[0];
    case 211: return G[0] * ykl + G[1];
    case 212: return G[0];
    case 213: return G[0] * ykl2 + 2.0 * (G[1] * ykl) + G[2];
    case 214: return G[0] * ykl + G[1];
    case 215: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsdd_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[0] * zkl + G[1];
    case 3: return G[0];
    case 4: return G[0] * zkl + G[1];
    case 5: return G[0] * zkl2 + 2.0 * (G[1] * zkl) + G[2];
    case 6: return G[0];
    case 7: return G[0];
    case 8: return G[0] * zkl + G[1];
    case 9: return G[0];
    case 10: return G[0] * zkl + G[1];
    case 11: return G[0] * zkl2 + 2.0 * (G[1] * zkl) + G[2];
    case 12: return G[1];
    case 13: return G[1];
    case 14: return G[1] * zkl + G[2];
    case 15: return G[1];
    case 16: return G[1] * zkl + G[2];
    case 17: return G[1] * zkl2 + 2.0 * (G[2] * zkl) + G[3];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[0] * zkl + G[1];
    case 21: return G[0];
    case 22: return G[0] * zkl + G[1];
    case 23: return G[0] * zkl2 + 2.0 * (G[1] * zkl) + G[2];
    case 24: return G[1];
    case 25: return G[1];
    case 26: return G[1] * zkl + G[2];
    case 27: return G[1];
    case 28: return G[1] * zkl + G[2];
    case 29: return G[1] * zkl2 + 2.0 * (G[2] * zkl) + G[3];
    case 30: return G[2];
    case 31: return G[2];
    case 32: return G[2] * zkl + G[3];
    case 33: return G[2];
    case 34: return G[2] * zkl + G[3];
    case 35: return G[2] * zkl2 + 2.0 * (G[3] * zkl) + G[4];
    case 36: return G[0];
    case 37: return G[0];
    case 38: return G[0] * zkl + G[1];
    case 39: return G[0];
    case 40: return G[0] * zkl + G[1];
    case 41: return G[0] * zkl2 + 2.0 * (G[1] * zkl) + G[2];
    case 42: return G[0];
    case 43: return G[0];
    case 44: return G[0] * zkl + G[1];
    case 45: return G[0];
    case 46: return G[0] * zkl + G[1];
    case 47: return G[0] * zkl2 + 2.0 * (G[1] * zkl) + G[2];
    case 48: return G[1];
    case 49: return G[1];
    case 50: return G[1] * zkl + G[2];
    case 51: return G[1];
    case 52: return G[1] * zkl + G[2];
    case 53: return G[1] * zkl2 + 2.0 * (G[2] * zkl) + G[3];
    case 54: return G[0];
    case 55: return G[0];
    case 56: return G[0] * zkl + G[1];
    case 57: return G[0];
    case 58: return G[0] * zkl + G[1];
    case 59: return G[0] * zkl2 + 2.0 * (G[1] * zkl) + G[2];
    case 60: return G[1];
    case 61: return G[1];
    case 62: return G[1] * zkl + G[2];
    case 63: return G[1];
    case 64: return G[1] * zkl + G[2];
    case 65: return G[1] * zkl2 + 2.0 * (G[2] * zkl) + G[3];
    case 66: return G[2];
    case 67: return G[2];
    case 68: return G[2] * zkl + G[3];
    case 69: return G[2];
    case 70: return G[2] * zkl + G[3];
    case 71: return G[2] * zkl2 + 2.0 * (G[3] * zkl) + G[4];
    case 72: return G[7];
    case 73: return G[7];
    case 74: return G[7] * zkl + G[8];
    case 75: return G[7];
    case 76: return G[7] * zkl + G[8];
    case 77: return G[7] * zkl2 + 2.0 * (G[8] * zkl) + G[9];
    case 78: return G[7];
    case 79: return G[7];
    case 80: return G[7] * zkl + G[8];
    case 81: return G[7];
    case 82: return G[7] * zkl + G[8];
    case 83: return G[7] * zkl2 + 2.0 * (G[8] * zkl) + G[9];
    case 84: return G[8];
    case 85: return G[8];
    case 86: return G[8] * zkl + G[9];
    case 87: return G[8];
    case 88: return G[8] * zkl + G[9];
    case 89: return G[8] * zkl2 + 2.0 * (G[9] * zkl) + G[10];
    case 90: return G[7];
    case 91: return G[7];
    case 92: return G[7] * zkl + G[8];
    case 93: return G[7];
    case 94: return G[7] * zkl + G[8];
    case 95: return G[7] * zkl2 + 2.0 * (G[8] * zkl) + G[9];
    case 96: return G[8];
    case 97: return G[8];
    case 98: return G[8] * zkl + G[9];
    case 99: return G[8];
    case 100: return G[8] * zkl + G[9];
    case 101: return G[8] * zkl2 + 2.0 * (G[9] * zkl) + G[10];
    case 102: return G[9];
    case 103: return G[9];
    case 104: return G[9] * zkl + G[10];
    case 105: return G[9];
    case 106: return G[9] * zkl + G[10];
    case 107: return G[9] * zkl2 + 2.0 * (G[10] * zkl) + G[11];
    case 108: return G[0];
    case 109: return G[0];
    case 110: return G[0] * zkl + G[1];
    case 111: return G[0];
    case 112: return G[0] * zkl + G[1];
    case 113: return G[0] * zkl2 + 2.0 * (G[1] * zkl) + G[2];
    case 114: return G[0];
    case 115: return G[0];
    case 116: return G[0] * zkl + G[1];
    case 117: return G[0];
    case 118: return G[0] * zkl + G[1];
    case 119: return G[0] * zkl2 + 2.0 * (G[1] * zkl) + G[2];
    case 120: return G[1];
    case 121: return G[1];
    case 122: return G[1] * zkl + G[2];
    case 123: return G[1];
    case 124: return G[1] * zkl + G[2];
    case 125: return G[1] * zkl2 + 2.0 * (G[2] * zkl) + G[3];
    case 126: return G[0];
    case 127: return G[0];
    case 128: return G[0] * zkl + G[1];
    case 129: return G[0];
    case 130: return G[0] * zkl + G[1];
    case 131: return G[0] * zkl2 + 2.0 * (G[1] * zkl) + G[2];
    case 132: return G[1];
    case 133: return G[1];
    case 134: return G[1] * zkl + G[2];
    case 135: return G[1];
    case 136: return G[1] * zkl + G[2];
    case 137: return G[1] * zkl2 + 2.0 * (G[2] * zkl) + G[3];
    case 138: return G[2];
    case 139: return G[2];
    case 140: return G[2] * zkl + G[3];
    case 141: return G[2];
    case 142: return G[2] * zkl + G[3];
    case 143: return G[2] * zkl2 + 2.0 * (G[3] * zkl) + G[4];
    case 144: return G[7];
    case 145: return G[7];
    case 146: return G[7] * zkl + G[8];
    case 147: return G[7];
    case 148: return G[7] * zkl + G[8];
    case 149: return G[7] * zkl2 + 2.0 * (G[8] * zkl) + G[9];
    case 150: return G[7];
    case 151: return G[7];
    case 152: return G[7] * zkl + G[8];
    case 153: return G[7];
    case 154: return G[7] * zkl + G[8];
    case 155: return G[7] * zkl2 + 2.0 * (G[8] * zkl) + G[9];
    case 156: return G[8];
    case 157: return G[8];
    case 158: return G[8] * zkl + G[9];
    case 159: return G[8];
    case 160: return G[8] * zkl + G[9];
    case 161: return G[8] * zkl2 + 2.0 * (G[9] * zkl) + G[10];
    case 162: return G[7];
    case 163: return G[7];
    case 164: return G[7] * zkl + G[8];
    case 165: return G[7];
    case 166: return G[7] * zkl + G[8];
    case 167: return G[7] * zkl2 + 2.0 * (G[8] * zkl) + G[9];
    case 168: return G[8];
    case 169: return G[8];
    case 170: return G[8] * zkl + G[9];
    case 171: return G[8];
    case 172: return G[8] * zkl + G[9];
    case 173: return G[8] * zkl2 + 2.0 * (G[9] * zkl) + G[10];
    case 174: return G[9];
    case 175: return G[9];
    case 176: return G[9] * zkl + G[10];
    case 177: return G[9];
    case 178: return G[9] * zkl + G[10];
    case 179: return G[9] * zkl2 + 2.0 * (G[10] * zkl) + G[11];
    case 180: return G[14];
    case 181: return G[14];
    case 182: return G[14] * zkl + G[15];
    case 183: return G[14];
    case 184: return G[14] * zkl + G[15];
    case 185: return G[14] * zkl2 + 2.0 * (G[15] * zkl) + G[16];
    case 186: return G[14];
    case 187: return G[14];
    case 188: return G[14] * zkl + G[15];
    case 189: return G[14];
    case 190: return G[14] * zkl + G[15];
    case 191: return G[14] * zkl2 + 2.0 * (G[15] * zkl) + G[16];
    case 192: return G[15];
    case 193: return G[15];
    case 194: return G[15] * zkl + G[16];
    case 195: return G[15];
    case 196: return G[15] * zkl + G[16];
    case 197: return G[15] * zkl2 + 2.0 * (G[16] * zkl) + G[17];
    case 198: return G[14];
    case 199: return G[14];
    case 200: return G[14] * zkl + G[15];
    case 201: return G[14];
    case 202: return G[14] * zkl + G[15];
    case 203: return G[14] * zkl2 + 2.0 * (G[15] * zkl) + G[16];
    case 204: return G[15];
    case 205: return G[15];
    case 206: return G[15] * zkl + G[16];
    case 207: return G[15];
    case 208: return G[15] * zkl + G[16];
    case 209: return G[15] * zkl2 + 2.0 * (G[16] * zkl) + G[17];
    case 210: return G[16];
    case 211: return G[16];
    case 212: return G[16] * zkl + G[17];
    case 213: return G[16];
    case 214: return G[16] * zkl + G[17];
    case 215: return G[16] * zkl2 + 2.0 * (G[17] * zkl) + G[18];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_dsdd_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 216;
  constexpr int kNMax = 2;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_dsdd_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_dsdd_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_dsdd_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fpss_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[21] * xij + G[28];
    case 1: return G[21];
    case 2: return G[21];
    case 3: return G[14] * xij + G[21];
    case 4: return G[14];
    case 5: return G[14];
    case 6: return G[14] * xij + G[21];
    case 7: return G[14];
    case 8: return G[14];
    case 9: return G[7] * xij + G[14];
    case 10: return G[7];
    case 11: return G[7];
    case 12: return G[7] * xij + G[14];
    case 13: return G[7];
    case 14: return G[7];
    case 15: return G[7] * xij + G[14];
    case 16: return G[7];
    case 17: return G[7];
    case 18: return G[0] * xij + G[7];
    case 19: return G[0];
    case 20: return G[0];
    case 21: return G[0] * xij + G[7];
    case 22: return G[0];
    case 23: return G[0];
    case 24: return G[0] * xij + G[7];
    case 25: return G[0];
    case 26: return G[0];
    case 27: return G[0] * xij + G[7];
    case 28: return G[0];
    case 29: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpss_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0] * yij + G[7];
    case 2: return G[0];
    case 3: return G[7];
    case 4: return G[7] * yij + G[14];
    case 5: return G[7];
    case 6: return G[0];
    case 7: return G[0] * yij + G[7];
    case 8: return G[0];
    case 9: return G[14];
    case 10: return G[14] * yij + G[21];
    case 11: return G[14];
    case 12: return G[7];
    case 13: return G[7] * yij + G[14];
    case 14: return G[7];
    case 15: return G[0];
    case 16: return G[0] * yij + G[7];
    case 17: return G[0];
    case 18: return G[21];
    case 19: return G[21] * yij + G[28];
    case 20: return G[21];
    case 21: return G[14];
    case 22: return G[14] * yij + G[21];
    case 23: return G[14];
    case 24: return G[7];
    case 25: return G[7] * yij + G[14];
    case 26: return G[7];
    case 27: return G[0];
    case 28: return G[0] * yij + G[7];
    case 29: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpss_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[0] * zij + G[7];
    case 3: return G[0];
    case 4: return G[0];
    case 5: return G[0] * zij + G[7];
    case 6: return G[7];
    case 7: return G[7];
    case 8: return G[7] * zij + G[14];
    case 9: return G[0];
    case 10: return G[0];
    case 11: return G[0] * zij + G[7];
    case 12: return G[7];
    case 13: return G[7];
    case 14: return G[7] * zij + G[14];
    case 15: return G[14];
    case 16: return G[14];
    case 17: return G[14] * zij + G[21];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[0] * zij + G[7];
    case 21: return G[7];
    case 22: return G[7];
    case 23: return G[7] * zij + G[14];
    case 24: return G[14];
    case 25: return G[14];
    case 26: return G[14] * zij + G[21];
    case 27: return G[21];
    case 28: return G[21];
    case 29: return G[21] * zij + G[28];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fpss_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 30;
  constexpr int kNMax = 4;
  constexpr int kMMax = 0;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fpss_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fpss_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fpss_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fdss_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 1: return G[21] * xij + G[28];
    case 2: return G[21] * xij + G[28];
    case 3: return G[21];
    case 4: return G[21];
    case 5: return G[21];
    case 6: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 7: return G[14] * xij + G[21];
    case 8: return G[14] * xij + G[21];
    case 9: return G[14];
    case 10: return G[14];
    case 11: return G[14];
    case 12: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 13: return G[14] * xij + G[21];
    case 14: return G[14] * xij + G[21];
    case 15: return G[14];
    case 16: return G[14];
    case 17: return G[14];
    case 18: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 19: return G[7] * xij + G[14];
    case 20: return G[7] * xij + G[14];
    case 21: return G[7];
    case 22: return G[7];
    case 23: return G[7];
    case 24: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 25: return G[7] * xij + G[14];
    case 26: return G[7] * xij + G[14];
    case 27: return G[7];
    case 28: return G[7];
    case 29: return G[7];
    case 30: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 31: return G[7] * xij + G[14];
    case 32: return G[7] * xij + G[14];
    case 33: return G[7];
    case 34: return G[7];
    case 35: return G[7];
    case 36: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 37: return G[0] * xij + G[7];
    case 38: return G[0] * xij + G[7];
    case 39: return G[0];
    case 40: return G[0];
    case 41: return G[0];
    case 42: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 43: return G[0] * xij + G[7];
    case 44: return G[0] * xij + G[7];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[0];
    case 48: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 49: return G[0] * xij + G[7];
    case 50: return G[0] * xij + G[7];
    case 51: return G[0];
    case 52: return G[0];
    case 53: return G[0];
    case 54: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 55: return G[0] * xij + G[7];
    case 56: return G[0] * xij + G[7];
    case 57: return G[0];
    case 58: return G[0];
    case 59: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdss_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0] * yij + G[7];
    case 2: return G[0];
    case 3: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 4: return G[0] * yij + G[7];
    case 5: return G[0];
    case 6: return G[7];
    case 7: return G[7] * yij + G[14];
    case 8: return G[7];
    case 9: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 10: return G[7] * yij + G[14];
    case 11: return G[7];
    case 12: return G[0];
    case 13: return G[0] * yij + G[7];
    case 14: return G[0];
    case 15: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 16: return G[0] * yij + G[7];
    case 17: return G[0];
    case 18: return G[14];
    case 19: return G[14] * yij + G[21];
    case 20: return G[14];
    case 21: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 22: return G[14] * yij + G[21];
    case 23: return G[14];
    case 24: return G[7];
    case 25: return G[7] * yij + G[14];
    case 26: return G[7];
    case 27: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 28: return G[7] * yij + G[14];
    case 29: return G[7];
    case 30: return G[0];
    case 31: return G[0] * yij + G[7];
    case 32: return G[0];
    case 33: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 34: return G[0] * yij + G[7];
    case 35: return G[0];
    case 36: return G[21];
    case 37: return G[21] * yij + G[28];
    case 38: return G[21];
    case 39: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 40: return G[21] * yij + G[28];
    case 41: return G[21];
    case 42: return G[14];
    case 43: return G[14] * yij + G[21];
    case 44: return G[14];
    case 45: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 46: return G[14] * yij + G[21];
    case 47: return G[14];
    case 48: return G[7];
    case 49: return G[7] * yij + G[14];
    case 50: return G[7];
    case 51: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 52: return G[7] * yij + G[14];
    case 53: return G[7];
    case 54: return G[0];
    case 55: return G[0] * yij + G[7];
    case 56: return G[0];
    case 57: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 58: return G[0] * yij + G[7];
    case 59: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdss_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[0] * zij + G[7];
    case 3: return G[0];
    case 4: return G[0] * zij + G[7];
    case 5: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 6: return G[0];
    case 7: return G[0];
    case 8: return G[0] * zij + G[7];
    case 9: return G[0];
    case 10: return G[0] * zij + G[7];
    case 11: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 12: return G[7];
    case 13: return G[7];
    case 14: return G[7] * zij + G[14];
    case 15: return G[7];
    case 16: return G[7] * zij + G[14];
    case 17: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[0] * zij + G[7];
    case 21: return G[0];
    case 22: return G[0] * zij + G[7];
    case 23: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 24: return G[7];
    case 25: return G[7];
    case 26: return G[7] * zij + G[14];
    case 27: return G[7];
    case 28: return G[7] * zij + G[14];
    case 29: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 30: return G[14];
    case 31: return G[14];
    case 32: return G[14] * zij + G[21];
    case 33: return G[14];
    case 34: return G[14] * zij + G[21];
    case 35: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 36: return G[0];
    case 37: return G[0];
    case 38: return G[0] * zij + G[7];
    case 39: return G[0];
    case 40: return G[0] * zij + G[7];
    case 41: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 42: return G[7];
    case 43: return G[7];
    case 44: return G[7] * zij + G[14];
    case 45: return G[7];
    case 46: return G[7] * zij + G[14];
    case 47: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 48: return G[14];
    case 49: return G[14];
    case 50: return G[14] * zij + G[21];
    case 51: return G[14];
    case 52: return G[14] * zij + G[21];
    case 53: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 54: return G[21];
    case 55: return G[21];
    case 56: return G[21] * zij + G[28];
    case 57: return G[21];
    case 58: return G[21] * zij + G[28];
    case 59: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fdss_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 60;
  constexpr int kNMax = 5;
  constexpr int kMMax = 0;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fdss_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fdss_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fdss_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ffss_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 1: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 2: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 3: return G[21] * xij + G[28];
    case 4: return G[21] * xij + G[28];
    case 5: return G[21] * xij + G[28];
    case 6: return G[21];
    case 7: return G[21];
    case 8: return G[21];
    case 9: return G[21];
    case 10: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 11: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 12: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 13: return G[14] * xij + G[21];
    case 14: return G[14] * xij + G[21];
    case 15: return G[14] * xij + G[21];
    case 16: return G[14];
    case 17: return G[14];
    case 18: return G[14];
    case 19: return G[14];
    case 20: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 21: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 22: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 23: return G[14] * xij + G[21];
    case 24: return G[14] * xij + G[21];
    case 25: return G[14] * xij + G[21];
    case 26: return G[14];
    case 27: return G[14];
    case 28: return G[14];
    case 29: return G[14];
    case 30: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 31: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 32: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 33: return G[7] * xij + G[14];
    case 34: return G[7] * xij + G[14];
    case 35: return G[7] * xij + G[14];
    case 36: return G[7];
    case 37: return G[7];
    case 38: return G[7];
    case 39: return G[7];
    case 40: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 41: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 42: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 43: return G[7] * xij + G[14];
    case 44: return G[7] * xij + G[14];
    case 45: return G[7] * xij + G[14];
    case 46: return G[7];
    case 47: return G[7];
    case 48: return G[7];
    case 49: return G[7];
    case 50: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 51: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 52: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 53: return G[7] * xij + G[14];
    case 54: return G[7] * xij + G[14];
    case 55: return G[7] * xij + G[14];
    case 56: return G[7];
    case 57: return G[7];
    case 58: return G[7];
    case 59: return G[7];
    case 60: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 61: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 62: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 63: return G[0] * xij + G[7];
    case 64: return G[0] * xij + G[7];
    case 65: return G[0] * xij + G[7];
    case 66: return G[0];
    case 67: return G[0];
    case 68: return G[0];
    case 69: return G[0];
    case 70: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 71: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 72: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 73: return G[0] * xij + G[7];
    case 74: return G[0] * xij + G[7];
    case 75: return G[0] * xij + G[7];
    case 76: return G[0];
    case 77: return G[0];
    case 78: return G[0];
    case 79: return G[0];
    case 80: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 81: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 82: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 83: return G[0] * xij + G[7];
    case 84: return G[0] * xij + G[7];
    case 85: return G[0] * xij + G[7];
    case 86: return G[0];
    case 87: return G[0];
    case 88: return G[0];
    case 89: return G[0];
    case 90: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 91: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 92: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 93: return G[0] * xij + G[7];
    case 94: return G[0] * xij + G[7];
    case 95: return G[0] * xij + G[7];
    case 96: return G[0];
    case 97: return G[0];
    case 98: return G[0];
    case 99: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ffss_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0] * yij + G[7];
    case 2: return G[0];
    case 3: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 4: return G[0] * yij + G[7];
    case 5: return G[0];
    case 6: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 7: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 8: return G[0] * yij + G[7];
    case 9: return G[0];
    case 10: return G[7];
    case 11: return G[7] * yij + G[14];
    case 12: return G[7];
    case 13: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 14: return G[7] * yij + G[14];
    case 15: return G[7];
    case 16: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 17: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 18: return G[7] * yij + G[14];
    case 19: return G[7];
    case 20: return G[0];
    case 21: return G[0] * yij + G[7];
    case 22: return G[0];
    case 23: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 24: return G[0] * yij + G[7];
    case 25: return G[0];
    case 26: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 27: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 28: return G[0] * yij + G[7];
    case 29: return G[0];
    case 30: return G[14];
    case 31: return G[14] * yij + G[21];
    case 32: return G[14];
    case 33: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 34: return G[14] * yij + G[21];
    case 35: return G[14];
    case 36: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 37: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 38: return G[14] * yij + G[21];
    case 39: return G[14];
    case 40: return G[7];
    case 41: return G[7] * yij + G[14];
    case 42: return G[7];
    case 43: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 44: return G[7] * yij + G[14];
    case 45: return G[7];
    case 46: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 47: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 48: return G[7] * yij + G[14];
    case 49: return G[7];
    case 50: return G[0];
    case 51: return G[0] * yij + G[7];
    case 52: return G[0];
    case 53: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 54: return G[0] * yij + G[7];
    case 55: return G[0];
    case 56: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 57: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 58: return G[0] * yij + G[7];
    case 59: return G[0];
    case 60: return G[21];
    case 61: return G[21] * yij + G[28];
    case 62: return G[21];
    case 63: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 64: return G[21] * yij + G[28];
    case 65: return G[21];
    case 66: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 67: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 68: return G[21] * yij + G[28];
    case 69: return G[21];
    case 70: return G[14];
    case 71: return G[14] * yij + G[21];
    case 72: return G[14];
    case 73: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 74: return G[14] * yij + G[21];
    case 75: return G[14];
    case 76: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 77: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 78: return G[14] * yij + G[21];
    case 79: return G[14];
    case 80: return G[7];
    case 81: return G[7] * yij + G[14];
    case 82: return G[7];
    case 83: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 84: return G[7] * yij + G[14];
    case 85: return G[7];
    case 86: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 87: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 88: return G[7] * yij + G[14];
    case 89: return G[7];
    case 90: return G[0];
    case 91: return G[0] * yij + G[7];
    case 92: return G[0];
    case 93: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 94: return G[0] * yij + G[7];
    case 95: return G[0];
    case 96: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 97: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 98: return G[0] * yij + G[7];
    case 99: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ffss_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[0] * zij + G[7];
    case 3: return G[0];
    case 4: return G[0] * zij + G[7];
    case 5: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 6: return G[0];
    case 7: return G[0] * zij + G[7];
    case 8: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 9: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[0] * zij + G[7];
    case 13: return G[0];
    case 14: return G[0] * zij + G[7];
    case 15: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 16: return G[0];
    case 17: return G[0] * zij + G[7];
    case 18: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 19: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 20: return G[7];
    case 21: return G[7];
    case 22: return G[7] * zij + G[14];
    case 23: return G[7];
    case 24: return G[7] * zij + G[14];
    case 25: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 26: return G[7];
    case 27: return G[7] * zij + G[14];
    case 28: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 29: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[0] * zij + G[7];
    case 33: return G[0];
    case 34: return G[0] * zij + G[7];
    case 35: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 36: return G[0];
    case 37: return G[0] * zij + G[7];
    case 38: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 39: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 40: return G[7];
    case 41: return G[7];
    case 42: return G[7] * zij + G[14];
    case 43: return G[7];
    case 44: return G[7] * zij + G[14];
    case 45: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 46: return G[7];
    case 47: return G[7] * zij + G[14];
    case 48: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 49: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 50: return G[14];
    case 51: return G[14];
    case 52: return G[14] * zij + G[21];
    case 53: return G[14];
    case 54: return G[14] * zij + G[21];
    case 55: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 56: return G[14];
    case 57: return G[14] * zij + G[21];
    case 58: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 59: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[0] * zij + G[7];
    case 63: return G[0];
    case 64: return G[0] * zij + G[7];
    case 65: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 66: return G[0];
    case 67: return G[0] * zij + G[7];
    case 68: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 69: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[7] * zij + G[14];
    case 73: return G[7];
    case 74: return G[7] * zij + G[14];
    case 75: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 76: return G[7];
    case 77: return G[7] * zij + G[14];
    case 78: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 79: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 80: return G[14];
    case 81: return G[14];
    case 82: return G[14] * zij + G[21];
    case 83: return G[14];
    case 84: return G[14] * zij + G[21];
    case 85: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 86: return G[14];
    case 87: return G[14] * zij + G[21];
    case 88: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 89: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 90: return G[21];
    case 91: return G[21];
    case 92: return G[21] * zij + G[28];
    case 93: return G[21];
    case 94: return G[21] * zij + G[28];
    case 95: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 96: return G[21];
    case 97: return G[21] * zij + G[28];
    case 98: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 99: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ffss_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 100;
  constexpr int kNMax = 6;
  constexpr int kMMax = 0;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ffss_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ffss_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ffss_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fpps_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[22] * xij + G[29];
    case 1: return G[21] * xij + G[28];
    case 2: return G[21] * xij + G[28];
    case 3: return G[22];
    case 4: return G[21];
    case 5: return G[21];
    case 6: return G[22];
    case 7: return G[21];
    case 8: return G[21];
    case 9: return G[15] * xij + G[22];
    case 10: return G[14] * xij + G[21];
    case 11: return G[14] * xij + G[21];
    case 12: return G[15];
    case 13: return G[14];
    case 14: return G[14];
    case 15: return G[15];
    case 16: return G[14];
    case 17: return G[14];
    case 18: return G[15] * xij + G[22];
    case 19: return G[14] * xij + G[21];
    case 20: return G[14] * xij + G[21];
    case 21: return G[15];
    case 22: return G[14];
    case 23: return G[14];
    case 24: return G[15];
    case 25: return G[14];
    case 26: return G[14];
    case 27: return G[8] * xij + G[15];
    case 28: return G[7] * xij + G[14];
    case 29: return G[7] * xij + G[14];
    case 30: return G[8];
    case 31: return G[7];
    case 32: return G[7];
    case 33: return G[8];
    case 34: return G[7];
    case 35: return G[7];
    case 36: return G[8] * xij + G[15];
    case 37: return G[7] * xij + G[14];
    case 38: return G[7] * xij + G[14];
    case 39: return G[8];
    case 40: return G[7];
    case 41: return G[7];
    case 42: return G[8];
    case 43: return G[7];
    case 44: return G[7];
    case 45: return G[8] * xij + G[15];
    case 46: return G[7] * xij + G[14];
    case 47: return G[7] * xij + G[14];
    case 48: return G[8];
    case 49: return G[7];
    case 50: return G[7];
    case 51: return G[8];
    case 52: return G[7];
    case 53: return G[7];
    case 54: return G[1] * xij + G[8];
    case 55: return G[0] * xij + G[7];
    case 56: return G[0] * xij + G[7];
    case 57: return G[1];
    case 58: return G[0];
    case 59: return G[0];
    case 60: return G[1];
    case 61: return G[0];
    case 62: return G[0];
    case 63: return G[1] * xij + G[8];
    case 64: return G[0] * xij + G[7];
    case 65: return G[0] * xij + G[7];
    case 66: return G[1];
    case 67: return G[0];
    case 68: return G[0];
    case 69: return G[1];
    case 70: return G[0];
    case 71: return G[0];
    case 72: return G[1] * xij + G[8];
    case 73: return G[0] * xij + G[7];
    case 74: return G[0] * xij + G[7];
    case 75: return G[1];
    case 76: return G[0];
    case 77: return G[0];
    case 78: return G[1];
    case 79: return G[0];
    case 80: return G[0];
    case 81: return G[1] * xij + G[8];
    case 82: return G[0] * xij + G[7];
    case 83: return G[0] * xij + G[7];
    case 84: return G[1];
    case 85: return G[0];
    case 86: return G[0];
    case 87: return G[1];
    case 88: return G[0];
    case 89: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpps_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[0] * yij + G[7];
    case 4: return G[1] * yij + G[8];
    case 5: return G[0] * yij + G[7];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[0];
    case 9: return G[7];
    case 10: return G[8];
    case 11: return G[7];
    case 12: return G[7] * yij + G[14];
    case 13: return G[8] * yij + G[15];
    case 14: return G[7] * yij + G[14];
    case 15: return G[7];
    case 16: return G[8];
    case 17: return G[7];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[0];
    case 21: return G[0] * yij + G[7];
    case 22: return G[1] * yij + G[8];
    case 23: return G[0] * yij + G[7];
    case 24: return G[0];
    case 25: return G[1];
    case 26: return G[0];
    case 27: return G[14];
    case 28: return G[15];
    case 29: return G[14];
    case 30: return G[14] * yij + G[21];
    case 31: return G[15] * yij + G[22];
    case 32: return G[14] * yij + G[21];
    case 33: return G[14];
    case 34: return G[15];
    case 35: return G[14];
    case 36: return G[7];
    case 37: return G[8];
    case 38: return G[7];
    case 39: return G[7] * yij + G[14];
    case 40: return G[8] * yij + G[15];
    case 41: return G[7] * yij + G[14];
    case 42: return G[7];
    case 43: return G[8];
    case 44: return G[7];
    case 45: return G[0];
    case 46: return G[1];
    case 47: return G[0];
    case 48: return G[0] * yij + G[7];
    case 49: return G[1] * yij + G[8];
    case 50: return G[0] * yij + G[7];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[0];
    case 54: return G[21];
    case 55: return G[22];
    case 56: return G[21];
    case 57: return G[21] * yij + G[28];
    case 58: return G[22] * yij + G[29];
    case 59: return G[21] * yij + G[28];
    case 60: return G[21];
    case 61: return G[22];
    case 62: return G[21];
    case 63: return G[14];
    case 64: return G[15];
    case 65: return G[14];
    case 66: return G[14] * yij + G[21];
    case 67: return G[15] * yij + G[22];
    case 68: return G[14] * yij + G[21];
    case 69: return G[14];
    case 70: return G[15];
    case 71: return G[14];
    case 72: return G[7];
    case 73: return G[8];
    case 74: return G[7];
    case 75: return G[7] * yij + G[14];
    case 76: return G[8] * yij + G[15];
    case 77: return G[7] * yij + G[14];
    case 78: return G[7];
    case 79: return G[8];
    case 80: return G[7];
    case 81: return G[0];
    case 82: return G[1];
    case 83: return G[0];
    case 84: return G[0] * yij + G[7];
    case 85: return G[1] * yij + G[8];
    case 86: return G[0] * yij + G[7];
    case 87: return G[0];
    case 88: return G[1];
    case 89: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpps_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[0];
    case 5: return G[1];
    case 6: return G[0] * zij + G[7];
    case 7: return G[0] * zij + G[7];
    case 8: return G[1] * zij + G[8];
    case 9: return G[0];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[0];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[0] * zij + G[7];
    case 16: return G[0] * zij + G[7];
    case 17: return G[1] * zij + G[8];
    case 18: return G[7];
    case 19: return G[7];
    case 20: return G[8];
    case 21: return G[7];
    case 22: return G[7];
    case 23: return G[8];
    case 24: return G[7] * zij + G[14];
    case 25: return G[7] * zij + G[14];
    case 26: return G[8] * zij + G[15];
    case 27: return G[0];
    case 28: return G[0];
    case 29: return G[1];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0] * zij + G[7];
    case 34: return G[0] * zij + G[7];
    case 35: return G[1] * zij + G[8];
    case 36: return G[7];
    case 37: return G[7];
    case 38: return G[8];
    case 39: return G[7];
    case 40: return G[7];
    case 41: return G[8];
    case 42: return G[7] * zij + G[14];
    case 43: return G[7] * zij + G[14];
    case 44: return G[8] * zij + G[15];
    case 45: return G[14];
    case 46: return G[14];
    case 47: return G[15];
    case 48: return G[14];
    case 49: return G[14];
    case 50: return G[15];
    case 51: return G[14] * zij + G[21];
    case 52: return G[14] * zij + G[21];
    case 53: return G[15] * zij + G[22];
    case 54: return G[0];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[0];
    case 58: return G[0];
    case 59: return G[1];
    case 60: return G[0] * zij + G[7];
    case 61: return G[0] * zij + G[7];
    case 62: return G[1] * zij + G[8];
    case 63: return G[7];
    case 64: return G[7];
    case 65: return G[8];
    case 66: return G[7];
    case 67: return G[7];
    case 68: return G[8];
    case 69: return G[7] * zij + G[14];
    case 70: return G[7] * zij + G[14];
    case 71: return G[8] * zij + G[15];
    case 72: return G[14];
    case 73: return G[14];
    case 74: return G[15];
    case 75: return G[14];
    case 76: return G[14];
    case 77: return G[15];
    case 78: return G[14] * zij + G[21];
    case 79: return G[14] * zij + G[21];
    case 80: return G[15] * zij + G[22];
    case 81: return G[21];
    case 82: return G[21];
    case 83: return G[22];
    case 84: return G[21];
    case 85: return G[21];
    case 86: return G[22];
    case 87: return G[21] * zij + G[28];
    case 88: return G[21] * zij + G[28];
    case 89: return G[22] * zij + G[29];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fpps_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 90;
  constexpr int kNMax = 4;
  constexpr int kMMax = 1;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fpps_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fpps_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fpps_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fdps_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 1: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 2: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 3: return G[22] * xij + G[29];
    case 4: return G[21] * xij + G[28];
    case 5: return G[21] * xij + G[28];
    case 6: return G[22] * xij + G[29];
    case 7: return G[21] * xij + G[28];
    case 8: return G[21] * xij + G[28];
    case 9: return G[22];
    case 10: return G[21];
    case 11: return G[21];
    case 12: return G[22];
    case 13: return G[21];
    case 14: return G[21];
    case 15: return G[22];
    case 16: return G[21];
    case 17: return G[21];
    case 18: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 19: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 20: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 21: return G[15] * xij + G[22];
    case 22: return G[14] * xij + G[21];
    case 23: return G[14] * xij + G[21];
    case 24: return G[15] * xij + G[22];
    case 25: return G[14] * xij + G[21];
    case 26: return G[14] * xij + G[21];
    case 27: return G[15];
    case 28: return G[14];
    case 29: return G[14];
    case 30: return G[15];
    case 31: return G[14];
    case 32: return G[14];
    case 33: return G[15];
    case 34: return G[14];
    case 35: return G[14];
    case 36: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 37: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 38: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 39: return G[15] * xij + G[22];
    case 40: return G[14] * xij + G[21];
    case 41: return G[14] * xij + G[21];
    case 42: return G[15] * xij + G[22];
    case 43: return G[14] * xij + G[21];
    case 44: return G[14] * xij + G[21];
    case 45: return G[15];
    case 46: return G[14];
    case 47: return G[14];
    case 48: return G[15];
    case 49: return G[14];
    case 50: return G[14];
    case 51: return G[15];
    case 52: return G[14];
    case 53: return G[14];
    case 54: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 55: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 56: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 57: return G[8] * xij + G[15];
    case 58: return G[7] * xij + G[14];
    case 59: return G[7] * xij + G[14];
    case 60: return G[8] * xij + G[15];
    case 61: return G[7] * xij + G[14];
    case 62: return G[7] * xij + G[14];
    case 63: return G[8];
    case 64: return G[7];
    case 65: return G[7];
    case 66: return G[8];
    case 67: return G[7];
    case 68: return G[7];
    case 69: return G[8];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 73: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 74: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 75: return G[8] * xij + G[15];
    case 76: return G[7] * xij + G[14];
    case 77: return G[7] * xij + G[14];
    case 78: return G[8] * xij + G[15];
    case 79: return G[7] * xij + G[14];
    case 80: return G[7] * xij + G[14];
    case 81: return G[8];
    case 82: return G[7];
    case 83: return G[7];
    case 84: return G[8];
    case 85: return G[7];
    case 86: return G[7];
    case 87: return G[8];
    case 88: return G[7];
    case 89: return G[7];
    case 90: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 91: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 92: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 93: return G[8] * xij + G[15];
    case 94: return G[7] * xij + G[14];
    case 95: return G[7] * xij + G[14];
    case 96: return G[8] * xij + G[15];
    case 97: return G[7] * xij + G[14];
    case 98: return G[7] * xij + G[14];
    case 99: return G[8];
    case 100: return G[7];
    case 101: return G[7];
    case 102: return G[8];
    case 103: return G[7];
    case 104: return G[7];
    case 105: return G[8];
    case 106: return G[7];
    case 107: return G[7];
    case 108: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 109: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 110: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 111: return G[1] * xij + G[8];
    case 112: return G[0] * xij + G[7];
    case 113: return G[0] * xij + G[7];
    case 114: return G[1] * xij + G[8];
    case 115: return G[0] * xij + G[7];
    case 116: return G[0] * xij + G[7];
    case 117: return G[1];
    case 118: return G[0];
    case 119: return G[0];
    case 120: return G[1];
    case 121: return G[0];
    case 122: return G[0];
    case 123: return G[1];
    case 124: return G[0];
    case 125: return G[0];
    case 126: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 127: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 128: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 129: return G[1] * xij + G[8];
    case 130: return G[0] * xij + G[7];
    case 131: return G[0] * xij + G[7];
    case 132: return G[1] * xij + G[8];
    case 133: return G[0] * xij + G[7];
    case 134: return G[0] * xij + G[7];
    case 135: return G[1];
    case 136: return G[0];
    case 137: return G[0];
    case 138: return G[1];
    case 139: return G[0];
    case 140: return G[0];
    case 141: return G[1];
    case 142: return G[0];
    case 143: return G[0];
    case 144: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 145: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 146: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 147: return G[1] * xij + G[8];
    case 148: return G[0] * xij + G[7];
    case 149: return G[0] * xij + G[7];
    case 150: return G[1] * xij + G[8];
    case 151: return G[0] * xij + G[7];
    case 152: return G[0] * xij + G[7];
    case 153: return G[1];
    case 154: return G[0];
    case 155: return G[0];
    case 156: return G[1];
    case 157: return G[0];
    case 158: return G[0];
    case 159: return G[1];
    case 160: return G[0];
    case 161: return G[0];
    case 162: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 163: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 164: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 165: return G[1] * xij + G[8];
    case 166: return G[0] * xij + G[7];
    case 167: return G[0] * xij + G[7];
    case 168: return G[1] * xij + G[8];
    case 169: return G[0] * xij + G[7];
    case 170: return G[0] * xij + G[7];
    case 171: return G[1];
    case 172: return G[0];
    case 173: return G[0];
    case 174: return G[1];
    case 175: return G[0];
    case 176: return G[0];
    case 177: return G[1];
    case 178: return G[0];
    case 179: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdps_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[0] * yij + G[7];
    case 4: return G[1] * yij + G[8];
    case 5: return G[0] * yij + G[7];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[0];
    case 9: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 10: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 11: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 12: return G[0] * yij + G[7];
    case 13: return G[1] * yij + G[8];
    case 14: return G[0] * yij + G[7];
    case 15: return G[0];
    case 16: return G[1];
    case 17: return G[0];
    case 18: return G[7];
    case 19: return G[8];
    case 20: return G[7];
    case 21: return G[7] * yij + G[14];
    case 22: return G[8] * yij + G[15];
    case 23: return G[7] * yij + G[14];
    case 24: return G[7];
    case 25: return G[8];
    case 26: return G[7];
    case 27: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 28: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 29: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 30: return G[7] * yij + G[14];
    case 31: return G[8] * yij + G[15];
    case 32: return G[7] * yij + G[14];
    case 33: return G[7];
    case 34: return G[8];
    case 35: return G[7];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[0];
    case 39: return G[0] * yij + G[7];
    case 40: return G[1] * yij + G[8];
    case 41: return G[0] * yij + G[7];
    case 42: return G[0];
    case 43: return G[1];
    case 44: return G[0];
    case 45: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 46: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 47: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 48: return G[0] * yij + G[7];
    case 49: return G[1] * yij + G[8];
    case 50: return G[0] * yij + G[7];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[0];
    case 54: return G[14];
    case 55: return G[15];
    case 56: return G[14];
    case 57: return G[14] * yij + G[21];
    case 58: return G[15] * yij + G[22];
    case 59: return G[14] * yij + G[21];
    case 60: return G[14];
    case 61: return G[15];
    case 62: return G[14];
    case 63: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 64: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 65: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 66: return G[14] * yij + G[21];
    case 67: return G[15] * yij + G[22];
    case 68: return G[14] * yij + G[21];
    case 69: return G[14];
    case 70: return G[15];
    case 71: return G[14];
    case 72: return G[7];
    case 73: return G[8];
    case 74: return G[7];
    case 75: return G[7] * yij + G[14];
    case 76: return G[8] * yij + G[15];
    case 77: return G[7] * yij + G[14];
    case 78: return G[7];
    case 79: return G[8];
    case 80: return G[7];
    case 81: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 82: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 83: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 84: return G[7] * yij + G[14];
    case 85: return G[8] * yij + G[15];
    case 86: return G[7] * yij + G[14];
    case 87: return G[7];
    case 88: return G[8];
    case 89: return G[7];
    case 90: return G[0];
    case 91: return G[1];
    case 92: return G[0];
    case 93: return G[0] * yij + G[7];
    case 94: return G[1] * yij + G[8];
    case 95: return G[0] * yij + G[7];
    case 96: return G[0];
    case 97: return G[1];
    case 98: return G[0];
    case 99: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 100: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 101: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 102: return G[0] * yij + G[7];
    case 103: return G[1] * yij + G[8];
    case 104: return G[0] * yij + G[7];
    case 105: return G[0];
    case 106: return G[1];
    case 107: return G[0];
    case 108: return G[21];
    case 109: return G[22];
    case 110: return G[21];
    case 111: return G[21] * yij + G[28];
    case 112: return G[22] * yij + G[29];
    case 113: return G[21] * yij + G[28];
    case 114: return G[21];
    case 115: return G[22];
    case 116: return G[21];
    case 117: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 118: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 119: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 120: return G[21] * yij + G[28];
    case 121: return G[22] * yij + G[29];
    case 122: return G[21] * yij + G[28];
    case 123: return G[21];
    case 124: return G[22];
    case 125: return G[21];
    case 126: return G[14];
    case 127: return G[15];
    case 128: return G[14];
    case 129: return G[14] * yij + G[21];
    case 130: return G[15] * yij + G[22];
    case 131: return G[14] * yij + G[21];
    case 132: return G[14];
    case 133: return G[15];
    case 134: return G[14];
    case 135: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 136: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 137: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 138: return G[14] * yij + G[21];
    case 139: return G[15] * yij + G[22];
    case 140: return G[14] * yij + G[21];
    case 141: return G[14];
    case 142: return G[15];
    case 143: return G[14];
    case 144: return G[7];
    case 145: return G[8];
    case 146: return G[7];
    case 147: return G[7] * yij + G[14];
    case 148: return G[8] * yij + G[15];
    case 149: return G[7] * yij + G[14];
    case 150: return G[7];
    case 151: return G[8];
    case 152: return G[7];
    case 153: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 154: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 155: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 156: return G[7] * yij + G[14];
    case 157: return G[8] * yij + G[15];
    case 158: return G[7] * yij + G[14];
    case 159: return G[7];
    case 160: return G[8];
    case 161: return G[7];
    case 162: return G[0];
    case 163: return G[1];
    case 164: return G[0];
    case 165: return G[0] * yij + G[7];
    case 166: return G[1] * yij + G[8];
    case 167: return G[0] * yij + G[7];
    case 168: return G[0];
    case 169: return G[1];
    case 170: return G[0];
    case 171: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 172: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 173: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 174: return G[0] * yij + G[7];
    case 175: return G[1] * yij + G[8];
    case 176: return G[0] * yij + G[7];
    case 177: return G[0];
    case 178: return G[1];
    case 179: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdps_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[0];
    case 5: return G[1];
    case 6: return G[0] * zij + G[7];
    case 7: return G[0] * zij + G[7];
    case 8: return G[1] * zij + G[8];
    case 9: return G[0];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[0] * zij + G[7];
    case 13: return G[0] * zij + G[7];
    case 14: return G[1] * zij + G[8];
    case 15: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 16: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 17: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[1];
    case 21: return G[0];
    case 22: return G[0];
    case 23: return G[1];
    case 24: return G[0] * zij + G[7];
    case 25: return G[0] * zij + G[7];
    case 26: return G[1] * zij + G[8];
    case 27: return G[0];
    case 28: return G[0];
    case 29: return G[1];
    case 30: return G[0] * zij + G[7];
    case 31: return G[0] * zij + G[7];
    case 32: return G[1] * zij + G[8];
    case 33: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 34: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 35: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 36: return G[7];
    case 37: return G[7];
    case 38: return G[8];
    case 39: return G[7];
    case 40: return G[7];
    case 41: return G[8];
    case 42: return G[7] * zij + G[14];
    case 43: return G[7] * zij + G[14];
    case 44: return G[8] * zij + G[15];
    case 45: return G[7];
    case 46: return G[7];
    case 47: return G[8];
    case 48: return G[7] * zij + G[14];
    case 49: return G[7] * zij + G[14];
    case 50: return G[8] * zij + G[15];
    case 51: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 52: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 53: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 54: return G[0];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[0];
    case 58: return G[0];
    case 59: return G[1];
    case 60: return G[0] * zij + G[7];
    case 61: return G[0] * zij + G[7];
    case 62: return G[1] * zij + G[8];
    case 63: return G[0];
    case 64: return G[0];
    case 65: return G[1];
    case 66: return G[0] * zij + G[7];
    case 67: return G[0] * zij + G[7];
    case 68: return G[1] * zij + G[8];
    case 69: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 70: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 71: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 72: return G[7];
    case 73: return G[7];
    case 74: return G[8];
    case 75: return G[7];
    case 76: return G[7];
    case 77: return G[8];
    case 78: return G[7] * zij + G[14];
    case 79: return G[7] * zij + G[14];
    case 80: return G[8] * zij + G[15];
    case 81: return G[7];
    case 82: return G[7];
    case 83: return G[8];
    case 84: return G[7] * zij + G[14];
    case 85: return G[7] * zij + G[14];
    case 86: return G[8] * zij + G[15];
    case 87: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 88: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 89: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 90: return G[14];
    case 91: return G[14];
    case 92: return G[15];
    case 93: return G[14];
    case 94: return G[14];
    case 95: return G[15];
    case 96: return G[14] * zij + G[21];
    case 97: return G[14] * zij + G[21];
    case 98: return G[15] * zij + G[22];
    case 99: return G[14];
    case 100: return G[14];
    case 101: return G[15];
    case 102: return G[14] * zij + G[21];
    case 103: return G[14] * zij + G[21];
    case 104: return G[15] * zij + G[22];
    case 105: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 106: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 107: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 108: return G[0];
    case 109: return G[0];
    case 110: return G[1];
    case 111: return G[0];
    case 112: return G[0];
    case 113: return G[1];
    case 114: return G[0] * zij + G[7];
    case 115: return G[0] * zij + G[7];
    case 116: return G[1] * zij + G[8];
    case 117: return G[0];
    case 118: return G[0];
    case 119: return G[1];
    case 120: return G[0] * zij + G[7];
    case 121: return G[0] * zij + G[7];
    case 122: return G[1] * zij + G[8];
    case 123: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 124: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 125: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 126: return G[7];
    case 127: return G[7];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[7];
    case 131: return G[8];
    case 132: return G[7] * zij + G[14];
    case 133: return G[7] * zij + G[14];
    case 134: return G[8] * zij + G[15];
    case 135: return G[7];
    case 136: return G[7];
    case 137: return G[8];
    case 138: return G[7] * zij + G[14];
    case 139: return G[7] * zij + G[14];
    case 140: return G[8] * zij + G[15];
    case 141: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 142: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 143: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 144: return G[14];
    case 145: return G[14];
    case 146: return G[15];
    case 147: return G[14];
    case 148: return G[14];
    case 149: return G[15];
    case 150: return G[14] * zij + G[21];
    case 151: return G[14] * zij + G[21];
    case 152: return G[15] * zij + G[22];
    case 153: return G[14];
    case 154: return G[14];
    case 155: return G[15];
    case 156: return G[14] * zij + G[21];
    case 157: return G[14] * zij + G[21];
    case 158: return G[15] * zij + G[22];
    case 159: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 160: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 161: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 162: return G[21];
    case 163: return G[21];
    case 164: return G[22];
    case 165: return G[21];
    case 166: return G[21];
    case 167: return G[22];
    case 168: return G[21] * zij + G[28];
    case 169: return G[21] * zij + G[28];
    case 170: return G[22] * zij + G[29];
    case 171: return G[21];
    case 172: return G[21];
    case 173: return G[22];
    case 174: return G[21] * zij + G[28];
    case 175: return G[21] * zij + G[28];
    case 176: return G[22] * zij + G[29];
    case 177: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 178: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 179: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fdps_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 180;
  constexpr int kNMax = 5;
  constexpr int kMMax = 1;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fdps_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fdps_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fdps_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ffps_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 1: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 2: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 3: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 4: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 5: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 6: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 7: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 8: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 9: return G[22] * xij + G[29];
    case 10: return G[21] * xij + G[28];
    case 11: return G[21] * xij + G[28];
    case 12: return G[22] * xij + G[29];
    case 13: return G[21] * xij + G[28];
    case 14: return G[21] * xij + G[28];
    case 15: return G[22] * xij + G[29];
    case 16: return G[21] * xij + G[28];
    case 17: return G[21] * xij + G[28];
    case 18: return G[22];
    case 19: return G[21];
    case 20: return G[21];
    case 21: return G[22];
    case 22: return G[21];
    case 23: return G[21];
    case 24: return G[22];
    case 25: return G[21];
    case 26: return G[21];
    case 27: return G[22];
    case 28: return G[21];
    case 29: return G[21];
    case 30: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 31: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 32: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 33: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 34: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 35: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 36: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 37: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 38: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 39: return G[15] * xij + G[22];
    case 40: return G[14] * xij + G[21];
    case 41: return G[14] * xij + G[21];
    case 42: return G[15] * xij + G[22];
    case 43: return G[14] * xij + G[21];
    case 44: return G[14] * xij + G[21];
    case 45: return G[15] * xij + G[22];
    case 46: return G[14] * xij + G[21];
    case 47: return G[14] * xij + G[21];
    case 48: return G[15];
    case 49: return G[14];
    case 50: return G[14];
    case 51: return G[15];
    case 52: return G[14];
    case 53: return G[14];
    case 54: return G[15];
    case 55: return G[14];
    case 56: return G[14];
    case 57: return G[15];
    case 58: return G[14];
    case 59: return G[14];
    case 60: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 61: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 62: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 63: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 64: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 65: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 66: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 67: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 68: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 69: return G[15] * xij + G[22];
    case 70: return G[14] * xij + G[21];
    case 71: return G[14] * xij + G[21];
    case 72: return G[15] * xij + G[22];
    case 73: return G[14] * xij + G[21];
    case 74: return G[14] * xij + G[21];
    case 75: return G[15] * xij + G[22];
    case 76: return G[14] * xij + G[21];
    case 77: return G[14] * xij + G[21];
    case 78: return G[15];
    case 79: return G[14];
    case 80: return G[14];
    case 81: return G[15];
    case 82: return G[14];
    case 83: return G[14];
    case 84: return G[15];
    case 85: return G[14];
    case 86: return G[14];
    case 87: return G[15];
    case 88: return G[14];
    case 89: return G[14];
    case 90: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 91: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 92: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 93: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 94: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 95: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 96: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 97: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 98: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 99: return G[8] * xij + G[15];
    case 100: return G[7] * xij + G[14];
    case 101: return G[7] * xij + G[14];
    case 102: return G[8] * xij + G[15];
    case 103: return G[7] * xij + G[14];
    case 104: return G[7] * xij + G[14];
    case 105: return G[8] * xij + G[15];
    case 106: return G[7] * xij + G[14];
    case 107: return G[7] * xij + G[14];
    case 108: return G[8];
    case 109: return G[7];
    case 110: return G[7];
    case 111: return G[8];
    case 112: return G[7];
    case 113: return G[7];
    case 114: return G[8];
    case 115: return G[7];
    case 116: return G[7];
    case 117: return G[8];
    case 118: return G[7];
    case 119: return G[7];
    case 120: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 121: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 122: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 123: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 124: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 125: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 126: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 127: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 128: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 129: return G[8] * xij + G[15];
    case 130: return G[7] * xij + G[14];
    case 131: return G[7] * xij + G[14];
    case 132: return G[8] * xij + G[15];
    case 133: return G[7] * xij + G[14];
    case 134: return G[7] * xij + G[14];
    case 135: return G[8] * xij + G[15];
    case 136: return G[7] * xij + G[14];
    case 137: return G[7] * xij + G[14];
    case 138: return G[8];
    case 139: return G[7];
    case 140: return G[7];
    case 141: return G[8];
    case 142: return G[7];
    case 143: return G[7];
    case 144: return G[8];
    case 145: return G[7];
    case 146: return G[7];
    case 147: return G[8];
    case 148: return G[7];
    case 149: return G[7];
    case 150: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 151: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 152: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 153: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 154: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 155: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 156: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 157: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 158: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 159: return G[8] * xij + G[15];
    case 160: return G[7] * xij + G[14];
    case 161: return G[7] * xij + G[14];
    case 162: return G[8] * xij + G[15];
    case 163: return G[7] * xij + G[14];
    case 164: return G[7] * xij + G[14];
    case 165: return G[8] * xij + G[15];
    case 166: return G[7] * xij + G[14];
    case 167: return G[7] * xij + G[14];
    case 168: return G[8];
    case 169: return G[7];
    case 170: return G[7];
    case 171: return G[8];
    case 172: return G[7];
    case 173: return G[7];
    case 174: return G[8];
    case 175: return G[7];
    case 176: return G[7];
    case 177: return G[8];
    case 178: return G[7];
    case 179: return G[7];
    case 180: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 181: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 182: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 183: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 184: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 185: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 186: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 187: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 188: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 189: return G[1] * xij + G[8];
    case 190: return G[0] * xij + G[7];
    case 191: return G[0] * xij + G[7];
    case 192: return G[1] * xij + G[8];
    case 193: return G[0] * xij + G[7];
    case 194: return G[0] * xij + G[7];
    case 195: return G[1] * xij + G[8];
    case 196: return G[0] * xij + G[7];
    case 197: return G[0] * xij + G[7];
    case 198: return G[1];
    case 199: return G[0];
    case 200: return G[0];
    case 201: return G[1];
    case 202: return G[0];
    case 203: return G[0];
    case 204: return G[1];
    case 205: return G[0];
    case 206: return G[0];
    case 207: return G[1];
    case 208: return G[0];
    case 209: return G[0];
    case 210: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 211: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 212: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 213: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 214: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 215: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 216: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 217: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 218: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 219: return G[1] * xij + G[8];
    case 220: return G[0] * xij + G[7];
    case 221: return G[0] * xij + G[7];
    case 222: return G[1] * xij + G[8];
    case 223: return G[0] * xij + G[7];
    case 224: return G[0] * xij + G[7];
    case 225: return G[1] * xij + G[8];
    case 226: return G[0] * xij + G[7];
    case 227: return G[0] * xij + G[7];
    case 228: return G[1];
    case 229: return G[0];
    case 230: return G[0];
    case 231: return G[1];
    case 232: return G[0];
    case 233: return G[0];
    case 234: return G[1];
    case 235: return G[0];
    case 236: return G[0];
    case 237: return G[1];
    case 238: return G[0];
    case 239: return G[0];
    case 240: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 241: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 242: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 243: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 244: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 245: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 246: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 247: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 248: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 249: return G[1] * xij + G[8];
    case 250: return G[0] * xij + G[7];
    case 251: return G[0] * xij + G[7];
    case 252: return G[1] * xij + G[8];
    case 253: return G[0] * xij + G[7];
    case 254: return G[0] * xij + G[7];
    case 255: return G[1] * xij + G[8];
    case 256: return G[0] * xij + G[7];
    case 257: return G[0] * xij + G[7];
    case 258: return G[1];
    case 259: return G[0];
    case 260: return G[0];
    case 261: return G[1];
    case 262: return G[0];
    case 263: return G[0];
    case 264: return G[1];
    case 265: return G[0];
    case 266: return G[0];
    case 267: return G[1];
    case 268: return G[0];
    case 269: return G[0];
    case 270: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 271: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 272: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 273: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 274: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 275: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 276: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 277: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 278: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 279: return G[1] * xij + G[8];
    case 280: return G[0] * xij + G[7];
    case 281: return G[0] * xij + G[7];
    case 282: return G[1] * xij + G[8];
    case 283: return G[0] * xij + G[7];
    case 284: return G[0] * xij + G[7];
    case 285: return G[1] * xij + G[8];
    case 286: return G[0] * xij + G[7];
    case 287: return G[0] * xij + G[7];
    case 288: return G[1];
    case 289: return G[0];
    case 290: return G[0];
    case 291: return G[1];
    case 292: return G[0];
    case 293: return G[0];
    case 294: return G[1];
    case 295: return G[0];
    case 296: return G[0];
    case 297: return G[1];
    case 298: return G[0];
    case 299: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ffps_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[0] * yij + G[7];
    case 4: return G[1] * yij + G[8];
    case 5: return G[0] * yij + G[7];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[0];
    case 9: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 10: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 11: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 12: return G[0] * yij + G[7];
    case 13: return G[1] * yij + G[8];
    case 14: return G[0] * yij + G[7];
    case 15: return G[0];
    case 16: return G[1];
    case 17: return G[0];
    case 18: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 19: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 20: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 21: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 22: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 23: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 24: return G[0] * yij + G[7];
    case 25: return G[1] * yij + G[8];
    case 26: return G[0] * yij + G[7];
    case 27: return G[0];
    case 28: return G[1];
    case 29: return G[0];
    case 30: return G[7];
    case 31: return G[8];
    case 32: return G[7];
    case 33: return G[7] * yij + G[14];
    case 34: return G[8] * yij + G[15];
    case 35: return G[7] * yij + G[14];
    case 36: return G[7];
    case 37: return G[8];
    case 38: return G[7];
    case 39: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 40: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 41: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 42: return G[7] * yij + G[14];
    case 43: return G[8] * yij + G[15];
    case 44: return G[7] * yij + G[14];
    case 45: return G[7];
    case 46: return G[8];
    case 47: return G[7];
    case 48: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 49: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 50: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 51: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 52: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 53: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 54: return G[7] * yij + G[14];
    case 55: return G[8] * yij + G[15];
    case 56: return G[7] * yij + G[14];
    case 57: return G[7];
    case 58: return G[8];
    case 59: return G[7];
    case 60: return G[0];
    case 61: return G[1];
    case 62: return G[0];
    case 63: return G[0] * yij + G[7];
    case 64: return G[1] * yij + G[8];
    case 65: return G[0] * yij + G[7];
    case 66: return G[0];
    case 67: return G[1];
    case 68: return G[0];
    case 69: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 70: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 71: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 72: return G[0] * yij + G[7];
    case 73: return G[1] * yij + G[8];
    case 74: return G[0] * yij + G[7];
    case 75: return G[0];
    case 76: return G[1];
    case 77: return G[0];
    case 78: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 79: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 80: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 81: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 82: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 83: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 84: return G[0] * yij + G[7];
    case 85: return G[1] * yij + G[8];
    case 86: return G[0] * yij + G[7];
    case 87: return G[0];
    case 88: return G[1];
    case 89: return G[0];
    case 90: return G[14];
    case 91: return G[15];
    case 92: return G[14];
    case 93: return G[14] * yij + G[21];
    case 94: return G[15] * yij + G[22];
    case 95: return G[14] * yij + G[21];
    case 96: return G[14];
    case 97: return G[15];
    case 98: return G[14];
    case 99: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 100: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 101: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 102: return G[14] * yij + G[21];
    case 103: return G[15] * yij + G[22];
    case 104: return G[14] * yij + G[21];
    case 105: return G[14];
    case 106: return G[15];
    case 107: return G[14];
    case 108: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 109: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 110: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 111: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 112: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 113: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 114: return G[14] * yij + G[21];
    case 115: return G[15] * yij + G[22];
    case 116: return G[14] * yij + G[21];
    case 117: return G[14];
    case 118: return G[15];
    case 119: return G[14];
    case 120: return G[7];
    case 121: return G[8];
    case 122: return G[7];
    case 123: return G[7] * yij + G[14];
    case 124: return G[8] * yij + G[15];
    case 125: return G[7] * yij + G[14];
    case 126: return G[7];
    case 127: return G[8];
    case 128: return G[7];
    case 129: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 130: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 131: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 132: return G[7] * yij + G[14];
    case 133: return G[8] * yij + G[15];
    case 134: return G[7] * yij + G[14];
    case 135: return G[7];
    case 136: return G[8];
    case 137: return G[7];
    case 138: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 139: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 140: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 141: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 142: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 143: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 144: return G[7] * yij + G[14];
    case 145: return G[8] * yij + G[15];
    case 146: return G[7] * yij + G[14];
    case 147: return G[7];
    case 148: return G[8];
    case 149: return G[7];
    case 150: return G[0];
    case 151: return G[1];
    case 152: return G[0];
    case 153: return G[0] * yij + G[7];
    case 154: return G[1] * yij + G[8];
    case 155: return G[0] * yij + G[7];
    case 156: return G[0];
    case 157: return G[1];
    case 158: return G[0];
    case 159: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 160: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 161: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 162: return G[0] * yij + G[7];
    case 163: return G[1] * yij + G[8];
    case 164: return G[0] * yij + G[7];
    case 165: return G[0];
    case 166: return G[1];
    case 167: return G[0];
    case 168: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 169: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 170: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 171: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 172: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 173: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 174: return G[0] * yij + G[7];
    case 175: return G[1] * yij + G[8];
    case 176: return G[0] * yij + G[7];
    case 177: return G[0];
    case 178: return G[1];
    case 179: return G[0];
    case 180: return G[21];
    case 181: return G[22];
    case 182: return G[21];
    case 183: return G[21] * yij + G[28];
    case 184: return G[22] * yij + G[29];
    case 185: return G[21] * yij + G[28];
    case 186: return G[21];
    case 187: return G[22];
    case 188: return G[21];
    case 189: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 190: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 191: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 192: return G[21] * yij + G[28];
    case 193: return G[22] * yij + G[29];
    case 194: return G[21] * yij + G[28];
    case 195: return G[21];
    case 196: return G[22];
    case 197: return G[21];
    case 198: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 199: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 200: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 201: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 202: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 203: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 204: return G[21] * yij + G[28];
    case 205: return G[22] * yij + G[29];
    case 206: return G[21] * yij + G[28];
    case 207: return G[21];
    case 208: return G[22];
    case 209: return G[21];
    case 210: return G[14];
    case 211: return G[15];
    case 212: return G[14];
    case 213: return G[14] * yij + G[21];
    case 214: return G[15] * yij + G[22];
    case 215: return G[14] * yij + G[21];
    case 216: return G[14];
    case 217: return G[15];
    case 218: return G[14];
    case 219: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 220: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 221: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 222: return G[14] * yij + G[21];
    case 223: return G[15] * yij + G[22];
    case 224: return G[14] * yij + G[21];
    case 225: return G[14];
    case 226: return G[15];
    case 227: return G[14];
    case 228: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 229: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 230: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 231: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 232: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 233: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 234: return G[14] * yij + G[21];
    case 235: return G[15] * yij + G[22];
    case 236: return G[14] * yij + G[21];
    case 237: return G[14];
    case 238: return G[15];
    case 239: return G[14];
    case 240: return G[7];
    case 241: return G[8];
    case 242: return G[7];
    case 243: return G[7] * yij + G[14];
    case 244: return G[8] * yij + G[15];
    case 245: return G[7] * yij + G[14];
    case 246: return G[7];
    case 247: return G[8];
    case 248: return G[7];
    case 249: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 250: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 251: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 252: return G[7] * yij + G[14];
    case 253: return G[8] * yij + G[15];
    case 254: return G[7] * yij + G[14];
    case 255: return G[7];
    case 256: return G[8];
    case 257: return G[7];
    case 258: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 259: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 260: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 261: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 262: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 263: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 264: return G[7] * yij + G[14];
    case 265: return G[8] * yij + G[15];
    case 266: return G[7] * yij + G[14];
    case 267: return G[7];
    case 268: return G[8];
    case 269: return G[7];
    case 270: return G[0];
    case 271: return G[1];
    case 272: return G[0];
    case 273: return G[0] * yij + G[7];
    case 274: return G[1] * yij + G[8];
    case 275: return G[0] * yij + G[7];
    case 276: return G[0];
    case 277: return G[1];
    case 278: return G[0];
    case 279: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 280: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 281: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 282: return G[0] * yij + G[7];
    case 283: return G[1] * yij + G[8];
    case 284: return G[0] * yij + G[7];
    case 285: return G[0];
    case 286: return G[1];
    case 287: return G[0];
    case 288: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 289: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 290: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 291: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 292: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 293: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 294: return G[0] * yij + G[7];
    case 295: return G[1] * yij + G[8];
    case 296: return G[0] * yij + G[7];
    case 297: return G[0];
    case 298: return G[1];
    case 299: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ffps_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[0];
    case 5: return G[1];
    case 6: return G[0] * zij + G[7];
    case 7: return G[0] * zij + G[7];
    case 8: return G[1] * zij + G[8];
    case 9: return G[0];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[0] * zij + G[7];
    case 13: return G[0] * zij + G[7];
    case 14: return G[1] * zij + G[8];
    case 15: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 16: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 17: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[1];
    case 21: return G[0] * zij + G[7];
    case 22: return G[0] * zij + G[7];
    case 23: return G[1] * zij + G[8];
    case 24: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 25: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 26: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 27: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 28: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 29: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[0];
    case 35: return G[1];
    case 36: return G[0] * zij + G[7];
    case 37: return G[0] * zij + G[7];
    case 38: return G[1] * zij + G[8];
    case 39: return G[0];
    case 40: return G[0];
    case 41: return G[1];
    case 42: return G[0] * zij + G[7];
    case 43: return G[0] * zij + G[7];
    case 44: return G[1] * zij + G[8];
    case 45: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 46: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 47: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 48: return G[0];
    case 49: return G[0];
    case 50: return G[1];
    case 51: return G[0] * zij + G[7];
    case 52: return G[0] * zij + G[7];
    case 53: return G[1] * zij + G[8];
    case 54: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 55: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 56: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 57: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 58: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 59: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 60: return G[7];
    case 61: return G[7];
    case 62: return G[8];
    case 63: return G[7];
    case 64: return G[7];
    case 65: return G[8];
    case 66: return G[7] * zij + G[14];
    case 67: return G[7] * zij + G[14];
    case 68: return G[8] * zij + G[15];
    case 69: return G[7];
    case 70: return G[7];
    case 71: return G[8];
    case 72: return G[7] * zij + G[14];
    case 73: return G[7] * zij + G[14];
    case 74: return G[8] * zij + G[15];
    case 75: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 76: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 77: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 78: return G[7];
    case 79: return G[7];
    case 80: return G[8];
    case 81: return G[7] * zij + G[14];
    case 82: return G[7] * zij + G[14];
    case 83: return G[8] * zij + G[15];
    case 84: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 85: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 86: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 87: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 88: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 89: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 90: return G[0];
    case 91: return G[0];
    case 92: return G[1];
    case 93: return G[0];
    case 94: return G[0];
    case 95: return G[1];
    case 96: return G[0] * zij + G[7];
    case 97: return G[0] * zij + G[7];
    case 98: return G[1] * zij + G[8];
    case 99: return G[0];
    case 100: return G[0];
    case 101: return G[1];
    case 102: return G[0] * zij + G[7];
    case 103: return G[0] * zij + G[7];
    case 104: return G[1] * zij + G[8];
    case 105: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 106: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 107: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 108: return G[0];
    case 109: return G[0];
    case 110: return G[1];
    case 111: return G[0] * zij + G[7];
    case 112: return G[0] * zij + G[7];
    case 113: return G[1] * zij + G[8];
    case 114: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 115: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 116: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 117: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 118: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 119: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 120: return G[7];
    case 121: return G[7];
    case 122: return G[8];
    case 123: return G[7];
    case 124: return G[7];
    case 125: return G[8];
    case 126: return G[7] * zij + G[14];
    case 127: return G[7] * zij + G[14];
    case 128: return G[8] * zij + G[15];
    case 129: return G[7];
    case 130: return G[7];
    case 131: return G[8];
    case 132: return G[7] * zij + G[14];
    case 133: return G[7] * zij + G[14];
    case 134: return G[8] * zij + G[15];
    case 135: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 136: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 137: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 138: return G[7];
    case 139: return G[7];
    case 140: return G[8];
    case 141: return G[7] * zij + G[14];
    case 142: return G[7] * zij + G[14];
    case 143: return G[8] * zij + G[15];
    case 144: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 145: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 146: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 147: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 148: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 149: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 150: return G[14];
    case 151: return G[14];
    case 152: return G[15];
    case 153: return G[14];
    case 154: return G[14];
    case 155: return G[15];
    case 156: return G[14] * zij + G[21];
    case 157: return G[14] * zij + G[21];
    case 158: return G[15] * zij + G[22];
    case 159: return G[14];
    case 160: return G[14];
    case 161: return G[15];
    case 162: return G[14] * zij + G[21];
    case 163: return G[14] * zij + G[21];
    case 164: return G[15] * zij + G[22];
    case 165: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 166: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 167: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 168: return G[14];
    case 169: return G[14];
    case 170: return G[15];
    case 171: return G[14] * zij + G[21];
    case 172: return G[14] * zij + G[21];
    case 173: return G[15] * zij + G[22];
    case 174: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 175: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 176: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 177: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 178: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 179: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 180: return G[0];
    case 181: return G[0];
    case 182: return G[1];
    case 183: return G[0];
    case 184: return G[0];
    case 185: return G[1];
    case 186: return G[0] * zij + G[7];
    case 187: return G[0] * zij + G[7];
    case 188: return G[1] * zij + G[8];
    case 189: return G[0];
    case 190: return G[0];
    case 191: return G[1];
    case 192: return G[0] * zij + G[7];
    case 193: return G[0] * zij + G[7];
    case 194: return G[1] * zij + G[8];
    case 195: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 196: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 197: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 198: return G[0];
    case 199: return G[0];
    case 200: return G[1];
    case 201: return G[0] * zij + G[7];
    case 202: return G[0] * zij + G[7];
    case 203: return G[1] * zij + G[8];
    case 204: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 205: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 206: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 207: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 208: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 209: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 210: return G[7];
    case 211: return G[7];
    case 212: return G[8];
    case 213: return G[7];
    case 214: return G[7];
    case 215: return G[8];
    case 216: return G[7] * zij + G[14];
    case 217: return G[7] * zij + G[14];
    case 218: return G[8] * zij + G[15];
    case 219: return G[7];
    case 220: return G[7];
    case 221: return G[8];
    case 222: return G[7] * zij + G[14];
    case 223: return G[7] * zij + G[14];
    case 224: return G[8] * zij + G[15];
    case 225: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 226: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 227: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 228: return G[7];
    case 229: return G[7];
    case 230: return G[8];
    case 231: return G[7] * zij + G[14];
    case 232: return G[7] * zij + G[14];
    case 233: return G[8] * zij + G[15];
    case 234: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 235: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 236: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 237: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 238: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 239: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 240: return G[14];
    case 241: return G[14];
    case 242: return G[15];
    case 243: return G[14];
    case 244: return G[14];
    case 245: return G[15];
    case 246: return G[14] * zij + G[21];
    case 247: return G[14] * zij + G[21];
    case 248: return G[15] * zij + G[22];
    case 249: return G[14];
    case 250: return G[14];
    case 251: return G[15];
    case 252: return G[14] * zij + G[21];
    case 253: return G[14] * zij + G[21];
    case 254: return G[15] * zij + G[22];
    case 255: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 256: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 257: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 258: return G[14];
    case 259: return G[14];
    case 260: return G[15];
    case 261: return G[14] * zij + G[21];
    case 262: return G[14] * zij + G[21];
    case 263: return G[15] * zij + G[22];
    case 264: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 265: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 266: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 267: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 268: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 269: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 270: return G[21];
    case 271: return G[21];
    case 272: return G[22];
    case 273: return G[21];
    case 274: return G[21];
    case 275: return G[22];
    case 276: return G[21] * zij + G[28];
    case 277: return G[21] * zij + G[28];
    case 278: return G[22] * zij + G[29];
    case 279: return G[21];
    case 280: return G[21];
    case 281: return G[22];
    case 282: return G[21] * zij + G[28];
    case 283: return G[21] * zij + G[28];
    case 284: return G[22] * zij + G[29];
    case 285: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 286: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 287: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 288: return G[21];
    case 289: return G[21];
    case 290: return G[22];
    case 291: return G[21] * zij + G[28];
    case 292: return G[21] * zij + G[28];
    case 293: return G[22] * zij + G[29];
    case 294: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 295: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 296: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 297: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 298: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 299: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ffps_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 300;
  constexpr int kNMax = 6;
  constexpr int kMMax = 1;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ffps_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ffps_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ffps_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fpds_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[23] * xij + G[30];
    case 1: return G[22] * xij + G[29];
    case 2: return G[22] * xij + G[29];
    case 3: return G[21] * xij + G[28];
    case 4: return G[21] * xij + G[28];
    case 5: return G[21] * xij + G[28];
    case 6: return G[23];
    case 7: return G[22];
    case 8: return G[22];
    case 9: return G[21];
    case 10: return G[21];
    case 11: return G[21];
    case 12: return G[23];
    case 13: return G[22];
    case 14: return G[22];
    case 15: return G[21];
    case 16: return G[21];
    case 17: return G[21];
    case 18: return G[16] * xij + G[23];
    case 19: return G[15] * xij + G[22];
    case 20: return G[15] * xij + G[22];
    case 21: return G[14] * xij + G[21];
    case 22: return G[14] * xij + G[21];
    case 23: return G[14] * xij + G[21];
    case 24: return G[16];
    case 25: return G[15];
    case 26: return G[15];
    case 27: return G[14];
    case 28: return G[14];
    case 29: return G[14];
    case 30: return G[16];
    case 31: return G[15];
    case 32: return G[15];
    case 33: return G[14];
    case 34: return G[14];
    case 35: return G[14];
    case 36: return G[16] * xij + G[23];
    case 37: return G[15] * xij + G[22];
    case 38: return G[15] * xij + G[22];
    case 39: return G[14] * xij + G[21];
    case 40: return G[14] * xij + G[21];
    case 41: return G[14] * xij + G[21];
    case 42: return G[16];
    case 43: return G[15];
    case 44: return G[15];
    case 45: return G[14];
    case 46: return G[14];
    case 47: return G[14];
    case 48: return G[16];
    case 49: return G[15];
    case 50: return G[15];
    case 51: return G[14];
    case 52: return G[14];
    case 53: return G[14];
    case 54: return G[9] * xij + G[16];
    case 55: return G[8] * xij + G[15];
    case 56: return G[8] * xij + G[15];
    case 57: return G[7] * xij + G[14];
    case 58: return G[7] * xij + G[14];
    case 59: return G[7] * xij + G[14];
    case 60: return G[9];
    case 61: return G[8];
    case 62: return G[8];
    case 63: return G[7];
    case 64: return G[7];
    case 65: return G[7];
    case 66: return G[9];
    case 67: return G[8];
    case 68: return G[8];
    case 69: return G[7];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[9] * xij + G[16];
    case 73: return G[8] * xij + G[15];
    case 74: return G[8] * xij + G[15];
    case 75: return G[7] * xij + G[14];
    case 76: return G[7] * xij + G[14];
    case 77: return G[7] * xij + G[14];
    case 78: return G[9];
    case 79: return G[8];
    case 80: return G[8];
    case 81: return G[7];
    case 82: return G[7];
    case 83: return G[7];
    case 84: return G[9];
    case 85: return G[8];
    case 86: return G[8];
    case 87: return G[7];
    case 88: return G[7];
    case 89: return G[7];
    case 90: return G[9] * xij + G[16];
    case 91: return G[8] * xij + G[15];
    case 92: return G[8] * xij + G[15];
    case 93: return G[7] * xij + G[14];
    case 94: return G[7] * xij + G[14];
    case 95: return G[7] * xij + G[14];
    case 96: return G[9];
    case 97: return G[8];
    case 98: return G[8];
    case 99: return G[7];
    case 100: return G[7];
    case 101: return G[7];
    case 102: return G[9];
    case 103: return G[8];
    case 104: return G[8];
    case 105: return G[7];
    case 106: return G[7];
    case 107: return G[7];
    case 108: return G[2] * xij + G[9];
    case 109: return G[1] * xij + G[8];
    case 110: return G[1] * xij + G[8];
    case 111: return G[0] * xij + G[7];
    case 112: return G[0] * xij + G[7];
    case 113: return G[0] * xij + G[7];
    case 114: return G[2];
    case 115: return G[1];
    case 116: return G[1];
    case 117: return G[0];
    case 118: return G[0];
    case 119: return G[0];
    case 120: return G[2];
    case 121: return G[1];
    case 122: return G[1];
    case 123: return G[0];
    case 124: return G[0];
    case 125: return G[0];
    case 126: return G[2] * xij + G[9];
    case 127: return G[1] * xij + G[8];
    case 128: return G[1] * xij + G[8];
    case 129: return G[0] * xij + G[7];
    case 130: return G[0] * xij + G[7];
    case 131: return G[0] * xij + G[7];
    case 132: return G[2];
    case 133: return G[1];
    case 134: return G[1];
    case 135: return G[0];
    case 136: return G[0];
    case 137: return G[0];
    case 138: return G[2];
    case 139: return G[1];
    case 140: return G[1];
    case 141: return G[0];
    case 142: return G[0];
    case 143: return G[0];
    case 144: return G[2] * xij + G[9];
    case 145: return G[1] * xij + G[8];
    case 146: return G[1] * xij + G[8];
    case 147: return G[0] * xij + G[7];
    case 148: return G[0] * xij + G[7];
    case 149: return G[0] * xij + G[7];
    case 150: return G[2];
    case 151: return G[1];
    case 152: return G[1];
    case 153: return G[0];
    case 154: return G[0];
    case 155: return G[0];
    case 156: return G[2];
    case 157: return G[1];
    case 158: return G[1];
    case 159: return G[0];
    case 160: return G[0];
    case 161: return G[0];
    case 162: return G[2] * xij + G[9];
    case 163: return G[1] * xij + G[8];
    case 164: return G[1] * xij + G[8];
    case 165: return G[0] * xij + G[7];
    case 166: return G[0] * xij + G[7];
    case 167: return G[0] * xij + G[7];
    case 168: return G[2];
    case 169: return G[1];
    case 170: return G[1];
    case 171: return G[0];
    case 172: return G[0];
    case 173: return G[0];
    case 174: return G[2];
    case 175: return G[1];
    case 176: return G[1];
    case 177: return G[0];
    case 178: return G[0];
    case 179: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpds_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[0] * yij + G[7];
    case 7: return G[1] * yij + G[8];
    case 8: return G[0] * yij + G[7];
    case 9: return G[2] * yij + G[9];
    case 10: return G[1] * yij + G[8];
    case 11: return G[0] * yij + G[7];
    case 12: return G[0];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[2];
    case 16: return G[1];
    case 17: return G[0];
    case 18: return G[7];
    case 19: return G[8];
    case 20: return G[7];
    case 21: return G[9];
    case 22: return G[8];
    case 23: return G[7];
    case 24: return G[7] * yij + G[14];
    case 25: return G[8] * yij + G[15];
    case 26: return G[7] * yij + G[14];
    case 27: return G[9] * yij + G[16];
    case 28: return G[8] * yij + G[15];
    case 29: return G[7] * yij + G[14];
    case 30: return G[7];
    case 31: return G[8];
    case 32: return G[7];
    case 33: return G[9];
    case 34: return G[8];
    case 35: return G[7];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[0];
    case 39: return G[2];
    case 40: return G[1];
    case 41: return G[0];
    case 42: return G[0] * yij + G[7];
    case 43: return G[1] * yij + G[8];
    case 44: return G[0] * yij + G[7];
    case 45: return G[2] * yij + G[9];
    case 46: return G[1] * yij + G[8];
    case 47: return G[0] * yij + G[7];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[0];
    case 51: return G[2];
    case 52: return G[1];
    case 53: return G[0];
    case 54: return G[14];
    case 55: return G[15];
    case 56: return G[14];
    case 57: return G[16];
    case 58: return G[15];
    case 59: return G[14];
    case 60: return G[14] * yij + G[21];
    case 61: return G[15] * yij + G[22];
    case 62: return G[14] * yij + G[21];
    case 63: return G[16] * yij + G[23];
    case 64: return G[15] * yij + G[22];
    case 65: return G[14] * yij + G[21];
    case 66: return G[14];
    case 67: return G[15];
    case 68: return G[14];
    case 69: return G[16];
    case 70: return G[15];
    case 71: return G[14];
    case 72: return G[7];
    case 73: return G[8];
    case 74: return G[7];
    case 75: return G[9];
    case 76: return G[8];
    case 77: return G[7];
    case 78: return G[7] * yij + G[14];
    case 79: return G[8] * yij + G[15];
    case 80: return G[7] * yij + G[14];
    case 81: return G[9] * yij + G[16];
    case 82: return G[8] * yij + G[15];
    case 83: return G[7] * yij + G[14];
    case 84: return G[7];
    case 85: return G[8];
    case 86: return G[7];
    case 87: return G[9];
    case 88: return G[8];
    case 89: return G[7];
    case 90: return G[0];
    case 91: return G[1];
    case 92: return G[0];
    case 93: return G[2];
    case 94: return G[1];
    case 95: return G[0];
    case 96: return G[0] * yij + G[7];
    case 97: return G[1] * yij + G[8];
    case 98: return G[0] * yij + G[7];
    case 99: return G[2] * yij + G[9];
    case 100: return G[1] * yij + G[8];
    case 101: return G[0] * yij + G[7];
    case 102: return G[0];
    case 103: return G[1];
    case 104: return G[0];
    case 105: return G[2];
    case 106: return G[1];
    case 107: return G[0];
    case 108: return G[21];
    case 109: return G[22];
    case 110: return G[21];
    case 111: return G[23];
    case 112: return G[22];
    case 113: return G[21];
    case 114: return G[21] * yij + G[28];
    case 115: return G[22] * yij + G[29];
    case 116: return G[21] * yij + G[28];
    case 117: return G[23] * yij + G[30];
    case 118: return G[22] * yij + G[29];
    case 119: return G[21] * yij + G[28];
    case 120: return G[21];
    case 121: return G[22];
    case 122: return G[21];
    case 123: return G[23];
    case 124: return G[22];
    case 125: return G[21];
    case 126: return G[14];
    case 127: return G[15];
    case 128: return G[14];
    case 129: return G[16];
    case 130: return G[15];
    case 131: return G[14];
    case 132: return G[14] * yij + G[21];
    case 133: return G[15] * yij + G[22];
    case 134: return G[14] * yij + G[21];
    case 135: return G[16] * yij + G[23];
    case 136: return G[15] * yij + G[22];
    case 137: return G[14] * yij + G[21];
    case 138: return G[14];
    case 139: return G[15];
    case 140: return G[14];
    case 141: return G[16];
    case 142: return G[15];
    case 143: return G[14];
    case 144: return G[7];
    case 145: return G[8];
    case 146: return G[7];
    case 147: return G[9];
    case 148: return G[8];
    case 149: return G[7];
    case 150: return G[7] * yij + G[14];
    case 151: return G[8] * yij + G[15];
    case 152: return G[7] * yij + G[14];
    case 153: return G[9] * yij + G[16];
    case 154: return G[8] * yij + G[15];
    case 155: return G[7] * yij + G[14];
    case 156: return G[7];
    case 157: return G[8];
    case 158: return G[7];
    case 159: return G[9];
    case 160: return G[8];
    case 161: return G[7];
    case 162: return G[0];
    case 163: return G[1];
    case 164: return G[0];
    case 165: return G[2];
    case 166: return G[1];
    case 167: return G[0];
    case 168: return G[0] * yij + G[7];
    case 169: return G[1] * yij + G[8];
    case 170: return G[0] * yij + G[7];
    case 171: return G[2] * yij + G[9];
    case 172: return G[1] * yij + G[8];
    case 173: return G[0] * yij + G[7];
    case 174: return G[0];
    case 175: return G[1];
    case 176: return G[0];
    case 177: return G[2];
    case 178: return G[1];
    case 179: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpds_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[0];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[1];
    case 11: return G[2];
    case 12: return G[0] * zij + G[7];
    case 13: return G[0] * zij + G[7];
    case 14: return G[1] * zij + G[8];
    case 15: return G[0] * zij + G[7];
    case 16: return G[1] * zij + G[8];
    case 17: return G[2] * zij + G[9];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[1];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[0];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[0];
    case 28: return G[1];
    case 29: return G[2];
    case 30: return G[0] * zij + G[7];
    case 31: return G[0] * zij + G[7];
    case 32: return G[1] * zij + G[8];
    case 33: return G[0] * zij + G[7];
    case 34: return G[1] * zij + G[8];
    case 35: return G[2] * zij + G[9];
    case 36: return G[7];
    case 37: return G[7];
    case 38: return G[8];
    case 39: return G[7];
    case 40: return G[8];
    case 41: return G[9];
    case 42: return G[7];
    case 43: return G[7];
    case 44: return G[8];
    case 45: return G[7];
    case 46: return G[8];
    case 47: return G[9];
    case 48: return G[7] * zij + G[14];
    case 49: return G[7] * zij + G[14];
    case 50: return G[8] * zij + G[15];
    case 51: return G[7] * zij + G[14];
    case 52: return G[8] * zij + G[15];
    case 53: return G[9] * zij + G[16];
    case 54: return G[0];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[0];
    case 58: return G[1];
    case 59: return G[2];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[1];
    case 63: return G[0];
    case 64: return G[1];
    case 65: return G[2];
    case 66: return G[0] * zij + G[7];
    case 67: return G[0] * zij + G[7];
    case 68: return G[1] * zij + G[8];
    case 69: return G[0] * zij + G[7];
    case 70: return G[1] * zij + G[8];
    case 71: return G[2] * zij + G[9];
    case 72: return G[7];
    case 73: return G[7];
    case 74: return G[8];
    case 75: return G[7];
    case 76: return G[8];
    case 77: return G[9];
    case 78: return G[7];
    case 79: return G[7];
    case 80: return G[8];
    case 81: return G[7];
    case 82: return G[8];
    case 83: return G[9];
    case 84: return G[7] * zij + G[14];
    case 85: return G[7] * zij + G[14];
    case 86: return G[8] * zij + G[15];
    case 87: return G[7] * zij + G[14];
    case 88: return G[8] * zij + G[15];
    case 89: return G[9] * zij + G[16];
    case 90: return G[14];
    case 91: return G[14];
    case 92: return G[15];
    case 93: return G[14];
    case 94: return G[15];
    case 95: return G[16];
    case 96: return G[14];
    case 97: return G[14];
    case 98: return G[15];
    case 99: return G[14];
    case 100: return G[15];
    case 101: return G[16];
    case 102: return G[14] * zij + G[21];
    case 103: return G[14] * zij + G[21];
    case 104: return G[15] * zij + G[22];
    case 105: return G[14] * zij + G[21];
    case 106: return G[15] * zij + G[22];
    case 107: return G[16] * zij + G[23];
    case 108: return G[0];
    case 109: return G[0];
    case 110: return G[1];
    case 111: return G[0];
    case 112: return G[1];
    case 113: return G[2];
    case 114: return G[0];
    case 115: return G[0];
    case 116: return G[1];
    case 117: return G[0];
    case 118: return G[1];
    case 119: return G[2];
    case 120: return G[0] * zij + G[7];
    case 121: return G[0] * zij + G[7];
    case 122: return G[1] * zij + G[8];
    case 123: return G[0] * zij + G[7];
    case 124: return G[1] * zij + G[8];
    case 125: return G[2] * zij + G[9];
    case 126: return G[7];
    case 127: return G[7];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[8];
    case 131: return G[9];
    case 132: return G[7];
    case 133: return G[7];
    case 134: return G[8];
    case 135: return G[7];
    case 136: return G[8];
    case 137: return G[9];
    case 138: return G[7] * zij + G[14];
    case 139: return G[7] * zij + G[14];
    case 140: return G[8] * zij + G[15];
    case 141: return G[7] * zij + G[14];
    case 142: return G[8] * zij + G[15];
    case 143: return G[9] * zij + G[16];
    case 144: return G[14];
    case 145: return G[14];
    case 146: return G[15];
    case 147: return G[14];
    case 148: return G[15];
    case 149: return G[16];
    case 150: return G[14];
    case 151: return G[14];
    case 152: return G[15];
    case 153: return G[14];
    case 154: return G[15];
    case 155: return G[16];
    case 156: return G[14] * zij + G[21];
    case 157: return G[14] * zij + G[21];
    case 158: return G[15] * zij + G[22];
    case 159: return G[14] * zij + G[21];
    case 160: return G[15] * zij + G[22];
    case 161: return G[16] * zij + G[23];
    case 162: return G[21];
    case 163: return G[21];
    case 164: return G[22];
    case 165: return G[21];
    case 166: return G[22];
    case 167: return G[23];
    case 168: return G[21];
    case 169: return G[21];
    case 170: return G[22];
    case 171: return G[21];
    case 172: return G[22];
    case 173: return G[23];
    case 174: return G[21] * zij + G[28];
    case 175: return G[21] * zij + G[28];
    case 176: return G[22] * zij + G[29];
    case 177: return G[21] * zij + G[28];
    case 178: return G[22] * zij + G[29];
    case 179: return G[23] * zij + G[30];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fpds_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 180;
  constexpr int kNMax = 4;
  constexpr int kMMax = 2;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fpds_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fpds_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fpds_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fdds_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 1: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 2: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 3: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 4: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 5: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 6: return G[23] * xij + G[30];
    case 7: return G[22] * xij + G[29];
    case 8: return G[22] * xij + G[29];
    case 9: return G[21] * xij + G[28];
    case 10: return G[21] * xij + G[28];
    case 11: return G[21] * xij + G[28];
    case 12: return G[23] * xij + G[30];
    case 13: return G[22] * xij + G[29];
    case 14: return G[22] * xij + G[29];
    case 15: return G[21] * xij + G[28];
    case 16: return G[21] * xij + G[28];
    case 17: return G[21] * xij + G[28];
    case 18: return G[23];
    case 19: return G[22];
    case 20: return G[22];
    case 21: return G[21];
    case 22: return G[21];
    case 23: return G[21];
    case 24: return G[23];
    case 25: return G[22];
    case 26: return G[22];
    case 27: return G[21];
    case 28: return G[21];
    case 29: return G[21];
    case 30: return G[23];
    case 31: return G[22];
    case 32: return G[22];
    case 33: return G[21];
    case 34: return G[21];
    case 35: return G[21];
    case 36: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 37: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 38: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 39: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 40: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 41: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 42: return G[16] * xij + G[23];
    case 43: return G[15] * xij + G[22];
    case 44: return G[15] * xij + G[22];
    case 45: return G[14] * xij + G[21];
    case 46: return G[14] * xij + G[21];
    case 47: return G[14] * xij + G[21];
    case 48: return G[16] * xij + G[23];
    case 49: return G[15] * xij + G[22];
    case 50: return G[15] * xij + G[22];
    case 51: return G[14] * xij + G[21];
    case 52: return G[14] * xij + G[21];
    case 53: return G[14] * xij + G[21];
    case 54: return G[16];
    case 55: return G[15];
    case 56: return G[15];
    case 57: return G[14];
    case 58: return G[14];
    case 59: return G[14];
    case 60: return G[16];
    case 61: return G[15];
    case 62: return G[15];
    case 63: return G[14];
    case 64: return G[14];
    case 65: return G[14];
    case 66: return G[16];
    case 67: return G[15];
    case 68: return G[15];
    case 69: return G[14];
    case 70: return G[14];
    case 71: return G[14];
    case 72: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 73: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 74: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 75: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 76: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 77: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 78: return G[16] * xij + G[23];
    case 79: return G[15] * xij + G[22];
    case 80: return G[15] * xij + G[22];
    case 81: return G[14] * xij + G[21];
    case 82: return G[14] * xij + G[21];
    case 83: return G[14] * xij + G[21];
    case 84: return G[16] * xij + G[23];
    case 85: return G[15] * xij + G[22];
    case 86: return G[15] * xij + G[22];
    case 87: return G[14] * xij + G[21];
    case 88: return G[14] * xij + G[21];
    case 89: return G[14] * xij + G[21];
    case 90: return G[16];
    case 91: return G[15];
    case 92: return G[15];
    case 93: return G[14];
    case 94: return G[14];
    case 95: return G[14];
    case 96: return G[16];
    case 97: return G[15];
    case 98: return G[15];
    case 99: return G[14];
    case 100: return G[14];
    case 101: return G[14];
    case 102: return G[16];
    case 103: return G[15];
    case 104: return G[15];
    case 105: return G[14];
    case 106: return G[14];
    case 107: return G[14];
    case 108: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 109: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 110: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 111: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 112: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 113: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 114: return G[9] * xij + G[16];
    case 115: return G[8] * xij + G[15];
    case 116: return G[8] * xij + G[15];
    case 117: return G[7] * xij + G[14];
    case 118: return G[7] * xij + G[14];
    case 119: return G[7] * xij + G[14];
    case 120: return G[9] * xij + G[16];
    case 121: return G[8] * xij + G[15];
    case 122: return G[8] * xij + G[15];
    case 123: return G[7] * xij + G[14];
    case 124: return G[7] * xij + G[14];
    case 125: return G[7] * xij + G[14];
    case 126: return G[9];
    case 127: return G[8];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[7];
    case 131: return G[7];
    case 132: return G[9];
    case 133: return G[8];
    case 134: return G[8];
    case 135: return G[7];
    case 136: return G[7];
    case 137: return G[7];
    case 138: return G[9];
    case 139: return G[8];
    case 140: return G[8];
    case 141: return G[7];
    case 142: return G[7];
    case 143: return G[7];
    case 144: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 145: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 146: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 147: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 148: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 149: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 150: return G[9] * xij + G[16];
    case 151: return G[8] * xij + G[15];
    case 152: return G[8] * xij + G[15];
    case 153: return G[7] * xij + G[14];
    case 154: return G[7] * xij + G[14];
    case 155: return G[7] * xij + G[14];
    case 156: return G[9] * xij + G[16];
    case 157: return G[8] * xij + G[15];
    case 158: return G[8] * xij + G[15];
    case 159: return G[7] * xij + G[14];
    case 160: return G[7] * xij + G[14];
    case 161: return G[7] * xij + G[14];
    case 162: return G[9];
    case 163: return G[8];
    case 164: return G[8];
    case 165: return G[7];
    case 166: return G[7];
    case 167: return G[7];
    case 168: return G[9];
    case 169: return G[8];
    case 170: return G[8];
    case 171: return G[7];
    case 172: return G[7];
    case 173: return G[7];
    case 174: return G[9];
    case 175: return G[8];
    case 176: return G[8];
    case 177: return G[7];
    case 178: return G[7];
    case 179: return G[7];
    case 180: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 181: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 182: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 183: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 184: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 185: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 186: return G[9] * xij + G[16];
    case 187: return G[8] * xij + G[15];
    case 188: return G[8] * xij + G[15];
    case 189: return G[7] * xij + G[14];
    case 190: return G[7] * xij + G[14];
    case 191: return G[7] * xij + G[14];
    case 192: return G[9] * xij + G[16];
    case 193: return G[8] * xij + G[15];
    case 194: return G[8] * xij + G[15];
    case 195: return G[7] * xij + G[14];
    case 196: return G[7] * xij + G[14];
    case 197: return G[7] * xij + G[14];
    case 198: return G[9];
    case 199: return G[8];
    case 200: return G[8];
    case 201: return G[7];
    case 202: return G[7];
    case 203: return G[7];
    case 204: return G[9];
    case 205: return G[8];
    case 206: return G[8];
    case 207: return G[7];
    case 208: return G[7];
    case 209: return G[7];
    case 210: return G[9];
    case 211: return G[8];
    case 212: return G[8];
    case 213: return G[7];
    case 214: return G[7];
    case 215: return G[7];
    case 216: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 217: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 218: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 219: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 220: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 221: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 222: return G[2] * xij + G[9];
    case 223: return G[1] * xij + G[8];
    case 224: return G[1] * xij + G[8];
    case 225: return G[0] * xij + G[7];
    case 226: return G[0] * xij + G[7];
    case 227: return G[0] * xij + G[7];
    case 228: return G[2] * xij + G[9];
    case 229: return G[1] * xij + G[8];
    case 230: return G[1] * xij + G[8];
    case 231: return G[0] * xij + G[7];
    case 232: return G[0] * xij + G[7];
    case 233: return G[0] * xij + G[7];
    case 234: return G[2];
    case 235: return G[1];
    case 236: return G[1];
    case 237: return G[0];
    case 238: return G[0];
    case 239: return G[0];
    case 240: return G[2];
    case 241: return G[1];
    case 242: return G[1];
    case 243: return G[0];
    case 244: return G[0];
    case 245: return G[0];
    case 246: return G[2];
    case 247: return G[1];
    case 248: return G[1];
    case 249: return G[0];
    case 250: return G[0];
    case 251: return G[0];
    case 252: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 253: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 254: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 255: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 256: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 257: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 258: return G[2] * xij + G[9];
    case 259: return G[1] * xij + G[8];
    case 260: return G[1] * xij + G[8];
    case 261: return G[0] * xij + G[7];
    case 262: return G[0] * xij + G[7];
    case 263: return G[0] * xij + G[7];
    case 264: return G[2] * xij + G[9];
    case 265: return G[1] * xij + G[8];
    case 266: return G[1] * xij + G[8];
    case 267: return G[0] * xij + G[7];
    case 268: return G[0] * xij + G[7];
    case 269: return G[0] * xij + G[7];
    case 270: return G[2];
    case 271: return G[1];
    case 272: return G[1];
    case 273: return G[0];
    case 274: return G[0];
    case 275: return G[0];
    case 276: return G[2];
    case 277: return G[1];
    case 278: return G[1];
    case 279: return G[0];
    case 280: return G[0];
    case 281: return G[0];
    case 282: return G[2];
    case 283: return G[1];
    case 284: return G[1];
    case 285: return G[0];
    case 286: return G[0];
    case 287: return G[0];
    case 288: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 289: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 290: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 291: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 292: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 293: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 294: return G[2] * xij + G[9];
    case 295: return G[1] * xij + G[8];
    case 296: return G[1] * xij + G[8];
    case 297: return G[0] * xij + G[7];
    case 298: return G[0] * xij + G[7];
    case 299: return G[0] * xij + G[7];
    case 300: return G[2] * xij + G[9];
    case 301: return G[1] * xij + G[8];
    case 302: return G[1] * xij + G[8];
    case 303: return G[0] * xij + G[7];
    case 304: return G[0] * xij + G[7];
    case 305: return G[0] * xij + G[7];
    case 306: return G[2];
    case 307: return G[1];
    case 308: return G[1];
    case 309: return G[0];
    case 310: return G[0];
    case 311: return G[0];
    case 312: return G[2];
    case 313: return G[1];
    case 314: return G[1];
    case 315: return G[0];
    case 316: return G[0];
    case 317: return G[0];
    case 318: return G[2];
    case 319: return G[1];
    case 320: return G[1];
    case 321: return G[0];
    case 322: return G[0];
    case 323: return G[0];
    case 324: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 325: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 326: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 327: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 328: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 329: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 330: return G[2] * xij + G[9];
    case 331: return G[1] * xij + G[8];
    case 332: return G[1] * xij + G[8];
    case 333: return G[0] * xij + G[7];
    case 334: return G[0] * xij + G[7];
    case 335: return G[0] * xij + G[7];
    case 336: return G[2] * xij + G[9];
    case 337: return G[1] * xij + G[8];
    case 338: return G[1] * xij + G[8];
    case 339: return G[0] * xij + G[7];
    case 340: return G[0] * xij + G[7];
    case 341: return G[0] * xij + G[7];
    case 342: return G[2];
    case 343: return G[1];
    case 344: return G[1];
    case 345: return G[0];
    case 346: return G[0];
    case 347: return G[0];
    case 348: return G[2];
    case 349: return G[1];
    case 350: return G[1];
    case 351: return G[0];
    case 352: return G[0];
    case 353: return G[0];
    case 354: return G[2];
    case 355: return G[1];
    case 356: return G[1];
    case 357: return G[0];
    case 358: return G[0];
    case 359: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdds_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[0] * yij + G[7];
    case 7: return G[1] * yij + G[8];
    case 8: return G[0] * yij + G[7];
    case 9: return G[2] * yij + G[9];
    case 10: return G[1] * yij + G[8];
    case 11: return G[0] * yij + G[7];
    case 12: return G[0];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[2];
    case 16: return G[1];
    case 17: return G[0];
    case 18: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 19: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 20: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 21: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 22: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 23: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 24: return G[0] * yij + G[7];
    case 25: return G[1] * yij + G[8];
    case 26: return G[0] * yij + G[7];
    case 27: return G[2] * yij + G[9];
    case 28: return G[1] * yij + G[8];
    case 29: return G[0] * yij + G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[7];
    case 37: return G[8];
    case 38: return G[7];
    case 39: return G[9];
    case 40: return G[8];
    case 41: return G[7];
    case 42: return G[7] * yij + G[14];
    case 43: return G[8] * yij + G[15];
    case 44: return G[7] * yij + G[14];
    case 45: return G[9] * yij + G[16];
    case 46: return G[8] * yij + G[15];
    case 47: return G[7] * yij + G[14];
    case 48: return G[7];
    case 49: return G[8];
    case 50: return G[7];
    case 51: return G[9];
    case 52: return G[8];
    case 53: return G[7];
    case 54: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 55: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 56: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 57: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 58: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 59: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 60: return G[7] * yij + G[14];
    case 61: return G[8] * yij + G[15];
    case 62: return G[7] * yij + G[14];
    case 63: return G[9] * yij + G[16];
    case 64: return G[8] * yij + G[15];
    case 65: return G[7] * yij + G[14];
    case 66: return G[7];
    case 67: return G[8];
    case 68: return G[7];
    case 69: return G[9];
    case 70: return G[8];
    case 71: return G[7];
    case 72: return G[0];
    case 73: return G[1];
    case 74: return G[0];
    case 75: return G[2];
    case 76: return G[1];
    case 77: return G[0];
    case 78: return G[0] * yij + G[7];
    case 79: return G[1] * yij + G[8];
    case 80: return G[0] * yij + G[7];
    case 81: return G[2] * yij + G[9];
    case 82: return G[1] * yij + G[8];
    case 83: return G[0] * yij + G[7];
    case 84: return G[0];
    case 85: return G[1];
    case 86: return G[0];
    case 87: return G[2];
    case 88: return G[1];
    case 89: return G[0];
    case 90: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 91: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 92: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 93: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 94: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 95: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 96: return G[0] * yij + G[7];
    case 97: return G[1] * yij + G[8];
    case 98: return G[0] * yij + G[7];
    case 99: return G[2] * yij + G[9];
    case 100: return G[1] * yij + G[8];
    case 101: return G[0] * yij + G[7];
    case 102: return G[0];
    case 103: return G[1];
    case 104: return G[0];
    case 105: return G[2];
    case 106: return G[1];
    case 107: return G[0];
    case 108: return G[14];
    case 109: return G[15];
    case 110: return G[14];
    case 111: return G[16];
    case 112: return G[15];
    case 113: return G[14];
    case 114: return G[14] * yij + G[21];
    case 115: return G[15] * yij + G[22];
    case 116: return G[14] * yij + G[21];
    case 117: return G[16] * yij + G[23];
    case 118: return G[15] * yij + G[22];
    case 119: return G[14] * yij + G[21];
    case 120: return G[14];
    case 121: return G[15];
    case 122: return G[14];
    case 123: return G[16];
    case 124: return G[15];
    case 125: return G[14];
    case 126: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 127: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 128: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 129: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 130: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 131: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 132: return G[14] * yij + G[21];
    case 133: return G[15] * yij + G[22];
    case 134: return G[14] * yij + G[21];
    case 135: return G[16] * yij + G[23];
    case 136: return G[15] * yij + G[22];
    case 137: return G[14] * yij + G[21];
    case 138: return G[14];
    case 139: return G[15];
    case 140: return G[14];
    case 141: return G[16];
    case 142: return G[15];
    case 143: return G[14];
    case 144: return G[7];
    case 145: return G[8];
    case 146: return G[7];
    case 147: return G[9];
    case 148: return G[8];
    case 149: return G[7];
    case 150: return G[7] * yij + G[14];
    case 151: return G[8] * yij + G[15];
    case 152: return G[7] * yij + G[14];
    case 153: return G[9] * yij + G[16];
    case 154: return G[8] * yij + G[15];
    case 155: return G[7] * yij + G[14];
    case 156: return G[7];
    case 157: return G[8];
    case 158: return G[7];
    case 159: return G[9];
    case 160: return G[8];
    case 161: return G[7];
    case 162: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 163: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 164: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 165: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 166: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 167: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 168: return G[7] * yij + G[14];
    case 169: return G[8] * yij + G[15];
    case 170: return G[7] * yij + G[14];
    case 171: return G[9] * yij + G[16];
    case 172: return G[8] * yij + G[15];
    case 173: return G[7] * yij + G[14];
    case 174: return G[7];
    case 175: return G[8];
    case 176: return G[7];
    case 177: return G[9];
    case 178: return G[8];
    case 179: return G[7];
    case 180: return G[0];
    case 181: return G[1];
    case 182: return G[0];
    case 183: return G[2];
    case 184: return G[1];
    case 185: return G[0];
    case 186: return G[0] * yij + G[7];
    case 187: return G[1] * yij + G[8];
    case 188: return G[0] * yij + G[7];
    case 189: return G[2] * yij + G[9];
    case 190: return G[1] * yij + G[8];
    case 191: return G[0] * yij + G[7];
    case 192: return G[0];
    case 193: return G[1];
    case 194: return G[0];
    case 195: return G[2];
    case 196: return G[1];
    case 197: return G[0];
    case 198: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 199: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 200: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 201: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 202: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 203: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 204: return G[0] * yij + G[7];
    case 205: return G[1] * yij + G[8];
    case 206: return G[0] * yij + G[7];
    case 207: return G[2] * yij + G[9];
    case 208: return G[1] * yij + G[8];
    case 209: return G[0] * yij + G[7];
    case 210: return G[0];
    case 211: return G[1];
    case 212: return G[0];
    case 213: return G[2];
    case 214: return G[1];
    case 215: return G[0];
    case 216: return G[21];
    case 217: return G[22];
    case 218: return G[21];
    case 219: return G[23];
    case 220: return G[22];
    case 221: return G[21];
    case 222: return G[21] * yij + G[28];
    case 223: return G[22] * yij + G[29];
    case 224: return G[21] * yij + G[28];
    case 225: return G[23] * yij + G[30];
    case 226: return G[22] * yij + G[29];
    case 227: return G[21] * yij + G[28];
    case 228: return G[21];
    case 229: return G[22];
    case 230: return G[21];
    case 231: return G[23];
    case 232: return G[22];
    case 233: return G[21];
    case 234: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 235: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 236: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 237: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 238: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 239: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 240: return G[21] * yij + G[28];
    case 241: return G[22] * yij + G[29];
    case 242: return G[21] * yij + G[28];
    case 243: return G[23] * yij + G[30];
    case 244: return G[22] * yij + G[29];
    case 245: return G[21] * yij + G[28];
    case 246: return G[21];
    case 247: return G[22];
    case 248: return G[21];
    case 249: return G[23];
    case 250: return G[22];
    case 251: return G[21];
    case 252: return G[14];
    case 253: return G[15];
    case 254: return G[14];
    case 255: return G[16];
    case 256: return G[15];
    case 257: return G[14];
    case 258: return G[14] * yij + G[21];
    case 259: return G[15] * yij + G[22];
    case 260: return G[14] * yij + G[21];
    case 261: return G[16] * yij + G[23];
    case 262: return G[15] * yij + G[22];
    case 263: return G[14] * yij + G[21];
    case 264: return G[14];
    case 265: return G[15];
    case 266: return G[14];
    case 267: return G[16];
    case 268: return G[15];
    case 269: return G[14];
    case 270: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 271: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 272: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 273: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 274: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 275: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 276: return G[14] * yij + G[21];
    case 277: return G[15] * yij + G[22];
    case 278: return G[14] * yij + G[21];
    case 279: return G[16] * yij + G[23];
    case 280: return G[15] * yij + G[22];
    case 281: return G[14] * yij + G[21];
    case 282: return G[14];
    case 283: return G[15];
    case 284: return G[14];
    case 285: return G[16];
    case 286: return G[15];
    case 287: return G[14];
    case 288: return G[7];
    case 289: return G[8];
    case 290: return G[7];
    case 291: return G[9];
    case 292: return G[8];
    case 293: return G[7];
    case 294: return G[7] * yij + G[14];
    case 295: return G[8] * yij + G[15];
    case 296: return G[7] * yij + G[14];
    case 297: return G[9] * yij + G[16];
    case 298: return G[8] * yij + G[15];
    case 299: return G[7] * yij + G[14];
    case 300: return G[7];
    case 301: return G[8];
    case 302: return G[7];
    case 303: return G[9];
    case 304: return G[8];
    case 305: return G[7];
    case 306: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 307: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 308: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 309: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 310: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 311: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 312: return G[7] * yij + G[14];
    case 313: return G[8] * yij + G[15];
    case 314: return G[7] * yij + G[14];
    case 315: return G[9] * yij + G[16];
    case 316: return G[8] * yij + G[15];
    case 317: return G[7] * yij + G[14];
    case 318: return G[7];
    case 319: return G[8];
    case 320: return G[7];
    case 321: return G[9];
    case 322: return G[8];
    case 323: return G[7];
    case 324: return G[0];
    case 325: return G[1];
    case 326: return G[0];
    case 327: return G[2];
    case 328: return G[1];
    case 329: return G[0];
    case 330: return G[0] * yij + G[7];
    case 331: return G[1] * yij + G[8];
    case 332: return G[0] * yij + G[7];
    case 333: return G[2] * yij + G[9];
    case 334: return G[1] * yij + G[8];
    case 335: return G[0] * yij + G[7];
    case 336: return G[0];
    case 337: return G[1];
    case 338: return G[0];
    case 339: return G[2];
    case 340: return G[1];
    case 341: return G[0];
    case 342: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 343: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 344: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 345: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 346: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 347: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 348: return G[0] * yij + G[7];
    case 349: return G[1] * yij + G[8];
    case 350: return G[0] * yij + G[7];
    case 351: return G[2] * yij + G[9];
    case 352: return G[1] * yij + G[8];
    case 353: return G[0] * yij + G[7];
    case 354: return G[0];
    case 355: return G[1];
    case 356: return G[0];
    case 357: return G[2];
    case 358: return G[1];
    case 359: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdds_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[0];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[1];
    case 11: return G[2];
    case 12: return G[0] * zij + G[7];
    case 13: return G[0] * zij + G[7];
    case 14: return G[1] * zij + G[8];
    case 15: return G[0] * zij + G[7];
    case 16: return G[1] * zij + G[8];
    case 17: return G[2] * zij + G[9];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[1];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[0] * zij + G[7];
    case 25: return G[0] * zij + G[7];
    case 26: return G[1] * zij + G[8];
    case 27: return G[0] * zij + G[7];
    case 28: return G[1] * zij + G[8];
    case 29: return G[2] * zij + G[9];
    case 30: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 31: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 32: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 33: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 34: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 35: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 36: return G[0];
    case 37: return G[0];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[1];
    case 41: return G[2];
    case 42: return G[0];
    case 43: return G[0];
    case 44: return G[1];
    case 45: return G[0];
    case 46: return G[1];
    case 47: return G[2];
    case 48: return G[0] * zij + G[7];
    case 49: return G[0] * zij + G[7];
    case 50: return G[1] * zij + G[8];
    case 51: return G[0] * zij + G[7];
    case 52: return G[1] * zij + G[8];
    case 53: return G[2] * zij + G[9];
    case 54: return G[0];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[0];
    case 58: return G[1];
    case 59: return G[2];
    case 60: return G[0] * zij + G[7];
    case 61: return G[0] * zij + G[7];
    case 62: return G[1] * zij + G[8];
    case 63: return G[0] * zij + G[7];
    case 64: return G[1] * zij + G[8];
    case 65: return G[2] * zij + G[9];
    case 66: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 67: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 68: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 69: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 70: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 71: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 72: return G[7];
    case 73: return G[7];
    case 74: return G[8];
    case 75: return G[7];
    case 76: return G[8];
    case 77: return G[9];
    case 78: return G[7];
    case 79: return G[7];
    case 80: return G[8];
    case 81: return G[7];
    case 82: return G[8];
    case 83: return G[9];
    case 84: return G[7] * zij + G[14];
    case 85: return G[7] * zij + G[14];
    case 86: return G[8] * zij + G[15];
    case 87: return G[7] * zij + G[14];
    case 88: return G[8] * zij + G[15];
    case 89: return G[9] * zij + G[16];
    case 90: return G[7];
    case 91: return G[7];
    case 92: return G[8];
    case 93: return G[7];
    case 94: return G[8];
    case 95: return G[9];
    case 96: return G[7] * zij + G[14];
    case 97: return G[7] * zij + G[14];
    case 98: return G[8] * zij + G[15];
    case 99: return G[7] * zij + G[14];
    case 100: return G[8] * zij + G[15];
    case 101: return G[9] * zij + G[16];
    case 102: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 103: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 104: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 105: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 106: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 107: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 108: return G[0];
    case 109: return G[0];
    case 110: return G[1];
    case 111: return G[0];
    case 112: return G[1];
    case 113: return G[2];
    case 114: return G[0];
    case 115: return G[0];
    case 116: return G[1];
    case 117: return G[0];
    case 118: return G[1];
    case 119: return G[2];
    case 120: return G[0] * zij + G[7];
    case 121: return G[0] * zij + G[7];
    case 122: return G[1] * zij + G[8];
    case 123: return G[0] * zij + G[7];
    case 124: return G[1] * zij + G[8];
    case 125: return G[2] * zij + G[9];
    case 126: return G[0];
    case 127: return G[0];
    case 128: return G[1];
    case 129: return G[0];
    case 130: return G[1];
    case 131: return G[2];
    case 132: return G[0] * zij + G[7];
    case 133: return G[0] * zij + G[7];
    case 134: return G[1] * zij + G[8];
    case 135: return G[0] * zij + G[7];
    case 136: return G[1] * zij + G[8];
    case 137: return G[2] * zij + G[9];
    case 138: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 139: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 140: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 141: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 142: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 143: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 144: return G[7];
    case 145: return G[7];
    case 146: return G[8];
    case 147: return G[7];
    case 148: return G[8];
    case 149: return G[9];
    case 150: return G[7];
    case 151: return G[7];
    case 152: return G[8];
    case 153: return G[7];
    case 154: return G[8];
    case 155: return G[9];
    case 156: return G[7] * zij + G[14];
    case 157: return G[7] * zij + G[14];
    case 158: return G[8] * zij + G[15];
    case 159: return G[7] * zij + G[14];
    case 160: return G[8] * zij + G[15];
    case 161: return G[9] * zij + G[16];
    case 162: return G[7];
    case 163: return G[7];
    case 164: return G[8];
    case 165: return G[7];
    case 166: return G[8];
    case 167: return G[9];
    case 168: return G[7] * zij + G[14];
    case 169: return G[7] * zij + G[14];
    case 170: return G[8] * zij + G[15];
    case 171: return G[7] * zij + G[14];
    case 172: return G[8] * zij + G[15];
    case 173: return G[9] * zij + G[16];
    case 174: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 175: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 176: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 177: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 178: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 179: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 180: return G[14];
    case 181: return G[14];
    case 182: return G[15];
    case 183: return G[14];
    case 184: return G[15];
    case 185: return G[16];
    case 186: return G[14];
    case 187: return G[14];
    case 188: return G[15];
    case 189: return G[14];
    case 190: return G[15];
    case 191: return G[16];
    case 192: return G[14] * zij + G[21];
    case 193: return G[14] * zij + G[21];
    case 194: return G[15] * zij + G[22];
    case 195: return G[14] * zij + G[21];
    case 196: return G[15] * zij + G[22];
    case 197: return G[16] * zij + G[23];
    case 198: return G[14];
    case 199: return G[14];
    case 200: return G[15];
    case 201: return G[14];
    case 202: return G[15];
    case 203: return G[16];
    case 204: return G[14] * zij + G[21];
    case 205: return G[14] * zij + G[21];
    case 206: return G[15] * zij + G[22];
    case 207: return G[14] * zij + G[21];
    case 208: return G[15] * zij + G[22];
    case 209: return G[16] * zij + G[23];
    case 210: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 211: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 212: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 213: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 214: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 215: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 216: return G[0];
    case 217: return G[0];
    case 218: return G[1];
    case 219: return G[0];
    case 220: return G[1];
    case 221: return G[2];
    case 222: return G[0];
    case 223: return G[0];
    case 224: return G[1];
    case 225: return G[0];
    case 226: return G[1];
    case 227: return G[2];
    case 228: return G[0] * zij + G[7];
    case 229: return G[0] * zij + G[7];
    case 230: return G[1] * zij + G[8];
    case 231: return G[0] * zij + G[7];
    case 232: return G[1] * zij + G[8];
    case 233: return G[2] * zij + G[9];
    case 234: return G[0];
    case 235: return G[0];
    case 236: return G[1];
    case 237: return G[0];
    case 238: return G[1];
    case 239: return G[2];
    case 240: return G[0] * zij + G[7];
    case 241: return G[0] * zij + G[7];
    case 242: return G[1] * zij + G[8];
    case 243: return G[0] * zij + G[7];
    case 244: return G[1] * zij + G[8];
    case 245: return G[2] * zij + G[9];
    case 246: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 247: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 248: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 249: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 250: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 251: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 252: return G[7];
    case 253: return G[7];
    case 254: return G[8];
    case 255: return G[7];
    case 256: return G[8];
    case 257: return G[9];
    case 258: return G[7];
    case 259: return G[7];
    case 260: return G[8];
    case 261: return G[7];
    case 262: return G[8];
    case 263: return G[9];
    case 264: return G[7] * zij + G[14];
    case 265: return G[7] * zij + G[14];
    case 266: return G[8] * zij + G[15];
    case 267: return G[7] * zij + G[14];
    case 268: return G[8] * zij + G[15];
    case 269: return G[9] * zij + G[16];
    case 270: return G[7];
    case 271: return G[7];
    case 272: return G[8];
    case 273: return G[7];
    case 274: return G[8];
    case 275: return G[9];
    case 276: return G[7] * zij + G[14];
    case 277: return G[7] * zij + G[14];
    case 278: return G[8] * zij + G[15];
    case 279: return G[7] * zij + G[14];
    case 280: return G[8] * zij + G[15];
    case 281: return G[9] * zij + G[16];
    case 282: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 283: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 284: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 285: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 286: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 287: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 288: return G[14];
    case 289: return G[14];
    case 290: return G[15];
    case 291: return G[14];
    case 292: return G[15];
    case 293: return G[16];
    case 294: return G[14];
    case 295: return G[14];
    case 296: return G[15];
    case 297: return G[14];
    case 298: return G[15];
    case 299: return G[16];
    case 300: return G[14] * zij + G[21];
    case 301: return G[14] * zij + G[21];
    case 302: return G[15] * zij + G[22];
    case 303: return G[14] * zij + G[21];
    case 304: return G[15] * zij + G[22];
    case 305: return G[16] * zij + G[23];
    case 306: return G[14];
    case 307: return G[14];
    case 308: return G[15];
    case 309: return G[14];
    case 310: return G[15];
    case 311: return G[16];
    case 312: return G[14] * zij + G[21];
    case 313: return G[14] * zij + G[21];
    case 314: return G[15] * zij + G[22];
    case 315: return G[14] * zij + G[21];
    case 316: return G[15] * zij + G[22];
    case 317: return G[16] * zij + G[23];
    case 318: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 319: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 320: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 321: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 322: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 323: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 324: return G[21];
    case 325: return G[21];
    case 326: return G[22];
    case 327: return G[21];
    case 328: return G[22];
    case 329: return G[23];
    case 330: return G[21];
    case 331: return G[21];
    case 332: return G[22];
    case 333: return G[21];
    case 334: return G[22];
    case 335: return G[23];
    case 336: return G[21] * zij + G[28];
    case 337: return G[21] * zij + G[28];
    case 338: return G[22] * zij + G[29];
    case 339: return G[21] * zij + G[28];
    case 340: return G[22] * zij + G[29];
    case 341: return G[23] * zij + G[30];
    case 342: return G[21];
    case 343: return G[21];
    case 344: return G[22];
    case 345: return G[21];
    case 346: return G[22];
    case 347: return G[23];
    case 348: return G[21] * zij + G[28];
    case 349: return G[21] * zij + G[28];
    case 350: return G[22] * zij + G[29];
    case 351: return G[21] * zij + G[28];
    case 352: return G[22] * zij + G[29];
    case 353: return G[23] * zij + G[30];
    case 354: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 355: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 356: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 357: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 358: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 359: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fdds_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 360;
  constexpr int kNMax = 5;
  constexpr int kMMax = 2;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fdds_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fdds_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fdds_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ffds_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[23] * pow(xij, 3) + 3.0 * (G[30] * xij2) + 3.0 * (G[37] * xij) + G[44];
    case 1: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 2: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 3: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 4: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 5: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 6: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 7: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 8: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 9: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 10: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 11: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 12: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 13: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 14: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 15: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 16: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 17: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 18: return G[23] * xij + G[30];
    case 19: return G[22] * xij + G[29];
    case 20: return G[22] * xij + G[29];
    case 21: return G[21] * xij + G[28];
    case 22: return G[21] * xij + G[28];
    case 23: return G[21] * xij + G[28];
    case 24: return G[23] * xij + G[30];
    case 25: return G[22] * xij + G[29];
    case 26: return G[22] * xij + G[29];
    case 27: return G[21] * xij + G[28];
    case 28: return G[21] * xij + G[28];
    case 29: return G[21] * xij + G[28];
    case 30: return G[23] * xij + G[30];
    case 31: return G[22] * xij + G[29];
    case 32: return G[22] * xij + G[29];
    case 33: return G[21] * xij + G[28];
    case 34: return G[21] * xij + G[28];
    case 35: return G[21] * xij + G[28];
    case 36: return G[23];
    case 37: return G[22];
    case 38: return G[22];
    case 39: return G[21];
    case 40: return G[21];
    case 41: return G[21];
    case 42: return G[23];
    case 43: return G[22];
    case 44: return G[22];
    case 45: return G[21];
    case 46: return G[21];
    case 47: return G[21];
    case 48: return G[23];
    case 49: return G[22];
    case 50: return G[22];
    case 51: return G[21];
    case 52: return G[21];
    case 53: return G[21];
    case 54: return G[23];
    case 55: return G[22];
    case 56: return G[22];
    case 57: return G[21];
    case 58: return G[21];
    case 59: return G[21];
    case 60: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 61: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 62: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 63: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 64: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 65: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 66: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 67: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 68: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 69: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 70: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 71: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 72: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 73: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 74: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 75: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 76: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 77: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 78: return G[16] * xij + G[23];
    case 79: return G[15] * xij + G[22];
    case 80: return G[15] * xij + G[22];
    case 81: return G[14] * xij + G[21];
    case 82: return G[14] * xij + G[21];
    case 83: return G[14] * xij + G[21];
    case 84: return G[16] * xij + G[23];
    case 85: return G[15] * xij + G[22];
    case 86: return G[15] * xij + G[22];
    case 87: return G[14] * xij + G[21];
    case 88: return G[14] * xij + G[21];
    case 89: return G[14] * xij + G[21];
    case 90: return G[16] * xij + G[23];
    case 91: return G[15] * xij + G[22];
    case 92: return G[15] * xij + G[22];
    case 93: return G[14] * xij + G[21];
    case 94: return G[14] * xij + G[21];
    case 95: return G[14] * xij + G[21];
    case 96: return G[16];
    case 97: return G[15];
    case 98: return G[15];
    case 99: return G[14];
    case 100: return G[14];
    case 101: return G[14];
    case 102: return G[16];
    case 103: return G[15];
    case 104: return G[15];
    case 105: return G[14];
    case 106: return G[14];
    case 107: return G[14];
    case 108: return G[16];
    case 109: return G[15];
    case 110: return G[15];
    case 111: return G[14];
    case 112: return G[14];
    case 113: return G[14];
    case 114: return G[16];
    case 115: return G[15];
    case 116: return G[15];
    case 117: return G[14];
    case 118: return G[14];
    case 119: return G[14];
    case 120: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 121: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 122: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 123: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 124: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 125: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 126: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 127: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 128: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 129: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 130: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 131: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 132: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 133: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 134: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 135: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 136: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 137: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 138: return G[16] * xij + G[23];
    case 139: return G[15] * xij + G[22];
    case 140: return G[15] * xij + G[22];
    case 141: return G[14] * xij + G[21];
    case 142: return G[14] * xij + G[21];
    case 143: return G[14] * xij + G[21];
    case 144: return G[16] * xij + G[23];
    case 145: return G[15] * xij + G[22];
    case 146: return G[15] * xij + G[22];
    case 147: return G[14] * xij + G[21];
    case 148: return G[14] * xij + G[21];
    case 149: return G[14] * xij + G[21];
    case 150: return G[16] * xij + G[23];
    case 151: return G[15] * xij + G[22];
    case 152: return G[15] * xij + G[22];
    case 153: return G[14] * xij + G[21];
    case 154: return G[14] * xij + G[21];
    case 155: return G[14] * xij + G[21];
    case 156: return G[16];
    case 157: return G[15];
    case 158: return G[15];
    case 159: return G[14];
    case 160: return G[14];
    case 161: return G[14];
    case 162: return G[16];
    case 163: return G[15];
    case 164: return G[15];
    case 165: return G[14];
    case 166: return G[14];
    case 167: return G[14];
    case 168: return G[16];
    case 169: return G[15];
    case 170: return G[15];
    case 171: return G[14];
    case 172: return G[14];
    case 173: return G[14];
    case 174: return G[16];
    case 175: return G[15];
    case 176: return G[15];
    case 177: return G[14];
    case 178: return G[14];
    case 179: return G[14];
    case 180: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 181: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 182: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 183: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 184: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 185: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 186: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 187: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 188: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 189: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 190: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 191: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 192: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 193: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 194: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 195: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 196: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 197: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 198: return G[9] * xij + G[16];
    case 199: return G[8] * xij + G[15];
    case 200: return G[8] * xij + G[15];
    case 201: return G[7] * xij + G[14];
    case 202: return G[7] * xij + G[14];
    case 203: return G[7] * xij + G[14];
    case 204: return G[9] * xij + G[16];
    case 205: return G[8] * xij + G[15];
    case 206: return G[8] * xij + G[15];
    case 207: return G[7] * xij + G[14];
    case 208: return G[7] * xij + G[14];
    case 209: return G[7] * xij + G[14];
    case 210: return G[9] * xij + G[16];
    case 211: return G[8] * xij + G[15];
    case 212: return G[8] * xij + G[15];
    case 213: return G[7] * xij + G[14];
    case 214: return G[7] * xij + G[14];
    case 215: return G[7] * xij + G[14];
    case 216: return G[9];
    case 217: return G[8];
    case 218: return G[8];
    case 219: return G[7];
    case 220: return G[7];
    case 221: return G[7];
    case 222: return G[9];
    case 223: return G[8];
    case 224: return G[8];
    case 225: return G[7];
    case 226: return G[7];
    case 227: return G[7];
    case 228: return G[9];
    case 229: return G[8];
    case 230: return G[8];
    case 231: return G[7];
    case 232: return G[7];
    case 233: return G[7];
    case 234: return G[9];
    case 235: return G[8];
    case 236: return G[8];
    case 237: return G[7];
    case 238: return G[7];
    case 239: return G[7];
    case 240: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 241: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 242: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 243: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 244: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 245: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 246: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 247: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 248: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 249: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 250: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 251: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 252: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 253: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 254: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 255: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 256: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 257: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 258: return G[9] * xij + G[16];
    case 259: return G[8] * xij + G[15];
    case 260: return G[8] * xij + G[15];
    case 261: return G[7] * xij + G[14];
    case 262: return G[7] * xij + G[14];
    case 263: return G[7] * xij + G[14];
    case 264: return G[9] * xij + G[16];
    case 265: return G[8] * xij + G[15];
    case 266: return G[8] * xij + G[15];
    case 267: return G[7] * xij + G[14];
    case 268: return G[7] * xij + G[14];
    case 269: return G[7] * xij + G[14];
    case 270: return G[9] * xij + G[16];
    case 271: return G[8] * xij + G[15];
    case 272: return G[8] * xij + G[15];
    case 273: return G[7] * xij + G[14];
    case 274: return G[7] * xij + G[14];
    case 275: return G[7] * xij + G[14];
    case 276: return G[9];
    case 277: return G[8];
    case 278: return G[8];
    case 279: return G[7];
    case 280: return G[7];
    case 281: return G[7];
    case 282: return G[9];
    case 283: return G[8];
    case 284: return G[8];
    case 285: return G[7];
    case 286: return G[7];
    case 287: return G[7];
    case 288: return G[9];
    case 289: return G[8];
    case 290: return G[8];
    case 291: return G[7];
    case 292: return G[7];
    case 293: return G[7];
    case 294: return G[9];
    case 295: return G[8];
    case 296: return G[8];
    case 297: return G[7];
    case 298: return G[7];
    case 299: return G[7];
    case 300: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 301: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 302: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 303: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 304: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 305: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 306: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 307: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 308: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 309: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 310: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 311: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 312: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 313: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 314: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 315: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 316: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 317: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 318: return G[9] * xij + G[16];
    case 319: return G[8] * xij + G[15];
    case 320: return G[8] * xij + G[15];
    case 321: return G[7] * xij + G[14];
    case 322: return G[7] * xij + G[14];
    case 323: return G[7] * xij + G[14];
    case 324: return G[9] * xij + G[16];
    case 325: return G[8] * xij + G[15];
    case 326: return G[8] * xij + G[15];
    case 327: return G[7] * xij + G[14];
    case 328: return G[7] * xij + G[14];
    case 329: return G[7] * xij + G[14];
    case 330: return G[9] * xij + G[16];
    case 331: return G[8] * xij + G[15];
    case 332: return G[8] * xij + G[15];
    case 333: return G[7] * xij + G[14];
    case 334: return G[7] * xij + G[14];
    case 335: return G[7] * xij + G[14];
    case 336: return G[9];
    case 337: return G[8];
    case 338: return G[8];
    case 339: return G[7];
    case 340: return G[7];
    case 341: return G[7];
    case 342: return G[9];
    case 343: return G[8];
    case 344: return G[8];
    case 345: return G[7];
    case 346: return G[7];
    case 347: return G[7];
    case 348: return G[9];
    case 349: return G[8];
    case 350: return G[8];
    case 351: return G[7];
    case 352: return G[7];
    case 353: return G[7];
    case 354: return G[9];
    case 355: return G[8];
    case 356: return G[8];
    case 357: return G[7];
    case 358: return G[7];
    case 359: return G[7];
    case 360: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 361: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 362: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 363: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 364: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 365: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 366: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 367: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 368: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 369: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 370: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 371: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 372: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 373: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 374: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 375: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 376: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 377: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 378: return G[2] * xij + G[9];
    case 379: return G[1] * xij + G[8];
    case 380: return G[1] * xij + G[8];
    case 381: return G[0] * xij + G[7];
    case 382: return G[0] * xij + G[7];
    case 383: return G[0] * xij + G[7];
    case 384: return G[2] * xij + G[9];
    case 385: return G[1] * xij + G[8];
    case 386: return G[1] * xij + G[8];
    case 387: return G[0] * xij + G[7];
    case 388: return G[0] * xij + G[7];
    case 389: return G[0] * xij + G[7];
    case 390: return G[2] * xij + G[9];
    case 391: return G[1] * xij + G[8];
    case 392: return G[1] * xij + G[8];
    case 393: return G[0] * xij + G[7];
    case 394: return G[0] * xij + G[7];
    case 395: return G[0] * xij + G[7];
    case 396: return G[2];
    case 397: return G[1];
    case 398: return G[1];
    case 399: return G[0];
    case 400: return G[0];
    case 401: return G[0];
    case 402: return G[2];
    case 403: return G[1];
    case 404: return G[1];
    case 405: return G[0];
    case 406: return G[0];
    case 407: return G[0];
    case 408: return G[2];
    case 409: return G[1];
    case 410: return G[1];
    case 411: return G[0];
    case 412: return G[0];
    case 413: return G[0];
    case 414: return G[2];
    case 415: return G[1];
    case 416: return G[1];
    case 417: return G[0];
    case 418: return G[0];
    case 419: return G[0];
    case 420: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 421: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 422: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 423: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 424: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 425: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 426: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 427: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 428: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 429: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 430: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 431: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 432: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 433: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 434: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 435: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 436: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 437: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 438: return G[2] * xij + G[9];
    case 439: return G[1] * xij + G[8];
    case 440: return G[1] * xij + G[8];
    case 441: return G[0] * xij + G[7];
    case 442: return G[0] * xij + G[7];
    case 443: return G[0] * xij + G[7];
    case 444: return G[2] * xij + G[9];
    case 445: return G[1] * xij + G[8];
    case 446: return G[1] * xij + G[8];
    case 447: return G[0] * xij + G[7];
    case 448: return G[0] * xij + G[7];
    case 449: return G[0] * xij + G[7];
    case 450: return G[2] * xij + G[9];
    case 451: return G[1] * xij + G[8];
    case 452: return G[1] * xij + G[8];
    case 453: return G[0] * xij + G[7];
    case 454: return G[0] * xij + G[7];
    case 455: return G[0] * xij + G[7];
    case 456: return G[2];
    case 457: return G[1];
    case 458: return G[1];
    case 459: return G[0];
    case 460: return G[0];
    case 461: return G[0];
    case 462: return G[2];
    case 463: return G[1];
    case 464: return G[1];
    case 465: return G[0];
    case 466: return G[0];
    case 467: return G[0];
    case 468: return G[2];
    case 469: return G[1];
    case 470: return G[1];
    case 471: return G[0];
    case 472: return G[0];
    case 473: return G[0];
    case 474: return G[2];
    case 475: return G[1];
    case 476: return G[1];
    case 477: return G[0];
    case 478: return G[0];
    case 479: return G[0];
    case 480: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 481: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 482: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 483: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 484: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 485: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 486: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 487: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 488: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 489: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 490: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 491: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 492: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 493: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 494: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 495: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 496: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 497: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 498: return G[2] * xij + G[9];
    case 499: return G[1] * xij + G[8];
    case 500: return G[1] * xij + G[8];
    case 501: return G[0] * xij + G[7];
    case 502: return G[0] * xij + G[7];
    case 503: return G[0] * xij + G[7];
    case 504: return G[2] * xij + G[9];
    case 505: return G[1] * xij + G[8];
    case 506: return G[1] * xij + G[8];
    case 507: return G[0] * xij + G[7];
    case 508: return G[0] * xij + G[7];
    case 509: return G[0] * xij + G[7];
    case 510: return G[2] * xij + G[9];
    case 511: return G[1] * xij + G[8];
    case 512: return G[1] * xij + G[8];
    case 513: return G[0] * xij + G[7];
    case 514: return G[0] * xij + G[7];
    case 515: return G[0] * xij + G[7];
    case 516: return G[2];
    case 517: return G[1];
    case 518: return G[1];
    case 519: return G[0];
    case 520: return G[0];
    case 521: return G[0];
    case 522: return G[2];
    case 523: return G[1];
    case 524: return G[1];
    case 525: return G[0];
    case 526: return G[0];
    case 527: return G[0];
    case 528: return G[2];
    case 529: return G[1];
    case 530: return G[1];
    case 531: return G[0];
    case 532: return G[0];
    case 533: return G[0];
    case 534: return G[2];
    case 535: return G[1];
    case 536: return G[1];
    case 537: return G[0];
    case 538: return G[0];
    case 539: return G[0];
    case 540: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 541: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 542: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 543: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 544: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 545: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 546: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 547: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 548: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 549: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 550: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 551: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 552: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 553: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 554: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 555: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 556: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 557: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 558: return G[2] * xij + G[9];
    case 559: return G[1] * xij + G[8];
    case 560: return G[1] * xij + G[8];
    case 561: return G[0] * xij + G[7];
    case 562: return G[0] * xij + G[7];
    case 563: return G[0] * xij + G[7];
    case 564: return G[2] * xij + G[9];
    case 565: return G[1] * xij + G[8];
    case 566: return G[1] * xij + G[8];
    case 567: return G[0] * xij + G[7];
    case 568: return G[0] * xij + G[7];
    case 569: return G[0] * xij + G[7];
    case 570: return G[2] * xij + G[9];
    case 571: return G[1] * xij + G[8];
    case 572: return G[1] * xij + G[8];
    case 573: return G[0] * xij + G[7];
    case 574: return G[0] * xij + G[7];
    case 575: return G[0] * xij + G[7];
    case 576: return G[2];
    case 577: return G[1];
    case 578: return G[1];
    case 579: return G[0];
    case 580: return G[0];
    case 581: return G[0];
    case 582: return G[2];
    case 583: return G[1];
    case 584: return G[1];
    case 585: return G[0];
    case 586: return G[0];
    case 587: return G[0];
    case 588: return G[2];
    case 589: return G[1];
    case 590: return G[1];
    case 591: return G[0];
    case 592: return G[0];
    case 593: return G[0];
    case 594: return G[2];
    case 595: return G[1];
    case 596: return G[1];
    case 597: return G[0];
    case 598: return G[0];
    case 599: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ffds_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[0] * yij + G[7];
    case 7: return G[1] * yij + G[8];
    case 8: return G[0] * yij + G[7];
    case 9: return G[2] * yij + G[9];
    case 10: return G[1] * yij + G[8];
    case 11: return G[0] * yij + G[7];
    case 12: return G[0];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[2];
    case 16: return G[1];
    case 17: return G[0];
    case 18: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 19: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 20: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 21: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 22: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 23: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 24: return G[0] * yij + G[7];
    case 25: return G[1] * yij + G[8];
    case 26: return G[0] * yij + G[7];
    case 27: return G[2] * yij + G[9];
    case 28: return G[1] * yij + G[8];
    case 29: return G[0] * yij + G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 37: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 38: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 39: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 40: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 41: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 42: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 43: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 44: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 45: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 46: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 47: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 48: return G[0] * yij + G[7];
    case 49: return G[1] * yij + G[8];
    case 50: return G[0] * yij + G[7];
    case 51: return G[2] * yij + G[9];
    case 52: return G[1] * yij + G[8];
    case 53: return G[0] * yij + G[7];
    case 54: return G[0];
    case 55: return G[1];
    case 56: return G[0];
    case 57: return G[2];
    case 58: return G[1];
    case 59: return G[0];
    case 60: return G[7];
    case 61: return G[8];
    case 62: return G[7];
    case 63: return G[9];
    case 64: return G[8];
    case 65: return G[7];
    case 66: return G[7] * yij + G[14];
    case 67: return G[8] * yij + G[15];
    case 68: return G[7] * yij + G[14];
    case 69: return G[9] * yij + G[16];
    case 70: return G[8] * yij + G[15];
    case 71: return G[7] * yij + G[14];
    case 72: return G[7];
    case 73: return G[8];
    case 74: return G[7];
    case 75: return G[9];
    case 76: return G[8];
    case 77: return G[7];
    case 78: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 79: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 80: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 81: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 82: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 83: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 84: return G[7] * yij + G[14];
    case 85: return G[8] * yij + G[15];
    case 86: return G[7] * yij + G[14];
    case 87: return G[9] * yij + G[16];
    case 88: return G[8] * yij + G[15];
    case 89: return G[7] * yij + G[14];
    case 90: return G[7];
    case 91: return G[8];
    case 92: return G[7];
    case 93: return G[9];
    case 94: return G[8];
    case 95: return G[7];
    case 96: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 97: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 98: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 99: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 100: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 101: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 102: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 103: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 104: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 105: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 106: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 107: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 108: return G[7] * yij + G[14];
    case 109: return G[8] * yij + G[15];
    case 110: return G[7] * yij + G[14];
    case 111: return G[9] * yij + G[16];
    case 112: return G[8] * yij + G[15];
    case 113: return G[7] * yij + G[14];
    case 114: return G[7];
    case 115: return G[8];
    case 116: return G[7];
    case 117: return G[9];
    case 118: return G[8];
    case 119: return G[7];
    case 120: return G[0];
    case 121: return G[1];
    case 122: return G[0];
    case 123: return G[2];
    case 124: return G[1];
    case 125: return G[0];
    case 126: return G[0] * yij + G[7];
    case 127: return G[1] * yij + G[8];
    case 128: return G[0] * yij + G[7];
    case 129: return G[2] * yij + G[9];
    case 130: return G[1] * yij + G[8];
    case 131: return G[0] * yij + G[7];
    case 132: return G[0];
    case 133: return G[1];
    case 134: return G[0];
    case 135: return G[2];
    case 136: return G[1];
    case 137: return G[0];
    case 138: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 139: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 140: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 141: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 142: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 143: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 144: return G[0] * yij + G[7];
    case 145: return G[1] * yij + G[8];
    case 146: return G[0] * yij + G[7];
    case 147: return G[2] * yij + G[9];
    case 148: return G[1] * yij + G[8];
    case 149: return G[0] * yij + G[7];
    case 150: return G[0];
    case 151: return G[1];
    case 152: return G[0];
    case 153: return G[2];
    case 154: return G[1];
    case 155: return G[0];
    case 156: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 157: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 158: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 159: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 160: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 161: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 162: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 163: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 164: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 165: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 166: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 167: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 168: return G[0] * yij + G[7];
    case 169: return G[1] * yij + G[8];
    case 170: return G[0] * yij + G[7];
    case 171: return G[2] * yij + G[9];
    case 172: return G[1] * yij + G[8];
    case 173: return G[0] * yij + G[7];
    case 174: return G[0];
    case 175: return G[1];
    case 176: return G[0];
    case 177: return G[2];
    case 178: return G[1];
    case 179: return G[0];
    case 180: return G[14];
    case 181: return G[15];
    case 182: return G[14];
    case 183: return G[16];
    case 184: return G[15];
    case 185: return G[14];
    case 186: return G[14] * yij + G[21];
    case 187: return G[15] * yij + G[22];
    case 188: return G[14] * yij + G[21];
    case 189: return G[16] * yij + G[23];
    case 190: return G[15] * yij + G[22];
    case 191: return G[14] * yij + G[21];
    case 192: return G[14];
    case 193: return G[15];
    case 194: return G[14];
    case 195: return G[16];
    case 196: return G[15];
    case 197: return G[14];
    case 198: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 199: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 200: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 201: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 202: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 203: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 204: return G[14] * yij + G[21];
    case 205: return G[15] * yij + G[22];
    case 206: return G[14] * yij + G[21];
    case 207: return G[16] * yij + G[23];
    case 208: return G[15] * yij + G[22];
    case 209: return G[14] * yij + G[21];
    case 210: return G[14];
    case 211: return G[15];
    case 212: return G[14];
    case 213: return G[16];
    case 214: return G[15];
    case 215: return G[14];
    case 216: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 217: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 218: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 219: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 220: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 221: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 222: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 223: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 224: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 225: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 226: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 227: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 228: return G[14] * yij + G[21];
    case 229: return G[15] * yij + G[22];
    case 230: return G[14] * yij + G[21];
    case 231: return G[16] * yij + G[23];
    case 232: return G[15] * yij + G[22];
    case 233: return G[14] * yij + G[21];
    case 234: return G[14];
    case 235: return G[15];
    case 236: return G[14];
    case 237: return G[16];
    case 238: return G[15];
    case 239: return G[14];
    case 240: return G[7];
    case 241: return G[8];
    case 242: return G[7];
    case 243: return G[9];
    case 244: return G[8];
    case 245: return G[7];
    case 246: return G[7] * yij + G[14];
    case 247: return G[8] * yij + G[15];
    case 248: return G[7] * yij + G[14];
    case 249: return G[9] * yij + G[16];
    case 250: return G[8] * yij + G[15];
    case 251: return G[7] * yij + G[14];
    case 252: return G[7];
    case 253: return G[8];
    case 254: return G[7];
    case 255: return G[9];
    case 256: return G[8];
    case 257: return G[7];
    case 258: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 259: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 260: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 261: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 262: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 263: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 264: return G[7] * yij + G[14];
    case 265: return G[8] * yij + G[15];
    case 266: return G[7] * yij + G[14];
    case 267: return G[9] * yij + G[16];
    case 268: return G[8] * yij + G[15];
    case 269: return G[7] * yij + G[14];
    case 270: return G[7];
    case 271: return G[8];
    case 272: return G[7];
    case 273: return G[9];
    case 274: return G[8];
    case 275: return G[7];
    case 276: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 277: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 278: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 279: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 280: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 281: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 282: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 283: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 284: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 285: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 286: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 287: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 288: return G[7] * yij + G[14];
    case 289: return G[8] * yij + G[15];
    case 290: return G[7] * yij + G[14];
    case 291: return G[9] * yij + G[16];
    case 292: return G[8] * yij + G[15];
    case 293: return G[7] * yij + G[14];
    case 294: return G[7];
    case 295: return G[8];
    case 296: return G[7];
    case 297: return G[9];
    case 298: return G[8];
    case 299: return G[7];
    case 300: return G[0];
    case 301: return G[1];
    case 302: return G[0];
    case 303: return G[2];
    case 304: return G[1];
    case 305: return G[0];
    case 306: return G[0] * yij + G[7];
    case 307: return G[1] * yij + G[8];
    case 308: return G[0] * yij + G[7];
    case 309: return G[2] * yij + G[9];
    case 310: return G[1] * yij + G[8];
    case 311: return G[0] * yij + G[7];
    case 312: return G[0];
    case 313: return G[1];
    case 314: return G[0];
    case 315: return G[2];
    case 316: return G[1];
    case 317: return G[0];
    case 318: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 319: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 320: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 321: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 322: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 323: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 324: return G[0] * yij + G[7];
    case 325: return G[1] * yij + G[8];
    case 326: return G[0] * yij + G[7];
    case 327: return G[2] * yij + G[9];
    case 328: return G[1] * yij + G[8];
    case 329: return G[0] * yij + G[7];
    case 330: return G[0];
    case 331: return G[1];
    case 332: return G[0];
    case 333: return G[2];
    case 334: return G[1];
    case 335: return G[0];
    case 336: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 337: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 338: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 339: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 340: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 341: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 342: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 343: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 344: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 345: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 346: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 347: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 348: return G[0] * yij + G[7];
    case 349: return G[1] * yij + G[8];
    case 350: return G[0] * yij + G[7];
    case 351: return G[2] * yij + G[9];
    case 352: return G[1] * yij + G[8];
    case 353: return G[0] * yij + G[7];
    case 354: return G[0];
    case 355: return G[1];
    case 356: return G[0];
    case 357: return G[2];
    case 358: return G[1];
    case 359: return G[0];
    case 360: return G[21];
    case 361: return G[22];
    case 362: return G[21];
    case 363: return G[23];
    case 364: return G[22];
    case 365: return G[21];
    case 366: return G[21] * yij + G[28];
    case 367: return G[22] * yij + G[29];
    case 368: return G[21] * yij + G[28];
    case 369: return G[23] * yij + G[30];
    case 370: return G[22] * yij + G[29];
    case 371: return G[21] * yij + G[28];
    case 372: return G[21];
    case 373: return G[22];
    case 374: return G[21];
    case 375: return G[23];
    case 376: return G[22];
    case 377: return G[21];
    case 378: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 379: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 380: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 381: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 382: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 383: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 384: return G[21] * yij + G[28];
    case 385: return G[22] * yij + G[29];
    case 386: return G[21] * yij + G[28];
    case 387: return G[23] * yij + G[30];
    case 388: return G[22] * yij + G[29];
    case 389: return G[21] * yij + G[28];
    case 390: return G[21];
    case 391: return G[22];
    case 392: return G[21];
    case 393: return G[23];
    case 394: return G[22];
    case 395: return G[21];
    case 396: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 397: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 398: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 399: return G[23] * pow(yij, 3) + 3.0 * (G[30] * yij2) + 3.0 * (G[37] * yij) + G[44];
    case 400: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 401: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 402: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 403: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 404: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 405: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 406: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 407: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 408: return G[21] * yij + G[28];
    case 409: return G[22] * yij + G[29];
    case 410: return G[21] * yij + G[28];
    case 411: return G[23] * yij + G[30];
    case 412: return G[22] * yij + G[29];
    case 413: return G[21] * yij + G[28];
    case 414: return G[21];
    case 415: return G[22];
    case 416: return G[21];
    case 417: return G[23];
    case 418: return G[22];
    case 419: return G[21];
    case 420: return G[14];
    case 421: return G[15];
    case 422: return G[14];
    case 423: return G[16];
    case 424: return G[15];
    case 425: return G[14];
    case 426: return G[14] * yij + G[21];
    case 427: return G[15] * yij + G[22];
    case 428: return G[14] * yij + G[21];
    case 429: return G[16] * yij + G[23];
    case 430: return G[15] * yij + G[22];
    case 431: return G[14] * yij + G[21];
    case 432: return G[14];
    case 433: return G[15];
    case 434: return G[14];
    case 435: return G[16];
    case 436: return G[15];
    case 437: return G[14];
    case 438: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 439: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 440: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 441: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 442: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 443: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 444: return G[14] * yij + G[21];
    case 445: return G[15] * yij + G[22];
    case 446: return G[14] * yij + G[21];
    case 447: return G[16] * yij + G[23];
    case 448: return G[15] * yij + G[22];
    case 449: return G[14] * yij + G[21];
    case 450: return G[14];
    case 451: return G[15];
    case 452: return G[14];
    case 453: return G[16];
    case 454: return G[15];
    case 455: return G[14];
    case 456: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 457: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 458: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 459: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 460: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 461: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 462: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 463: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 464: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 465: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 466: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 467: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 468: return G[14] * yij + G[21];
    case 469: return G[15] * yij + G[22];
    case 470: return G[14] * yij + G[21];
    case 471: return G[16] * yij + G[23];
    case 472: return G[15] * yij + G[22];
    case 473: return G[14] * yij + G[21];
    case 474: return G[14];
    case 475: return G[15];
    case 476: return G[14];
    case 477: return G[16];
    case 478: return G[15];
    case 479: return G[14];
    case 480: return G[7];
    case 481: return G[8];
    case 482: return G[7];
    case 483: return G[9];
    case 484: return G[8];
    case 485: return G[7];
    case 486: return G[7] * yij + G[14];
    case 487: return G[8] * yij + G[15];
    case 488: return G[7] * yij + G[14];
    case 489: return G[9] * yij + G[16];
    case 490: return G[8] * yij + G[15];
    case 491: return G[7] * yij + G[14];
    case 492: return G[7];
    case 493: return G[8];
    case 494: return G[7];
    case 495: return G[9];
    case 496: return G[8];
    case 497: return G[7];
    case 498: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 499: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 500: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 501: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 502: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 503: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 504: return G[7] * yij + G[14];
    case 505: return G[8] * yij + G[15];
    case 506: return G[7] * yij + G[14];
    case 507: return G[9] * yij + G[16];
    case 508: return G[8] * yij + G[15];
    case 509: return G[7] * yij + G[14];
    case 510: return G[7];
    case 511: return G[8];
    case 512: return G[7];
    case 513: return G[9];
    case 514: return G[8];
    case 515: return G[7];
    case 516: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 517: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 518: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 519: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 520: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 521: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 522: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 523: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 524: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 525: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 526: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 527: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 528: return G[7] * yij + G[14];
    case 529: return G[8] * yij + G[15];
    case 530: return G[7] * yij + G[14];
    case 531: return G[9] * yij + G[16];
    case 532: return G[8] * yij + G[15];
    case 533: return G[7] * yij + G[14];
    case 534: return G[7];
    case 535: return G[8];
    case 536: return G[7];
    case 537: return G[9];
    case 538: return G[8];
    case 539: return G[7];
    case 540: return G[0];
    case 541: return G[1];
    case 542: return G[0];
    case 543: return G[2];
    case 544: return G[1];
    case 545: return G[0];
    case 546: return G[0] * yij + G[7];
    case 547: return G[1] * yij + G[8];
    case 548: return G[0] * yij + G[7];
    case 549: return G[2] * yij + G[9];
    case 550: return G[1] * yij + G[8];
    case 551: return G[0] * yij + G[7];
    case 552: return G[0];
    case 553: return G[1];
    case 554: return G[0];
    case 555: return G[2];
    case 556: return G[1];
    case 557: return G[0];
    case 558: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 559: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 560: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 561: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 562: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 563: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 564: return G[0] * yij + G[7];
    case 565: return G[1] * yij + G[8];
    case 566: return G[0] * yij + G[7];
    case 567: return G[2] * yij + G[9];
    case 568: return G[1] * yij + G[8];
    case 569: return G[0] * yij + G[7];
    case 570: return G[0];
    case 571: return G[1];
    case 572: return G[0];
    case 573: return G[2];
    case 574: return G[1];
    case 575: return G[0];
    case 576: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 577: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 578: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 579: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 580: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 581: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 582: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 583: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 584: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 585: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 586: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 587: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 588: return G[0] * yij + G[7];
    case 589: return G[1] * yij + G[8];
    case 590: return G[0] * yij + G[7];
    case 591: return G[2] * yij + G[9];
    case 592: return G[1] * yij + G[8];
    case 593: return G[0] * yij + G[7];
    case 594: return G[0];
    case 595: return G[1];
    case 596: return G[0];
    case 597: return G[2];
    case 598: return G[1];
    case 599: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ffds_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[0];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[1];
    case 11: return G[2];
    case 12: return G[0] * zij + G[7];
    case 13: return G[0] * zij + G[7];
    case 14: return G[1] * zij + G[8];
    case 15: return G[0] * zij + G[7];
    case 16: return G[1] * zij + G[8];
    case 17: return G[2] * zij + G[9];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[1];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[0] * zij + G[7];
    case 25: return G[0] * zij + G[7];
    case 26: return G[1] * zij + G[8];
    case 27: return G[0] * zij + G[7];
    case 28: return G[1] * zij + G[8];
    case 29: return G[2] * zij + G[9];
    case 30: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 31: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 32: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 33: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 34: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 35: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 36: return G[0];
    case 37: return G[0];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[1];
    case 41: return G[2];
    case 42: return G[0] * zij + G[7];
    case 43: return G[0] * zij + G[7];
    case 44: return G[1] * zij + G[8];
    case 45: return G[0] * zij + G[7];
    case 46: return G[1] * zij + G[8];
    case 47: return G[2] * zij + G[9];
    case 48: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 49: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 50: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 51: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 52: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 53: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 54: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 55: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 56: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 57: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 58: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 59: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[1];
    case 63: return G[0];
    case 64: return G[1];
    case 65: return G[2];
    case 66: return G[0];
    case 67: return G[0];
    case 68: return G[1];
    case 69: return G[0];
    case 70: return G[1];
    case 71: return G[2];
    case 72: return G[0] * zij + G[7];
    case 73: return G[0] * zij + G[7];
    case 74: return G[1] * zij + G[8];
    case 75: return G[0] * zij + G[7];
    case 76: return G[1] * zij + G[8];
    case 77: return G[2] * zij + G[9];
    case 78: return G[0];
    case 79: return G[0];
    case 80: return G[1];
    case 81: return G[0];
    case 82: return G[1];
    case 83: return G[2];
    case 84: return G[0] * zij + G[7];
    case 85: return G[0] * zij + G[7];
    case 86: return G[1] * zij + G[8];
    case 87: return G[0] * zij + G[7];
    case 88: return G[1] * zij + G[8];
    case 89: return G[2] * zij + G[9];
    case 90: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 91: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 92: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 93: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 94: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 95: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 96: return G[0];
    case 97: return G[0];
    case 98: return G[1];
    case 99: return G[0];
    case 100: return G[1];
    case 101: return G[2];
    case 102: return G[0] * zij + G[7];
    case 103: return G[0] * zij + G[7];
    case 104: return G[1] * zij + G[8];
    case 105: return G[0] * zij + G[7];
    case 106: return G[1] * zij + G[8];
    case 107: return G[2] * zij + G[9];
    case 108: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 109: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 110: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 111: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 112: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 113: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 114: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 115: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 116: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 117: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 118: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 119: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 120: return G[7];
    case 121: return G[7];
    case 122: return G[8];
    case 123: return G[7];
    case 124: return G[8];
    case 125: return G[9];
    case 126: return G[7];
    case 127: return G[7];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[8];
    case 131: return G[9];
    case 132: return G[7] * zij + G[14];
    case 133: return G[7] * zij + G[14];
    case 134: return G[8] * zij + G[15];
    case 135: return G[7] * zij + G[14];
    case 136: return G[8] * zij + G[15];
    case 137: return G[9] * zij + G[16];
    case 138: return G[7];
    case 139: return G[7];
    case 140: return G[8];
    case 141: return G[7];
    case 142: return G[8];
    case 143: return G[9];
    case 144: return G[7] * zij + G[14];
    case 145: return G[7] * zij + G[14];
    case 146: return G[8] * zij + G[15];
    case 147: return G[7] * zij + G[14];
    case 148: return G[8] * zij + G[15];
    case 149: return G[9] * zij + G[16];
    case 150: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 151: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 152: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 153: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 154: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 155: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 156: return G[7];
    case 157: return G[7];
    case 158: return G[8];
    case 159: return G[7];
    case 160: return G[8];
    case 161: return G[9];
    case 162: return G[7] * zij + G[14];
    case 163: return G[7] * zij + G[14];
    case 164: return G[8] * zij + G[15];
    case 165: return G[7] * zij + G[14];
    case 166: return G[8] * zij + G[15];
    case 167: return G[9] * zij + G[16];
    case 168: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 169: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 170: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 171: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 172: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 173: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 174: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 175: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 176: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 177: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 178: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 179: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 180: return G[0];
    case 181: return G[0];
    case 182: return G[1];
    case 183: return G[0];
    case 184: return G[1];
    case 185: return G[2];
    case 186: return G[0];
    case 187: return G[0];
    case 188: return G[1];
    case 189: return G[0];
    case 190: return G[1];
    case 191: return G[2];
    case 192: return G[0] * zij + G[7];
    case 193: return G[0] * zij + G[7];
    case 194: return G[1] * zij + G[8];
    case 195: return G[0] * zij + G[7];
    case 196: return G[1] * zij + G[8];
    case 197: return G[2] * zij + G[9];
    case 198: return G[0];
    case 199: return G[0];
    case 200: return G[1];
    case 201: return G[0];
    case 202: return G[1];
    case 203: return G[2];
    case 204: return G[0] * zij + G[7];
    case 205: return G[0] * zij + G[7];
    case 206: return G[1] * zij + G[8];
    case 207: return G[0] * zij + G[7];
    case 208: return G[1] * zij + G[8];
    case 209: return G[2] * zij + G[9];
    case 210: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 211: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 212: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 213: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 214: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 215: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 216: return G[0];
    case 217: return G[0];
    case 218: return G[1];
    case 219: return G[0];
    case 220: return G[1];
    case 221: return G[2];
    case 222: return G[0] * zij + G[7];
    case 223: return G[0] * zij + G[7];
    case 224: return G[1] * zij + G[8];
    case 225: return G[0] * zij + G[7];
    case 226: return G[1] * zij + G[8];
    case 227: return G[2] * zij + G[9];
    case 228: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 229: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 230: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 231: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 232: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 233: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 234: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 235: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 236: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 237: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 238: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 239: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 240: return G[7];
    case 241: return G[7];
    case 242: return G[8];
    case 243: return G[7];
    case 244: return G[8];
    case 245: return G[9];
    case 246: return G[7];
    case 247: return G[7];
    case 248: return G[8];
    case 249: return G[7];
    case 250: return G[8];
    case 251: return G[9];
    case 252: return G[7] * zij + G[14];
    case 253: return G[7] * zij + G[14];
    case 254: return G[8] * zij + G[15];
    case 255: return G[7] * zij + G[14];
    case 256: return G[8] * zij + G[15];
    case 257: return G[9] * zij + G[16];
    case 258: return G[7];
    case 259: return G[7];
    case 260: return G[8];
    case 261: return G[7];
    case 262: return G[8];
    case 263: return G[9];
    case 264: return G[7] * zij + G[14];
    case 265: return G[7] * zij + G[14];
    case 266: return G[8] * zij + G[15];
    case 267: return G[7] * zij + G[14];
    case 268: return G[8] * zij + G[15];
    case 269: return G[9] * zij + G[16];
    case 270: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 271: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 272: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 273: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 274: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 275: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 276: return G[7];
    case 277: return G[7];
    case 278: return G[8];
    case 279: return G[7];
    case 280: return G[8];
    case 281: return G[9];
    case 282: return G[7] * zij + G[14];
    case 283: return G[7] * zij + G[14];
    case 284: return G[8] * zij + G[15];
    case 285: return G[7] * zij + G[14];
    case 286: return G[8] * zij + G[15];
    case 287: return G[9] * zij + G[16];
    case 288: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 289: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 290: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 291: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 292: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 293: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 294: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 295: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 296: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 297: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 298: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 299: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 300: return G[14];
    case 301: return G[14];
    case 302: return G[15];
    case 303: return G[14];
    case 304: return G[15];
    case 305: return G[16];
    case 306: return G[14];
    case 307: return G[14];
    case 308: return G[15];
    case 309: return G[14];
    case 310: return G[15];
    case 311: return G[16];
    case 312: return G[14] * zij + G[21];
    case 313: return G[14] * zij + G[21];
    case 314: return G[15] * zij + G[22];
    case 315: return G[14] * zij + G[21];
    case 316: return G[15] * zij + G[22];
    case 317: return G[16] * zij + G[23];
    case 318: return G[14];
    case 319: return G[14];
    case 320: return G[15];
    case 321: return G[14];
    case 322: return G[15];
    case 323: return G[16];
    case 324: return G[14] * zij + G[21];
    case 325: return G[14] * zij + G[21];
    case 326: return G[15] * zij + G[22];
    case 327: return G[14] * zij + G[21];
    case 328: return G[15] * zij + G[22];
    case 329: return G[16] * zij + G[23];
    case 330: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 331: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 332: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 333: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 334: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 335: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 336: return G[14];
    case 337: return G[14];
    case 338: return G[15];
    case 339: return G[14];
    case 340: return G[15];
    case 341: return G[16];
    case 342: return G[14] * zij + G[21];
    case 343: return G[14] * zij + G[21];
    case 344: return G[15] * zij + G[22];
    case 345: return G[14] * zij + G[21];
    case 346: return G[15] * zij + G[22];
    case 347: return G[16] * zij + G[23];
    case 348: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 349: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 350: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 351: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 352: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 353: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 354: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 355: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 356: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 357: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 358: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 359: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 360: return G[0];
    case 361: return G[0];
    case 362: return G[1];
    case 363: return G[0];
    case 364: return G[1];
    case 365: return G[2];
    case 366: return G[0];
    case 367: return G[0];
    case 368: return G[1];
    case 369: return G[0];
    case 370: return G[1];
    case 371: return G[2];
    case 372: return G[0] * zij + G[7];
    case 373: return G[0] * zij + G[7];
    case 374: return G[1] * zij + G[8];
    case 375: return G[0] * zij + G[7];
    case 376: return G[1] * zij + G[8];
    case 377: return G[2] * zij + G[9];
    case 378: return G[0];
    case 379: return G[0];
    case 380: return G[1];
    case 381: return G[0];
    case 382: return G[1];
    case 383: return G[2];
    case 384: return G[0] * zij + G[7];
    case 385: return G[0] * zij + G[7];
    case 386: return G[1] * zij + G[8];
    case 387: return G[0] * zij + G[7];
    case 388: return G[1] * zij + G[8];
    case 389: return G[2] * zij + G[9];
    case 390: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 391: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 392: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 393: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 394: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 395: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 396: return G[0];
    case 397: return G[0];
    case 398: return G[1];
    case 399: return G[0];
    case 400: return G[1];
    case 401: return G[2];
    case 402: return G[0] * zij + G[7];
    case 403: return G[0] * zij + G[7];
    case 404: return G[1] * zij + G[8];
    case 405: return G[0] * zij + G[7];
    case 406: return G[1] * zij + G[8];
    case 407: return G[2] * zij + G[9];
    case 408: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 409: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 410: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 411: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 412: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 413: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 414: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 415: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 416: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 417: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 418: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 419: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 420: return G[7];
    case 421: return G[7];
    case 422: return G[8];
    case 423: return G[7];
    case 424: return G[8];
    case 425: return G[9];
    case 426: return G[7];
    case 427: return G[7];
    case 428: return G[8];
    case 429: return G[7];
    case 430: return G[8];
    case 431: return G[9];
    case 432: return G[7] * zij + G[14];
    case 433: return G[7] * zij + G[14];
    case 434: return G[8] * zij + G[15];
    case 435: return G[7] * zij + G[14];
    case 436: return G[8] * zij + G[15];
    case 437: return G[9] * zij + G[16];
    case 438: return G[7];
    case 439: return G[7];
    case 440: return G[8];
    case 441: return G[7];
    case 442: return G[8];
    case 443: return G[9];
    case 444: return G[7] * zij + G[14];
    case 445: return G[7] * zij + G[14];
    case 446: return G[8] * zij + G[15];
    case 447: return G[7] * zij + G[14];
    case 448: return G[8] * zij + G[15];
    case 449: return G[9] * zij + G[16];
    case 450: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 451: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 452: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 453: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 454: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 455: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 456: return G[7];
    case 457: return G[7];
    case 458: return G[8];
    case 459: return G[7];
    case 460: return G[8];
    case 461: return G[9];
    case 462: return G[7] * zij + G[14];
    case 463: return G[7] * zij + G[14];
    case 464: return G[8] * zij + G[15];
    case 465: return G[7] * zij + G[14];
    case 466: return G[8] * zij + G[15];
    case 467: return G[9] * zij + G[16];
    case 468: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 469: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 470: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 471: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 472: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 473: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 474: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 475: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 476: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 477: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 478: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 479: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 480: return G[14];
    case 481: return G[14];
    case 482: return G[15];
    case 483: return G[14];
    case 484: return G[15];
    case 485: return G[16];
    case 486: return G[14];
    case 487: return G[14];
    case 488: return G[15];
    case 489: return G[14];
    case 490: return G[15];
    case 491: return G[16];
    case 492: return G[14] * zij + G[21];
    case 493: return G[14] * zij + G[21];
    case 494: return G[15] * zij + G[22];
    case 495: return G[14] * zij + G[21];
    case 496: return G[15] * zij + G[22];
    case 497: return G[16] * zij + G[23];
    case 498: return G[14];
    case 499: return G[14];
    case 500: return G[15];
    case 501: return G[14];
    case 502: return G[15];
    case 503: return G[16];
    case 504: return G[14] * zij + G[21];
    case 505: return G[14] * zij + G[21];
    case 506: return G[15] * zij + G[22];
    case 507: return G[14] * zij + G[21];
    case 508: return G[15] * zij + G[22];
    case 509: return G[16] * zij + G[23];
    case 510: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 511: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 512: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 513: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 514: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 515: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 516: return G[14];
    case 517: return G[14];
    case 518: return G[15];
    case 519: return G[14];
    case 520: return G[15];
    case 521: return G[16];
    case 522: return G[14] * zij + G[21];
    case 523: return G[14] * zij + G[21];
    case 524: return G[15] * zij + G[22];
    case 525: return G[14] * zij + G[21];
    case 526: return G[15] * zij + G[22];
    case 527: return G[16] * zij + G[23];
    case 528: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 529: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 530: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 531: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 532: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 533: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 534: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 535: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 536: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 537: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 538: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 539: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 540: return G[21];
    case 541: return G[21];
    case 542: return G[22];
    case 543: return G[21];
    case 544: return G[22];
    case 545: return G[23];
    case 546: return G[21];
    case 547: return G[21];
    case 548: return G[22];
    case 549: return G[21];
    case 550: return G[22];
    case 551: return G[23];
    case 552: return G[21] * zij + G[28];
    case 553: return G[21] * zij + G[28];
    case 554: return G[22] * zij + G[29];
    case 555: return G[21] * zij + G[28];
    case 556: return G[22] * zij + G[29];
    case 557: return G[23] * zij + G[30];
    case 558: return G[21];
    case 559: return G[21];
    case 560: return G[22];
    case 561: return G[21];
    case 562: return G[22];
    case 563: return G[23];
    case 564: return G[21] * zij + G[28];
    case 565: return G[21] * zij + G[28];
    case 566: return G[22] * zij + G[29];
    case 567: return G[21] * zij + G[28];
    case 568: return G[22] * zij + G[29];
    case 569: return G[23] * zij + G[30];
    case 570: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 571: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 572: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 573: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 574: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 575: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 576: return G[21];
    case 577: return G[21];
    case 578: return G[22];
    case 579: return G[21];
    case 580: return G[22];
    case 581: return G[23];
    case 582: return G[21] * zij + G[28];
    case 583: return G[21] * zij + G[28];
    case 584: return G[22] * zij + G[29];
    case 585: return G[21] * zij + G[28];
    case 586: return G[22] * zij + G[29];
    case 587: return G[23] * zij + G[30];
    case 588: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 589: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 590: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 591: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 592: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 593: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 594: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 595: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 596: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    case 597: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 598: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    case 599: return G[23] * pow(zij, 3) + 3.0 * (G[30] * zij2) + 3.0 * (G[37] * zij) + G[44];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ffds_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 600;
  constexpr int kNMax = 6;
  constexpr int kMMax = 2;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ffds_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ffds_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ffds_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ssfs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[3];
    case 1: return G[2];
    case 2: return G[2];
    case 3: return G[1];
    case 4: return G[1];
    case 5: return G[1];
    case 6: return G[0];
    case 7: return G[0];
    case 8: return G[0];
    case 9: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ssfs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ssfs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ssfs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 10;
  constexpr int kNMax = 0;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ssfs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ssfs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ssfs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_psfs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[10];
    case 1: return G[9];
    case 2: return G[9];
    case 3: return G[8];
    case 4: return G[8];
    case 5: return G[8];
    case 6: return G[7];
    case 7: return G[7];
    case 8: return G[7];
    case 9: return G[7];
    case 10: return G[3];
    case 11: return G[2];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[1];
    case 15: return G[1];
    case 16: return G[0];
    case 17: return G[0];
    case 18: return G[0];
    case 19: return G[0];
    case 20: return G[3];
    case 21: return G[2];
    case 22: return G[2];
    case 23: return G[1];
    case 24: return G[1];
    case 25: return G[1];
    case 26: return G[0];
    case 27: return G[0];
    case 28: return G[0];
    case 29: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_psfs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[7];
    case 11: return G[8];
    case 12: return G[7];
    case 13: return G[9];
    case 14: return G[8];
    case 15: return G[7];
    case 16: return G[10];
    case 17: return G[9];
    case 18: return G[8];
    case 19: return G[7];
    case 20: return G[0];
    case 21: return G[1];
    case 22: return G[0];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[3];
    case 27: return G[2];
    case 28: return G[1];
    case 29: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_psfs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[1];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[2];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[2];
    case 19: return G[3];
    case 20: return G[7];
    case 21: return G[7];
    case 22: return G[8];
    case 23: return G[7];
    case 24: return G[8];
    case 25: return G[9];
    case 26: return G[7];
    case 27: return G[8];
    case 28: return G[9];
    case 29: return G[10];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_psfs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 30;
  constexpr int kNMax = 1;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_psfs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_psfs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_psfs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ppfs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[10] * xij + G[17];
    case 1: return G[9] * xij + G[16];
    case 2: return G[9] * xij + G[16];
    case 3: return G[8] * xij + G[15];
    case 4: return G[8] * xij + G[15];
    case 5: return G[8] * xij + G[15];
    case 6: return G[7] * xij + G[14];
    case 7: return G[7] * xij + G[14];
    case 8: return G[7] * xij + G[14];
    case 9: return G[7] * xij + G[14];
    case 10: return G[10];
    case 11: return G[9];
    case 12: return G[9];
    case 13: return G[8];
    case 14: return G[8];
    case 15: return G[8];
    case 16: return G[7];
    case 17: return G[7];
    case 18: return G[7];
    case 19: return G[7];
    case 20: return G[10];
    case 21: return G[9];
    case 22: return G[9];
    case 23: return G[8];
    case 24: return G[8];
    case 25: return G[8];
    case 26: return G[7];
    case 27: return G[7];
    case 28: return G[7];
    case 29: return G[7];
    case 30: return G[3] * xij + G[10];
    case 31: return G[2] * xij + G[9];
    case 32: return G[2] * xij + G[9];
    case 33: return G[1] * xij + G[8];
    case 34: return G[1] * xij + G[8];
    case 35: return G[1] * xij + G[8];
    case 36: return G[0] * xij + G[7];
    case 37: return G[0] * xij + G[7];
    case 38: return G[0] * xij + G[7];
    case 39: return G[0] * xij + G[7];
    case 40: return G[3];
    case 41: return G[2];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[1];
    case 45: return G[1];
    case 46: return G[0];
    case 47: return G[0];
    case 48: return G[0];
    case 49: return G[0];
    case 50: return G[3];
    case 51: return G[2];
    case 52: return G[2];
    case 53: return G[1];
    case 54: return G[1];
    case 55: return G[1];
    case 56: return G[0];
    case 57: return G[0];
    case 58: return G[0];
    case 59: return G[0];
    case 60: return G[3] * xij + G[10];
    case 61: return G[2] * xij + G[9];
    case 62: return G[2] * xij + G[9];
    case 63: return G[1] * xij + G[8];
    case 64: return G[1] * xij + G[8];
    case 65: return G[1] * xij + G[8];
    case 66: return G[0] * xij + G[7];
    case 67: return G[0] * xij + G[7];
    case 68: return G[0] * xij + G[7];
    case 69: return G[0] * xij + G[7];
    case 70: return G[3];
    case 71: return G[2];
    case 72: return G[2];
    case 73: return G[1];
    case 74: return G[1];
    case 75: return G[1];
    case 76: return G[0];
    case 77: return G[0];
    case 78: return G[0];
    case 79: return G[0];
    case 80: return G[3];
    case 81: return G[2];
    case 82: return G[2];
    case 83: return G[1];
    case 84: return G[1];
    case 85: return G[1];
    case 86: return G[0];
    case 87: return G[0];
    case 88: return G[0];
    case 89: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ppfs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[0] * yij + G[7];
    case 11: return G[1] * yij + G[8];
    case 12: return G[0] * yij + G[7];
    case 13: return G[2] * yij + G[9];
    case 14: return G[1] * yij + G[8];
    case 15: return G[0] * yij + G[7];
    case 16: return G[3] * yij + G[10];
    case 17: return G[2] * yij + G[9];
    case 18: return G[1] * yij + G[8];
    case 19: return G[0] * yij + G[7];
    case 20: return G[0];
    case 21: return G[1];
    case 22: return G[0];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[3];
    case 27: return G[2];
    case 28: return G[1];
    case 29: return G[0];
    case 30: return G[7];
    case 31: return G[8];
    case 32: return G[7];
    case 33: return G[9];
    case 34: return G[8];
    case 35: return G[7];
    case 36: return G[10];
    case 37: return G[9];
    case 38: return G[8];
    case 39: return G[7];
    case 40: return G[7] * yij + G[14];
    case 41: return G[8] * yij + G[15];
    case 42: return G[7] * yij + G[14];
    case 43: return G[9] * yij + G[16];
    case 44: return G[8] * yij + G[15];
    case 45: return G[7] * yij + G[14];
    case 46: return G[10] * yij + G[17];
    case 47: return G[9] * yij + G[16];
    case 48: return G[8] * yij + G[15];
    case 49: return G[7] * yij + G[14];
    case 50: return G[7];
    case 51: return G[8];
    case 52: return G[7];
    case 53: return G[9];
    case 54: return G[8];
    case 55: return G[7];
    case 56: return G[10];
    case 57: return G[9];
    case 58: return G[8];
    case 59: return G[7];
    case 60: return G[0];
    case 61: return G[1];
    case 62: return G[0];
    case 63: return G[2];
    case 64: return G[1];
    case 65: return G[0];
    case 66: return G[3];
    case 67: return G[2];
    case 68: return G[1];
    case 69: return G[0];
    case 70: return G[0] * yij + G[7];
    case 71: return G[1] * yij + G[8];
    case 72: return G[0] * yij + G[7];
    case 73: return G[2] * yij + G[9];
    case 74: return G[1] * yij + G[8];
    case 75: return G[0] * yij + G[7];
    case 76: return G[3] * yij + G[10];
    case 77: return G[2] * yij + G[9];
    case 78: return G[1] * yij + G[8];
    case 79: return G[0] * yij + G[7];
    case 80: return G[0];
    case 81: return G[1];
    case 82: return G[0];
    case 83: return G[2];
    case 84: return G[1];
    case 85: return G[0];
    case 86: return G[3];
    case 87: return G[2];
    case 88: return G[1];
    case 89: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ppfs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[1];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[2];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[2];
    case 19: return G[3];
    case 20: return G[0] * zij + G[7];
    case 21: return G[0] * zij + G[7];
    case 22: return G[1] * zij + G[8];
    case 23: return G[0] * zij + G[7];
    case 24: return G[1] * zij + G[8];
    case 25: return G[2] * zij + G[9];
    case 26: return G[0] * zij + G[7];
    case 27: return G[1] * zij + G[8];
    case 28: return G[2] * zij + G[9];
    case 29: return G[3] * zij + G[10];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[1];
    case 35: return G[2];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[2];
    case 39: return G[3];
    case 40: return G[0];
    case 41: return G[0];
    case 42: return G[1];
    case 43: return G[0];
    case 44: return G[1];
    case 45: return G[2];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[2];
    case 49: return G[3];
    case 50: return G[0] * zij + G[7];
    case 51: return G[0] * zij + G[7];
    case 52: return G[1] * zij + G[8];
    case 53: return G[0] * zij + G[7];
    case 54: return G[1] * zij + G[8];
    case 55: return G[2] * zij + G[9];
    case 56: return G[0] * zij + G[7];
    case 57: return G[1] * zij + G[8];
    case 58: return G[2] * zij + G[9];
    case 59: return G[3] * zij + G[10];
    case 60: return G[7];
    case 61: return G[7];
    case 62: return G[8];
    case 63: return G[7];
    case 64: return G[8];
    case 65: return G[9];
    case 66: return G[7];
    case 67: return G[8];
    case 68: return G[9];
    case 69: return G[10];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[8];
    case 73: return G[7];
    case 74: return G[8];
    case 75: return G[9];
    case 76: return G[7];
    case 77: return G[8];
    case 78: return G[9];
    case 79: return G[10];
    case 80: return G[7] * zij + G[14];
    case 81: return G[7] * zij + G[14];
    case 82: return G[8] * zij + G[15];
    case 83: return G[7] * zij + G[14];
    case 84: return G[8] * zij + G[15];
    case 85: return G[9] * zij + G[16];
    case 86: return G[7] * zij + G[14];
    case 87: return G[8] * zij + G[15];
    case 88: return G[9] * zij + G[16];
    case 89: return G[10] * zij + G[17];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ppfs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 90;
  constexpr int kNMax = 2;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ppfs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ppfs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ppfs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_dsfs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[17];
    case 1: return G[16];
    case 2: return G[16];
    case 3: return G[15];
    case 4: return G[15];
    case 5: return G[15];
    case 6: return G[14];
    case 7: return G[14];
    case 8: return G[14];
    case 9: return G[14];
    case 10: return G[10];
    case 11: return G[9];
    case 12: return G[9];
    case 13: return G[8];
    case 14: return G[8];
    case 15: return G[8];
    case 16: return G[7];
    case 17: return G[7];
    case 18: return G[7];
    case 19: return G[7];
    case 20: return G[10];
    case 21: return G[9];
    case 22: return G[9];
    case 23: return G[8];
    case 24: return G[8];
    case 25: return G[8];
    case 26: return G[7];
    case 27: return G[7];
    case 28: return G[7];
    case 29: return G[7];
    case 30: return G[3];
    case 31: return G[2];
    case 32: return G[2];
    case 33: return G[1];
    case 34: return G[1];
    case 35: return G[1];
    case 36: return G[0];
    case 37: return G[0];
    case 38: return G[0];
    case 39: return G[0];
    case 40: return G[3];
    case 41: return G[2];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[1];
    case 45: return G[1];
    case 46: return G[0];
    case 47: return G[0];
    case 48: return G[0];
    case 49: return G[0];
    case 50: return G[3];
    case 51: return G[2];
    case 52: return G[2];
    case 53: return G[1];
    case 54: return G[1];
    case 55: return G[1];
    case 56: return G[0];
    case 57: return G[0];
    case 58: return G[0];
    case 59: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsfs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[7];
    case 11: return G[8];
    case 12: return G[7];
    case 13: return G[9];
    case 14: return G[8];
    case 15: return G[7];
    case 16: return G[10];
    case 17: return G[9];
    case 18: return G[8];
    case 19: return G[7];
    case 20: return G[0];
    case 21: return G[1];
    case 22: return G[0];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[3];
    case 27: return G[2];
    case 28: return G[1];
    case 29: return G[0];
    case 30: return G[14];
    case 31: return G[15];
    case 32: return G[14];
    case 33: return G[16];
    case 34: return G[15];
    case 35: return G[14];
    case 36: return G[17];
    case 37: return G[16];
    case 38: return G[15];
    case 39: return G[14];
    case 40: return G[7];
    case 41: return G[8];
    case 42: return G[7];
    case 43: return G[9];
    case 44: return G[8];
    case 45: return G[7];
    case 46: return G[10];
    case 47: return G[9];
    case 48: return G[8];
    case 49: return G[7];
    case 50: return G[0];
    case 51: return G[1];
    case 52: return G[0];
    case 53: return G[2];
    case 54: return G[1];
    case 55: return G[0];
    case 56: return G[3];
    case 57: return G[2];
    case 58: return G[1];
    case 59: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsfs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[1];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[2];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[2];
    case 19: return G[3];
    case 20: return G[7];
    case 21: return G[7];
    case 22: return G[8];
    case 23: return G[7];
    case 24: return G[8];
    case 25: return G[9];
    case 26: return G[7];
    case 27: return G[8];
    case 28: return G[9];
    case 29: return G[10];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[1];
    case 35: return G[2];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[2];
    case 39: return G[3];
    case 40: return G[7];
    case 41: return G[7];
    case 42: return G[8];
    case 43: return G[7];
    case 44: return G[8];
    case 45: return G[9];
    case 46: return G[7];
    case 47: return G[8];
    case 48: return G[9];
    case 49: return G[10];
    case 50: return G[14];
    case 51: return G[14];
    case 52: return G[15];
    case 53: return G[14];
    case 54: return G[15];
    case 55: return G[16];
    case 56: return G[14];
    case 57: return G[15];
    case 58: return G[16];
    case 59: return G[17];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_dsfs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 60;
  constexpr int kNMax = 2;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_dsfs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_dsfs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_dsfs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fsfs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[24];
    case 1: return G[23];
    case 2: return G[23];
    case 3: return G[22];
    case 4: return G[22];
    case 5: return G[22];
    case 6: return G[21];
    case 7: return G[21];
    case 8: return G[21];
    case 9: return G[21];
    case 10: return G[17];
    case 11: return G[16];
    case 12: return G[16];
    case 13: return G[15];
    case 14: return G[15];
    case 15: return G[15];
    case 16: return G[14];
    case 17: return G[14];
    case 18: return G[14];
    case 19: return G[14];
    case 20: return G[17];
    case 21: return G[16];
    case 22: return G[16];
    case 23: return G[15];
    case 24: return G[15];
    case 25: return G[15];
    case 26: return G[14];
    case 27: return G[14];
    case 28: return G[14];
    case 29: return G[14];
    case 30: return G[10];
    case 31: return G[9];
    case 32: return G[9];
    case 33: return G[8];
    case 34: return G[8];
    case 35: return G[8];
    case 36: return G[7];
    case 37: return G[7];
    case 38: return G[7];
    case 39: return G[7];
    case 40: return G[10];
    case 41: return G[9];
    case 42: return G[9];
    case 43: return G[8];
    case 44: return G[8];
    case 45: return G[8];
    case 46: return G[7];
    case 47: return G[7];
    case 48: return G[7];
    case 49: return G[7];
    case 50: return G[10];
    case 51: return G[9];
    case 52: return G[9];
    case 53: return G[8];
    case 54: return G[8];
    case 55: return G[8];
    case 56: return G[7];
    case 57: return G[7];
    case 58: return G[7];
    case 59: return G[7];
    case 60: return G[3];
    case 61: return G[2];
    case 62: return G[2];
    case 63: return G[1];
    case 64: return G[1];
    case 65: return G[1];
    case 66: return G[0];
    case 67: return G[0];
    case 68: return G[0];
    case 69: return G[0];
    case 70: return G[3];
    case 71: return G[2];
    case 72: return G[2];
    case 73: return G[1];
    case 74: return G[1];
    case 75: return G[1];
    case 76: return G[0];
    case 77: return G[0];
    case 78: return G[0];
    case 79: return G[0];
    case 80: return G[3];
    case 81: return G[2];
    case 82: return G[2];
    case 83: return G[1];
    case 84: return G[1];
    case 85: return G[1];
    case 86: return G[0];
    case 87: return G[0];
    case 88: return G[0];
    case 89: return G[0];
    case 90: return G[3];
    case 91: return G[2];
    case 92: return G[2];
    case 93: return G[1];
    case 94: return G[1];
    case 95: return G[1];
    case 96: return G[0];
    case 97: return G[0];
    case 98: return G[0];
    case 99: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fsfs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[7];
    case 11: return G[8];
    case 12: return G[7];
    case 13: return G[9];
    case 14: return G[8];
    case 15: return G[7];
    case 16: return G[10];
    case 17: return G[9];
    case 18: return G[8];
    case 19: return G[7];
    case 20: return G[0];
    case 21: return G[1];
    case 22: return G[0];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[3];
    case 27: return G[2];
    case 28: return G[1];
    case 29: return G[0];
    case 30: return G[14];
    case 31: return G[15];
    case 32: return G[14];
    case 33: return G[16];
    case 34: return G[15];
    case 35: return G[14];
    case 36: return G[17];
    case 37: return G[16];
    case 38: return G[15];
    case 39: return G[14];
    case 40: return G[7];
    case 41: return G[8];
    case 42: return G[7];
    case 43: return G[9];
    case 44: return G[8];
    case 45: return G[7];
    case 46: return G[10];
    case 47: return G[9];
    case 48: return G[8];
    case 49: return G[7];
    case 50: return G[0];
    case 51: return G[1];
    case 52: return G[0];
    case 53: return G[2];
    case 54: return G[1];
    case 55: return G[0];
    case 56: return G[3];
    case 57: return G[2];
    case 58: return G[1];
    case 59: return G[0];
    case 60: return G[21];
    case 61: return G[22];
    case 62: return G[21];
    case 63: return G[23];
    case 64: return G[22];
    case 65: return G[21];
    case 66: return G[24];
    case 67: return G[23];
    case 68: return G[22];
    case 69: return G[21];
    case 70: return G[14];
    case 71: return G[15];
    case 72: return G[14];
    case 73: return G[16];
    case 74: return G[15];
    case 75: return G[14];
    case 76: return G[17];
    case 77: return G[16];
    case 78: return G[15];
    case 79: return G[14];
    case 80: return G[7];
    case 81: return G[8];
    case 82: return G[7];
    case 83: return G[9];
    case 84: return G[8];
    case 85: return G[7];
    case 86: return G[10];
    case 87: return G[9];
    case 88: return G[8];
    case 89: return G[7];
    case 90: return G[0];
    case 91: return G[1];
    case 92: return G[0];
    case 93: return G[2];
    case 94: return G[1];
    case 95: return G[0];
    case 96: return G[3];
    case 97: return G[2];
    case 98: return G[1];
    case 99: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fsfs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[1];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[2];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[2];
    case 19: return G[3];
    case 20: return G[7];
    case 21: return G[7];
    case 22: return G[8];
    case 23: return G[7];
    case 24: return G[8];
    case 25: return G[9];
    case 26: return G[7];
    case 27: return G[8];
    case 28: return G[9];
    case 29: return G[10];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[1];
    case 35: return G[2];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[2];
    case 39: return G[3];
    case 40: return G[7];
    case 41: return G[7];
    case 42: return G[8];
    case 43: return G[7];
    case 44: return G[8];
    case 45: return G[9];
    case 46: return G[7];
    case 47: return G[8];
    case 48: return G[9];
    case 49: return G[10];
    case 50: return G[14];
    case 51: return G[14];
    case 52: return G[15];
    case 53: return G[14];
    case 54: return G[15];
    case 55: return G[16];
    case 56: return G[14];
    case 57: return G[15];
    case 58: return G[16];
    case 59: return G[17];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[1];
    case 63: return G[0];
    case 64: return G[1];
    case 65: return G[2];
    case 66: return G[0];
    case 67: return G[1];
    case 68: return G[2];
    case 69: return G[3];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[8];
    case 73: return G[7];
    case 74: return G[8];
    case 75: return G[9];
    case 76: return G[7];
    case 77: return G[8];
    case 78: return G[9];
    case 79: return G[10];
    case 80: return G[14];
    case 81: return G[14];
    case 82: return G[15];
    case 83: return G[14];
    case 84: return G[15];
    case 85: return G[16];
    case 86: return G[14];
    case 87: return G[15];
    case 88: return G[16];
    case 89: return G[17];
    case 90: return G[21];
    case 91: return G[21];
    case 92: return G[22];
    case 93: return G[21];
    case 94: return G[22];
    case 95: return G[23];
    case 96: return G[21];
    case 97: return G[22];
    case 98: return G[23];
    case 99: return G[24];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fsfs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 100;
  constexpr int kNMax = 3;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fsfs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fsfs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fsfs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_dpfs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[17] * xij + G[24];
    case 1: return G[16] * xij + G[23];
    case 2: return G[16] * xij + G[23];
    case 3: return G[15] * xij + G[22];
    case 4: return G[15] * xij + G[22];
    case 5: return G[15] * xij + G[22];
    case 6: return G[14] * xij + G[21];
    case 7: return G[14] * xij + G[21];
    case 8: return G[14] * xij + G[21];
    case 9: return G[14] * xij + G[21];
    case 10: return G[17];
    case 11: return G[16];
    case 12: return G[16];
    case 13: return G[15];
    case 14: return G[15];
    case 15: return G[15];
    case 16: return G[14];
    case 17: return G[14];
    case 18: return G[14];
    case 19: return G[14];
    case 20: return G[17];
    case 21: return G[16];
    case 22: return G[16];
    case 23: return G[15];
    case 24: return G[15];
    case 25: return G[15];
    case 26: return G[14];
    case 27: return G[14];
    case 28: return G[14];
    case 29: return G[14];
    case 30: return G[10] * xij + G[17];
    case 31: return G[9] * xij + G[16];
    case 32: return G[9] * xij + G[16];
    case 33: return G[8] * xij + G[15];
    case 34: return G[8] * xij + G[15];
    case 35: return G[8] * xij + G[15];
    case 36: return G[7] * xij + G[14];
    case 37: return G[7] * xij + G[14];
    case 38: return G[7] * xij + G[14];
    case 39: return G[7] * xij + G[14];
    case 40: return G[10];
    case 41: return G[9];
    case 42: return G[9];
    case 43: return G[8];
    case 44: return G[8];
    case 45: return G[8];
    case 46: return G[7];
    case 47: return G[7];
    case 48: return G[7];
    case 49: return G[7];
    case 50: return G[10];
    case 51: return G[9];
    case 52: return G[9];
    case 53: return G[8];
    case 54: return G[8];
    case 55: return G[8];
    case 56: return G[7];
    case 57: return G[7];
    case 58: return G[7];
    case 59: return G[7];
    case 60: return G[10] * xij + G[17];
    case 61: return G[9] * xij + G[16];
    case 62: return G[9] * xij + G[16];
    case 63: return G[8] * xij + G[15];
    case 64: return G[8] * xij + G[15];
    case 65: return G[8] * xij + G[15];
    case 66: return G[7] * xij + G[14];
    case 67: return G[7] * xij + G[14];
    case 68: return G[7] * xij + G[14];
    case 69: return G[7] * xij + G[14];
    case 70: return G[10];
    case 71: return G[9];
    case 72: return G[9];
    case 73: return G[8];
    case 74: return G[8];
    case 75: return G[8];
    case 76: return G[7];
    case 77: return G[7];
    case 78: return G[7];
    case 79: return G[7];
    case 80: return G[10];
    case 81: return G[9];
    case 82: return G[9];
    case 83: return G[8];
    case 84: return G[8];
    case 85: return G[8];
    case 86: return G[7];
    case 87: return G[7];
    case 88: return G[7];
    case 89: return G[7];
    case 90: return G[3] * xij + G[10];
    case 91: return G[2] * xij + G[9];
    case 92: return G[2] * xij + G[9];
    case 93: return G[1] * xij + G[8];
    case 94: return G[1] * xij + G[8];
    case 95: return G[1] * xij + G[8];
    case 96: return G[0] * xij + G[7];
    case 97: return G[0] * xij + G[7];
    case 98: return G[0] * xij + G[7];
    case 99: return G[0] * xij + G[7];
    case 100: return G[3];
    case 101: return G[2];
    case 102: return G[2];
    case 103: return G[1];
    case 104: return G[1];
    case 105: return G[1];
    case 106: return G[0];
    case 107: return G[0];
    case 108: return G[0];
    case 109: return G[0];
    case 110: return G[3];
    case 111: return G[2];
    case 112: return G[2];
    case 113: return G[1];
    case 114: return G[1];
    case 115: return G[1];
    case 116: return G[0];
    case 117: return G[0];
    case 118: return G[0];
    case 119: return G[0];
    case 120: return G[3] * xij + G[10];
    case 121: return G[2] * xij + G[9];
    case 122: return G[2] * xij + G[9];
    case 123: return G[1] * xij + G[8];
    case 124: return G[1] * xij + G[8];
    case 125: return G[1] * xij + G[8];
    case 126: return G[0] * xij + G[7];
    case 127: return G[0] * xij + G[7];
    case 128: return G[0] * xij + G[7];
    case 129: return G[0] * xij + G[7];
    case 130: return G[3];
    case 131: return G[2];
    case 132: return G[2];
    case 133: return G[1];
    case 134: return G[1];
    case 135: return G[1];
    case 136: return G[0];
    case 137: return G[0];
    case 138: return G[0];
    case 139: return G[0];
    case 140: return G[3];
    case 141: return G[2];
    case 142: return G[2];
    case 143: return G[1];
    case 144: return G[1];
    case 145: return G[1];
    case 146: return G[0];
    case 147: return G[0];
    case 148: return G[0];
    case 149: return G[0];
    case 150: return G[3] * xij + G[10];
    case 151: return G[2] * xij + G[9];
    case 152: return G[2] * xij + G[9];
    case 153: return G[1] * xij + G[8];
    case 154: return G[1] * xij + G[8];
    case 155: return G[1] * xij + G[8];
    case 156: return G[0] * xij + G[7];
    case 157: return G[0] * xij + G[7];
    case 158: return G[0] * xij + G[7];
    case 159: return G[0] * xij + G[7];
    case 160: return G[3];
    case 161: return G[2];
    case 162: return G[2];
    case 163: return G[1];
    case 164: return G[1];
    case 165: return G[1];
    case 166: return G[0];
    case 167: return G[0];
    case 168: return G[0];
    case 169: return G[0];
    case 170: return G[3];
    case 171: return G[2];
    case 172: return G[2];
    case 173: return G[1];
    case 174: return G[1];
    case 175: return G[1];
    case 176: return G[0];
    case 177: return G[0];
    case 178: return G[0];
    case 179: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dpfs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[0] * yij + G[7];
    case 11: return G[1] * yij + G[8];
    case 12: return G[0] * yij + G[7];
    case 13: return G[2] * yij + G[9];
    case 14: return G[1] * yij + G[8];
    case 15: return G[0] * yij + G[7];
    case 16: return G[3] * yij + G[10];
    case 17: return G[2] * yij + G[9];
    case 18: return G[1] * yij + G[8];
    case 19: return G[0] * yij + G[7];
    case 20: return G[0];
    case 21: return G[1];
    case 22: return G[0];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[3];
    case 27: return G[2];
    case 28: return G[1];
    case 29: return G[0];
    case 30: return G[7];
    case 31: return G[8];
    case 32: return G[7];
    case 33: return G[9];
    case 34: return G[8];
    case 35: return G[7];
    case 36: return G[10];
    case 37: return G[9];
    case 38: return G[8];
    case 39: return G[7];
    case 40: return G[7] * yij + G[14];
    case 41: return G[8] * yij + G[15];
    case 42: return G[7] * yij + G[14];
    case 43: return G[9] * yij + G[16];
    case 44: return G[8] * yij + G[15];
    case 45: return G[7] * yij + G[14];
    case 46: return G[10] * yij + G[17];
    case 47: return G[9] * yij + G[16];
    case 48: return G[8] * yij + G[15];
    case 49: return G[7] * yij + G[14];
    case 50: return G[7];
    case 51: return G[8];
    case 52: return G[7];
    case 53: return G[9];
    case 54: return G[8];
    case 55: return G[7];
    case 56: return G[10];
    case 57: return G[9];
    case 58: return G[8];
    case 59: return G[7];
    case 60: return G[0];
    case 61: return G[1];
    case 62: return G[0];
    case 63: return G[2];
    case 64: return G[1];
    case 65: return G[0];
    case 66: return G[3];
    case 67: return G[2];
    case 68: return G[1];
    case 69: return G[0];
    case 70: return G[0] * yij + G[7];
    case 71: return G[1] * yij + G[8];
    case 72: return G[0] * yij + G[7];
    case 73: return G[2] * yij + G[9];
    case 74: return G[1] * yij + G[8];
    case 75: return G[0] * yij + G[7];
    case 76: return G[3] * yij + G[10];
    case 77: return G[2] * yij + G[9];
    case 78: return G[1] * yij + G[8];
    case 79: return G[0] * yij + G[7];
    case 80: return G[0];
    case 81: return G[1];
    case 82: return G[0];
    case 83: return G[2];
    case 84: return G[1];
    case 85: return G[0];
    case 86: return G[3];
    case 87: return G[2];
    case 88: return G[1];
    case 89: return G[0];
    case 90: return G[14];
    case 91: return G[15];
    case 92: return G[14];
    case 93: return G[16];
    case 94: return G[15];
    case 95: return G[14];
    case 96: return G[17];
    case 97: return G[16];
    case 98: return G[15];
    case 99: return G[14];
    case 100: return G[14] * yij + G[21];
    case 101: return G[15] * yij + G[22];
    case 102: return G[14] * yij + G[21];
    case 103: return G[16] * yij + G[23];
    case 104: return G[15] * yij + G[22];
    case 105: return G[14] * yij + G[21];
    case 106: return G[17] * yij + G[24];
    case 107: return G[16] * yij + G[23];
    case 108: return G[15] * yij + G[22];
    case 109: return G[14] * yij + G[21];
    case 110: return G[14];
    case 111: return G[15];
    case 112: return G[14];
    case 113: return G[16];
    case 114: return G[15];
    case 115: return G[14];
    case 116: return G[17];
    case 117: return G[16];
    case 118: return G[15];
    case 119: return G[14];
    case 120: return G[7];
    case 121: return G[8];
    case 122: return G[7];
    case 123: return G[9];
    case 124: return G[8];
    case 125: return G[7];
    case 126: return G[10];
    case 127: return G[9];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[7] * yij + G[14];
    case 131: return G[8] * yij + G[15];
    case 132: return G[7] * yij + G[14];
    case 133: return G[9] * yij + G[16];
    case 134: return G[8] * yij + G[15];
    case 135: return G[7] * yij + G[14];
    case 136: return G[10] * yij + G[17];
    case 137: return G[9] * yij + G[16];
    case 138: return G[8] * yij + G[15];
    case 139: return G[7] * yij + G[14];
    case 140: return G[7];
    case 141: return G[8];
    case 142: return G[7];
    case 143: return G[9];
    case 144: return G[8];
    case 145: return G[7];
    case 146: return G[10];
    case 147: return G[9];
    case 148: return G[8];
    case 149: return G[7];
    case 150: return G[0];
    case 151: return G[1];
    case 152: return G[0];
    case 153: return G[2];
    case 154: return G[1];
    case 155: return G[0];
    case 156: return G[3];
    case 157: return G[2];
    case 158: return G[1];
    case 159: return G[0];
    case 160: return G[0] * yij + G[7];
    case 161: return G[1] * yij + G[8];
    case 162: return G[0] * yij + G[7];
    case 163: return G[2] * yij + G[9];
    case 164: return G[1] * yij + G[8];
    case 165: return G[0] * yij + G[7];
    case 166: return G[3] * yij + G[10];
    case 167: return G[2] * yij + G[9];
    case 168: return G[1] * yij + G[8];
    case 169: return G[0] * yij + G[7];
    case 170: return G[0];
    case 171: return G[1];
    case 172: return G[0];
    case 173: return G[2];
    case 174: return G[1];
    case 175: return G[0];
    case 176: return G[3];
    case 177: return G[2];
    case 178: return G[1];
    case 179: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dpfs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[1];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[2];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[2];
    case 19: return G[3];
    case 20: return G[0] * zij + G[7];
    case 21: return G[0] * zij + G[7];
    case 22: return G[1] * zij + G[8];
    case 23: return G[0] * zij + G[7];
    case 24: return G[1] * zij + G[8];
    case 25: return G[2] * zij + G[9];
    case 26: return G[0] * zij + G[7];
    case 27: return G[1] * zij + G[8];
    case 28: return G[2] * zij + G[9];
    case 29: return G[3] * zij + G[10];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[1];
    case 35: return G[2];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[2];
    case 39: return G[3];
    case 40: return G[0];
    case 41: return G[0];
    case 42: return G[1];
    case 43: return G[0];
    case 44: return G[1];
    case 45: return G[2];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[2];
    case 49: return G[3];
    case 50: return G[0] * zij + G[7];
    case 51: return G[0] * zij + G[7];
    case 52: return G[1] * zij + G[8];
    case 53: return G[0] * zij + G[7];
    case 54: return G[1] * zij + G[8];
    case 55: return G[2] * zij + G[9];
    case 56: return G[0] * zij + G[7];
    case 57: return G[1] * zij + G[8];
    case 58: return G[2] * zij + G[9];
    case 59: return G[3] * zij + G[10];
    case 60: return G[7];
    case 61: return G[7];
    case 62: return G[8];
    case 63: return G[7];
    case 64: return G[8];
    case 65: return G[9];
    case 66: return G[7];
    case 67: return G[8];
    case 68: return G[9];
    case 69: return G[10];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[8];
    case 73: return G[7];
    case 74: return G[8];
    case 75: return G[9];
    case 76: return G[7];
    case 77: return G[8];
    case 78: return G[9];
    case 79: return G[10];
    case 80: return G[7] * zij + G[14];
    case 81: return G[7] * zij + G[14];
    case 82: return G[8] * zij + G[15];
    case 83: return G[7] * zij + G[14];
    case 84: return G[8] * zij + G[15];
    case 85: return G[9] * zij + G[16];
    case 86: return G[7] * zij + G[14];
    case 87: return G[8] * zij + G[15];
    case 88: return G[9] * zij + G[16];
    case 89: return G[10] * zij + G[17];
    case 90: return G[0];
    case 91: return G[0];
    case 92: return G[1];
    case 93: return G[0];
    case 94: return G[1];
    case 95: return G[2];
    case 96: return G[0];
    case 97: return G[1];
    case 98: return G[2];
    case 99: return G[3];
    case 100: return G[0];
    case 101: return G[0];
    case 102: return G[1];
    case 103: return G[0];
    case 104: return G[1];
    case 105: return G[2];
    case 106: return G[0];
    case 107: return G[1];
    case 108: return G[2];
    case 109: return G[3];
    case 110: return G[0] * zij + G[7];
    case 111: return G[0] * zij + G[7];
    case 112: return G[1] * zij + G[8];
    case 113: return G[0] * zij + G[7];
    case 114: return G[1] * zij + G[8];
    case 115: return G[2] * zij + G[9];
    case 116: return G[0] * zij + G[7];
    case 117: return G[1] * zij + G[8];
    case 118: return G[2] * zij + G[9];
    case 119: return G[3] * zij + G[10];
    case 120: return G[7];
    case 121: return G[7];
    case 122: return G[8];
    case 123: return G[7];
    case 124: return G[8];
    case 125: return G[9];
    case 126: return G[7];
    case 127: return G[8];
    case 128: return G[9];
    case 129: return G[10];
    case 130: return G[7];
    case 131: return G[7];
    case 132: return G[8];
    case 133: return G[7];
    case 134: return G[8];
    case 135: return G[9];
    case 136: return G[7];
    case 137: return G[8];
    case 138: return G[9];
    case 139: return G[10];
    case 140: return G[7] * zij + G[14];
    case 141: return G[7] * zij + G[14];
    case 142: return G[8] * zij + G[15];
    case 143: return G[7] * zij + G[14];
    case 144: return G[8] * zij + G[15];
    case 145: return G[9] * zij + G[16];
    case 146: return G[7] * zij + G[14];
    case 147: return G[8] * zij + G[15];
    case 148: return G[9] * zij + G[16];
    case 149: return G[10] * zij + G[17];
    case 150: return G[14];
    case 151: return G[14];
    case 152: return G[15];
    case 153: return G[14];
    case 154: return G[15];
    case 155: return G[16];
    case 156: return G[14];
    case 157: return G[15];
    case 158: return G[16];
    case 159: return G[17];
    case 160: return G[14];
    case 161: return G[14];
    case 162: return G[15];
    case 163: return G[14];
    case 164: return G[15];
    case 165: return G[16];
    case 166: return G[14];
    case 167: return G[15];
    case 168: return G[16];
    case 169: return G[17];
    case 170: return G[14] * zij + G[21];
    case 171: return G[14] * zij + G[21];
    case 172: return G[15] * zij + G[22];
    case 173: return G[14] * zij + G[21];
    case 174: return G[15] * zij + G[22];
    case 175: return G[16] * zij + G[23];
    case 176: return G[14] * zij + G[21];
    case 177: return G[15] * zij + G[22];
    case 178: return G[16] * zij + G[23];
    case 179: return G[17] * zij + G[24];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_dpfs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 180;
  constexpr int kNMax = 3;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_dpfs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_dpfs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_dpfs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fpfs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[24] * xij + G[31];
    case 1: return G[23] * xij + G[30];
    case 2: return G[23] * xij + G[30];
    case 3: return G[22] * xij + G[29];
    case 4: return G[22] * xij + G[29];
    case 5: return G[22] * xij + G[29];
    case 6: return G[21] * xij + G[28];
    case 7: return G[21] * xij + G[28];
    case 8: return G[21] * xij + G[28];
    case 9: return G[21] * xij + G[28];
    case 10: return G[24];
    case 11: return G[23];
    case 12: return G[23];
    case 13: return G[22];
    case 14: return G[22];
    case 15: return G[22];
    case 16: return G[21];
    case 17: return G[21];
    case 18: return G[21];
    case 19: return G[21];
    case 20: return G[24];
    case 21: return G[23];
    case 22: return G[23];
    case 23: return G[22];
    case 24: return G[22];
    case 25: return G[22];
    case 26: return G[21];
    case 27: return G[21];
    case 28: return G[21];
    case 29: return G[21];
    case 30: return G[17] * xij + G[24];
    case 31: return G[16] * xij + G[23];
    case 32: return G[16] * xij + G[23];
    case 33: return G[15] * xij + G[22];
    case 34: return G[15] * xij + G[22];
    case 35: return G[15] * xij + G[22];
    case 36: return G[14] * xij + G[21];
    case 37: return G[14] * xij + G[21];
    case 38: return G[14] * xij + G[21];
    case 39: return G[14] * xij + G[21];
    case 40: return G[17];
    case 41: return G[16];
    case 42: return G[16];
    case 43: return G[15];
    case 44: return G[15];
    case 45: return G[15];
    case 46: return G[14];
    case 47: return G[14];
    case 48: return G[14];
    case 49: return G[14];
    case 50: return G[17];
    case 51: return G[16];
    case 52: return G[16];
    case 53: return G[15];
    case 54: return G[15];
    case 55: return G[15];
    case 56: return G[14];
    case 57: return G[14];
    case 58: return G[14];
    case 59: return G[14];
    case 60: return G[17] * xij + G[24];
    case 61: return G[16] * xij + G[23];
    case 62: return G[16] * xij + G[23];
    case 63: return G[15] * xij + G[22];
    case 64: return G[15] * xij + G[22];
    case 65: return G[15] * xij + G[22];
    case 66: return G[14] * xij + G[21];
    case 67: return G[14] * xij + G[21];
    case 68: return G[14] * xij + G[21];
    case 69: return G[14] * xij + G[21];
    case 70: return G[17];
    case 71: return G[16];
    case 72: return G[16];
    case 73: return G[15];
    case 74: return G[15];
    case 75: return G[15];
    case 76: return G[14];
    case 77: return G[14];
    case 78: return G[14];
    case 79: return G[14];
    case 80: return G[17];
    case 81: return G[16];
    case 82: return G[16];
    case 83: return G[15];
    case 84: return G[15];
    case 85: return G[15];
    case 86: return G[14];
    case 87: return G[14];
    case 88: return G[14];
    case 89: return G[14];
    case 90: return G[10] * xij + G[17];
    case 91: return G[9] * xij + G[16];
    case 92: return G[9] * xij + G[16];
    case 93: return G[8] * xij + G[15];
    case 94: return G[8] * xij + G[15];
    case 95: return G[8] * xij + G[15];
    case 96: return G[7] * xij + G[14];
    case 97: return G[7] * xij + G[14];
    case 98: return G[7] * xij + G[14];
    case 99: return G[7] * xij + G[14];
    case 100: return G[10];
    case 101: return G[9];
    case 102: return G[9];
    case 103: return G[8];
    case 104: return G[8];
    case 105: return G[8];
    case 106: return G[7];
    case 107: return G[7];
    case 108: return G[7];
    case 109: return G[7];
    case 110: return G[10];
    case 111: return G[9];
    case 112: return G[9];
    case 113: return G[8];
    case 114: return G[8];
    case 115: return G[8];
    case 116: return G[7];
    case 117: return G[7];
    case 118: return G[7];
    case 119: return G[7];
    case 120: return G[10] * xij + G[17];
    case 121: return G[9] * xij + G[16];
    case 122: return G[9] * xij + G[16];
    case 123: return G[8] * xij + G[15];
    case 124: return G[8] * xij + G[15];
    case 125: return G[8] * xij + G[15];
    case 126: return G[7] * xij + G[14];
    case 127: return G[7] * xij + G[14];
    case 128: return G[7] * xij + G[14];
    case 129: return G[7] * xij + G[14];
    case 130: return G[10];
    case 131: return G[9];
    case 132: return G[9];
    case 133: return G[8];
    case 134: return G[8];
    case 135: return G[8];
    case 136: return G[7];
    case 137: return G[7];
    case 138: return G[7];
    case 139: return G[7];
    case 140: return G[10];
    case 141: return G[9];
    case 142: return G[9];
    case 143: return G[8];
    case 144: return G[8];
    case 145: return G[8];
    case 146: return G[7];
    case 147: return G[7];
    case 148: return G[7];
    case 149: return G[7];
    case 150: return G[10] * xij + G[17];
    case 151: return G[9] * xij + G[16];
    case 152: return G[9] * xij + G[16];
    case 153: return G[8] * xij + G[15];
    case 154: return G[8] * xij + G[15];
    case 155: return G[8] * xij + G[15];
    case 156: return G[7] * xij + G[14];
    case 157: return G[7] * xij + G[14];
    case 158: return G[7] * xij + G[14];
    case 159: return G[7] * xij + G[14];
    case 160: return G[10];
    case 161: return G[9];
    case 162: return G[9];
    case 163: return G[8];
    case 164: return G[8];
    case 165: return G[8];
    case 166: return G[7];
    case 167: return G[7];
    case 168: return G[7];
    case 169: return G[7];
    case 170: return G[10];
    case 171: return G[9];
    case 172: return G[9];
    case 173: return G[8];
    case 174: return G[8];
    case 175: return G[8];
    case 176: return G[7];
    case 177: return G[7];
    case 178: return G[7];
    case 179: return G[7];
    case 180: return G[3] * xij + G[10];
    case 181: return G[2] * xij + G[9];
    case 182: return G[2] * xij + G[9];
    case 183: return G[1] * xij + G[8];
    case 184: return G[1] * xij + G[8];
    case 185: return G[1] * xij + G[8];
    case 186: return G[0] * xij + G[7];
    case 187: return G[0] * xij + G[7];
    case 188: return G[0] * xij + G[7];
    case 189: return G[0] * xij + G[7];
    case 190: return G[3];
    case 191: return G[2];
    case 192: return G[2];
    case 193: return G[1];
    case 194: return G[1];
    case 195: return G[1];
    case 196: return G[0];
    case 197: return G[0];
    case 198: return G[0];
    case 199: return G[0];
    case 200: return G[3];
    case 201: return G[2];
    case 202: return G[2];
    case 203: return G[1];
    case 204: return G[1];
    case 205: return G[1];
    case 206: return G[0];
    case 207: return G[0];
    case 208: return G[0];
    case 209: return G[0];
    case 210: return G[3] * xij + G[10];
    case 211: return G[2] * xij + G[9];
    case 212: return G[2] * xij + G[9];
    case 213: return G[1] * xij + G[8];
    case 214: return G[1] * xij + G[8];
    case 215: return G[1] * xij + G[8];
    case 216: return G[0] * xij + G[7];
    case 217: return G[0] * xij + G[7];
    case 218: return G[0] * xij + G[7];
    case 219: return G[0] * xij + G[7];
    case 220: return G[3];
    case 221: return G[2];
    case 222: return G[2];
    case 223: return G[1];
    case 224: return G[1];
    case 225: return G[1];
    case 226: return G[0];
    case 227: return G[0];
    case 228: return G[0];
    case 229: return G[0];
    case 230: return G[3];
    case 231: return G[2];
    case 232: return G[2];
    case 233: return G[1];
    case 234: return G[1];
    case 235: return G[1];
    case 236: return G[0];
    case 237: return G[0];
    case 238: return G[0];
    case 239: return G[0];
    case 240: return G[3] * xij + G[10];
    case 241: return G[2] * xij + G[9];
    case 242: return G[2] * xij + G[9];
    case 243: return G[1] * xij + G[8];
    case 244: return G[1] * xij + G[8];
    case 245: return G[1] * xij + G[8];
    case 246: return G[0] * xij + G[7];
    case 247: return G[0] * xij + G[7];
    case 248: return G[0] * xij + G[7];
    case 249: return G[0] * xij + G[7];
    case 250: return G[3];
    case 251: return G[2];
    case 252: return G[2];
    case 253: return G[1];
    case 254: return G[1];
    case 255: return G[1];
    case 256: return G[0];
    case 257: return G[0];
    case 258: return G[0];
    case 259: return G[0];
    case 260: return G[3];
    case 261: return G[2];
    case 262: return G[2];
    case 263: return G[1];
    case 264: return G[1];
    case 265: return G[1];
    case 266: return G[0];
    case 267: return G[0];
    case 268: return G[0];
    case 269: return G[0];
    case 270: return G[3] * xij + G[10];
    case 271: return G[2] * xij + G[9];
    case 272: return G[2] * xij + G[9];
    case 273: return G[1] * xij + G[8];
    case 274: return G[1] * xij + G[8];
    case 275: return G[1] * xij + G[8];
    case 276: return G[0] * xij + G[7];
    case 277: return G[0] * xij + G[7];
    case 278: return G[0] * xij + G[7];
    case 279: return G[0] * xij + G[7];
    case 280: return G[3];
    case 281: return G[2];
    case 282: return G[2];
    case 283: return G[1];
    case 284: return G[1];
    case 285: return G[1];
    case 286: return G[0];
    case 287: return G[0];
    case 288: return G[0];
    case 289: return G[0];
    case 290: return G[3];
    case 291: return G[2];
    case 292: return G[2];
    case 293: return G[1];
    case 294: return G[1];
    case 295: return G[1];
    case 296: return G[0];
    case 297: return G[0];
    case 298: return G[0];
    case 299: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpfs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[0] * yij + G[7];
    case 11: return G[1] * yij + G[8];
    case 12: return G[0] * yij + G[7];
    case 13: return G[2] * yij + G[9];
    case 14: return G[1] * yij + G[8];
    case 15: return G[0] * yij + G[7];
    case 16: return G[3] * yij + G[10];
    case 17: return G[2] * yij + G[9];
    case 18: return G[1] * yij + G[8];
    case 19: return G[0] * yij + G[7];
    case 20: return G[0];
    case 21: return G[1];
    case 22: return G[0];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[3];
    case 27: return G[2];
    case 28: return G[1];
    case 29: return G[0];
    case 30: return G[7];
    case 31: return G[8];
    case 32: return G[7];
    case 33: return G[9];
    case 34: return G[8];
    case 35: return G[7];
    case 36: return G[10];
    case 37: return G[9];
    case 38: return G[8];
    case 39: return G[7];
    case 40: return G[7] * yij + G[14];
    case 41: return G[8] * yij + G[15];
    case 42: return G[7] * yij + G[14];
    case 43: return G[9] * yij + G[16];
    case 44: return G[8] * yij + G[15];
    case 45: return G[7] * yij + G[14];
    case 46: return G[10] * yij + G[17];
    case 47: return G[9] * yij + G[16];
    case 48: return G[8] * yij + G[15];
    case 49: return G[7] * yij + G[14];
    case 50: return G[7];
    case 51: return G[8];
    case 52: return G[7];
    case 53: return G[9];
    case 54: return G[8];
    case 55: return G[7];
    case 56: return G[10];
    case 57: return G[9];
    case 58: return G[8];
    case 59: return G[7];
    case 60: return G[0];
    case 61: return G[1];
    case 62: return G[0];
    case 63: return G[2];
    case 64: return G[1];
    case 65: return G[0];
    case 66: return G[3];
    case 67: return G[2];
    case 68: return G[1];
    case 69: return G[0];
    case 70: return G[0] * yij + G[7];
    case 71: return G[1] * yij + G[8];
    case 72: return G[0] * yij + G[7];
    case 73: return G[2] * yij + G[9];
    case 74: return G[1] * yij + G[8];
    case 75: return G[0] * yij + G[7];
    case 76: return G[3] * yij + G[10];
    case 77: return G[2] * yij + G[9];
    case 78: return G[1] * yij + G[8];
    case 79: return G[0] * yij + G[7];
    case 80: return G[0];
    case 81: return G[1];
    case 82: return G[0];
    case 83: return G[2];
    case 84: return G[1];
    case 85: return G[0];
    case 86: return G[3];
    case 87: return G[2];
    case 88: return G[1];
    case 89: return G[0];
    case 90: return G[14];
    case 91: return G[15];
    case 92: return G[14];
    case 93: return G[16];
    case 94: return G[15];
    case 95: return G[14];
    case 96: return G[17];
    case 97: return G[16];
    case 98: return G[15];
    case 99: return G[14];
    case 100: return G[14] * yij + G[21];
    case 101: return G[15] * yij + G[22];
    case 102: return G[14] * yij + G[21];
    case 103: return G[16] * yij + G[23];
    case 104: return G[15] * yij + G[22];
    case 105: return G[14] * yij + G[21];
    case 106: return G[17] * yij + G[24];
    case 107: return G[16] * yij + G[23];
    case 108: return G[15] * yij + G[22];
    case 109: return G[14] * yij + G[21];
    case 110: return G[14];
    case 111: return G[15];
    case 112: return G[14];
    case 113: return G[16];
    case 114: return G[15];
    case 115: return G[14];
    case 116: return G[17];
    case 117: return G[16];
    case 118: return G[15];
    case 119: return G[14];
    case 120: return G[7];
    case 121: return G[8];
    case 122: return G[7];
    case 123: return G[9];
    case 124: return G[8];
    case 125: return G[7];
    case 126: return G[10];
    case 127: return G[9];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[7] * yij + G[14];
    case 131: return G[8] * yij + G[15];
    case 132: return G[7] * yij + G[14];
    case 133: return G[9] * yij + G[16];
    case 134: return G[8] * yij + G[15];
    case 135: return G[7] * yij + G[14];
    case 136: return G[10] * yij + G[17];
    case 137: return G[9] * yij + G[16];
    case 138: return G[8] * yij + G[15];
    case 139: return G[7] * yij + G[14];
    case 140: return G[7];
    case 141: return G[8];
    case 142: return G[7];
    case 143: return G[9];
    case 144: return G[8];
    case 145: return G[7];
    case 146: return G[10];
    case 147: return G[9];
    case 148: return G[8];
    case 149: return G[7];
    case 150: return G[0];
    case 151: return G[1];
    case 152: return G[0];
    case 153: return G[2];
    case 154: return G[1];
    case 155: return G[0];
    case 156: return G[3];
    case 157: return G[2];
    case 158: return G[1];
    case 159: return G[0];
    case 160: return G[0] * yij + G[7];
    case 161: return G[1] * yij + G[8];
    case 162: return G[0] * yij + G[7];
    case 163: return G[2] * yij + G[9];
    case 164: return G[1] * yij + G[8];
    case 165: return G[0] * yij + G[7];
    case 166: return G[3] * yij + G[10];
    case 167: return G[2] * yij + G[9];
    case 168: return G[1] * yij + G[8];
    case 169: return G[0] * yij + G[7];
    case 170: return G[0];
    case 171: return G[1];
    case 172: return G[0];
    case 173: return G[2];
    case 174: return G[1];
    case 175: return G[0];
    case 176: return G[3];
    case 177: return G[2];
    case 178: return G[1];
    case 179: return G[0];
    case 180: return G[21];
    case 181: return G[22];
    case 182: return G[21];
    case 183: return G[23];
    case 184: return G[22];
    case 185: return G[21];
    case 186: return G[24];
    case 187: return G[23];
    case 188: return G[22];
    case 189: return G[21];
    case 190: return G[21] * yij + G[28];
    case 191: return G[22] * yij + G[29];
    case 192: return G[21] * yij + G[28];
    case 193: return G[23] * yij + G[30];
    case 194: return G[22] * yij + G[29];
    case 195: return G[21] * yij + G[28];
    case 196: return G[24] * yij + G[31];
    case 197: return G[23] * yij + G[30];
    case 198: return G[22] * yij + G[29];
    case 199: return G[21] * yij + G[28];
    case 200: return G[21];
    case 201: return G[22];
    case 202: return G[21];
    case 203: return G[23];
    case 204: return G[22];
    case 205: return G[21];
    case 206: return G[24];
    case 207: return G[23];
    case 208: return G[22];
    case 209: return G[21];
    case 210: return G[14];
    case 211: return G[15];
    case 212: return G[14];
    case 213: return G[16];
    case 214: return G[15];
    case 215: return G[14];
    case 216: return G[17];
    case 217: return G[16];
    case 218: return G[15];
    case 219: return G[14];
    case 220: return G[14] * yij + G[21];
    case 221: return G[15] * yij + G[22];
    case 222: return G[14] * yij + G[21];
    case 223: return G[16] * yij + G[23];
    case 224: return G[15] * yij + G[22];
    case 225: return G[14] * yij + G[21];
    case 226: return G[17] * yij + G[24];
    case 227: return G[16] * yij + G[23];
    case 228: return G[15] * yij + G[22];
    case 229: return G[14] * yij + G[21];
    case 230: return G[14];
    case 231: return G[15];
    case 232: return G[14];
    case 233: return G[16];
    case 234: return G[15];
    case 235: return G[14];
    case 236: return G[17];
    case 237: return G[16];
    case 238: return G[15];
    case 239: return G[14];
    case 240: return G[7];
    case 241: return G[8];
    case 242: return G[7];
    case 243: return G[9];
    case 244: return G[8];
    case 245: return G[7];
    case 246: return G[10];
    case 247: return G[9];
    case 248: return G[8];
    case 249: return G[7];
    case 250: return G[7] * yij + G[14];
    case 251: return G[8] * yij + G[15];
    case 252: return G[7] * yij + G[14];
    case 253: return G[9] * yij + G[16];
    case 254: return G[8] * yij + G[15];
    case 255: return G[7] * yij + G[14];
    case 256: return G[10] * yij + G[17];
    case 257: return G[9] * yij + G[16];
    case 258: return G[8] * yij + G[15];
    case 259: return G[7] * yij + G[14];
    case 260: return G[7];
    case 261: return G[8];
    case 262: return G[7];
    case 263: return G[9];
    case 264: return G[8];
    case 265: return G[7];
    case 266: return G[10];
    case 267: return G[9];
    case 268: return G[8];
    case 269: return G[7];
    case 270: return G[0];
    case 271: return G[1];
    case 272: return G[0];
    case 273: return G[2];
    case 274: return G[1];
    case 275: return G[0];
    case 276: return G[3];
    case 277: return G[2];
    case 278: return G[1];
    case 279: return G[0];
    case 280: return G[0] * yij + G[7];
    case 281: return G[1] * yij + G[8];
    case 282: return G[0] * yij + G[7];
    case 283: return G[2] * yij + G[9];
    case 284: return G[1] * yij + G[8];
    case 285: return G[0] * yij + G[7];
    case 286: return G[3] * yij + G[10];
    case 287: return G[2] * yij + G[9];
    case 288: return G[1] * yij + G[8];
    case 289: return G[0] * yij + G[7];
    case 290: return G[0];
    case 291: return G[1];
    case 292: return G[0];
    case 293: return G[2];
    case 294: return G[1];
    case 295: return G[0];
    case 296: return G[3];
    case 297: return G[2];
    case 298: return G[1];
    case 299: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpfs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[1];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[2];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[2];
    case 19: return G[3];
    case 20: return G[0] * zij + G[7];
    case 21: return G[0] * zij + G[7];
    case 22: return G[1] * zij + G[8];
    case 23: return G[0] * zij + G[7];
    case 24: return G[1] * zij + G[8];
    case 25: return G[2] * zij + G[9];
    case 26: return G[0] * zij + G[7];
    case 27: return G[1] * zij + G[8];
    case 28: return G[2] * zij + G[9];
    case 29: return G[3] * zij + G[10];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[1];
    case 35: return G[2];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[2];
    case 39: return G[3];
    case 40: return G[0];
    case 41: return G[0];
    case 42: return G[1];
    case 43: return G[0];
    case 44: return G[1];
    case 45: return G[2];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[2];
    case 49: return G[3];
    case 50: return G[0] * zij + G[7];
    case 51: return G[0] * zij + G[7];
    case 52: return G[1] * zij + G[8];
    case 53: return G[0] * zij + G[7];
    case 54: return G[1] * zij + G[8];
    case 55: return G[2] * zij + G[9];
    case 56: return G[0] * zij + G[7];
    case 57: return G[1] * zij + G[8];
    case 58: return G[2] * zij + G[9];
    case 59: return G[3] * zij + G[10];
    case 60: return G[7];
    case 61: return G[7];
    case 62: return G[8];
    case 63: return G[7];
    case 64: return G[8];
    case 65: return G[9];
    case 66: return G[7];
    case 67: return G[8];
    case 68: return G[9];
    case 69: return G[10];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[8];
    case 73: return G[7];
    case 74: return G[8];
    case 75: return G[9];
    case 76: return G[7];
    case 77: return G[8];
    case 78: return G[9];
    case 79: return G[10];
    case 80: return G[7] * zij + G[14];
    case 81: return G[7] * zij + G[14];
    case 82: return G[8] * zij + G[15];
    case 83: return G[7] * zij + G[14];
    case 84: return G[8] * zij + G[15];
    case 85: return G[9] * zij + G[16];
    case 86: return G[7] * zij + G[14];
    case 87: return G[8] * zij + G[15];
    case 88: return G[9] * zij + G[16];
    case 89: return G[10] * zij + G[17];
    case 90: return G[0];
    case 91: return G[0];
    case 92: return G[1];
    case 93: return G[0];
    case 94: return G[1];
    case 95: return G[2];
    case 96: return G[0];
    case 97: return G[1];
    case 98: return G[2];
    case 99: return G[3];
    case 100: return G[0];
    case 101: return G[0];
    case 102: return G[1];
    case 103: return G[0];
    case 104: return G[1];
    case 105: return G[2];
    case 106: return G[0];
    case 107: return G[1];
    case 108: return G[2];
    case 109: return G[3];
    case 110: return G[0] * zij + G[7];
    case 111: return G[0] * zij + G[7];
    case 112: return G[1] * zij + G[8];
    case 113: return G[0] * zij + G[7];
    case 114: return G[1] * zij + G[8];
    case 115: return G[2] * zij + G[9];
    case 116: return G[0] * zij + G[7];
    case 117: return G[1] * zij + G[8];
    case 118: return G[2] * zij + G[9];
    case 119: return G[3] * zij + G[10];
    case 120: return G[7];
    case 121: return G[7];
    case 122: return G[8];
    case 123: return G[7];
    case 124: return G[8];
    case 125: return G[9];
    case 126: return G[7];
    case 127: return G[8];
    case 128: return G[9];
    case 129: return G[10];
    case 130: return G[7];
    case 131: return G[7];
    case 132: return G[8];
    case 133: return G[7];
    case 134: return G[8];
    case 135: return G[9];
    case 136: return G[7];
    case 137: return G[8];
    case 138: return G[9];
    case 139: return G[10];
    case 140: return G[7] * zij + G[14];
    case 141: return G[7] * zij + G[14];
    case 142: return G[8] * zij + G[15];
    case 143: return G[7] * zij + G[14];
    case 144: return G[8] * zij + G[15];
    case 145: return G[9] * zij + G[16];
    case 146: return G[7] * zij + G[14];
    case 147: return G[8] * zij + G[15];
    case 148: return G[9] * zij + G[16];
    case 149: return G[10] * zij + G[17];
    case 150: return G[14];
    case 151: return G[14];
    case 152: return G[15];
    case 153: return G[14];
    case 154: return G[15];
    case 155: return G[16];
    case 156: return G[14];
    case 157: return G[15];
    case 158: return G[16];
    case 159: return G[17];
    case 160: return G[14];
    case 161: return G[14];
    case 162: return G[15];
    case 163: return G[14];
    case 164: return G[15];
    case 165: return G[16];
    case 166: return G[14];
    case 167: return G[15];
    case 168: return G[16];
    case 169: return G[17];
    case 170: return G[14] * zij + G[21];
    case 171: return G[14] * zij + G[21];
    case 172: return G[15] * zij + G[22];
    case 173: return G[14] * zij + G[21];
    case 174: return G[15] * zij + G[22];
    case 175: return G[16] * zij + G[23];
    case 176: return G[14] * zij + G[21];
    case 177: return G[15] * zij + G[22];
    case 178: return G[16] * zij + G[23];
    case 179: return G[17] * zij + G[24];
    case 180: return G[0];
    case 181: return G[0];
    case 182: return G[1];
    case 183: return G[0];
    case 184: return G[1];
    case 185: return G[2];
    case 186: return G[0];
    case 187: return G[1];
    case 188: return G[2];
    case 189: return G[3];
    case 190: return G[0];
    case 191: return G[0];
    case 192: return G[1];
    case 193: return G[0];
    case 194: return G[1];
    case 195: return G[2];
    case 196: return G[0];
    case 197: return G[1];
    case 198: return G[2];
    case 199: return G[3];
    case 200: return G[0] * zij + G[7];
    case 201: return G[0] * zij + G[7];
    case 202: return G[1] * zij + G[8];
    case 203: return G[0] * zij + G[7];
    case 204: return G[1] * zij + G[8];
    case 205: return G[2] * zij + G[9];
    case 206: return G[0] * zij + G[7];
    case 207: return G[1] * zij + G[8];
    case 208: return G[2] * zij + G[9];
    case 209: return G[3] * zij + G[10];
    case 210: return G[7];
    case 211: return G[7];
    case 212: return G[8];
    case 213: return G[7];
    case 214: return G[8];
    case 215: return G[9];
    case 216: return G[7];
    case 217: return G[8];
    case 218: return G[9];
    case 219: return G[10];
    case 220: return G[7];
    case 221: return G[7];
    case 222: return G[8];
    case 223: return G[7];
    case 224: return G[8];
    case 225: return G[9];
    case 226: return G[7];
    case 227: return G[8];
    case 228: return G[9];
    case 229: return G[10];
    case 230: return G[7] * zij + G[14];
    case 231: return G[7] * zij + G[14];
    case 232: return G[8] * zij + G[15];
    case 233: return G[7] * zij + G[14];
    case 234: return G[8] * zij + G[15];
    case 235: return G[9] * zij + G[16];
    case 236: return G[7] * zij + G[14];
    case 237: return G[8] * zij + G[15];
    case 238: return G[9] * zij + G[16];
    case 239: return G[10] * zij + G[17];
    case 240: return G[14];
    case 241: return G[14];
    case 242: return G[15];
    case 243: return G[14];
    case 244: return G[15];
    case 245: return G[16];
    case 246: return G[14];
    case 247: return G[15];
    case 248: return G[16];
    case 249: return G[17];
    case 250: return G[14];
    case 251: return G[14];
    case 252: return G[15];
    case 253: return G[14];
    case 254: return G[15];
    case 255: return G[16];
    case 256: return G[14];
    case 257: return G[15];
    case 258: return G[16];
    case 259: return G[17];
    case 260: return G[14] * zij + G[21];
    case 261: return G[14] * zij + G[21];
    case 262: return G[15] * zij + G[22];
    case 263: return G[14] * zij + G[21];
    case 264: return G[15] * zij + G[22];
    case 265: return G[16] * zij + G[23];
    case 266: return G[14] * zij + G[21];
    case 267: return G[15] * zij + G[22];
    case 268: return G[16] * zij + G[23];
    case 269: return G[17] * zij + G[24];
    case 270: return G[21];
    case 271: return G[21];
    case 272: return G[22];
    case 273: return G[21];
    case 274: return G[22];
    case 275: return G[23];
    case 276: return G[21];
    case 277: return G[22];
    case 278: return G[23];
    case 279: return G[24];
    case 280: return G[21];
    case 281: return G[21];
    case 282: return G[22];
    case 283: return G[21];
    case 284: return G[22];
    case 285: return G[23];
    case 286: return G[21];
    case 287: return G[22];
    case 288: return G[23];
    case 289: return G[24];
    case 290: return G[21] * zij + G[28];
    case 291: return G[21] * zij + G[28];
    case 292: return G[22] * zij + G[29];
    case 293: return G[21] * zij + G[28];
    case 294: return G[22] * zij + G[29];
    case 295: return G[23] * zij + G[30];
    case 296: return G[21] * zij + G[28];
    case 297: return G[22] * zij + G[29];
    case 298: return G[23] * zij + G[30];
    case 299: return G[24] * zij + G[31];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fpfs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 300;
  constexpr int kNMax = 4;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fpfs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fpfs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fpfs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ddfs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 1: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 2: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 3: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 4: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 5: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 6: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 7: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 8: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 9: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 10: return G[17] * xij + G[24];
    case 11: return G[16] * xij + G[23];
    case 12: return G[16] * xij + G[23];
    case 13: return G[15] * xij + G[22];
    case 14: return G[15] * xij + G[22];
    case 15: return G[15] * xij + G[22];
    case 16: return G[14] * xij + G[21];
    case 17: return G[14] * xij + G[21];
    case 18: return G[14] * xij + G[21];
    case 19: return G[14] * xij + G[21];
    case 20: return G[17] * xij + G[24];
    case 21: return G[16] * xij + G[23];
    case 22: return G[16] * xij + G[23];
    case 23: return G[15] * xij + G[22];
    case 24: return G[15] * xij + G[22];
    case 25: return G[15] * xij + G[22];
    case 26: return G[14] * xij + G[21];
    case 27: return G[14] * xij + G[21];
    case 28: return G[14] * xij + G[21];
    case 29: return G[14] * xij + G[21];
    case 30: return G[17];
    case 31: return G[16];
    case 32: return G[16];
    case 33: return G[15];
    case 34: return G[15];
    case 35: return G[15];
    case 36: return G[14];
    case 37: return G[14];
    case 38: return G[14];
    case 39: return G[14];
    case 40: return G[17];
    case 41: return G[16];
    case 42: return G[16];
    case 43: return G[15];
    case 44: return G[15];
    case 45: return G[15];
    case 46: return G[14];
    case 47: return G[14];
    case 48: return G[14];
    case 49: return G[14];
    case 50: return G[17];
    case 51: return G[16];
    case 52: return G[16];
    case 53: return G[15];
    case 54: return G[15];
    case 55: return G[15];
    case 56: return G[14];
    case 57: return G[14];
    case 58: return G[14];
    case 59: return G[14];
    case 60: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 61: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 62: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 63: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 64: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 65: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 66: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 67: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 68: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 69: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 70: return G[10] * xij + G[17];
    case 71: return G[9] * xij + G[16];
    case 72: return G[9] * xij + G[16];
    case 73: return G[8] * xij + G[15];
    case 74: return G[8] * xij + G[15];
    case 75: return G[8] * xij + G[15];
    case 76: return G[7] * xij + G[14];
    case 77: return G[7] * xij + G[14];
    case 78: return G[7] * xij + G[14];
    case 79: return G[7] * xij + G[14];
    case 80: return G[10] * xij + G[17];
    case 81: return G[9] * xij + G[16];
    case 82: return G[9] * xij + G[16];
    case 83: return G[8] * xij + G[15];
    case 84: return G[8] * xij + G[15];
    case 85: return G[8] * xij + G[15];
    case 86: return G[7] * xij + G[14];
    case 87: return G[7] * xij + G[14];
    case 88: return G[7] * xij + G[14];
    case 89: return G[7] * xij + G[14];
    case 90: return G[10];
    case 91: return G[9];
    case 92: return G[9];
    case 93: return G[8];
    case 94: return G[8];
    case 95: return G[8];
    case 96: return G[7];
    case 97: return G[7];
    case 98: return G[7];
    case 99: return G[7];
    case 100: return G[10];
    case 101: return G[9];
    case 102: return G[9];
    case 103: return G[8];
    case 104: return G[8];
    case 105: return G[8];
    case 106: return G[7];
    case 107: return G[7];
    case 108: return G[7];
    case 109: return G[7];
    case 110: return G[10];
    case 111: return G[9];
    case 112: return G[9];
    case 113: return G[8];
    case 114: return G[8];
    case 115: return G[8];
    case 116: return G[7];
    case 117: return G[7];
    case 118: return G[7];
    case 119: return G[7];
    case 120: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 121: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 122: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 123: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 124: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 125: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 126: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 127: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 128: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 129: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 130: return G[10] * xij + G[17];
    case 131: return G[9] * xij + G[16];
    case 132: return G[9] * xij + G[16];
    case 133: return G[8] * xij + G[15];
    case 134: return G[8] * xij + G[15];
    case 135: return G[8] * xij + G[15];
    case 136: return G[7] * xij + G[14];
    case 137: return G[7] * xij + G[14];
    case 138: return G[7] * xij + G[14];
    case 139: return G[7] * xij + G[14];
    case 140: return G[10] * xij + G[17];
    case 141: return G[9] * xij + G[16];
    case 142: return G[9] * xij + G[16];
    case 143: return G[8] * xij + G[15];
    case 144: return G[8] * xij + G[15];
    case 145: return G[8] * xij + G[15];
    case 146: return G[7] * xij + G[14];
    case 147: return G[7] * xij + G[14];
    case 148: return G[7] * xij + G[14];
    case 149: return G[7] * xij + G[14];
    case 150: return G[10];
    case 151: return G[9];
    case 152: return G[9];
    case 153: return G[8];
    case 154: return G[8];
    case 155: return G[8];
    case 156: return G[7];
    case 157: return G[7];
    case 158: return G[7];
    case 159: return G[7];
    case 160: return G[10];
    case 161: return G[9];
    case 162: return G[9];
    case 163: return G[8];
    case 164: return G[8];
    case 165: return G[8];
    case 166: return G[7];
    case 167: return G[7];
    case 168: return G[7];
    case 169: return G[7];
    case 170: return G[10];
    case 171: return G[9];
    case 172: return G[9];
    case 173: return G[8];
    case 174: return G[8];
    case 175: return G[8];
    case 176: return G[7];
    case 177: return G[7];
    case 178: return G[7];
    case 179: return G[7];
    case 180: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 181: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 182: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 183: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 184: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 185: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 186: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 187: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 188: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 189: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 190: return G[3] * xij + G[10];
    case 191: return G[2] * xij + G[9];
    case 192: return G[2] * xij + G[9];
    case 193: return G[1] * xij + G[8];
    case 194: return G[1] * xij + G[8];
    case 195: return G[1] * xij + G[8];
    case 196: return G[0] * xij + G[7];
    case 197: return G[0] * xij + G[7];
    case 198: return G[0] * xij + G[7];
    case 199: return G[0] * xij + G[7];
    case 200: return G[3] * xij + G[10];
    case 201: return G[2] * xij + G[9];
    case 202: return G[2] * xij + G[9];
    case 203: return G[1] * xij + G[8];
    case 204: return G[1] * xij + G[8];
    case 205: return G[1] * xij + G[8];
    case 206: return G[0] * xij + G[7];
    case 207: return G[0] * xij + G[7];
    case 208: return G[0] * xij + G[7];
    case 209: return G[0] * xij + G[7];
    case 210: return G[3];
    case 211: return G[2];
    case 212: return G[2];
    case 213: return G[1];
    case 214: return G[1];
    case 215: return G[1];
    case 216: return G[0];
    case 217: return G[0];
    case 218: return G[0];
    case 219: return G[0];
    case 220: return G[3];
    case 221: return G[2];
    case 222: return G[2];
    case 223: return G[1];
    case 224: return G[1];
    case 225: return G[1];
    case 226: return G[0];
    case 227: return G[0];
    case 228: return G[0];
    case 229: return G[0];
    case 230: return G[3];
    case 231: return G[2];
    case 232: return G[2];
    case 233: return G[1];
    case 234: return G[1];
    case 235: return G[1];
    case 236: return G[0];
    case 237: return G[0];
    case 238: return G[0];
    case 239: return G[0];
    case 240: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 241: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 242: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 243: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 244: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 245: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 246: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 247: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 248: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 249: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 250: return G[3] * xij + G[10];
    case 251: return G[2] * xij + G[9];
    case 252: return G[2] * xij + G[9];
    case 253: return G[1] * xij + G[8];
    case 254: return G[1] * xij + G[8];
    case 255: return G[1] * xij + G[8];
    case 256: return G[0] * xij + G[7];
    case 257: return G[0] * xij + G[7];
    case 258: return G[0] * xij + G[7];
    case 259: return G[0] * xij + G[7];
    case 260: return G[3] * xij + G[10];
    case 261: return G[2] * xij + G[9];
    case 262: return G[2] * xij + G[9];
    case 263: return G[1] * xij + G[8];
    case 264: return G[1] * xij + G[8];
    case 265: return G[1] * xij + G[8];
    case 266: return G[0] * xij + G[7];
    case 267: return G[0] * xij + G[7];
    case 268: return G[0] * xij + G[7];
    case 269: return G[0] * xij + G[7];
    case 270: return G[3];
    case 271: return G[2];
    case 272: return G[2];
    case 273: return G[1];
    case 274: return G[1];
    case 275: return G[1];
    case 276: return G[0];
    case 277: return G[0];
    case 278: return G[0];
    case 279: return G[0];
    case 280: return G[3];
    case 281: return G[2];
    case 282: return G[2];
    case 283: return G[1];
    case 284: return G[1];
    case 285: return G[1];
    case 286: return G[0];
    case 287: return G[0];
    case 288: return G[0];
    case 289: return G[0];
    case 290: return G[3];
    case 291: return G[2];
    case 292: return G[2];
    case 293: return G[1];
    case 294: return G[1];
    case 295: return G[1];
    case 296: return G[0];
    case 297: return G[0];
    case 298: return G[0];
    case 299: return G[0];
    case 300: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 301: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 302: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 303: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 304: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 305: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 306: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 307: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 308: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 309: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 310: return G[3] * xij + G[10];
    case 311: return G[2] * xij + G[9];
    case 312: return G[2] * xij + G[9];
    case 313: return G[1] * xij + G[8];
    case 314: return G[1] * xij + G[8];
    case 315: return G[1] * xij + G[8];
    case 316: return G[0] * xij + G[7];
    case 317: return G[0] * xij + G[7];
    case 318: return G[0] * xij + G[7];
    case 319: return G[0] * xij + G[7];
    case 320: return G[3] * xij + G[10];
    case 321: return G[2] * xij + G[9];
    case 322: return G[2] * xij + G[9];
    case 323: return G[1] * xij + G[8];
    case 324: return G[1] * xij + G[8];
    case 325: return G[1] * xij + G[8];
    case 326: return G[0] * xij + G[7];
    case 327: return G[0] * xij + G[7];
    case 328: return G[0] * xij + G[7];
    case 329: return G[0] * xij + G[7];
    case 330: return G[3];
    case 331: return G[2];
    case 332: return G[2];
    case 333: return G[1];
    case 334: return G[1];
    case 335: return G[1];
    case 336: return G[0];
    case 337: return G[0];
    case 338: return G[0];
    case 339: return G[0];
    case 340: return G[3];
    case 341: return G[2];
    case 342: return G[2];
    case 343: return G[1];
    case 344: return G[1];
    case 345: return G[1];
    case 346: return G[0];
    case 347: return G[0];
    case 348: return G[0];
    case 349: return G[0];
    case 350: return G[3];
    case 351: return G[2];
    case 352: return G[2];
    case 353: return G[1];
    case 354: return G[1];
    case 355: return G[1];
    case 356: return G[0];
    case 357: return G[0];
    case 358: return G[0];
    case 359: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ddfs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[0] * yij + G[7];
    case 11: return G[1] * yij + G[8];
    case 12: return G[0] * yij + G[7];
    case 13: return G[2] * yij + G[9];
    case 14: return G[1] * yij + G[8];
    case 15: return G[0] * yij + G[7];
    case 16: return G[3] * yij + G[10];
    case 17: return G[2] * yij + G[9];
    case 18: return G[1] * yij + G[8];
    case 19: return G[0] * yij + G[7];
    case 20: return G[0];
    case 21: return G[1];
    case 22: return G[0];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[3];
    case 27: return G[2];
    case 28: return G[1];
    case 29: return G[0];
    case 30: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 31: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 32: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 33: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 34: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 35: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 36: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 37: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 38: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 39: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 40: return G[0] * yij + G[7];
    case 41: return G[1] * yij + G[8];
    case 42: return G[0] * yij + G[7];
    case 43: return G[2] * yij + G[9];
    case 44: return G[1] * yij + G[8];
    case 45: return G[0] * yij + G[7];
    case 46: return G[3] * yij + G[10];
    case 47: return G[2] * yij + G[9];
    case 48: return G[1] * yij + G[8];
    case 49: return G[0] * yij + G[7];
    case 50: return G[0];
    case 51: return G[1];
    case 52: return G[0];
    case 53: return G[2];
    case 54: return G[1];
    case 55: return G[0];
    case 56: return G[3];
    case 57: return G[2];
    case 58: return G[1];
    case 59: return G[0];
    case 60: return G[7];
    case 61: return G[8];
    case 62: return G[7];
    case 63: return G[9];
    case 64: return G[8];
    case 65: return G[7];
    case 66: return G[10];
    case 67: return G[9];
    case 68: return G[8];
    case 69: return G[7];
    case 70: return G[7] * yij + G[14];
    case 71: return G[8] * yij + G[15];
    case 72: return G[7] * yij + G[14];
    case 73: return G[9] * yij + G[16];
    case 74: return G[8] * yij + G[15];
    case 75: return G[7] * yij + G[14];
    case 76: return G[10] * yij + G[17];
    case 77: return G[9] * yij + G[16];
    case 78: return G[8] * yij + G[15];
    case 79: return G[7] * yij + G[14];
    case 80: return G[7];
    case 81: return G[8];
    case 82: return G[7];
    case 83: return G[9];
    case 84: return G[8];
    case 85: return G[7];
    case 86: return G[10];
    case 87: return G[9];
    case 88: return G[8];
    case 89: return G[7];
    case 90: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 91: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 92: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 93: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 94: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 95: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 96: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 97: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 98: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 99: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 100: return G[7] * yij + G[14];
    case 101: return G[8] * yij + G[15];
    case 102: return G[7] * yij + G[14];
    case 103: return G[9] * yij + G[16];
    case 104: return G[8] * yij + G[15];
    case 105: return G[7] * yij + G[14];
    case 106: return G[10] * yij + G[17];
    case 107: return G[9] * yij + G[16];
    case 108: return G[8] * yij + G[15];
    case 109: return G[7] * yij + G[14];
    case 110: return G[7];
    case 111: return G[8];
    case 112: return G[7];
    case 113: return G[9];
    case 114: return G[8];
    case 115: return G[7];
    case 116: return G[10];
    case 117: return G[9];
    case 118: return G[8];
    case 119: return G[7];
    case 120: return G[0];
    case 121: return G[1];
    case 122: return G[0];
    case 123: return G[2];
    case 124: return G[1];
    case 125: return G[0];
    case 126: return G[3];
    case 127: return G[2];
    case 128: return G[1];
    case 129: return G[0];
    case 130: return G[0] * yij + G[7];
    case 131: return G[1] * yij + G[8];
    case 132: return G[0] * yij + G[7];
    case 133: return G[2] * yij + G[9];
    case 134: return G[1] * yij + G[8];
    case 135: return G[0] * yij + G[7];
    case 136: return G[3] * yij + G[10];
    case 137: return G[2] * yij + G[9];
    case 138: return G[1] * yij + G[8];
    case 139: return G[0] * yij + G[7];
    case 140: return G[0];
    case 141: return G[1];
    case 142: return G[0];
    case 143: return G[2];
    case 144: return G[1];
    case 145: return G[0];
    case 146: return G[3];
    case 147: return G[2];
    case 148: return G[1];
    case 149: return G[0];
    case 150: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 151: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 152: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 153: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 154: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 155: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 156: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 157: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 158: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 159: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 160: return G[0] * yij + G[7];
    case 161: return G[1] * yij + G[8];
    case 162: return G[0] * yij + G[7];
    case 163: return G[2] * yij + G[9];
    case 164: return G[1] * yij + G[8];
    case 165: return G[0] * yij + G[7];
    case 166: return G[3] * yij + G[10];
    case 167: return G[2] * yij + G[9];
    case 168: return G[1] * yij + G[8];
    case 169: return G[0] * yij + G[7];
    case 170: return G[0];
    case 171: return G[1];
    case 172: return G[0];
    case 173: return G[2];
    case 174: return G[1];
    case 175: return G[0];
    case 176: return G[3];
    case 177: return G[2];
    case 178: return G[1];
    case 179: return G[0];
    case 180: return G[14];
    case 181: return G[15];
    case 182: return G[14];
    case 183: return G[16];
    case 184: return G[15];
    case 185: return G[14];
    case 186: return G[17];
    case 187: return G[16];
    case 188: return G[15];
    case 189: return G[14];
    case 190: return G[14] * yij + G[21];
    case 191: return G[15] * yij + G[22];
    case 192: return G[14] * yij + G[21];
    case 193: return G[16] * yij + G[23];
    case 194: return G[15] * yij + G[22];
    case 195: return G[14] * yij + G[21];
    case 196: return G[17] * yij + G[24];
    case 197: return G[16] * yij + G[23];
    case 198: return G[15] * yij + G[22];
    case 199: return G[14] * yij + G[21];
    case 200: return G[14];
    case 201: return G[15];
    case 202: return G[14];
    case 203: return G[16];
    case 204: return G[15];
    case 205: return G[14];
    case 206: return G[17];
    case 207: return G[16];
    case 208: return G[15];
    case 209: return G[14];
    case 210: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 211: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 212: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 213: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 214: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 215: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 216: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 217: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 218: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 219: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 220: return G[14] * yij + G[21];
    case 221: return G[15] * yij + G[22];
    case 222: return G[14] * yij + G[21];
    case 223: return G[16] * yij + G[23];
    case 224: return G[15] * yij + G[22];
    case 225: return G[14] * yij + G[21];
    case 226: return G[17] * yij + G[24];
    case 227: return G[16] * yij + G[23];
    case 228: return G[15] * yij + G[22];
    case 229: return G[14] * yij + G[21];
    case 230: return G[14];
    case 231: return G[15];
    case 232: return G[14];
    case 233: return G[16];
    case 234: return G[15];
    case 235: return G[14];
    case 236: return G[17];
    case 237: return G[16];
    case 238: return G[15];
    case 239: return G[14];
    case 240: return G[7];
    case 241: return G[8];
    case 242: return G[7];
    case 243: return G[9];
    case 244: return G[8];
    case 245: return G[7];
    case 246: return G[10];
    case 247: return G[9];
    case 248: return G[8];
    case 249: return G[7];
    case 250: return G[7] * yij + G[14];
    case 251: return G[8] * yij + G[15];
    case 252: return G[7] * yij + G[14];
    case 253: return G[9] * yij + G[16];
    case 254: return G[8] * yij + G[15];
    case 255: return G[7] * yij + G[14];
    case 256: return G[10] * yij + G[17];
    case 257: return G[9] * yij + G[16];
    case 258: return G[8] * yij + G[15];
    case 259: return G[7] * yij + G[14];
    case 260: return G[7];
    case 261: return G[8];
    case 262: return G[7];
    case 263: return G[9];
    case 264: return G[8];
    case 265: return G[7];
    case 266: return G[10];
    case 267: return G[9];
    case 268: return G[8];
    case 269: return G[7];
    case 270: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 271: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 272: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 273: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 274: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 275: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 276: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 277: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 278: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 279: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 280: return G[7] * yij + G[14];
    case 281: return G[8] * yij + G[15];
    case 282: return G[7] * yij + G[14];
    case 283: return G[9] * yij + G[16];
    case 284: return G[8] * yij + G[15];
    case 285: return G[7] * yij + G[14];
    case 286: return G[10] * yij + G[17];
    case 287: return G[9] * yij + G[16];
    case 288: return G[8] * yij + G[15];
    case 289: return G[7] * yij + G[14];
    case 290: return G[7];
    case 291: return G[8];
    case 292: return G[7];
    case 293: return G[9];
    case 294: return G[8];
    case 295: return G[7];
    case 296: return G[10];
    case 297: return G[9];
    case 298: return G[8];
    case 299: return G[7];
    case 300: return G[0];
    case 301: return G[1];
    case 302: return G[0];
    case 303: return G[2];
    case 304: return G[1];
    case 305: return G[0];
    case 306: return G[3];
    case 307: return G[2];
    case 308: return G[1];
    case 309: return G[0];
    case 310: return G[0] * yij + G[7];
    case 311: return G[1] * yij + G[8];
    case 312: return G[0] * yij + G[7];
    case 313: return G[2] * yij + G[9];
    case 314: return G[1] * yij + G[8];
    case 315: return G[0] * yij + G[7];
    case 316: return G[3] * yij + G[10];
    case 317: return G[2] * yij + G[9];
    case 318: return G[1] * yij + G[8];
    case 319: return G[0] * yij + G[7];
    case 320: return G[0];
    case 321: return G[1];
    case 322: return G[0];
    case 323: return G[2];
    case 324: return G[1];
    case 325: return G[0];
    case 326: return G[3];
    case 327: return G[2];
    case 328: return G[1];
    case 329: return G[0];
    case 330: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 331: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 332: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 333: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 334: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 335: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 336: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 337: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 338: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 339: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 340: return G[0] * yij + G[7];
    case 341: return G[1] * yij + G[8];
    case 342: return G[0] * yij + G[7];
    case 343: return G[2] * yij + G[9];
    case 344: return G[1] * yij + G[8];
    case 345: return G[0] * yij + G[7];
    case 346: return G[3] * yij + G[10];
    case 347: return G[2] * yij + G[9];
    case 348: return G[1] * yij + G[8];
    case 349: return G[0] * yij + G[7];
    case 350: return G[0];
    case 351: return G[1];
    case 352: return G[0];
    case 353: return G[2];
    case 354: return G[1];
    case 355: return G[0];
    case 356: return G[3];
    case 357: return G[2];
    case 358: return G[1];
    case 359: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ddfs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[1];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[2];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[2];
    case 19: return G[3];
    case 20: return G[0] * zij + G[7];
    case 21: return G[0] * zij + G[7];
    case 22: return G[1] * zij + G[8];
    case 23: return G[0] * zij + G[7];
    case 24: return G[1] * zij + G[8];
    case 25: return G[2] * zij + G[9];
    case 26: return G[0] * zij + G[7];
    case 27: return G[1] * zij + G[8];
    case 28: return G[2] * zij + G[9];
    case 29: return G[3] * zij + G[10];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[1];
    case 35: return G[2];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[2];
    case 39: return G[3];
    case 40: return G[0] * zij + G[7];
    case 41: return G[0] * zij + G[7];
    case 42: return G[1] * zij + G[8];
    case 43: return G[0] * zij + G[7];
    case 44: return G[1] * zij + G[8];
    case 45: return G[2] * zij + G[9];
    case 46: return G[0] * zij + G[7];
    case 47: return G[1] * zij + G[8];
    case 48: return G[2] * zij + G[9];
    case 49: return G[3] * zij + G[10];
    case 50: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 51: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 52: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 53: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 54: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 55: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 56: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 57: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 58: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 59: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[1];
    case 63: return G[0];
    case 64: return G[1];
    case 65: return G[2];
    case 66: return G[0];
    case 67: return G[1];
    case 68: return G[2];
    case 69: return G[3];
    case 70: return G[0];
    case 71: return G[0];
    case 72: return G[1];
    case 73: return G[0];
    case 74: return G[1];
    case 75: return G[2];
    case 76: return G[0];
    case 77: return G[1];
    case 78: return G[2];
    case 79: return G[3];
    case 80: return G[0] * zij + G[7];
    case 81: return G[0] * zij + G[7];
    case 82: return G[1] * zij + G[8];
    case 83: return G[0] * zij + G[7];
    case 84: return G[1] * zij + G[8];
    case 85: return G[2] * zij + G[9];
    case 86: return G[0] * zij + G[7];
    case 87: return G[1] * zij + G[8];
    case 88: return G[2] * zij + G[9];
    case 89: return G[3] * zij + G[10];
    case 90: return G[0];
    case 91: return G[0];
    case 92: return G[1];
    case 93: return G[0];
    case 94: return G[1];
    case 95: return G[2];
    case 96: return G[0];
    case 97: return G[1];
    case 98: return G[2];
    case 99: return G[3];
    case 100: return G[0] * zij + G[7];
    case 101: return G[0] * zij + G[7];
    case 102: return G[1] * zij + G[8];
    case 103: return G[0] * zij + G[7];
    case 104: return G[1] * zij + G[8];
    case 105: return G[2] * zij + G[9];
    case 106: return G[0] * zij + G[7];
    case 107: return G[1] * zij + G[8];
    case 108: return G[2] * zij + G[9];
    case 109: return G[3] * zij + G[10];
    case 110: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 111: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 112: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 113: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 114: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 115: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 116: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 117: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 118: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 119: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 120: return G[7];
    case 121: return G[7];
    case 122: return G[8];
    case 123: return G[7];
    case 124: return G[8];
    case 125: return G[9];
    case 126: return G[7];
    case 127: return G[8];
    case 128: return G[9];
    case 129: return G[10];
    case 130: return G[7];
    case 131: return G[7];
    case 132: return G[8];
    case 133: return G[7];
    case 134: return G[8];
    case 135: return G[9];
    case 136: return G[7];
    case 137: return G[8];
    case 138: return G[9];
    case 139: return G[10];
    case 140: return G[7] * zij + G[14];
    case 141: return G[7] * zij + G[14];
    case 142: return G[8] * zij + G[15];
    case 143: return G[7] * zij + G[14];
    case 144: return G[8] * zij + G[15];
    case 145: return G[9] * zij + G[16];
    case 146: return G[7] * zij + G[14];
    case 147: return G[8] * zij + G[15];
    case 148: return G[9] * zij + G[16];
    case 149: return G[10] * zij + G[17];
    case 150: return G[7];
    case 151: return G[7];
    case 152: return G[8];
    case 153: return G[7];
    case 154: return G[8];
    case 155: return G[9];
    case 156: return G[7];
    case 157: return G[8];
    case 158: return G[9];
    case 159: return G[10];
    case 160: return G[7] * zij + G[14];
    case 161: return G[7] * zij + G[14];
    case 162: return G[8] * zij + G[15];
    case 163: return G[7] * zij + G[14];
    case 164: return G[8] * zij + G[15];
    case 165: return G[9] * zij + G[16];
    case 166: return G[7] * zij + G[14];
    case 167: return G[8] * zij + G[15];
    case 168: return G[9] * zij + G[16];
    case 169: return G[10] * zij + G[17];
    case 170: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 171: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 172: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 173: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 174: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 175: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 176: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 177: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 178: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 179: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 180: return G[0];
    case 181: return G[0];
    case 182: return G[1];
    case 183: return G[0];
    case 184: return G[1];
    case 185: return G[2];
    case 186: return G[0];
    case 187: return G[1];
    case 188: return G[2];
    case 189: return G[3];
    case 190: return G[0];
    case 191: return G[0];
    case 192: return G[1];
    case 193: return G[0];
    case 194: return G[1];
    case 195: return G[2];
    case 196: return G[0];
    case 197: return G[1];
    case 198: return G[2];
    case 199: return G[3];
    case 200: return G[0] * zij + G[7];
    case 201: return G[0] * zij + G[7];
    case 202: return G[1] * zij + G[8];
    case 203: return G[0] * zij + G[7];
    case 204: return G[1] * zij + G[8];
    case 205: return G[2] * zij + G[9];
    case 206: return G[0] * zij + G[7];
    case 207: return G[1] * zij + G[8];
    case 208: return G[2] * zij + G[9];
    case 209: return G[3] * zij + G[10];
    case 210: return G[0];
    case 211: return G[0];
    case 212: return G[1];
    case 213: return G[0];
    case 214: return G[1];
    case 215: return G[2];
    case 216: return G[0];
    case 217: return G[1];
    case 218: return G[2];
    case 219: return G[3];
    case 220: return G[0] * zij + G[7];
    case 221: return G[0] * zij + G[7];
    case 222: return G[1] * zij + G[8];
    case 223: return G[0] * zij + G[7];
    case 224: return G[1] * zij + G[8];
    case 225: return G[2] * zij + G[9];
    case 226: return G[0] * zij + G[7];
    case 227: return G[1] * zij + G[8];
    case 228: return G[2] * zij + G[9];
    case 229: return G[3] * zij + G[10];
    case 230: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 231: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 232: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 233: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 234: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 235: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 236: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 237: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 238: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 239: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 240: return G[7];
    case 241: return G[7];
    case 242: return G[8];
    case 243: return G[7];
    case 244: return G[8];
    case 245: return G[9];
    case 246: return G[7];
    case 247: return G[8];
    case 248: return G[9];
    case 249: return G[10];
    case 250: return G[7];
    case 251: return G[7];
    case 252: return G[8];
    case 253: return G[7];
    case 254: return G[8];
    case 255: return G[9];
    case 256: return G[7];
    case 257: return G[8];
    case 258: return G[9];
    case 259: return G[10];
    case 260: return G[7] * zij + G[14];
    case 261: return G[7] * zij + G[14];
    case 262: return G[8] * zij + G[15];
    case 263: return G[7] * zij + G[14];
    case 264: return G[8] * zij + G[15];
    case 265: return G[9] * zij + G[16];
    case 266: return G[7] * zij + G[14];
    case 267: return G[8] * zij + G[15];
    case 268: return G[9] * zij + G[16];
    case 269: return G[10] * zij + G[17];
    case 270: return G[7];
    case 271: return G[7];
    case 272: return G[8];
    case 273: return G[7];
    case 274: return G[8];
    case 275: return G[9];
    case 276: return G[7];
    case 277: return G[8];
    case 278: return G[9];
    case 279: return G[10];
    case 280: return G[7] * zij + G[14];
    case 281: return G[7] * zij + G[14];
    case 282: return G[8] * zij + G[15];
    case 283: return G[7] * zij + G[14];
    case 284: return G[8] * zij + G[15];
    case 285: return G[9] * zij + G[16];
    case 286: return G[7] * zij + G[14];
    case 287: return G[8] * zij + G[15];
    case 288: return G[9] * zij + G[16];
    case 289: return G[10] * zij + G[17];
    case 290: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 291: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 292: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 293: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 294: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 295: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 296: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 297: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 298: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 299: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 300: return G[14];
    case 301: return G[14];
    case 302: return G[15];
    case 303: return G[14];
    case 304: return G[15];
    case 305: return G[16];
    case 306: return G[14];
    case 307: return G[15];
    case 308: return G[16];
    case 309: return G[17];
    case 310: return G[14];
    case 311: return G[14];
    case 312: return G[15];
    case 313: return G[14];
    case 314: return G[15];
    case 315: return G[16];
    case 316: return G[14];
    case 317: return G[15];
    case 318: return G[16];
    case 319: return G[17];
    case 320: return G[14] * zij + G[21];
    case 321: return G[14] * zij + G[21];
    case 322: return G[15] * zij + G[22];
    case 323: return G[14] * zij + G[21];
    case 324: return G[15] * zij + G[22];
    case 325: return G[16] * zij + G[23];
    case 326: return G[14] * zij + G[21];
    case 327: return G[15] * zij + G[22];
    case 328: return G[16] * zij + G[23];
    case 329: return G[17] * zij + G[24];
    case 330: return G[14];
    case 331: return G[14];
    case 332: return G[15];
    case 333: return G[14];
    case 334: return G[15];
    case 335: return G[16];
    case 336: return G[14];
    case 337: return G[15];
    case 338: return G[16];
    case 339: return G[17];
    case 340: return G[14] * zij + G[21];
    case 341: return G[14] * zij + G[21];
    case 342: return G[15] * zij + G[22];
    case 343: return G[14] * zij + G[21];
    case 344: return G[15] * zij + G[22];
    case 345: return G[16] * zij + G[23];
    case 346: return G[14] * zij + G[21];
    case 347: return G[15] * zij + G[22];
    case 348: return G[16] * zij + G[23];
    case 349: return G[17] * zij + G[24];
    case 350: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 351: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 352: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 353: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 354: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 355: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 356: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 357: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 358: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 359: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ddfs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 360;
  constexpr int kNMax = 4;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ddfs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ddfs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ddfs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fdfs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[24] * xij2 + 2.0 * (G[31] * xij) + G[38];
    case 1: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 2: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 3: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 4: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 5: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 6: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 7: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 8: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 9: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 10: return G[24] * xij + G[31];
    case 11: return G[23] * xij + G[30];
    case 12: return G[23] * xij + G[30];
    case 13: return G[22] * xij + G[29];
    case 14: return G[22] * xij + G[29];
    case 15: return G[22] * xij + G[29];
    case 16: return G[21] * xij + G[28];
    case 17: return G[21] * xij + G[28];
    case 18: return G[21] * xij + G[28];
    case 19: return G[21] * xij + G[28];
    case 20: return G[24] * xij + G[31];
    case 21: return G[23] * xij + G[30];
    case 22: return G[23] * xij + G[30];
    case 23: return G[22] * xij + G[29];
    case 24: return G[22] * xij + G[29];
    case 25: return G[22] * xij + G[29];
    case 26: return G[21] * xij + G[28];
    case 27: return G[21] * xij + G[28];
    case 28: return G[21] * xij + G[28];
    case 29: return G[21] * xij + G[28];
    case 30: return G[24];
    case 31: return G[23];
    case 32: return G[23];
    case 33: return G[22];
    case 34: return G[22];
    case 35: return G[22];
    case 36: return G[21];
    case 37: return G[21];
    case 38: return G[21];
    case 39: return G[21];
    case 40: return G[24];
    case 41: return G[23];
    case 42: return G[23];
    case 43: return G[22];
    case 44: return G[22];
    case 45: return G[22];
    case 46: return G[21];
    case 47: return G[21];
    case 48: return G[21];
    case 49: return G[21];
    case 50: return G[24];
    case 51: return G[23];
    case 52: return G[23];
    case 53: return G[22];
    case 54: return G[22];
    case 55: return G[22];
    case 56: return G[21];
    case 57: return G[21];
    case 58: return G[21];
    case 59: return G[21];
    case 60: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 61: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 62: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 63: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 64: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 65: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 66: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 67: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 68: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 69: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 70: return G[17] * xij + G[24];
    case 71: return G[16] * xij + G[23];
    case 72: return G[16] * xij + G[23];
    case 73: return G[15] * xij + G[22];
    case 74: return G[15] * xij + G[22];
    case 75: return G[15] * xij + G[22];
    case 76: return G[14] * xij + G[21];
    case 77: return G[14] * xij + G[21];
    case 78: return G[14] * xij + G[21];
    case 79: return G[14] * xij + G[21];
    case 80: return G[17] * xij + G[24];
    case 81: return G[16] * xij + G[23];
    case 82: return G[16] * xij + G[23];
    case 83: return G[15] * xij + G[22];
    case 84: return G[15] * xij + G[22];
    case 85: return G[15] * xij + G[22];
    case 86: return G[14] * xij + G[21];
    case 87: return G[14] * xij + G[21];
    case 88: return G[14] * xij + G[21];
    case 89: return G[14] * xij + G[21];
    case 90: return G[17];
    case 91: return G[16];
    case 92: return G[16];
    case 93: return G[15];
    case 94: return G[15];
    case 95: return G[15];
    case 96: return G[14];
    case 97: return G[14];
    case 98: return G[14];
    case 99: return G[14];
    case 100: return G[17];
    case 101: return G[16];
    case 102: return G[16];
    case 103: return G[15];
    case 104: return G[15];
    case 105: return G[15];
    case 106: return G[14];
    case 107: return G[14];
    case 108: return G[14];
    case 109: return G[14];
    case 110: return G[17];
    case 111: return G[16];
    case 112: return G[16];
    case 113: return G[15];
    case 114: return G[15];
    case 115: return G[15];
    case 116: return G[14];
    case 117: return G[14];
    case 118: return G[14];
    case 119: return G[14];
    case 120: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 121: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 122: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 123: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 124: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 125: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 126: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 127: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 128: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 129: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 130: return G[17] * xij + G[24];
    case 131: return G[16] * xij + G[23];
    case 132: return G[16] * xij + G[23];
    case 133: return G[15] * xij + G[22];
    case 134: return G[15] * xij + G[22];
    case 135: return G[15] * xij + G[22];
    case 136: return G[14] * xij + G[21];
    case 137: return G[14] * xij + G[21];
    case 138: return G[14] * xij + G[21];
    case 139: return G[14] * xij + G[21];
    case 140: return G[17] * xij + G[24];
    case 141: return G[16] * xij + G[23];
    case 142: return G[16] * xij + G[23];
    case 143: return G[15] * xij + G[22];
    case 144: return G[15] * xij + G[22];
    case 145: return G[15] * xij + G[22];
    case 146: return G[14] * xij + G[21];
    case 147: return G[14] * xij + G[21];
    case 148: return G[14] * xij + G[21];
    case 149: return G[14] * xij + G[21];
    case 150: return G[17];
    case 151: return G[16];
    case 152: return G[16];
    case 153: return G[15];
    case 154: return G[15];
    case 155: return G[15];
    case 156: return G[14];
    case 157: return G[14];
    case 158: return G[14];
    case 159: return G[14];
    case 160: return G[17];
    case 161: return G[16];
    case 162: return G[16];
    case 163: return G[15];
    case 164: return G[15];
    case 165: return G[15];
    case 166: return G[14];
    case 167: return G[14];
    case 168: return G[14];
    case 169: return G[14];
    case 170: return G[17];
    case 171: return G[16];
    case 172: return G[16];
    case 173: return G[15];
    case 174: return G[15];
    case 175: return G[15];
    case 176: return G[14];
    case 177: return G[14];
    case 178: return G[14];
    case 179: return G[14];
    case 180: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 181: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 182: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 183: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 184: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 185: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 186: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 187: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 188: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 189: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 190: return G[10] * xij + G[17];
    case 191: return G[9] * xij + G[16];
    case 192: return G[9] * xij + G[16];
    case 193: return G[8] * xij + G[15];
    case 194: return G[8] * xij + G[15];
    case 195: return G[8] * xij + G[15];
    case 196: return G[7] * xij + G[14];
    case 197: return G[7] * xij + G[14];
    case 198: return G[7] * xij + G[14];
    case 199: return G[7] * xij + G[14];
    case 200: return G[10] * xij + G[17];
    case 201: return G[9] * xij + G[16];
    case 202: return G[9] * xij + G[16];
    case 203: return G[8] * xij + G[15];
    case 204: return G[8] * xij + G[15];
    case 205: return G[8] * xij + G[15];
    case 206: return G[7] * xij + G[14];
    case 207: return G[7] * xij + G[14];
    case 208: return G[7] * xij + G[14];
    case 209: return G[7] * xij + G[14];
    case 210: return G[10];
    case 211: return G[9];
    case 212: return G[9];
    case 213: return G[8];
    case 214: return G[8];
    case 215: return G[8];
    case 216: return G[7];
    case 217: return G[7];
    case 218: return G[7];
    case 219: return G[7];
    case 220: return G[10];
    case 221: return G[9];
    case 222: return G[9];
    case 223: return G[8];
    case 224: return G[8];
    case 225: return G[8];
    case 226: return G[7];
    case 227: return G[7];
    case 228: return G[7];
    case 229: return G[7];
    case 230: return G[10];
    case 231: return G[9];
    case 232: return G[9];
    case 233: return G[8];
    case 234: return G[8];
    case 235: return G[8];
    case 236: return G[7];
    case 237: return G[7];
    case 238: return G[7];
    case 239: return G[7];
    case 240: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 241: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 242: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 243: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 244: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 245: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 246: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 247: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 248: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 249: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 250: return G[10] * xij + G[17];
    case 251: return G[9] * xij + G[16];
    case 252: return G[9] * xij + G[16];
    case 253: return G[8] * xij + G[15];
    case 254: return G[8] * xij + G[15];
    case 255: return G[8] * xij + G[15];
    case 256: return G[7] * xij + G[14];
    case 257: return G[7] * xij + G[14];
    case 258: return G[7] * xij + G[14];
    case 259: return G[7] * xij + G[14];
    case 260: return G[10] * xij + G[17];
    case 261: return G[9] * xij + G[16];
    case 262: return G[9] * xij + G[16];
    case 263: return G[8] * xij + G[15];
    case 264: return G[8] * xij + G[15];
    case 265: return G[8] * xij + G[15];
    case 266: return G[7] * xij + G[14];
    case 267: return G[7] * xij + G[14];
    case 268: return G[7] * xij + G[14];
    case 269: return G[7] * xij + G[14];
    case 270: return G[10];
    case 271: return G[9];
    case 272: return G[9];
    case 273: return G[8];
    case 274: return G[8];
    case 275: return G[8];
    case 276: return G[7];
    case 277: return G[7];
    case 278: return G[7];
    case 279: return G[7];
    case 280: return G[10];
    case 281: return G[9];
    case 282: return G[9];
    case 283: return G[8];
    case 284: return G[8];
    case 285: return G[8];
    case 286: return G[7];
    case 287: return G[7];
    case 288: return G[7];
    case 289: return G[7];
    case 290: return G[10];
    case 291: return G[9];
    case 292: return G[9];
    case 293: return G[8];
    case 294: return G[8];
    case 295: return G[8];
    case 296: return G[7];
    case 297: return G[7];
    case 298: return G[7];
    case 299: return G[7];
    case 300: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 301: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 302: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 303: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 304: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 305: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 306: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 307: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 308: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 309: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 310: return G[10] * xij + G[17];
    case 311: return G[9] * xij + G[16];
    case 312: return G[9] * xij + G[16];
    case 313: return G[8] * xij + G[15];
    case 314: return G[8] * xij + G[15];
    case 315: return G[8] * xij + G[15];
    case 316: return G[7] * xij + G[14];
    case 317: return G[7] * xij + G[14];
    case 318: return G[7] * xij + G[14];
    case 319: return G[7] * xij + G[14];
    case 320: return G[10] * xij + G[17];
    case 321: return G[9] * xij + G[16];
    case 322: return G[9] * xij + G[16];
    case 323: return G[8] * xij + G[15];
    case 324: return G[8] * xij + G[15];
    case 325: return G[8] * xij + G[15];
    case 326: return G[7] * xij + G[14];
    case 327: return G[7] * xij + G[14];
    case 328: return G[7] * xij + G[14];
    case 329: return G[7] * xij + G[14];
    case 330: return G[10];
    case 331: return G[9];
    case 332: return G[9];
    case 333: return G[8];
    case 334: return G[8];
    case 335: return G[8];
    case 336: return G[7];
    case 337: return G[7];
    case 338: return G[7];
    case 339: return G[7];
    case 340: return G[10];
    case 341: return G[9];
    case 342: return G[9];
    case 343: return G[8];
    case 344: return G[8];
    case 345: return G[8];
    case 346: return G[7];
    case 347: return G[7];
    case 348: return G[7];
    case 349: return G[7];
    case 350: return G[10];
    case 351: return G[9];
    case 352: return G[9];
    case 353: return G[8];
    case 354: return G[8];
    case 355: return G[8];
    case 356: return G[7];
    case 357: return G[7];
    case 358: return G[7];
    case 359: return G[7];
    case 360: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 361: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 362: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 363: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 364: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 365: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 366: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 367: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 368: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 369: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 370: return G[3] * xij + G[10];
    case 371: return G[2] * xij + G[9];
    case 372: return G[2] * xij + G[9];
    case 373: return G[1] * xij + G[8];
    case 374: return G[1] * xij + G[8];
    case 375: return G[1] * xij + G[8];
    case 376: return G[0] * xij + G[7];
    case 377: return G[0] * xij + G[7];
    case 378: return G[0] * xij + G[7];
    case 379: return G[0] * xij + G[7];
    case 380: return G[3] * xij + G[10];
    case 381: return G[2] * xij + G[9];
    case 382: return G[2] * xij + G[9];
    case 383: return G[1] * xij + G[8];
    case 384: return G[1] * xij + G[8];
    case 385: return G[1] * xij + G[8];
    case 386: return G[0] * xij + G[7];
    case 387: return G[0] * xij + G[7];
    case 388: return G[0] * xij + G[7];
    case 389: return G[0] * xij + G[7];
    case 390: return G[3];
    case 391: return G[2];
    case 392: return G[2];
    case 393: return G[1];
    case 394: return G[1];
    case 395: return G[1];
    case 396: return G[0];
    case 397: return G[0];
    case 398: return G[0];
    case 399: return G[0];
    case 400: return G[3];
    case 401: return G[2];
    case 402: return G[2];
    case 403: return G[1];
    case 404: return G[1];
    case 405: return G[1];
    case 406: return G[0];
    case 407: return G[0];
    case 408: return G[0];
    case 409: return G[0];
    case 410: return G[3];
    case 411: return G[2];
    case 412: return G[2];
    case 413: return G[1];
    case 414: return G[1];
    case 415: return G[1];
    case 416: return G[0];
    case 417: return G[0];
    case 418: return G[0];
    case 419: return G[0];
    case 420: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 421: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 422: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 423: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 424: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 425: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 426: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 427: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 428: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 429: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 430: return G[3] * xij + G[10];
    case 431: return G[2] * xij + G[9];
    case 432: return G[2] * xij + G[9];
    case 433: return G[1] * xij + G[8];
    case 434: return G[1] * xij + G[8];
    case 435: return G[1] * xij + G[8];
    case 436: return G[0] * xij + G[7];
    case 437: return G[0] * xij + G[7];
    case 438: return G[0] * xij + G[7];
    case 439: return G[0] * xij + G[7];
    case 440: return G[3] * xij + G[10];
    case 441: return G[2] * xij + G[9];
    case 442: return G[2] * xij + G[9];
    case 443: return G[1] * xij + G[8];
    case 444: return G[1] * xij + G[8];
    case 445: return G[1] * xij + G[8];
    case 446: return G[0] * xij + G[7];
    case 447: return G[0] * xij + G[7];
    case 448: return G[0] * xij + G[7];
    case 449: return G[0] * xij + G[7];
    case 450: return G[3];
    case 451: return G[2];
    case 452: return G[2];
    case 453: return G[1];
    case 454: return G[1];
    case 455: return G[1];
    case 456: return G[0];
    case 457: return G[0];
    case 458: return G[0];
    case 459: return G[0];
    case 460: return G[3];
    case 461: return G[2];
    case 462: return G[2];
    case 463: return G[1];
    case 464: return G[1];
    case 465: return G[1];
    case 466: return G[0];
    case 467: return G[0];
    case 468: return G[0];
    case 469: return G[0];
    case 470: return G[3];
    case 471: return G[2];
    case 472: return G[2];
    case 473: return G[1];
    case 474: return G[1];
    case 475: return G[1];
    case 476: return G[0];
    case 477: return G[0];
    case 478: return G[0];
    case 479: return G[0];
    case 480: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 481: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 482: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 483: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 484: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 485: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 486: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 487: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 488: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 489: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 490: return G[3] * xij + G[10];
    case 491: return G[2] * xij + G[9];
    case 492: return G[2] * xij + G[9];
    case 493: return G[1] * xij + G[8];
    case 494: return G[1] * xij + G[8];
    case 495: return G[1] * xij + G[8];
    case 496: return G[0] * xij + G[7];
    case 497: return G[0] * xij + G[7];
    case 498: return G[0] * xij + G[7];
    case 499: return G[0] * xij + G[7];
    case 500: return G[3] * xij + G[10];
    case 501: return G[2] * xij + G[9];
    case 502: return G[2] * xij + G[9];
    case 503: return G[1] * xij + G[8];
    case 504: return G[1] * xij + G[8];
    case 505: return G[1] * xij + G[8];
    case 506: return G[0] * xij + G[7];
    case 507: return G[0] * xij + G[7];
    case 508: return G[0] * xij + G[7];
    case 509: return G[0] * xij + G[7];
    case 510: return G[3];
    case 511: return G[2];
    case 512: return G[2];
    case 513: return G[1];
    case 514: return G[1];
    case 515: return G[1];
    case 516: return G[0];
    case 517: return G[0];
    case 518: return G[0];
    case 519: return G[0];
    case 520: return G[3];
    case 521: return G[2];
    case 522: return G[2];
    case 523: return G[1];
    case 524: return G[1];
    case 525: return G[1];
    case 526: return G[0];
    case 527: return G[0];
    case 528: return G[0];
    case 529: return G[0];
    case 530: return G[3];
    case 531: return G[2];
    case 532: return G[2];
    case 533: return G[1];
    case 534: return G[1];
    case 535: return G[1];
    case 536: return G[0];
    case 537: return G[0];
    case 538: return G[0];
    case 539: return G[0];
    case 540: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 541: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 542: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 543: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 544: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 545: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 546: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 547: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 548: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 549: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 550: return G[3] * xij + G[10];
    case 551: return G[2] * xij + G[9];
    case 552: return G[2] * xij + G[9];
    case 553: return G[1] * xij + G[8];
    case 554: return G[1] * xij + G[8];
    case 555: return G[1] * xij + G[8];
    case 556: return G[0] * xij + G[7];
    case 557: return G[0] * xij + G[7];
    case 558: return G[0] * xij + G[7];
    case 559: return G[0] * xij + G[7];
    case 560: return G[3] * xij + G[10];
    case 561: return G[2] * xij + G[9];
    case 562: return G[2] * xij + G[9];
    case 563: return G[1] * xij + G[8];
    case 564: return G[1] * xij + G[8];
    case 565: return G[1] * xij + G[8];
    case 566: return G[0] * xij + G[7];
    case 567: return G[0] * xij + G[7];
    case 568: return G[0] * xij + G[7];
    case 569: return G[0] * xij + G[7];
    case 570: return G[3];
    case 571: return G[2];
    case 572: return G[2];
    case 573: return G[1];
    case 574: return G[1];
    case 575: return G[1];
    case 576: return G[0];
    case 577: return G[0];
    case 578: return G[0];
    case 579: return G[0];
    case 580: return G[3];
    case 581: return G[2];
    case 582: return G[2];
    case 583: return G[1];
    case 584: return G[1];
    case 585: return G[1];
    case 586: return G[0];
    case 587: return G[0];
    case 588: return G[0];
    case 589: return G[0];
    case 590: return G[3];
    case 591: return G[2];
    case 592: return G[2];
    case 593: return G[1];
    case 594: return G[1];
    case 595: return G[1];
    case 596: return G[0];
    case 597: return G[0];
    case 598: return G[0];
    case 599: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdfs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[0] * yij + G[7];
    case 11: return G[1] * yij + G[8];
    case 12: return G[0] * yij + G[7];
    case 13: return G[2] * yij + G[9];
    case 14: return G[1] * yij + G[8];
    case 15: return G[0] * yij + G[7];
    case 16: return G[3] * yij + G[10];
    case 17: return G[2] * yij + G[9];
    case 18: return G[1] * yij + G[8];
    case 19: return G[0] * yij + G[7];
    case 20: return G[0];
    case 21: return G[1];
    case 22: return G[0];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[3];
    case 27: return G[2];
    case 28: return G[1];
    case 29: return G[0];
    case 30: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 31: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 32: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 33: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 34: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 35: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 36: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 37: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 38: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 39: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 40: return G[0] * yij + G[7];
    case 41: return G[1] * yij + G[8];
    case 42: return G[0] * yij + G[7];
    case 43: return G[2] * yij + G[9];
    case 44: return G[1] * yij + G[8];
    case 45: return G[0] * yij + G[7];
    case 46: return G[3] * yij + G[10];
    case 47: return G[2] * yij + G[9];
    case 48: return G[1] * yij + G[8];
    case 49: return G[0] * yij + G[7];
    case 50: return G[0];
    case 51: return G[1];
    case 52: return G[0];
    case 53: return G[2];
    case 54: return G[1];
    case 55: return G[0];
    case 56: return G[3];
    case 57: return G[2];
    case 58: return G[1];
    case 59: return G[0];
    case 60: return G[7];
    case 61: return G[8];
    case 62: return G[7];
    case 63: return G[9];
    case 64: return G[8];
    case 65: return G[7];
    case 66: return G[10];
    case 67: return G[9];
    case 68: return G[8];
    case 69: return G[7];
    case 70: return G[7] * yij + G[14];
    case 71: return G[8] * yij + G[15];
    case 72: return G[7] * yij + G[14];
    case 73: return G[9] * yij + G[16];
    case 74: return G[8] * yij + G[15];
    case 75: return G[7] * yij + G[14];
    case 76: return G[10] * yij + G[17];
    case 77: return G[9] * yij + G[16];
    case 78: return G[8] * yij + G[15];
    case 79: return G[7] * yij + G[14];
    case 80: return G[7];
    case 81: return G[8];
    case 82: return G[7];
    case 83: return G[9];
    case 84: return G[8];
    case 85: return G[7];
    case 86: return G[10];
    case 87: return G[9];
    case 88: return G[8];
    case 89: return G[7];
    case 90: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 91: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 92: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 93: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 94: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 95: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 96: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 97: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 98: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 99: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 100: return G[7] * yij + G[14];
    case 101: return G[8] * yij + G[15];
    case 102: return G[7] * yij + G[14];
    case 103: return G[9] * yij + G[16];
    case 104: return G[8] * yij + G[15];
    case 105: return G[7] * yij + G[14];
    case 106: return G[10] * yij + G[17];
    case 107: return G[9] * yij + G[16];
    case 108: return G[8] * yij + G[15];
    case 109: return G[7] * yij + G[14];
    case 110: return G[7];
    case 111: return G[8];
    case 112: return G[7];
    case 113: return G[9];
    case 114: return G[8];
    case 115: return G[7];
    case 116: return G[10];
    case 117: return G[9];
    case 118: return G[8];
    case 119: return G[7];
    case 120: return G[0];
    case 121: return G[1];
    case 122: return G[0];
    case 123: return G[2];
    case 124: return G[1];
    case 125: return G[0];
    case 126: return G[3];
    case 127: return G[2];
    case 128: return G[1];
    case 129: return G[0];
    case 130: return G[0] * yij + G[7];
    case 131: return G[1] * yij + G[8];
    case 132: return G[0] * yij + G[7];
    case 133: return G[2] * yij + G[9];
    case 134: return G[1] * yij + G[8];
    case 135: return G[0] * yij + G[7];
    case 136: return G[3] * yij + G[10];
    case 137: return G[2] * yij + G[9];
    case 138: return G[1] * yij + G[8];
    case 139: return G[0] * yij + G[7];
    case 140: return G[0];
    case 141: return G[1];
    case 142: return G[0];
    case 143: return G[2];
    case 144: return G[1];
    case 145: return G[0];
    case 146: return G[3];
    case 147: return G[2];
    case 148: return G[1];
    case 149: return G[0];
    case 150: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 151: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 152: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 153: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 154: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 155: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 156: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 157: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 158: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 159: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 160: return G[0] * yij + G[7];
    case 161: return G[1] * yij + G[8];
    case 162: return G[0] * yij + G[7];
    case 163: return G[2] * yij + G[9];
    case 164: return G[1] * yij + G[8];
    case 165: return G[0] * yij + G[7];
    case 166: return G[3] * yij + G[10];
    case 167: return G[2] * yij + G[9];
    case 168: return G[1] * yij + G[8];
    case 169: return G[0] * yij + G[7];
    case 170: return G[0];
    case 171: return G[1];
    case 172: return G[0];
    case 173: return G[2];
    case 174: return G[1];
    case 175: return G[0];
    case 176: return G[3];
    case 177: return G[2];
    case 178: return G[1];
    case 179: return G[0];
    case 180: return G[14];
    case 181: return G[15];
    case 182: return G[14];
    case 183: return G[16];
    case 184: return G[15];
    case 185: return G[14];
    case 186: return G[17];
    case 187: return G[16];
    case 188: return G[15];
    case 189: return G[14];
    case 190: return G[14] * yij + G[21];
    case 191: return G[15] * yij + G[22];
    case 192: return G[14] * yij + G[21];
    case 193: return G[16] * yij + G[23];
    case 194: return G[15] * yij + G[22];
    case 195: return G[14] * yij + G[21];
    case 196: return G[17] * yij + G[24];
    case 197: return G[16] * yij + G[23];
    case 198: return G[15] * yij + G[22];
    case 199: return G[14] * yij + G[21];
    case 200: return G[14];
    case 201: return G[15];
    case 202: return G[14];
    case 203: return G[16];
    case 204: return G[15];
    case 205: return G[14];
    case 206: return G[17];
    case 207: return G[16];
    case 208: return G[15];
    case 209: return G[14];
    case 210: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 211: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 212: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 213: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 214: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 215: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 216: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 217: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 218: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 219: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 220: return G[14] * yij + G[21];
    case 221: return G[15] * yij + G[22];
    case 222: return G[14] * yij + G[21];
    case 223: return G[16] * yij + G[23];
    case 224: return G[15] * yij + G[22];
    case 225: return G[14] * yij + G[21];
    case 226: return G[17] * yij + G[24];
    case 227: return G[16] * yij + G[23];
    case 228: return G[15] * yij + G[22];
    case 229: return G[14] * yij + G[21];
    case 230: return G[14];
    case 231: return G[15];
    case 232: return G[14];
    case 233: return G[16];
    case 234: return G[15];
    case 235: return G[14];
    case 236: return G[17];
    case 237: return G[16];
    case 238: return G[15];
    case 239: return G[14];
    case 240: return G[7];
    case 241: return G[8];
    case 242: return G[7];
    case 243: return G[9];
    case 244: return G[8];
    case 245: return G[7];
    case 246: return G[10];
    case 247: return G[9];
    case 248: return G[8];
    case 249: return G[7];
    case 250: return G[7] * yij + G[14];
    case 251: return G[8] * yij + G[15];
    case 252: return G[7] * yij + G[14];
    case 253: return G[9] * yij + G[16];
    case 254: return G[8] * yij + G[15];
    case 255: return G[7] * yij + G[14];
    case 256: return G[10] * yij + G[17];
    case 257: return G[9] * yij + G[16];
    case 258: return G[8] * yij + G[15];
    case 259: return G[7] * yij + G[14];
    case 260: return G[7];
    case 261: return G[8];
    case 262: return G[7];
    case 263: return G[9];
    case 264: return G[8];
    case 265: return G[7];
    case 266: return G[10];
    case 267: return G[9];
    case 268: return G[8];
    case 269: return G[7];
    case 270: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 271: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 272: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 273: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 274: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 275: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 276: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 277: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 278: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 279: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 280: return G[7] * yij + G[14];
    case 281: return G[8] * yij + G[15];
    case 282: return G[7] * yij + G[14];
    case 283: return G[9] * yij + G[16];
    case 284: return G[8] * yij + G[15];
    case 285: return G[7] * yij + G[14];
    case 286: return G[10] * yij + G[17];
    case 287: return G[9] * yij + G[16];
    case 288: return G[8] * yij + G[15];
    case 289: return G[7] * yij + G[14];
    case 290: return G[7];
    case 291: return G[8];
    case 292: return G[7];
    case 293: return G[9];
    case 294: return G[8];
    case 295: return G[7];
    case 296: return G[10];
    case 297: return G[9];
    case 298: return G[8];
    case 299: return G[7];
    case 300: return G[0];
    case 301: return G[1];
    case 302: return G[0];
    case 303: return G[2];
    case 304: return G[1];
    case 305: return G[0];
    case 306: return G[3];
    case 307: return G[2];
    case 308: return G[1];
    case 309: return G[0];
    case 310: return G[0] * yij + G[7];
    case 311: return G[1] * yij + G[8];
    case 312: return G[0] * yij + G[7];
    case 313: return G[2] * yij + G[9];
    case 314: return G[1] * yij + G[8];
    case 315: return G[0] * yij + G[7];
    case 316: return G[3] * yij + G[10];
    case 317: return G[2] * yij + G[9];
    case 318: return G[1] * yij + G[8];
    case 319: return G[0] * yij + G[7];
    case 320: return G[0];
    case 321: return G[1];
    case 322: return G[0];
    case 323: return G[2];
    case 324: return G[1];
    case 325: return G[0];
    case 326: return G[3];
    case 327: return G[2];
    case 328: return G[1];
    case 329: return G[0];
    case 330: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 331: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 332: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 333: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 334: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 335: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 336: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 337: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 338: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 339: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 340: return G[0] * yij + G[7];
    case 341: return G[1] * yij + G[8];
    case 342: return G[0] * yij + G[7];
    case 343: return G[2] * yij + G[9];
    case 344: return G[1] * yij + G[8];
    case 345: return G[0] * yij + G[7];
    case 346: return G[3] * yij + G[10];
    case 347: return G[2] * yij + G[9];
    case 348: return G[1] * yij + G[8];
    case 349: return G[0] * yij + G[7];
    case 350: return G[0];
    case 351: return G[1];
    case 352: return G[0];
    case 353: return G[2];
    case 354: return G[1];
    case 355: return G[0];
    case 356: return G[3];
    case 357: return G[2];
    case 358: return G[1];
    case 359: return G[0];
    case 360: return G[21];
    case 361: return G[22];
    case 362: return G[21];
    case 363: return G[23];
    case 364: return G[22];
    case 365: return G[21];
    case 366: return G[24];
    case 367: return G[23];
    case 368: return G[22];
    case 369: return G[21];
    case 370: return G[21] * yij + G[28];
    case 371: return G[22] * yij + G[29];
    case 372: return G[21] * yij + G[28];
    case 373: return G[23] * yij + G[30];
    case 374: return G[22] * yij + G[29];
    case 375: return G[21] * yij + G[28];
    case 376: return G[24] * yij + G[31];
    case 377: return G[23] * yij + G[30];
    case 378: return G[22] * yij + G[29];
    case 379: return G[21] * yij + G[28];
    case 380: return G[21];
    case 381: return G[22];
    case 382: return G[21];
    case 383: return G[23];
    case 384: return G[22];
    case 385: return G[21];
    case 386: return G[24];
    case 387: return G[23];
    case 388: return G[22];
    case 389: return G[21];
    case 390: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 391: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 392: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 393: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 394: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 395: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 396: return G[24] * yij2 + 2.0 * (G[31] * yij) + G[38];
    case 397: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 398: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 399: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 400: return G[21] * yij + G[28];
    case 401: return G[22] * yij + G[29];
    case 402: return G[21] * yij + G[28];
    case 403: return G[23] * yij + G[30];
    case 404: return G[22] * yij + G[29];
    case 405: return G[21] * yij + G[28];
    case 406: return G[24] * yij + G[31];
    case 407: return G[23] * yij + G[30];
    case 408: return G[22] * yij + G[29];
    case 409: return G[21] * yij + G[28];
    case 410: return G[21];
    case 411: return G[22];
    case 412: return G[21];
    case 413: return G[23];
    case 414: return G[22];
    case 415: return G[21];
    case 416: return G[24];
    case 417: return G[23];
    case 418: return G[22];
    case 419: return G[21];
    case 420: return G[14];
    case 421: return G[15];
    case 422: return G[14];
    case 423: return G[16];
    case 424: return G[15];
    case 425: return G[14];
    case 426: return G[17];
    case 427: return G[16];
    case 428: return G[15];
    case 429: return G[14];
    case 430: return G[14] * yij + G[21];
    case 431: return G[15] * yij + G[22];
    case 432: return G[14] * yij + G[21];
    case 433: return G[16] * yij + G[23];
    case 434: return G[15] * yij + G[22];
    case 435: return G[14] * yij + G[21];
    case 436: return G[17] * yij + G[24];
    case 437: return G[16] * yij + G[23];
    case 438: return G[15] * yij + G[22];
    case 439: return G[14] * yij + G[21];
    case 440: return G[14];
    case 441: return G[15];
    case 442: return G[14];
    case 443: return G[16];
    case 444: return G[15];
    case 445: return G[14];
    case 446: return G[17];
    case 447: return G[16];
    case 448: return G[15];
    case 449: return G[14];
    case 450: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 451: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 452: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 453: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 454: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 455: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 456: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 457: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 458: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 459: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 460: return G[14] * yij + G[21];
    case 461: return G[15] * yij + G[22];
    case 462: return G[14] * yij + G[21];
    case 463: return G[16] * yij + G[23];
    case 464: return G[15] * yij + G[22];
    case 465: return G[14] * yij + G[21];
    case 466: return G[17] * yij + G[24];
    case 467: return G[16] * yij + G[23];
    case 468: return G[15] * yij + G[22];
    case 469: return G[14] * yij + G[21];
    case 470: return G[14];
    case 471: return G[15];
    case 472: return G[14];
    case 473: return G[16];
    case 474: return G[15];
    case 475: return G[14];
    case 476: return G[17];
    case 477: return G[16];
    case 478: return G[15];
    case 479: return G[14];
    case 480: return G[7];
    case 481: return G[8];
    case 482: return G[7];
    case 483: return G[9];
    case 484: return G[8];
    case 485: return G[7];
    case 486: return G[10];
    case 487: return G[9];
    case 488: return G[8];
    case 489: return G[7];
    case 490: return G[7] * yij + G[14];
    case 491: return G[8] * yij + G[15];
    case 492: return G[7] * yij + G[14];
    case 493: return G[9] * yij + G[16];
    case 494: return G[8] * yij + G[15];
    case 495: return G[7] * yij + G[14];
    case 496: return G[10] * yij + G[17];
    case 497: return G[9] * yij + G[16];
    case 498: return G[8] * yij + G[15];
    case 499: return G[7] * yij + G[14];
    case 500: return G[7];
    case 501: return G[8];
    case 502: return G[7];
    case 503: return G[9];
    case 504: return G[8];
    case 505: return G[7];
    case 506: return G[10];
    case 507: return G[9];
    case 508: return G[8];
    case 509: return G[7];
    case 510: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 511: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 512: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 513: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 514: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 515: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 516: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 517: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 518: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 519: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 520: return G[7] * yij + G[14];
    case 521: return G[8] * yij + G[15];
    case 522: return G[7] * yij + G[14];
    case 523: return G[9] * yij + G[16];
    case 524: return G[8] * yij + G[15];
    case 525: return G[7] * yij + G[14];
    case 526: return G[10] * yij + G[17];
    case 527: return G[9] * yij + G[16];
    case 528: return G[8] * yij + G[15];
    case 529: return G[7] * yij + G[14];
    case 530: return G[7];
    case 531: return G[8];
    case 532: return G[7];
    case 533: return G[9];
    case 534: return G[8];
    case 535: return G[7];
    case 536: return G[10];
    case 537: return G[9];
    case 538: return G[8];
    case 539: return G[7];
    case 540: return G[0];
    case 541: return G[1];
    case 542: return G[0];
    case 543: return G[2];
    case 544: return G[1];
    case 545: return G[0];
    case 546: return G[3];
    case 547: return G[2];
    case 548: return G[1];
    case 549: return G[0];
    case 550: return G[0] * yij + G[7];
    case 551: return G[1] * yij + G[8];
    case 552: return G[0] * yij + G[7];
    case 553: return G[2] * yij + G[9];
    case 554: return G[1] * yij + G[8];
    case 555: return G[0] * yij + G[7];
    case 556: return G[3] * yij + G[10];
    case 557: return G[2] * yij + G[9];
    case 558: return G[1] * yij + G[8];
    case 559: return G[0] * yij + G[7];
    case 560: return G[0];
    case 561: return G[1];
    case 562: return G[0];
    case 563: return G[2];
    case 564: return G[1];
    case 565: return G[0];
    case 566: return G[3];
    case 567: return G[2];
    case 568: return G[1];
    case 569: return G[0];
    case 570: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 571: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 572: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 573: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 574: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 575: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 576: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 577: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 578: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 579: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 580: return G[0] * yij + G[7];
    case 581: return G[1] * yij + G[8];
    case 582: return G[0] * yij + G[7];
    case 583: return G[2] * yij + G[9];
    case 584: return G[1] * yij + G[8];
    case 585: return G[0] * yij + G[7];
    case 586: return G[3] * yij + G[10];
    case 587: return G[2] * yij + G[9];
    case 588: return G[1] * yij + G[8];
    case 589: return G[0] * yij + G[7];
    case 590: return G[0];
    case 591: return G[1];
    case 592: return G[0];
    case 593: return G[2];
    case 594: return G[1];
    case 595: return G[0];
    case 596: return G[3];
    case 597: return G[2];
    case 598: return G[1];
    case 599: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdfs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[1];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[2];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[2];
    case 19: return G[3];
    case 20: return G[0] * zij + G[7];
    case 21: return G[0] * zij + G[7];
    case 22: return G[1] * zij + G[8];
    case 23: return G[0] * zij + G[7];
    case 24: return G[1] * zij + G[8];
    case 25: return G[2] * zij + G[9];
    case 26: return G[0] * zij + G[7];
    case 27: return G[1] * zij + G[8];
    case 28: return G[2] * zij + G[9];
    case 29: return G[3] * zij + G[10];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[1];
    case 35: return G[2];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[2];
    case 39: return G[3];
    case 40: return G[0] * zij + G[7];
    case 41: return G[0] * zij + G[7];
    case 42: return G[1] * zij + G[8];
    case 43: return G[0] * zij + G[7];
    case 44: return G[1] * zij + G[8];
    case 45: return G[2] * zij + G[9];
    case 46: return G[0] * zij + G[7];
    case 47: return G[1] * zij + G[8];
    case 48: return G[2] * zij + G[9];
    case 49: return G[3] * zij + G[10];
    case 50: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 51: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 52: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 53: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 54: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 55: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 56: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 57: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 58: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 59: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[1];
    case 63: return G[0];
    case 64: return G[1];
    case 65: return G[2];
    case 66: return G[0];
    case 67: return G[1];
    case 68: return G[2];
    case 69: return G[3];
    case 70: return G[0];
    case 71: return G[0];
    case 72: return G[1];
    case 73: return G[0];
    case 74: return G[1];
    case 75: return G[2];
    case 76: return G[0];
    case 77: return G[1];
    case 78: return G[2];
    case 79: return G[3];
    case 80: return G[0] * zij + G[7];
    case 81: return G[0] * zij + G[7];
    case 82: return G[1] * zij + G[8];
    case 83: return G[0] * zij + G[7];
    case 84: return G[1] * zij + G[8];
    case 85: return G[2] * zij + G[9];
    case 86: return G[0] * zij + G[7];
    case 87: return G[1] * zij + G[8];
    case 88: return G[2] * zij + G[9];
    case 89: return G[3] * zij + G[10];
    case 90: return G[0];
    case 91: return G[0];
    case 92: return G[1];
    case 93: return G[0];
    case 94: return G[1];
    case 95: return G[2];
    case 96: return G[0];
    case 97: return G[1];
    case 98: return G[2];
    case 99: return G[3];
    case 100: return G[0] * zij + G[7];
    case 101: return G[0] * zij + G[7];
    case 102: return G[1] * zij + G[8];
    case 103: return G[0] * zij + G[7];
    case 104: return G[1] * zij + G[8];
    case 105: return G[2] * zij + G[9];
    case 106: return G[0] * zij + G[7];
    case 107: return G[1] * zij + G[8];
    case 108: return G[2] * zij + G[9];
    case 109: return G[3] * zij + G[10];
    case 110: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 111: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 112: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 113: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 114: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 115: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 116: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 117: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 118: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 119: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 120: return G[7];
    case 121: return G[7];
    case 122: return G[8];
    case 123: return G[7];
    case 124: return G[8];
    case 125: return G[9];
    case 126: return G[7];
    case 127: return G[8];
    case 128: return G[9];
    case 129: return G[10];
    case 130: return G[7];
    case 131: return G[7];
    case 132: return G[8];
    case 133: return G[7];
    case 134: return G[8];
    case 135: return G[9];
    case 136: return G[7];
    case 137: return G[8];
    case 138: return G[9];
    case 139: return G[10];
    case 140: return G[7] * zij + G[14];
    case 141: return G[7] * zij + G[14];
    case 142: return G[8] * zij + G[15];
    case 143: return G[7] * zij + G[14];
    case 144: return G[8] * zij + G[15];
    case 145: return G[9] * zij + G[16];
    case 146: return G[7] * zij + G[14];
    case 147: return G[8] * zij + G[15];
    case 148: return G[9] * zij + G[16];
    case 149: return G[10] * zij + G[17];
    case 150: return G[7];
    case 151: return G[7];
    case 152: return G[8];
    case 153: return G[7];
    case 154: return G[8];
    case 155: return G[9];
    case 156: return G[7];
    case 157: return G[8];
    case 158: return G[9];
    case 159: return G[10];
    case 160: return G[7] * zij + G[14];
    case 161: return G[7] * zij + G[14];
    case 162: return G[8] * zij + G[15];
    case 163: return G[7] * zij + G[14];
    case 164: return G[8] * zij + G[15];
    case 165: return G[9] * zij + G[16];
    case 166: return G[7] * zij + G[14];
    case 167: return G[8] * zij + G[15];
    case 168: return G[9] * zij + G[16];
    case 169: return G[10] * zij + G[17];
    case 170: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 171: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 172: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 173: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 174: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 175: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 176: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 177: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 178: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 179: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 180: return G[0];
    case 181: return G[0];
    case 182: return G[1];
    case 183: return G[0];
    case 184: return G[1];
    case 185: return G[2];
    case 186: return G[0];
    case 187: return G[1];
    case 188: return G[2];
    case 189: return G[3];
    case 190: return G[0];
    case 191: return G[0];
    case 192: return G[1];
    case 193: return G[0];
    case 194: return G[1];
    case 195: return G[2];
    case 196: return G[0];
    case 197: return G[1];
    case 198: return G[2];
    case 199: return G[3];
    case 200: return G[0] * zij + G[7];
    case 201: return G[0] * zij + G[7];
    case 202: return G[1] * zij + G[8];
    case 203: return G[0] * zij + G[7];
    case 204: return G[1] * zij + G[8];
    case 205: return G[2] * zij + G[9];
    case 206: return G[0] * zij + G[7];
    case 207: return G[1] * zij + G[8];
    case 208: return G[2] * zij + G[9];
    case 209: return G[3] * zij + G[10];
    case 210: return G[0];
    case 211: return G[0];
    case 212: return G[1];
    case 213: return G[0];
    case 214: return G[1];
    case 215: return G[2];
    case 216: return G[0];
    case 217: return G[1];
    case 218: return G[2];
    case 219: return G[3];
    case 220: return G[0] * zij + G[7];
    case 221: return G[0] * zij + G[7];
    case 222: return G[1] * zij + G[8];
    case 223: return G[0] * zij + G[7];
    case 224: return G[1] * zij + G[8];
    case 225: return G[2] * zij + G[9];
    case 226: return G[0] * zij + G[7];
    case 227: return G[1] * zij + G[8];
    case 228: return G[2] * zij + G[9];
    case 229: return G[3] * zij + G[10];
    case 230: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 231: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 232: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 233: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 234: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 235: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 236: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 237: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 238: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 239: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 240: return G[7];
    case 241: return G[7];
    case 242: return G[8];
    case 243: return G[7];
    case 244: return G[8];
    case 245: return G[9];
    case 246: return G[7];
    case 247: return G[8];
    case 248: return G[9];
    case 249: return G[10];
    case 250: return G[7];
    case 251: return G[7];
    case 252: return G[8];
    case 253: return G[7];
    case 254: return G[8];
    case 255: return G[9];
    case 256: return G[7];
    case 257: return G[8];
    case 258: return G[9];
    case 259: return G[10];
    case 260: return G[7] * zij + G[14];
    case 261: return G[7] * zij + G[14];
    case 262: return G[8] * zij + G[15];
    case 263: return G[7] * zij + G[14];
    case 264: return G[8] * zij + G[15];
    case 265: return G[9] * zij + G[16];
    case 266: return G[7] * zij + G[14];
    case 267: return G[8] * zij + G[15];
    case 268: return G[9] * zij + G[16];
    case 269: return G[10] * zij + G[17];
    case 270: return G[7];
    case 271: return G[7];
    case 272: return G[8];
    case 273: return G[7];
    case 274: return G[8];
    case 275: return G[9];
    case 276: return G[7];
    case 277: return G[8];
    case 278: return G[9];
    case 279: return G[10];
    case 280: return G[7] * zij + G[14];
    case 281: return G[7] * zij + G[14];
    case 282: return G[8] * zij + G[15];
    case 283: return G[7] * zij + G[14];
    case 284: return G[8] * zij + G[15];
    case 285: return G[9] * zij + G[16];
    case 286: return G[7] * zij + G[14];
    case 287: return G[8] * zij + G[15];
    case 288: return G[9] * zij + G[16];
    case 289: return G[10] * zij + G[17];
    case 290: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 291: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 292: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 293: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 294: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 295: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 296: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 297: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 298: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 299: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 300: return G[14];
    case 301: return G[14];
    case 302: return G[15];
    case 303: return G[14];
    case 304: return G[15];
    case 305: return G[16];
    case 306: return G[14];
    case 307: return G[15];
    case 308: return G[16];
    case 309: return G[17];
    case 310: return G[14];
    case 311: return G[14];
    case 312: return G[15];
    case 313: return G[14];
    case 314: return G[15];
    case 315: return G[16];
    case 316: return G[14];
    case 317: return G[15];
    case 318: return G[16];
    case 319: return G[17];
    case 320: return G[14] * zij + G[21];
    case 321: return G[14] * zij + G[21];
    case 322: return G[15] * zij + G[22];
    case 323: return G[14] * zij + G[21];
    case 324: return G[15] * zij + G[22];
    case 325: return G[16] * zij + G[23];
    case 326: return G[14] * zij + G[21];
    case 327: return G[15] * zij + G[22];
    case 328: return G[16] * zij + G[23];
    case 329: return G[17] * zij + G[24];
    case 330: return G[14];
    case 331: return G[14];
    case 332: return G[15];
    case 333: return G[14];
    case 334: return G[15];
    case 335: return G[16];
    case 336: return G[14];
    case 337: return G[15];
    case 338: return G[16];
    case 339: return G[17];
    case 340: return G[14] * zij + G[21];
    case 341: return G[14] * zij + G[21];
    case 342: return G[15] * zij + G[22];
    case 343: return G[14] * zij + G[21];
    case 344: return G[15] * zij + G[22];
    case 345: return G[16] * zij + G[23];
    case 346: return G[14] * zij + G[21];
    case 347: return G[15] * zij + G[22];
    case 348: return G[16] * zij + G[23];
    case 349: return G[17] * zij + G[24];
    case 350: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 351: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 352: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 353: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 354: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 355: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 356: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 357: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 358: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 359: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 360: return G[0];
    case 361: return G[0];
    case 362: return G[1];
    case 363: return G[0];
    case 364: return G[1];
    case 365: return G[2];
    case 366: return G[0];
    case 367: return G[1];
    case 368: return G[2];
    case 369: return G[3];
    case 370: return G[0];
    case 371: return G[0];
    case 372: return G[1];
    case 373: return G[0];
    case 374: return G[1];
    case 375: return G[2];
    case 376: return G[0];
    case 377: return G[1];
    case 378: return G[2];
    case 379: return G[3];
    case 380: return G[0] * zij + G[7];
    case 381: return G[0] * zij + G[7];
    case 382: return G[1] * zij + G[8];
    case 383: return G[0] * zij + G[7];
    case 384: return G[1] * zij + G[8];
    case 385: return G[2] * zij + G[9];
    case 386: return G[0] * zij + G[7];
    case 387: return G[1] * zij + G[8];
    case 388: return G[2] * zij + G[9];
    case 389: return G[3] * zij + G[10];
    case 390: return G[0];
    case 391: return G[0];
    case 392: return G[1];
    case 393: return G[0];
    case 394: return G[1];
    case 395: return G[2];
    case 396: return G[0];
    case 397: return G[1];
    case 398: return G[2];
    case 399: return G[3];
    case 400: return G[0] * zij + G[7];
    case 401: return G[0] * zij + G[7];
    case 402: return G[1] * zij + G[8];
    case 403: return G[0] * zij + G[7];
    case 404: return G[1] * zij + G[8];
    case 405: return G[2] * zij + G[9];
    case 406: return G[0] * zij + G[7];
    case 407: return G[1] * zij + G[8];
    case 408: return G[2] * zij + G[9];
    case 409: return G[3] * zij + G[10];
    case 410: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 411: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 412: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 413: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 414: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 415: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 416: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 417: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 418: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 419: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 420: return G[7];
    case 421: return G[7];
    case 422: return G[8];
    case 423: return G[7];
    case 424: return G[8];
    case 425: return G[9];
    case 426: return G[7];
    case 427: return G[8];
    case 428: return G[9];
    case 429: return G[10];
    case 430: return G[7];
    case 431: return G[7];
    case 432: return G[8];
    case 433: return G[7];
    case 434: return G[8];
    case 435: return G[9];
    case 436: return G[7];
    case 437: return G[8];
    case 438: return G[9];
    case 439: return G[10];
    case 440: return G[7] * zij + G[14];
    case 441: return G[7] * zij + G[14];
    case 442: return G[8] * zij + G[15];
    case 443: return G[7] * zij + G[14];
    case 444: return G[8] * zij + G[15];
    case 445: return G[9] * zij + G[16];
    case 446: return G[7] * zij + G[14];
    case 447: return G[8] * zij + G[15];
    case 448: return G[9] * zij + G[16];
    case 449: return G[10] * zij + G[17];
    case 450: return G[7];
    case 451: return G[7];
    case 452: return G[8];
    case 453: return G[7];
    case 454: return G[8];
    case 455: return G[9];
    case 456: return G[7];
    case 457: return G[8];
    case 458: return G[9];
    case 459: return G[10];
    case 460: return G[7] * zij + G[14];
    case 461: return G[7] * zij + G[14];
    case 462: return G[8] * zij + G[15];
    case 463: return G[7] * zij + G[14];
    case 464: return G[8] * zij + G[15];
    case 465: return G[9] * zij + G[16];
    case 466: return G[7] * zij + G[14];
    case 467: return G[8] * zij + G[15];
    case 468: return G[9] * zij + G[16];
    case 469: return G[10] * zij + G[17];
    case 470: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 471: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 472: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 473: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 474: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 475: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 476: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 477: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 478: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 479: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 480: return G[14];
    case 481: return G[14];
    case 482: return G[15];
    case 483: return G[14];
    case 484: return G[15];
    case 485: return G[16];
    case 486: return G[14];
    case 487: return G[15];
    case 488: return G[16];
    case 489: return G[17];
    case 490: return G[14];
    case 491: return G[14];
    case 492: return G[15];
    case 493: return G[14];
    case 494: return G[15];
    case 495: return G[16];
    case 496: return G[14];
    case 497: return G[15];
    case 498: return G[16];
    case 499: return G[17];
    case 500: return G[14] * zij + G[21];
    case 501: return G[14] * zij + G[21];
    case 502: return G[15] * zij + G[22];
    case 503: return G[14] * zij + G[21];
    case 504: return G[15] * zij + G[22];
    case 505: return G[16] * zij + G[23];
    case 506: return G[14] * zij + G[21];
    case 507: return G[15] * zij + G[22];
    case 508: return G[16] * zij + G[23];
    case 509: return G[17] * zij + G[24];
    case 510: return G[14];
    case 511: return G[14];
    case 512: return G[15];
    case 513: return G[14];
    case 514: return G[15];
    case 515: return G[16];
    case 516: return G[14];
    case 517: return G[15];
    case 518: return G[16];
    case 519: return G[17];
    case 520: return G[14] * zij + G[21];
    case 521: return G[14] * zij + G[21];
    case 522: return G[15] * zij + G[22];
    case 523: return G[14] * zij + G[21];
    case 524: return G[15] * zij + G[22];
    case 525: return G[16] * zij + G[23];
    case 526: return G[14] * zij + G[21];
    case 527: return G[15] * zij + G[22];
    case 528: return G[16] * zij + G[23];
    case 529: return G[17] * zij + G[24];
    case 530: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 531: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 532: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 533: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 534: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 535: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 536: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 537: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 538: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 539: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 540: return G[21];
    case 541: return G[21];
    case 542: return G[22];
    case 543: return G[21];
    case 544: return G[22];
    case 545: return G[23];
    case 546: return G[21];
    case 547: return G[22];
    case 548: return G[23];
    case 549: return G[24];
    case 550: return G[21];
    case 551: return G[21];
    case 552: return G[22];
    case 553: return G[21];
    case 554: return G[22];
    case 555: return G[23];
    case 556: return G[21];
    case 557: return G[22];
    case 558: return G[23];
    case 559: return G[24];
    case 560: return G[21] * zij + G[28];
    case 561: return G[21] * zij + G[28];
    case 562: return G[22] * zij + G[29];
    case 563: return G[21] * zij + G[28];
    case 564: return G[22] * zij + G[29];
    case 565: return G[23] * zij + G[30];
    case 566: return G[21] * zij + G[28];
    case 567: return G[22] * zij + G[29];
    case 568: return G[23] * zij + G[30];
    case 569: return G[24] * zij + G[31];
    case 570: return G[21];
    case 571: return G[21];
    case 572: return G[22];
    case 573: return G[21];
    case 574: return G[22];
    case 575: return G[23];
    case 576: return G[21];
    case 577: return G[22];
    case 578: return G[23];
    case 579: return G[24];
    case 580: return G[21] * zij + G[28];
    case 581: return G[21] * zij + G[28];
    case 582: return G[22] * zij + G[29];
    case 583: return G[21] * zij + G[28];
    case 584: return G[22] * zij + G[29];
    case 585: return G[23] * zij + G[30];
    case 586: return G[21] * zij + G[28];
    case 587: return G[22] * zij + G[29];
    case 588: return G[23] * zij + G[30];
    case 589: return G[24] * zij + G[31];
    case 590: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 591: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 592: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 593: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 594: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 595: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 596: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 597: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 598: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 599: return G[24] * zij2 + 2.0 * (G[31] * zij) + G[38];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fdfs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 600;
  constexpr int kNMax = 5;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fdfs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fdfs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fdfs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fffs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[24] * pow(xij, 3) + 3.0 * (G[31] * xij2) + 3.0 * (G[38] * xij) + G[45];
    case 1: return G[23] * pow(xij, 3) + 3.0 * (G[30] * xij2) + 3.0 * (G[37] * xij) + G[44];
    case 2: return G[23] * pow(xij, 3) + 3.0 * (G[30] * xij2) + 3.0 * (G[37] * xij) + G[44];
    case 3: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 4: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 5: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 6: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 7: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 8: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 9: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 10: return G[24] * xij2 + 2.0 * (G[31] * xij) + G[38];
    case 11: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 12: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 13: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 14: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 15: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 16: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 17: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 18: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 19: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 20: return G[24] * xij2 + 2.0 * (G[31] * xij) + G[38];
    case 21: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 22: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 23: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 24: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 25: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 26: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 27: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 28: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 29: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 30: return G[24] * xij + G[31];
    case 31: return G[23] * xij + G[30];
    case 32: return G[23] * xij + G[30];
    case 33: return G[22] * xij + G[29];
    case 34: return G[22] * xij + G[29];
    case 35: return G[22] * xij + G[29];
    case 36: return G[21] * xij + G[28];
    case 37: return G[21] * xij + G[28];
    case 38: return G[21] * xij + G[28];
    case 39: return G[21] * xij + G[28];
    case 40: return G[24] * xij + G[31];
    case 41: return G[23] * xij + G[30];
    case 42: return G[23] * xij + G[30];
    case 43: return G[22] * xij + G[29];
    case 44: return G[22] * xij + G[29];
    case 45: return G[22] * xij + G[29];
    case 46: return G[21] * xij + G[28];
    case 47: return G[21] * xij + G[28];
    case 48: return G[21] * xij + G[28];
    case 49: return G[21] * xij + G[28];
    case 50: return G[24] * xij + G[31];
    case 51: return G[23] * xij + G[30];
    case 52: return G[23] * xij + G[30];
    case 53: return G[22] * xij + G[29];
    case 54: return G[22] * xij + G[29];
    case 55: return G[22] * xij + G[29];
    case 56: return G[21] * xij + G[28];
    case 57: return G[21] * xij + G[28];
    case 58: return G[21] * xij + G[28];
    case 59: return G[21] * xij + G[28];
    case 60: return G[24];
    case 61: return G[23];
    case 62: return G[23];
    case 63: return G[22];
    case 64: return G[22];
    case 65: return G[22];
    case 66: return G[21];
    case 67: return G[21];
    case 68: return G[21];
    case 69: return G[21];
    case 70: return G[24];
    case 71: return G[23];
    case 72: return G[23];
    case 73: return G[22];
    case 74: return G[22];
    case 75: return G[22];
    case 76: return G[21];
    case 77: return G[21];
    case 78: return G[21];
    case 79: return G[21];
    case 80: return G[24];
    case 81: return G[23];
    case 82: return G[23];
    case 83: return G[22];
    case 84: return G[22];
    case 85: return G[22];
    case 86: return G[21];
    case 87: return G[21];
    case 88: return G[21];
    case 89: return G[21];
    case 90: return G[24];
    case 91: return G[23];
    case 92: return G[23];
    case 93: return G[22];
    case 94: return G[22];
    case 95: return G[22];
    case 96: return G[21];
    case 97: return G[21];
    case 98: return G[21];
    case 99: return G[21];
    case 100: return G[17] * pow(xij, 3) + 3.0 * (G[24] * xij2) + 3.0 * (G[31] * xij) + G[38];
    case 101: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 102: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 103: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 104: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 105: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 106: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 107: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 108: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 109: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 110: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 111: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 112: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 113: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 114: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 115: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 116: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 117: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 118: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 119: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 120: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 121: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 122: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 123: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 124: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 125: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 126: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 127: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 128: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 129: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 130: return G[17] * xij + G[24];
    case 131: return G[16] * xij + G[23];
    case 132: return G[16] * xij + G[23];
    case 133: return G[15] * xij + G[22];
    case 134: return G[15] * xij + G[22];
    case 135: return G[15] * xij + G[22];
    case 136: return G[14] * xij + G[21];
    case 137: return G[14] * xij + G[21];
    case 138: return G[14] * xij + G[21];
    case 139: return G[14] * xij + G[21];
    case 140: return G[17] * xij + G[24];
    case 141: return G[16] * xij + G[23];
    case 142: return G[16] * xij + G[23];
    case 143: return G[15] * xij + G[22];
    case 144: return G[15] * xij + G[22];
    case 145: return G[15] * xij + G[22];
    case 146: return G[14] * xij + G[21];
    case 147: return G[14] * xij + G[21];
    case 148: return G[14] * xij + G[21];
    case 149: return G[14] * xij + G[21];
    case 150: return G[17] * xij + G[24];
    case 151: return G[16] * xij + G[23];
    case 152: return G[16] * xij + G[23];
    case 153: return G[15] * xij + G[22];
    case 154: return G[15] * xij + G[22];
    case 155: return G[15] * xij + G[22];
    case 156: return G[14] * xij + G[21];
    case 157: return G[14] * xij + G[21];
    case 158: return G[14] * xij + G[21];
    case 159: return G[14] * xij + G[21];
    case 160: return G[17];
    case 161: return G[16];
    case 162: return G[16];
    case 163: return G[15];
    case 164: return G[15];
    case 165: return G[15];
    case 166: return G[14];
    case 167: return G[14];
    case 168: return G[14];
    case 169: return G[14];
    case 170: return G[17];
    case 171: return G[16];
    case 172: return G[16];
    case 173: return G[15];
    case 174: return G[15];
    case 175: return G[15];
    case 176: return G[14];
    case 177: return G[14];
    case 178: return G[14];
    case 179: return G[14];
    case 180: return G[17];
    case 181: return G[16];
    case 182: return G[16];
    case 183: return G[15];
    case 184: return G[15];
    case 185: return G[15];
    case 186: return G[14];
    case 187: return G[14];
    case 188: return G[14];
    case 189: return G[14];
    case 190: return G[17];
    case 191: return G[16];
    case 192: return G[16];
    case 193: return G[15];
    case 194: return G[15];
    case 195: return G[15];
    case 196: return G[14];
    case 197: return G[14];
    case 198: return G[14];
    case 199: return G[14];
    case 200: return G[17] * pow(xij, 3) + 3.0 * (G[24] * xij2) + 3.0 * (G[31] * xij) + G[38];
    case 201: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 202: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 203: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 204: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 205: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 206: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 207: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 208: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 209: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 210: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 211: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 212: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 213: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 214: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 215: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 216: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 217: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 218: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 219: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 220: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 221: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 222: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 223: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 224: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 225: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 226: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 227: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 228: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 229: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 230: return G[17] * xij + G[24];
    case 231: return G[16] * xij + G[23];
    case 232: return G[16] * xij + G[23];
    case 233: return G[15] * xij + G[22];
    case 234: return G[15] * xij + G[22];
    case 235: return G[15] * xij + G[22];
    case 236: return G[14] * xij + G[21];
    case 237: return G[14] * xij + G[21];
    case 238: return G[14] * xij + G[21];
    case 239: return G[14] * xij + G[21];
    case 240: return G[17] * xij + G[24];
    case 241: return G[16] * xij + G[23];
    case 242: return G[16] * xij + G[23];
    case 243: return G[15] * xij + G[22];
    case 244: return G[15] * xij + G[22];
    case 245: return G[15] * xij + G[22];
    case 246: return G[14] * xij + G[21];
    case 247: return G[14] * xij + G[21];
    case 248: return G[14] * xij + G[21];
    case 249: return G[14] * xij + G[21];
    case 250: return G[17] * xij + G[24];
    case 251: return G[16] * xij + G[23];
    case 252: return G[16] * xij + G[23];
    case 253: return G[15] * xij + G[22];
    case 254: return G[15] * xij + G[22];
    case 255: return G[15] * xij + G[22];
    case 256: return G[14] * xij + G[21];
    case 257: return G[14] * xij + G[21];
    case 258: return G[14] * xij + G[21];
    case 259: return G[14] * xij + G[21];
    case 260: return G[17];
    case 261: return G[16];
    case 262: return G[16];
    case 263: return G[15];
    case 264: return G[15];
    case 265: return G[15];
    case 266: return G[14];
    case 267: return G[14];
    case 268: return G[14];
    case 269: return G[14];
    case 270: return G[17];
    case 271: return G[16];
    case 272: return G[16];
    case 273: return G[15];
    case 274: return G[15];
    case 275: return G[15];
    case 276: return G[14];
    case 277: return G[14];
    case 278: return G[14];
    case 279: return G[14];
    case 280: return G[17];
    case 281: return G[16];
    case 282: return G[16];
    case 283: return G[15];
    case 284: return G[15];
    case 285: return G[15];
    case 286: return G[14];
    case 287: return G[14];
    case 288: return G[14];
    case 289: return G[14];
    case 290: return G[17];
    case 291: return G[16];
    case 292: return G[16];
    case 293: return G[15];
    case 294: return G[15];
    case 295: return G[15];
    case 296: return G[14];
    case 297: return G[14];
    case 298: return G[14];
    case 299: return G[14];
    case 300: return G[10] * pow(xij, 3) + 3.0 * (G[17] * xij2) + 3.0 * (G[24] * xij) + G[31];
    case 301: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 302: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 303: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 304: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 305: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 306: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 307: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 308: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 309: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 310: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 311: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 312: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 313: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 314: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 315: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 316: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 317: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 318: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 319: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 320: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 321: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 322: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 323: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 324: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 325: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 326: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 327: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 328: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 329: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 330: return G[10] * xij + G[17];
    case 331: return G[9] * xij + G[16];
    case 332: return G[9] * xij + G[16];
    case 333: return G[8] * xij + G[15];
    case 334: return G[8] * xij + G[15];
    case 335: return G[8] * xij + G[15];
    case 336: return G[7] * xij + G[14];
    case 337: return G[7] * xij + G[14];
    case 338: return G[7] * xij + G[14];
    case 339: return G[7] * xij + G[14];
    case 340: return G[10] * xij + G[17];
    case 341: return G[9] * xij + G[16];
    case 342: return G[9] * xij + G[16];
    case 343: return G[8] * xij + G[15];
    case 344: return G[8] * xij + G[15];
    case 345: return G[8] * xij + G[15];
    case 346: return G[7] * xij + G[14];
    case 347: return G[7] * xij + G[14];
    case 348: return G[7] * xij + G[14];
    case 349: return G[7] * xij + G[14];
    case 350: return G[10] * xij + G[17];
    case 351: return G[9] * xij + G[16];
    case 352: return G[9] * xij + G[16];
    case 353: return G[8] * xij + G[15];
    case 354: return G[8] * xij + G[15];
    case 355: return G[8] * xij + G[15];
    case 356: return G[7] * xij + G[14];
    case 357: return G[7] * xij + G[14];
    case 358: return G[7] * xij + G[14];
    case 359: return G[7] * xij + G[14];
    case 360: return G[10];
    case 361: return G[9];
    case 362: return G[9];
    case 363: return G[8];
    case 364: return G[8];
    case 365: return G[8];
    case 366: return G[7];
    case 367: return G[7];
    case 368: return G[7];
    case 369: return G[7];
    case 370: return G[10];
    case 371: return G[9];
    case 372: return G[9];
    case 373: return G[8];
    case 374: return G[8];
    case 375: return G[8];
    case 376: return G[7];
    case 377: return G[7];
    case 378: return G[7];
    case 379: return G[7];
    case 380: return G[10];
    case 381: return G[9];
    case 382: return G[9];
    case 383: return G[8];
    case 384: return G[8];
    case 385: return G[8];
    case 386: return G[7];
    case 387: return G[7];
    case 388: return G[7];
    case 389: return G[7];
    case 390: return G[10];
    case 391: return G[9];
    case 392: return G[9];
    case 393: return G[8];
    case 394: return G[8];
    case 395: return G[8];
    case 396: return G[7];
    case 397: return G[7];
    case 398: return G[7];
    case 399: return G[7];
    case 400: return G[10] * pow(xij, 3) + 3.0 * (G[17] * xij2) + 3.0 * (G[24] * xij) + G[31];
    case 401: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 402: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 403: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 404: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 405: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 406: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 407: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 408: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 409: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 410: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 411: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 412: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 413: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 414: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 415: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 416: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 417: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 418: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 419: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 420: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 421: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 422: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 423: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 424: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 425: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 426: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 427: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 428: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 429: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 430: return G[10] * xij + G[17];
    case 431: return G[9] * xij + G[16];
    case 432: return G[9] * xij + G[16];
    case 433: return G[8] * xij + G[15];
    case 434: return G[8] * xij + G[15];
    case 435: return G[8] * xij + G[15];
    case 436: return G[7] * xij + G[14];
    case 437: return G[7] * xij + G[14];
    case 438: return G[7] * xij + G[14];
    case 439: return G[7] * xij + G[14];
    case 440: return G[10] * xij + G[17];
    case 441: return G[9] * xij + G[16];
    case 442: return G[9] * xij + G[16];
    case 443: return G[8] * xij + G[15];
    case 444: return G[8] * xij + G[15];
    case 445: return G[8] * xij + G[15];
    case 446: return G[7] * xij + G[14];
    case 447: return G[7] * xij + G[14];
    case 448: return G[7] * xij + G[14];
    case 449: return G[7] * xij + G[14];
    case 450: return G[10] * xij + G[17];
    case 451: return G[9] * xij + G[16];
    case 452: return G[9] * xij + G[16];
    case 453: return G[8] * xij + G[15];
    case 454: return G[8] * xij + G[15];
    case 455: return G[8] * xij + G[15];
    case 456: return G[7] * xij + G[14];
    case 457: return G[7] * xij + G[14];
    case 458: return G[7] * xij + G[14];
    case 459: return G[7] * xij + G[14];
    case 460: return G[10];
    case 461: return G[9];
    case 462: return G[9];
    case 463: return G[8];
    case 464: return G[8];
    case 465: return G[8];
    case 466: return G[7];
    case 467: return G[7];
    case 468: return G[7];
    case 469: return G[7];
    case 470: return G[10];
    case 471: return G[9];
    case 472: return G[9];
    case 473: return G[8];
    case 474: return G[8];
    case 475: return G[8];
    case 476: return G[7];
    case 477: return G[7];
    case 478: return G[7];
    case 479: return G[7];
    case 480: return G[10];
    case 481: return G[9];
    case 482: return G[9];
    case 483: return G[8];
    case 484: return G[8];
    case 485: return G[8];
    case 486: return G[7];
    case 487: return G[7];
    case 488: return G[7];
    case 489: return G[7];
    case 490: return G[10];
    case 491: return G[9];
    case 492: return G[9];
    case 493: return G[8];
    case 494: return G[8];
    case 495: return G[8];
    case 496: return G[7];
    case 497: return G[7];
    case 498: return G[7];
    case 499: return G[7];
    case 500: return G[10] * pow(xij, 3) + 3.0 * (G[17] * xij2) + 3.0 * (G[24] * xij) + G[31];
    case 501: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 502: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 503: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 504: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 505: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 506: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 507: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 508: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 509: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 510: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 511: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 512: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 513: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 514: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 515: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 516: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 517: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 518: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 519: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 520: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 521: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 522: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 523: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 524: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 525: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 526: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 527: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 528: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 529: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 530: return G[10] * xij + G[17];
    case 531: return G[9] * xij + G[16];
    case 532: return G[9] * xij + G[16];
    case 533: return G[8] * xij + G[15];
    case 534: return G[8] * xij + G[15];
    case 535: return G[8] * xij + G[15];
    case 536: return G[7] * xij + G[14];
    case 537: return G[7] * xij + G[14];
    case 538: return G[7] * xij + G[14];
    case 539: return G[7] * xij + G[14];
    case 540: return G[10] * xij + G[17];
    case 541: return G[9] * xij + G[16];
    case 542: return G[9] * xij + G[16];
    case 543: return G[8] * xij + G[15];
    case 544: return G[8] * xij + G[15];
    case 545: return G[8] * xij + G[15];
    case 546: return G[7] * xij + G[14];
    case 547: return G[7] * xij + G[14];
    case 548: return G[7] * xij + G[14];
    case 549: return G[7] * xij + G[14];
    case 550: return G[10] * xij + G[17];
    case 551: return G[9] * xij + G[16];
    case 552: return G[9] * xij + G[16];
    case 553: return G[8] * xij + G[15];
    case 554: return G[8] * xij + G[15];
    case 555: return G[8] * xij + G[15];
    case 556: return G[7] * xij + G[14];
    case 557: return G[7] * xij + G[14];
    case 558: return G[7] * xij + G[14];
    case 559: return G[7] * xij + G[14];
    case 560: return G[10];
    case 561: return G[9];
    case 562: return G[9];
    case 563: return G[8];
    case 564: return G[8];
    case 565: return G[8];
    case 566: return G[7];
    case 567: return G[7];
    case 568: return G[7];
    case 569: return G[7];
    case 570: return G[10];
    case 571: return G[9];
    case 572: return G[9];
    case 573: return G[8];
    case 574: return G[8];
    case 575: return G[8];
    case 576: return G[7];
    case 577: return G[7];
    case 578: return G[7];
    case 579: return G[7];
    case 580: return G[10];
    case 581: return G[9];
    case 582: return G[9];
    case 583: return G[8];
    case 584: return G[8];
    case 585: return G[8];
    case 586: return G[7];
    case 587: return G[7];
    case 588: return G[7];
    case 589: return G[7];
    case 590: return G[10];
    case 591: return G[9];
    case 592: return G[9];
    case 593: return G[8];
    case 594: return G[8];
    case 595: return G[8];
    case 596: return G[7];
    case 597: return G[7];
    case 598: return G[7];
    case 599: return G[7];
    case 600: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 601: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 602: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 603: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 604: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 605: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 606: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 607: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 608: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 609: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 610: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 611: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 612: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 613: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 614: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 615: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 616: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 617: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 618: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 619: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 620: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 621: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 622: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 623: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 624: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 625: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 626: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 627: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 628: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 629: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 630: return G[3] * xij + G[10];
    case 631: return G[2] * xij + G[9];
    case 632: return G[2] * xij + G[9];
    case 633: return G[1] * xij + G[8];
    case 634: return G[1] * xij + G[8];
    case 635: return G[1] * xij + G[8];
    case 636: return G[0] * xij + G[7];
    case 637: return G[0] * xij + G[7];
    case 638: return G[0] * xij + G[7];
    case 639: return G[0] * xij + G[7];
    case 640: return G[3] * xij + G[10];
    case 641: return G[2] * xij + G[9];
    case 642: return G[2] * xij + G[9];
    case 643: return G[1] * xij + G[8];
    case 644: return G[1] * xij + G[8];
    case 645: return G[1] * xij + G[8];
    case 646: return G[0] * xij + G[7];
    case 647: return G[0] * xij + G[7];
    case 648: return G[0] * xij + G[7];
    case 649: return G[0] * xij + G[7];
    case 650: return G[3] * xij + G[10];
    case 651: return G[2] * xij + G[9];
    case 652: return G[2] * xij + G[9];
    case 653: return G[1] * xij + G[8];
    case 654: return G[1] * xij + G[8];
    case 655: return G[1] * xij + G[8];
    case 656: return G[0] * xij + G[7];
    case 657: return G[0] * xij + G[7];
    case 658: return G[0] * xij + G[7];
    case 659: return G[0] * xij + G[7];
    case 660: return G[3];
    case 661: return G[2];
    case 662: return G[2];
    case 663: return G[1];
    case 664: return G[1];
    case 665: return G[1];
    case 666: return G[0];
    case 667: return G[0];
    case 668: return G[0];
    case 669: return G[0];
    case 670: return G[3];
    case 671: return G[2];
    case 672: return G[2];
    case 673: return G[1];
    case 674: return G[1];
    case 675: return G[1];
    case 676: return G[0];
    case 677: return G[0];
    case 678: return G[0];
    case 679: return G[0];
    case 680: return G[3];
    case 681: return G[2];
    case 682: return G[2];
    case 683: return G[1];
    case 684: return G[1];
    case 685: return G[1];
    case 686: return G[0];
    case 687: return G[0];
    case 688: return G[0];
    case 689: return G[0];
    case 690: return G[3];
    case 691: return G[2];
    case 692: return G[2];
    case 693: return G[1];
    case 694: return G[1];
    case 695: return G[1];
    case 696: return G[0];
    case 697: return G[0];
    case 698: return G[0];
    case 699: return G[0];
    case 700: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 701: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 702: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 703: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 704: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 705: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 706: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 707: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 708: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 709: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 710: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 711: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 712: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 713: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 714: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 715: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 716: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 717: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 718: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 719: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 720: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 721: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 722: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 723: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 724: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 725: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 726: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 727: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 728: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 729: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 730: return G[3] * xij + G[10];
    case 731: return G[2] * xij + G[9];
    case 732: return G[2] * xij + G[9];
    case 733: return G[1] * xij + G[8];
    case 734: return G[1] * xij + G[8];
    case 735: return G[1] * xij + G[8];
    case 736: return G[0] * xij + G[7];
    case 737: return G[0] * xij + G[7];
    case 738: return G[0] * xij + G[7];
    case 739: return G[0] * xij + G[7];
    case 740: return G[3] * xij + G[10];
    case 741: return G[2] * xij + G[9];
    case 742: return G[2] * xij + G[9];
    case 743: return G[1] * xij + G[8];
    case 744: return G[1] * xij + G[8];
    case 745: return G[1] * xij + G[8];
    case 746: return G[0] * xij + G[7];
    case 747: return G[0] * xij + G[7];
    case 748: return G[0] * xij + G[7];
    case 749: return G[0] * xij + G[7];
    case 750: return G[3] * xij + G[10];
    case 751: return G[2] * xij + G[9];
    case 752: return G[2] * xij + G[9];
    case 753: return G[1] * xij + G[8];
    case 754: return G[1] * xij + G[8];
    case 755: return G[1] * xij + G[8];
    case 756: return G[0] * xij + G[7];
    case 757: return G[0] * xij + G[7];
    case 758: return G[0] * xij + G[7];
    case 759: return G[0] * xij + G[7];
    case 760: return G[3];
    case 761: return G[2];
    case 762: return G[2];
    case 763: return G[1];
    case 764: return G[1];
    case 765: return G[1];
    case 766: return G[0];
    case 767: return G[0];
    case 768: return G[0];
    case 769: return G[0];
    case 770: return G[3];
    case 771: return G[2];
    case 772: return G[2];
    case 773: return G[1];
    case 774: return G[1];
    case 775: return G[1];
    case 776: return G[0];
    case 777: return G[0];
    case 778: return G[0];
    case 779: return G[0];
    case 780: return G[3];
    case 781: return G[2];
    case 782: return G[2];
    case 783: return G[1];
    case 784: return G[1];
    case 785: return G[1];
    case 786: return G[0];
    case 787: return G[0];
    case 788: return G[0];
    case 789: return G[0];
    case 790: return G[3];
    case 791: return G[2];
    case 792: return G[2];
    case 793: return G[1];
    case 794: return G[1];
    case 795: return G[1];
    case 796: return G[0];
    case 797: return G[0];
    case 798: return G[0];
    case 799: return G[0];
    case 800: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 801: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 802: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 803: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 804: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 805: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 806: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 807: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 808: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 809: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 810: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 811: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 812: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 813: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 814: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 815: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 816: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 817: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 818: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 819: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 820: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 821: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 822: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 823: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 824: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 825: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 826: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 827: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 828: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 829: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 830: return G[3] * xij + G[10];
    case 831: return G[2] * xij + G[9];
    case 832: return G[2] * xij + G[9];
    case 833: return G[1] * xij + G[8];
    case 834: return G[1] * xij + G[8];
    case 835: return G[1] * xij + G[8];
    case 836: return G[0] * xij + G[7];
    case 837: return G[0] * xij + G[7];
    case 838: return G[0] * xij + G[7];
    case 839: return G[0] * xij + G[7];
    case 840: return G[3] * xij + G[10];
    case 841: return G[2] * xij + G[9];
    case 842: return G[2] * xij + G[9];
    case 843: return G[1] * xij + G[8];
    case 844: return G[1] * xij + G[8];
    case 845: return G[1] * xij + G[8];
    case 846: return G[0] * xij + G[7];
    case 847: return G[0] * xij + G[7];
    case 848: return G[0] * xij + G[7];
    case 849: return G[0] * xij + G[7];
    case 850: return G[3] * xij + G[10];
    case 851: return G[2] * xij + G[9];
    case 852: return G[2] * xij + G[9];
    case 853: return G[1] * xij + G[8];
    case 854: return G[1] * xij + G[8];
    case 855: return G[1] * xij + G[8];
    case 856: return G[0] * xij + G[7];
    case 857: return G[0] * xij + G[7];
    case 858: return G[0] * xij + G[7];
    case 859: return G[0] * xij + G[7];
    case 860: return G[3];
    case 861: return G[2];
    case 862: return G[2];
    case 863: return G[1];
    case 864: return G[1];
    case 865: return G[1];
    case 866: return G[0];
    case 867: return G[0];
    case 868: return G[0];
    case 869: return G[0];
    case 870: return G[3];
    case 871: return G[2];
    case 872: return G[2];
    case 873: return G[1];
    case 874: return G[1];
    case 875: return G[1];
    case 876: return G[0];
    case 877: return G[0];
    case 878: return G[0];
    case 879: return G[0];
    case 880: return G[3];
    case 881: return G[2];
    case 882: return G[2];
    case 883: return G[1];
    case 884: return G[1];
    case 885: return G[1];
    case 886: return G[0];
    case 887: return G[0];
    case 888: return G[0];
    case 889: return G[0];
    case 890: return G[3];
    case 891: return G[2];
    case 892: return G[2];
    case 893: return G[1];
    case 894: return G[1];
    case 895: return G[1];
    case 896: return G[0];
    case 897: return G[0];
    case 898: return G[0];
    case 899: return G[0];
    case 900: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 901: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 902: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 903: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 904: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 905: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 906: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 907: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 908: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 909: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 910: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 911: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 912: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 913: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 914: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 915: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 916: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 917: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 918: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 919: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 920: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 921: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 922: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 923: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 924: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 925: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 926: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 927: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 928: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 929: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 930: return G[3] * xij + G[10];
    case 931: return G[2] * xij + G[9];
    case 932: return G[2] * xij + G[9];
    case 933: return G[1] * xij + G[8];
    case 934: return G[1] * xij + G[8];
    case 935: return G[1] * xij + G[8];
    case 936: return G[0] * xij + G[7];
    case 937: return G[0] * xij + G[7];
    case 938: return G[0] * xij + G[7];
    case 939: return G[0] * xij + G[7];
    case 940: return G[3] * xij + G[10];
    case 941: return G[2] * xij + G[9];
    case 942: return G[2] * xij + G[9];
    case 943: return G[1] * xij + G[8];
    case 944: return G[1] * xij + G[8];
    case 945: return G[1] * xij + G[8];
    case 946: return G[0] * xij + G[7];
    case 947: return G[0] * xij + G[7];
    case 948: return G[0] * xij + G[7];
    case 949: return G[0] * xij + G[7];
    case 950: return G[3] * xij + G[10];
    case 951: return G[2] * xij + G[9];
    case 952: return G[2] * xij + G[9];
    case 953: return G[1] * xij + G[8];
    case 954: return G[1] * xij + G[8];
    case 955: return G[1] * xij + G[8];
    case 956: return G[0] * xij + G[7];
    case 957: return G[0] * xij + G[7];
    case 958: return G[0] * xij + G[7];
    case 959: return G[0] * xij + G[7];
    case 960: return G[3];
    case 961: return G[2];
    case 962: return G[2];
    case 963: return G[1];
    case 964: return G[1];
    case 965: return G[1];
    case 966: return G[0];
    case 967: return G[0];
    case 968: return G[0];
    case 969: return G[0];
    case 970: return G[3];
    case 971: return G[2];
    case 972: return G[2];
    case 973: return G[1];
    case 974: return G[1];
    case 975: return G[1];
    case 976: return G[0];
    case 977: return G[0];
    case 978: return G[0];
    case 979: return G[0];
    case 980: return G[3];
    case 981: return G[2];
    case 982: return G[2];
    case 983: return G[1];
    case 984: return G[1];
    case 985: return G[1];
    case 986: return G[0];
    case 987: return G[0];
    case 988: return G[0];
    case 989: return G[0];
    case 990: return G[3];
    case 991: return G[2];
    case 992: return G[2];
    case 993: return G[1];
    case 994: return G[1];
    case 995: return G[1];
    case 996: return G[0];
    case 997: return G[0];
    case 998: return G[0];
    case 999: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fffs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[0] * yij + G[7];
    case 11: return G[1] * yij + G[8];
    case 12: return G[0] * yij + G[7];
    case 13: return G[2] * yij + G[9];
    case 14: return G[1] * yij + G[8];
    case 15: return G[0] * yij + G[7];
    case 16: return G[3] * yij + G[10];
    case 17: return G[2] * yij + G[9];
    case 18: return G[1] * yij + G[8];
    case 19: return G[0] * yij + G[7];
    case 20: return G[0];
    case 21: return G[1];
    case 22: return G[0];
    case 23: return G[2];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[3];
    case 27: return G[2];
    case 28: return G[1];
    case 29: return G[0];
    case 30: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 31: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 32: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 33: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 34: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 35: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 36: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 37: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 38: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 39: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 40: return G[0] * yij + G[7];
    case 41: return G[1] * yij + G[8];
    case 42: return G[0] * yij + G[7];
    case 43: return G[2] * yij + G[9];
    case 44: return G[1] * yij + G[8];
    case 45: return G[0] * yij + G[7];
    case 46: return G[3] * yij + G[10];
    case 47: return G[2] * yij + G[9];
    case 48: return G[1] * yij + G[8];
    case 49: return G[0] * yij + G[7];
    case 50: return G[0];
    case 51: return G[1];
    case 52: return G[0];
    case 53: return G[2];
    case 54: return G[1];
    case 55: return G[0];
    case 56: return G[3];
    case 57: return G[2];
    case 58: return G[1];
    case 59: return G[0];
    case 60: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 61: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 62: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 63: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 64: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 65: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 66: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 67: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 68: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 69: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 70: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 71: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 72: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 73: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 74: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 75: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 76: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 77: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 78: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 79: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 80: return G[0] * yij + G[7];
    case 81: return G[1] * yij + G[8];
    case 82: return G[0] * yij + G[7];
    case 83: return G[2] * yij + G[9];
    case 84: return G[1] * yij + G[8];
    case 85: return G[0] * yij + G[7];
    case 86: return G[3] * yij + G[10];
    case 87: return G[2] * yij + G[9];
    case 88: return G[1] * yij + G[8];
    case 89: return G[0] * yij + G[7];
    case 90: return G[0];
    case 91: return G[1];
    case 92: return G[0];
    case 93: return G[2];
    case 94: return G[1];
    case 95: return G[0];
    case 96: return G[3];
    case 97: return G[2];
    case 98: return G[1];
    case 99: return G[0];
    case 100: return G[7];
    case 101: return G[8];
    case 102: return G[7];
    case 103: return G[9];
    case 104: return G[8];
    case 105: return G[7];
    case 106: return G[10];
    case 107: return G[9];
    case 108: return G[8];
    case 109: return G[7];
    case 110: return G[7] * yij + G[14];
    case 111: return G[8] * yij + G[15];
    case 112: return G[7] * yij + G[14];
    case 113: return G[9] * yij + G[16];
    case 114: return G[8] * yij + G[15];
    case 115: return G[7] * yij + G[14];
    case 116: return G[10] * yij + G[17];
    case 117: return G[9] * yij + G[16];
    case 118: return G[8] * yij + G[15];
    case 119: return G[7] * yij + G[14];
    case 120: return G[7];
    case 121: return G[8];
    case 122: return G[7];
    case 123: return G[9];
    case 124: return G[8];
    case 125: return G[7];
    case 126: return G[10];
    case 127: return G[9];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 131: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 132: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 133: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 134: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 135: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 136: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 137: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 138: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 139: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 140: return G[7] * yij + G[14];
    case 141: return G[8] * yij + G[15];
    case 142: return G[7] * yij + G[14];
    case 143: return G[9] * yij + G[16];
    case 144: return G[8] * yij + G[15];
    case 145: return G[7] * yij + G[14];
    case 146: return G[10] * yij + G[17];
    case 147: return G[9] * yij + G[16];
    case 148: return G[8] * yij + G[15];
    case 149: return G[7] * yij + G[14];
    case 150: return G[7];
    case 151: return G[8];
    case 152: return G[7];
    case 153: return G[9];
    case 154: return G[8];
    case 155: return G[7];
    case 156: return G[10];
    case 157: return G[9];
    case 158: return G[8];
    case 159: return G[7];
    case 160: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 161: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 162: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 163: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 164: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 165: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 166: return G[10] * pow(yij, 3) + 3.0 * (G[17] * yij2) + 3.0 * (G[24] * yij) + G[31];
    case 167: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 168: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 169: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 170: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 171: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 172: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 173: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 174: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 175: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 176: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 177: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 178: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 179: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 180: return G[7] * yij + G[14];
    case 181: return G[8] * yij + G[15];
    case 182: return G[7] * yij + G[14];
    case 183: return G[9] * yij + G[16];
    case 184: return G[8] * yij + G[15];
    case 185: return G[7] * yij + G[14];
    case 186: return G[10] * yij + G[17];
    case 187: return G[9] * yij + G[16];
    case 188: return G[8] * yij + G[15];
    case 189: return G[7] * yij + G[14];
    case 190: return G[7];
    case 191: return G[8];
    case 192: return G[7];
    case 193: return G[9];
    case 194: return G[8];
    case 195: return G[7];
    case 196: return G[10];
    case 197: return G[9];
    case 198: return G[8];
    case 199: return G[7];
    case 200: return G[0];
    case 201: return G[1];
    case 202: return G[0];
    case 203: return G[2];
    case 204: return G[1];
    case 205: return G[0];
    case 206: return G[3];
    case 207: return G[2];
    case 208: return G[1];
    case 209: return G[0];
    case 210: return G[0] * yij + G[7];
    case 211: return G[1] * yij + G[8];
    case 212: return G[0] * yij + G[7];
    case 213: return G[2] * yij + G[9];
    case 214: return G[1] * yij + G[8];
    case 215: return G[0] * yij + G[7];
    case 216: return G[3] * yij + G[10];
    case 217: return G[2] * yij + G[9];
    case 218: return G[1] * yij + G[8];
    case 219: return G[0] * yij + G[7];
    case 220: return G[0];
    case 221: return G[1];
    case 222: return G[0];
    case 223: return G[2];
    case 224: return G[1];
    case 225: return G[0];
    case 226: return G[3];
    case 227: return G[2];
    case 228: return G[1];
    case 229: return G[0];
    case 230: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 231: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 232: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 233: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 234: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 235: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 236: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 237: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 238: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 239: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 240: return G[0] * yij + G[7];
    case 241: return G[1] * yij + G[8];
    case 242: return G[0] * yij + G[7];
    case 243: return G[2] * yij + G[9];
    case 244: return G[1] * yij + G[8];
    case 245: return G[0] * yij + G[7];
    case 246: return G[3] * yij + G[10];
    case 247: return G[2] * yij + G[9];
    case 248: return G[1] * yij + G[8];
    case 249: return G[0] * yij + G[7];
    case 250: return G[0];
    case 251: return G[1];
    case 252: return G[0];
    case 253: return G[2];
    case 254: return G[1];
    case 255: return G[0];
    case 256: return G[3];
    case 257: return G[2];
    case 258: return G[1];
    case 259: return G[0];
    case 260: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 261: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 262: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 263: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 264: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 265: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 266: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 267: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 268: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 269: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 270: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 271: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 272: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 273: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 274: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 275: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 276: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 277: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 278: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 279: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 280: return G[0] * yij + G[7];
    case 281: return G[1] * yij + G[8];
    case 282: return G[0] * yij + G[7];
    case 283: return G[2] * yij + G[9];
    case 284: return G[1] * yij + G[8];
    case 285: return G[0] * yij + G[7];
    case 286: return G[3] * yij + G[10];
    case 287: return G[2] * yij + G[9];
    case 288: return G[1] * yij + G[8];
    case 289: return G[0] * yij + G[7];
    case 290: return G[0];
    case 291: return G[1];
    case 292: return G[0];
    case 293: return G[2];
    case 294: return G[1];
    case 295: return G[0];
    case 296: return G[3];
    case 297: return G[2];
    case 298: return G[1];
    case 299: return G[0];
    case 300: return G[14];
    case 301: return G[15];
    case 302: return G[14];
    case 303: return G[16];
    case 304: return G[15];
    case 305: return G[14];
    case 306: return G[17];
    case 307: return G[16];
    case 308: return G[15];
    case 309: return G[14];
    case 310: return G[14] * yij + G[21];
    case 311: return G[15] * yij + G[22];
    case 312: return G[14] * yij + G[21];
    case 313: return G[16] * yij + G[23];
    case 314: return G[15] * yij + G[22];
    case 315: return G[14] * yij + G[21];
    case 316: return G[17] * yij + G[24];
    case 317: return G[16] * yij + G[23];
    case 318: return G[15] * yij + G[22];
    case 319: return G[14] * yij + G[21];
    case 320: return G[14];
    case 321: return G[15];
    case 322: return G[14];
    case 323: return G[16];
    case 324: return G[15];
    case 325: return G[14];
    case 326: return G[17];
    case 327: return G[16];
    case 328: return G[15];
    case 329: return G[14];
    case 330: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 331: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 332: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 333: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 334: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 335: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 336: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 337: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 338: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 339: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 340: return G[14] * yij + G[21];
    case 341: return G[15] * yij + G[22];
    case 342: return G[14] * yij + G[21];
    case 343: return G[16] * yij + G[23];
    case 344: return G[15] * yij + G[22];
    case 345: return G[14] * yij + G[21];
    case 346: return G[17] * yij + G[24];
    case 347: return G[16] * yij + G[23];
    case 348: return G[15] * yij + G[22];
    case 349: return G[14] * yij + G[21];
    case 350: return G[14];
    case 351: return G[15];
    case 352: return G[14];
    case 353: return G[16];
    case 354: return G[15];
    case 355: return G[14];
    case 356: return G[17];
    case 357: return G[16];
    case 358: return G[15];
    case 359: return G[14];
    case 360: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 361: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 362: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 363: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 364: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 365: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 366: return G[17] * pow(yij, 3) + 3.0 * (G[24] * yij2) + 3.0 * (G[31] * yij) + G[38];
    case 367: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 368: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 369: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 370: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 371: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 372: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 373: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 374: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 375: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 376: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 377: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 378: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 379: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 380: return G[14] * yij + G[21];
    case 381: return G[15] * yij + G[22];
    case 382: return G[14] * yij + G[21];
    case 383: return G[16] * yij + G[23];
    case 384: return G[15] * yij + G[22];
    case 385: return G[14] * yij + G[21];
    case 386: return G[17] * yij + G[24];
    case 387: return G[16] * yij + G[23];
    case 388: return G[15] * yij + G[22];
    case 389: return G[14] * yij + G[21];
    case 390: return G[14];
    case 391: return G[15];
    case 392: return G[14];
    case 393: return G[16];
    case 394: return G[15];
    case 395: return G[14];
    case 396: return G[17];
    case 397: return G[16];
    case 398: return G[15];
    case 399: return G[14];
    case 400: return G[7];
    case 401: return G[8];
    case 402: return G[7];
    case 403: return G[9];
    case 404: return G[8];
    case 405: return G[7];
    case 406: return G[10];
    case 407: return G[9];
    case 408: return G[8];
    case 409: return G[7];
    case 410: return G[7] * yij + G[14];
    case 411: return G[8] * yij + G[15];
    case 412: return G[7] * yij + G[14];
    case 413: return G[9] * yij + G[16];
    case 414: return G[8] * yij + G[15];
    case 415: return G[7] * yij + G[14];
    case 416: return G[10] * yij + G[17];
    case 417: return G[9] * yij + G[16];
    case 418: return G[8] * yij + G[15];
    case 419: return G[7] * yij + G[14];
    case 420: return G[7];
    case 421: return G[8];
    case 422: return G[7];
    case 423: return G[9];
    case 424: return G[8];
    case 425: return G[7];
    case 426: return G[10];
    case 427: return G[9];
    case 428: return G[8];
    case 429: return G[7];
    case 430: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 431: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 432: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 433: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 434: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 435: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 436: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 437: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 438: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 439: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 440: return G[7] * yij + G[14];
    case 441: return G[8] * yij + G[15];
    case 442: return G[7] * yij + G[14];
    case 443: return G[9] * yij + G[16];
    case 444: return G[8] * yij + G[15];
    case 445: return G[7] * yij + G[14];
    case 446: return G[10] * yij + G[17];
    case 447: return G[9] * yij + G[16];
    case 448: return G[8] * yij + G[15];
    case 449: return G[7] * yij + G[14];
    case 450: return G[7];
    case 451: return G[8];
    case 452: return G[7];
    case 453: return G[9];
    case 454: return G[8];
    case 455: return G[7];
    case 456: return G[10];
    case 457: return G[9];
    case 458: return G[8];
    case 459: return G[7];
    case 460: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 461: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 462: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 463: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 464: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 465: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 466: return G[10] * pow(yij, 3) + 3.0 * (G[17] * yij2) + 3.0 * (G[24] * yij) + G[31];
    case 467: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 468: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 469: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 470: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 471: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 472: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 473: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 474: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 475: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 476: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 477: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 478: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 479: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 480: return G[7] * yij + G[14];
    case 481: return G[8] * yij + G[15];
    case 482: return G[7] * yij + G[14];
    case 483: return G[9] * yij + G[16];
    case 484: return G[8] * yij + G[15];
    case 485: return G[7] * yij + G[14];
    case 486: return G[10] * yij + G[17];
    case 487: return G[9] * yij + G[16];
    case 488: return G[8] * yij + G[15];
    case 489: return G[7] * yij + G[14];
    case 490: return G[7];
    case 491: return G[8];
    case 492: return G[7];
    case 493: return G[9];
    case 494: return G[8];
    case 495: return G[7];
    case 496: return G[10];
    case 497: return G[9];
    case 498: return G[8];
    case 499: return G[7];
    case 500: return G[0];
    case 501: return G[1];
    case 502: return G[0];
    case 503: return G[2];
    case 504: return G[1];
    case 505: return G[0];
    case 506: return G[3];
    case 507: return G[2];
    case 508: return G[1];
    case 509: return G[0];
    case 510: return G[0] * yij + G[7];
    case 511: return G[1] * yij + G[8];
    case 512: return G[0] * yij + G[7];
    case 513: return G[2] * yij + G[9];
    case 514: return G[1] * yij + G[8];
    case 515: return G[0] * yij + G[7];
    case 516: return G[3] * yij + G[10];
    case 517: return G[2] * yij + G[9];
    case 518: return G[1] * yij + G[8];
    case 519: return G[0] * yij + G[7];
    case 520: return G[0];
    case 521: return G[1];
    case 522: return G[0];
    case 523: return G[2];
    case 524: return G[1];
    case 525: return G[0];
    case 526: return G[3];
    case 527: return G[2];
    case 528: return G[1];
    case 529: return G[0];
    case 530: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 531: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 532: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 533: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 534: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 535: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 536: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 537: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 538: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 539: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 540: return G[0] * yij + G[7];
    case 541: return G[1] * yij + G[8];
    case 542: return G[0] * yij + G[7];
    case 543: return G[2] * yij + G[9];
    case 544: return G[1] * yij + G[8];
    case 545: return G[0] * yij + G[7];
    case 546: return G[3] * yij + G[10];
    case 547: return G[2] * yij + G[9];
    case 548: return G[1] * yij + G[8];
    case 549: return G[0] * yij + G[7];
    case 550: return G[0];
    case 551: return G[1];
    case 552: return G[0];
    case 553: return G[2];
    case 554: return G[1];
    case 555: return G[0];
    case 556: return G[3];
    case 557: return G[2];
    case 558: return G[1];
    case 559: return G[0];
    case 560: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 561: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 562: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 563: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 564: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 565: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 566: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 567: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 568: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 569: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 570: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 571: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 572: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 573: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 574: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 575: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 576: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 577: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 578: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 579: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 580: return G[0] * yij + G[7];
    case 581: return G[1] * yij + G[8];
    case 582: return G[0] * yij + G[7];
    case 583: return G[2] * yij + G[9];
    case 584: return G[1] * yij + G[8];
    case 585: return G[0] * yij + G[7];
    case 586: return G[3] * yij + G[10];
    case 587: return G[2] * yij + G[9];
    case 588: return G[1] * yij + G[8];
    case 589: return G[0] * yij + G[7];
    case 590: return G[0];
    case 591: return G[1];
    case 592: return G[0];
    case 593: return G[2];
    case 594: return G[1];
    case 595: return G[0];
    case 596: return G[3];
    case 597: return G[2];
    case 598: return G[1];
    case 599: return G[0];
    case 600: return G[21];
    case 601: return G[22];
    case 602: return G[21];
    case 603: return G[23];
    case 604: return G[22];
    case 605: return G[21];
    case 606: return G[24];
    case 607: return G[23];
    case 608: return G[22];
    case 609: return G[21];
    case 610: return G[21] * yij + G[28];
    case 611: return G[22] * yij + G[29];
    case 612: return G[21] * yij + G[28];
    case 613: return G[23] * yij + G[30];
    case 614: return G[22] * yij + G[29];
    case 615: return G[21] * yij + G[28];
    case 616: return G[24] * yij + G[31];
    case 617: return G[23] * yij + G[30];
    case 618: return G[22] * yij + G[29];
    case 619: return G[21] * yij + G[28];
    case 620: return G[21];
    case 621: return G[22];
    case 622: return G[21];
    case 623: return G[23];
    case 624: return G[22];
    case 625: return G[21];
    case 626: return G[24];
    case 627: return G[23];
    case 628: return G[22];
    case 629: return G[21];
    case 630: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 631: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 632: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 633: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 634: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 635: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 636: return G[24] * yij2 + 2.0 * (G[31] * yij) + G[38];
    case 637: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 638: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 639: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 640: return G[21] * yij + G[28];
    case 641: return G[22] * yij + G[29];
    case 642: return G[21] * yij + G[28];
    case 643: return G[23] * yij + G[30];
    case 644: return G[22] * yij + G[29];
    case 645: return G[21] * yij + G[28];
    case 646: return G[24] * yij + G[31];
    case 647: return G[23] * yij + G[30];
    case 648: return G[22] * yij + G[29];
    case 649: return G[21] * yij + G[28];
    case 650: return G[21];
    case 651: return G[22];
    case 652: return G[21];
    case 653: return G[23];
    case 654: return G[22];
    case 655: return G[21];
    case 656: return G[24];
    case 657: return G[23];
    case 658: return G[22];
    case 659: return G[21];
    case 660: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 661: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 662: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 663: return G[23] * pow(yij, 3) + 3.0 * (G[30] * yij2) + 3.0 * (G[37] * yij) + G[44];
    case 664: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 665: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 666: return G[24] * pow(yij, 3) + 3.0 * (G[31] * yij2) + 3.0 * (G[38] * yij) + G[45];
    case 667: return G[23] * pow(yij, 3) + 3.0 * (G[30] * yij2) + 3.0 * (G[37] * yij) + G[44];
    case 668: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 669: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 670: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 671: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 672: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 673: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 674: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 675: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 676: return G[24] * yij2 + 2.0 * (G[31] * yij) + G[38];
    case 677: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 678: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 679: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 680: return G[21] * yij + G[28];
    case 681: return G[22] * yij + G[29];
    case 682: return G[21] * yij + G[28];
    case 683: return G[23] * yij + G[30];
    case 684: return G[22] * yij + G[29];
    case 685: return G[21] * yij + G[28];
    case 686: return G[24] * yij + G[31];
    case 687: return G[23] * yij + G[30];
    case 688: return G[22] * yij + G[29];
    case 689: return G[21] * yij + G[28];
    case 690: return G[21];
    case 691: return G[22];
    case 692: return G[21];
    case 693: return G[23];
    case 694: return G[22];
    case 695: return G[21];
    case 696: return G[24];
    case 697: return G[23];
    case 698: return G[22];
    case 699: return G[21];
    case 700: return G[14];
    case 701: return G[15];
    case 702: return G[14];
    case 703: return G[16];
    case 704: return G[15];
    case 705: return G[14];
    case 706: return G[17];
    case 707: return G[16];
    case 708: return G[15];
    case 709: return G[14];
    case 710: return G[14] * yij + G[21];
    case 711: return G[15] * yij + G[22];
    case 712: return G[14] * yij + G[21];
    case 713: return G[16] * yij + G[23];
    case 714: return G[15] * yij + G[22];
    case 715: return G[14] * yij + G[21];
    case 716: return G[17] * yij + G[24];
    case 717: return G[16] * yij + G[23];
    case 718: return G[15] * yij + G[22];
    case 719: return G[14] * yij + G[21];
    case 720: return G[14];
    case 721: return G[15];
    case 722: return G[14];
    case 723: return G[16];
    case 724: return G[15];
    case 725: return G[14];
    case 726: return G[17];
    case 727: return G[16];
    case 728: return G[15];
    case 729: return G[14];
    case 730: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 731: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 732: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 733: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 734: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 735: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 736: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 737: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 738: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 739: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 740: return G[14] * yij + G[21];
    case 741: return G[15] * yij + G[22];
    case 742: return G[14] * yij + G[21];
    case 743: return G[16] * yij + G[23];
    case 744: return G[15] * yij + G[22];
    case 745: return G[14] * yij + G[21];
    case 746: return G[17] * yij + G[24];
    case 747: return G[16] * yij + G[23];
    case 748: return G[15] * yij + G[22];
    case 749: return G[14] * yij + G[21];
    case 750: return G[14];
    case 751: return G[15];
    case 752: return G[14];
    case 753: return G[16];
    case 754: return G[15];
    case 755: return G[14];
    case 756: return G[17];
    case 757: return G[16];
    case 758: return G[15];
    case 759: return G[14];
    case 760: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 761: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 762: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 763: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 764: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 765: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 766: return G[17] * pow(yij, 3) + 3.0 * (G[24] * yij2) + 3.0 * (G[31] * yij) + G[38];
    case 767: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 768: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 769: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 770: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 771: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 772: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 773: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 774: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 775: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 776: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 777: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 778: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 779: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 780: return G[14] * yij + G[21];
    case 781: return G[15] * yij + G[22];
    case 782: return G[14] * yij + G[21];
    case 783: return G[16] * yij + G[23];
    case 784: return G[15] * yij + G[22];
    case 785: return G[14] * yij + G[21];
    case 786: return G[17] * yij + G[24];
    case 787: return G[16] * yij + G[23];
    case 788: return G[15] * yij + G[22];
    case 789: return G[14] * yij + G[21];
    case 790: return G[14];
    case 791: return G[15];
    case 792: return G[14];
    case 793: return G[16];
    case 794: return G[15];
    case 795: return G[14];
    case 796: return G[17];
    case 797: return G[16];
    case 798: return G[15];
    case 799: return G[14];
    case 800: return G[7];
    case 801: return G[8];
    case 802: return G[7];
    case 803: return G[9];
    case 804: return G[8];
    case 805: return G[7];
    case 806: return G[10];
    case 807: return G[9];
    case 808: return G[8];
    case 809: return G[7];
    case 810: return G[7] * yij + G[14];
    case 811: return G[8] * yij + G[15];
    case 812: return G[7] * yij + G[14];
    case 813: return G[9] * yij + G[16];
    case 814: return G[8] * yij + G[15];
    case 815: return G[7] * yij + G[14];
    case 816: return G[10] * yij + G[17];
    case 817: return G[9] * yij + G[16];
    case 818: return G[8] * yij + G[15];
    case 819: return G[7] * yij + G[14];
    case 820: return G[7];
    case 821: return G[8];
    case 822: return G[7];
    case 823: return G[9];
    case 824: return G[8];
    case 825: return G[7];
    case 826: return G[10];
    case 827: return G[9];
    case 828: return G[8];
    case 829: return G[7];
    case 830: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 831: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 832: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 833: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 834: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 835: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 836: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 837: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 838: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 839: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 840: return G[7] * yij + G[14];
    case 841: return G[8] * yij + G[15];
    case 842: return G[7] * yij + G[14];
    case 843: return G[9] * yij + G[16];
    case 844: return G[8] * yij + G[15];
    case 845: return G[7] * yij + G[14];
    case 846: return G[10] * yij + G[17];
    case 847: return G[9] * yij + G[16];
    case 848: return G[8] * yij + G[15];
    case 849: return G[7] * yij + G[14];
    case 850: return G[7];
    case 851: return G[8];
    case 852: return G[7];
    case 853: return G[9];
    case 854: return G[8];
    case 855: return G[7];
    case 856: return G[10];
    case 857: return G[9];
    case 858: return G[8];
    case 859: return G[7];
    case 860: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 861: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 862: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 863: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 864: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 865: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 866: return G[10] * pow(yij, 3) + 3.0 * (G[17] * yij2) + 3.0 * (G[24] * yij) + G[31];
    case 867: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 868: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 869: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 870: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 871: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 872: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 873: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 874: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 875: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 876: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 877: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 878: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 879: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 880: return G[7] * yij + G[14];
    case 881: return G[8] * yij + G[15];
    case 882: return G[7] * yij + G[14];
    case 883: return G[9] * yij + G[16];
    case 884: return G[8] * yij + G[15];
    case 885: return G[7] * yij + G[14];
    case 886: return G[10] * yij + G[17];
    case 887: return G[9] * yij + G[16];
    case 888: return G[8] * yij + G[15];
    case 889: return G[7] * yij + G[14];
    case 890: return G[7];
    case 891: return G[8];
    case 892: return G[7];
    case 893: return G[9];
    case 894: return G[8];
    case 895: return G[7];
    case 896: return G[10];
    case 897: return G[9];
    case 898: return G[8];
    case 899: return G[7];
    case 900: return G[0];
    case 901: return G[1];
    case 902: return G[0];
    case 903: return G[2];
    case 904: return G[1];
    case 905: return G[0];
    case 906: return G[3];
    case 907: return G[2];
    case 908: return G[1];
    case 909: return G[0];
    case 910: return G[0] * yij + G[7];
    case 911: return G[1] * yij + G[8];
    case 912: return G[0] * yij + G[7];
    case 913: return G[2] * yij + G[9];
    case 914: return G[1] * yij + G[8];
    case 915: return G[0] * yij + G[7];
    case 916: return G[3] * yij + G[10];
    case 917: return G[2] * yij + G[9];
    case 918: return G[1] * yij + G[8];
    case 919: return G[0] * yij + G[7];
    case 920: return G[0];
    case 921: return G[1];
    case 922: return G[0];
    case 923: return G[2];
    case 924: return G[1];
    case 925: return G[0];
    case 926: return G[3];
    case 927: return G[2];
    case 928: return G[1];
    case 929: return G[0];
    case 930: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 931: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 932: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 933: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 934: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 935: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 936: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 937: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 938: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 939: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 940: return G[0] * yij + G[7];
    case 941: return G[1] * yij + G[8];
    case 942: return G[0] * yij + G[7];
    case 943: return G[2] * yij + G[9];
    case 944: return G[1] * yij + G[8];
    case 945: return G[0] * yij + G[7];
    case 946: return G[3] * yij + G[10];
    case 947: return G[2] * yij + G[9];
    case 948: return G[1] * yij + G[8];
    case 949: return G[0] * yij + G[7];
    case 950: return G[0];
    case 951: return G[1];
    case 952: return G[0];
    case 953: return G[2];
    case 954: return G[1];
    case 955: return G[0];
    case 956: return G[3];
    case 957: return G[2];
    case 958: return G[1];
    case 959: return G[0];
    case 960: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 961: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 962: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 963: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 964: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 965: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 966: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 967: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 968: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 969: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 970: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 971: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 972: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 973: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 974: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 975: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 976: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 977: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 978: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 979: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 980: return G[0] * yij + G[7];
    case 981: return G[1] * yij + G[8];
    case 982: return G[0] * yij + G[7];
    case 983: return G[2] * yij + G[9];
    case 984: return G[1] * yij + G[8];
    case 985: return G[0] * yij + G[7];
    case 986: return G[3] * yij + G[10];
    case 987: return G[2] * yij + G[9];
    case 988: return G[1] * yij + G[8];
    case 989: return G[0] * yij + G[7];
    case 990: return G[0];
    case 991: return G[1];
    case 992: return G[0];
    case 993: return G[2];
    case 994: return G[1];
    case 995: return G[0];
    case 996: return G[3];
    case 997: return G[2];
    case 998: return G[1];
    case 999: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fffs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[1];
    case 13: return G[0];
    case 14: return G[1];
    case 15: return G[2];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[2];
    case 19: return G[3];
    case 20: return G[0] * zij + G[7];
    case 21: return G[0] * zij + G[7];
    case 22: return G[1] * zij + G[8];
    case 23: return G[0] * zij + G[7];
    case 24: return G[1] * zij + G[8];
    case 25: return G[2] * zij + G[9];
    case 26: return G[0] * zij + G[7];
    case 27: return G[1] * zij + G[8];
    case 28: return G[2] * zij + G[9];
    case 29: return G[3] * zij + G[10];
    case 30: return G[0];
    case 31: return G[0];
    case 32: return G[1];
    case 33: return G[0];
    case 34: return G[1];
    case 35: return G[2];
    case 36: return G[0];
    case 37: return G[1];
    case 38: return G[2];
    case 39: return G[3];
    case 40: return G[0] * zij + G[7];
    case 41: return G[0] * zij + G[7];
    case 42: return G[1] * zij + G[8];
    case 43: return G[0] * zij + G[7];
    case 44: return G[1] * zij + G[8];
    case 45: return G[2] * zij + G[9];
    case 46: return G[0] * zij + G[7];
    case 47: return G[1] * zij + G[8];
    case 48: return G[2] * zij + G[9];
    case 49: return G[3] * zij + G[10];
    case 50: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 51: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 52: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 53: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 54: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 55: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 56: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 57: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 58: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 59: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[1];
    case 63: return G[0];
    case 64: return G[1];
    case 65: return G[2];
    case 66: return G[0];
    case 67: return G[1];
    case 68: return G[2];
    case 69: return G[3];
    case 70: return G[0] * zij + G[7];
    case 71: return G[0] * zij + G[7];
    case 72: return G[1] * zij + G[8];
    case 73: return G[0] * zij + G[7];
    case 74: return G[1] * zij + G[8];
    case 75: return G[2] * zij + G[9];
    case 76: return G[0] * zij + G[7];
    case 77: return G[1] * zij + G[8];
    case 78: return G[2] * zij + G[9];
    case 79: return G[3] * zij + G[10];
    case 80: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 81: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 82: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 83: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 84: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 85: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 86: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 87: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 88: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 89: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 90: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 91: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 92: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 93: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 94: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 95: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 96: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 97: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 98: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 99: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 100: return G[0];
    case 101: return G[0];
    case 102: return G[1];
    case 103: return G[0];
    case 104: return G[1];
    case 105: return G[2];
    case 106: return G[0];
    case 107: return G[1];
    case 108: return G[2];
    case 109: return G[3];
    case 110: return G[0];
    case 111: return G[0];
    case 112: return G[1];
    case 113: return G[0];
    case 114: return G[1];
    case 115: return G[2];
    case 116: return G[0];
    case 117: return G[1];
    case 118: return G[2];
    case 119: return G[3];
    case 120: return G[0] * zij + G[7];
    case 121: return G[0] * zij + G[7];
    case 122: return G[1] * zij + G[8];
    case 123: return G[0] * zij + G[7];
    case 124: return G[1] * zij + G[8];
    case 125: return G[2] * zij + G[9];
    case 126: return G[0] * zij + G[7];
    case 127: return G[1] * zij + G[8];
    case 128: return G[2] * zij + G[9];
    case 129: return G[3] * zij + G[10];
    case 130: return G[0];
    case 131: return G[0];
    case 132: return G[1];
    case 133: return G[0];
    case 134: return G[1];
    case 135: return G[2];
    case 136: return G[0];
    case 137: return G[1];
    case 138: return G[2];
    case 139: return G[3];
    case 140: return G[0] * zij + G[7];
    case 141: return G[0] * zij + G[7];
    case 142: return G[1] * zij + G[8];
    case 143: return G[0] * zij + G[7];
    case 144: return G[1] * zij + G[8];
    case 145: return G[2] * zij + G[9];
    case 146: return G[0] * zij + G[7];
    case 147: return G[1] * zij + G[8];
    case 148: return G[2] * zij + G[9];
    case 149: return G[3] * zij + G[10];
    case 150: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 151: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 152: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 153: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 154: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 155: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 156: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 157: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 158: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 159: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 160: return G[0];
    case 161: return G[0];
    case 162: return G[1];
    case 163: return G[0];
    case 164: return G[1];
    case 165: return G[2];
    case 166: return G[0];
    case 167: return G[1];
    case 168: return G[2];
    case 169: return G[3];
    case 170: return G[0] * zij + G[7];
    case 171: return G[0] * zij + G[7];
    case 172: return G[1] * zij + G[8];
    case 173: return G[0] * zij + G[7];
    case 174: return G[1] * zij + G[8];
    case 175: return G[2] * zij + G[9];
    case 176: return G[0] * zij + G[7];
    case 177: return G[1] * zij + G[8];
    case 178: return G[2] * zij + G[9];
    case 179: return G[3] * zij + G[10];
    case 180: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 181: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 182: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 183: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 184: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 185: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 186: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 187: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 188: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 189: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 190: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 191: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 192: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 193: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 194: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 195: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 196: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 197: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 198: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 199: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 200: return G[7];
    case 201: return G[7];
    case 202: return G[8];
    case 203: return G[7];
    case 204: return G[8];
    case 205: return G[9];
    case 206: return G[7];
    case 207: return G[8];
    case 208: return G[9];
    case 209: return G[10];
    case 210: return G[7];
    case 211: return G[7];
    case 212: return G[8];
    case 213: return G[7];
    case 214: return G[8];
    case 215: return G[9];
    case 216: return G[7];
    case 217: return G[8];
    case 218: return G[9];
    case 219: return G[10];
    case 220: return G[7] * zij + G[14];
    case 221: return G[7] * zij + G[14];
    case 222: return G[8] * zij + G[15];
    case 223: return G[7] * zij + G[14];
    case 224: return G[8] * zij + G[15];
    case 225: return G[9] * zij + G[16];
    case 226: return G[7] * zij + G[14];
    case 227: return G[8] * zij + G[15];
    case 228: return G[9] * zij + G[16];
    case 229: return G[10] * zij + G[17];
    case 230: return G[7];
    case 231: return G[7];
    case 232: return G[8];
    case 233: return G[7];
    case 234: return G[8];
    case 235: return G[9];
    case 236: return G[7];
    case 237: return G[8];
    case 238: return G[9];
    case 239: return G[10];
    case 240: return G[7] * zij + G[14];
    case 241: return G[7] * zij + G[14];
    case 242: return G[8] * zij + G[15];
    case 243: return G[7] * zij + G[14];
    case 244: return G[8] * zij + G[15];
    case 245: return G[9] * zij + G[16];
    case 246: return G[7] * zij + G[14];
    case 247: return G[8] * zij + G[15];
    case 248: return G[9] * zij + G[16];
    case 249: return G[10] * zij + G[17];
    case 250: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 251: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 252: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 253: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 254: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 255: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 256: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 257: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 258: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 259: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 260: return G[7];
    case 261: return G[7];
    case 262: return G[8];
    case 263: return G[7];
    case 264: return G[8];
    case 265: return G[9];
    case 266: return G[7];
    case 267: return G[8];
    case 268: return G[9];
    case 269: return G[10];
    case 270: return G[7] * zij + G[14];
    case 271: return G[7] * zij + G[14];
    case 272: return G[8] * zij + G[15];
    case 273: return G[7] * zij + G[14];
    case 274: return G[8] * zij + G[15];
    case 275: return G[9] * zij + G[16];
    case 276: return G[7] * zij + G[14];
    case 277: return G[8] * zij + G[15];
    case 278: return G[9] * zij + G[16];
    case 279: return G[10] * zij + G[17];
    case 280: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 281: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 282: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 283: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 284: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 285: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 286: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 287: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 288: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 289: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 290: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 291: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 292: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 293: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 294: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 295: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 296: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 297: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 298: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 299: return G[10] * pow(zij, 3) + 3.0 * (G[17] * zij2) + 3.0 * (G[24] * zij) + G[31];
    case 300: return G[0];
    case 301: return G[0];
    case 302: return G[1];
    case 303: return G[0];
    case 304: return G[1];
    case 305: return G[2];
    case 306: return G[0];
    case 307: return G[1];
    case 308: return G[2];
    case 309: return G[3];
    case 310: return G[0];
    case 311: return G[0];
    case 312: return G[1];
    case 313: return G[0];
    case 314: return G[1];
    case 315: return G[2];
    case 316: return G[0];
    case 317: return G[1];
    case 318: return G[2];
    case 319: return G[3];
    case 320: return G[0] * zij + G[7];
    case 321: return G[0] * zij + G[7];
    case 322: return G[1] * zij + G[8];
    case 323: return G[0] * zij + G[7];
    case 324: return G[1] * zij + G[8];
    case 325: return G[2] * zij + G[9];
    case 326: return G[0] * zij + G[7];
    case 327: return G[1] * zij + G[8];
    case 328: return G[2] * zij + G[9];
    case 329: return G[3] * zij + G[10];
    case 330: return G[0];
    case 331: return G[0];
    case 332: return G[1];
    case 333: return G[0];
    case 334: return G[1];
    case 335: return G[2];
    case 336: return G[0];
    case 337: return G[1];
    case 338: return G[2];
    case 339: return G[3];
    case 340: return G[0] * zij + G[7];
    case 341: return G[0] * zij + G[7];
    case 342: return G[1] * zij + G[8];
    case 343: return G[0] * zij + G[7];
    case 344: return G[1] * zij + G[8];
    case 345: return G[2] * zij + G[9];
    case 346: return G[0] * zij + G[7];
    case 347: return G[1] * zij + G[8];
    case 348: return G[2] * zij + G[9];
    case 349: return G[3] * zij + G[10];
    case 350: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 351: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 352: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 353: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 354: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 355: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 356: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 357: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 358: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 359: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 360: return G[0];
    case 361: return G[0];
    case 362: return G[1];
    case 363: return G[0];
    case 364: return G[1];
    case 365: return G[2];
    case 366: return G[0];
    case 367: return G[1];
    case 368: return G[2];
    case 369: return G[3];
    case 370: return G[0] * zij + G[7];
    case 371: return G[0] * zij + G[7];
    case 372: return G[1] * zij + G[8];
    case 373: return G[0] * zij + G[7];
    case 374: return G[1] * zij + G[8];
    case 375: return G[2] * zij + G[9];
    case 376: return G[0] * zij + G[7];
    case 377: return G[1] * zij + G[8];
    case 378: return G[2] * zij + G[9];
    case 379: return G[3] * zij + G[10];
    case 380: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 381: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 382: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 383: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 384: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 385: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 386: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 387: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 388: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 389: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 390: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 391: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 392: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 393: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 394: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 395: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 396: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 397: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 398: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 399: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 400: return G[7];
    case 401: return G[7];
    case 402: return G[8];
    case 403: return G[7];
    case 404: return G[8];
    case 405: return G[9];
    case 406: return G[7];
    case 407: return G[8];
    case 408: return G[9];
    case 409: return G[10];
    case 410: return G[7];
    case 411: return G[7];
    case 412: return G[8];
    case 413: return G[7];
    case 414: return G[8];
    case 415: return G[9];
    case 416: return G[7];
    case 417: return G[8];
    case 418: return G[9];
    case 419: return G[10];
    case 420: return G[7] * zij + G[14];
    case 421: return G[7] * zij + G[14];
    case 422: return G[8] * zij + G[15];
    case 423: return G[7] * zij + G[14];
    case 424: return G[8] * zij + G[15];
    case 425: return G[9] * zij + G[16];
    case 426: return G[7] * zij + G[14];
    case 427: return G[8] * zij + G[15];
    case 428: return G[9] * zij + G[16];
    case 429: return G[10] * zij + G[17];
    case 430: return G[7];
    case 431: return G[7];
    case 432: return G[8];
    case 433: return G[7];
    case 434: return G[8];
    case 435: return G[9];
    case 436: return G[7];
    case 437: return G[8];
    case 438: return G[9];
    case 439: return G[10];
    case 440: return G[7] * zij + G[14];
    case 441: return G[7] * zij + G[14];
    case 442: return G[8] * zij + G[15];
    case 443: return G[7] * zij + G[14];
    case 444: return G[8] * zij + G[15];
    case 445: return G[9] * zij + G[16];
    case 446: return G[7] * zij + G[14];
    case 447: return G[8] * zij + G[15];
    case 448: return G[9] * zij + G[16];
    case 449: return G[10] * zij + G[17];
    case 450: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 451: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 452: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 453: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 454: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 455: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 456: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 457: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 458: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 459: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 460: return G[7];
    case 461: return G[7];
    case 462: return G[8];
    case 463: return G[7];
    case 464: return G[8];
    case 465: return G[9];
    case 466: return G[7];
    case 467: return G[8];
    case 468: return G[9];
    case 469: return G[10];
    case 470: return G[7] * zij + G[14];
    case 471: return G[7] * zij + G[14];
    case 472: return G[8] * zij + G[15];
    case 473: return G[7] * zij + G[14];
    case 474: return G[8] * zij + G[15];
    case 475: return G[9] * zij + G[16];
    case 476: return G[7] * zij + G[14];
    case 477: return G[8] * zij + G[15];
    case 478: return G[9] * zij + G[16];
    case 479: return G[10] * zij + G[17];
    case 480: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 481: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 482: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 483: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 484: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 485: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 486: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 487: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 488: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 489: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 490: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 491: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 492: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 493: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 494: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 495: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 496: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 497: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 498: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 499: return G[10] * pow(zij, 3) + 3.0 * (G[17] * zij2) + 3.0 * (G[24] * zij) + G[31];
    case 500: return G[14];
    case 501: return G[14];
    case 502: return G[15];
    case 503: return G[14];
    case 504: return G[15];
    case 505: return G[16];
    case 506: return G[14];
    case 507: return G[15];
    case 508: return G[16];
    case 509: return G[17];
    case 510: return G[14];
    case 511: return G[14];
    case 512: return G[15];
    case 513: return G[14];
    case 514: return G[15];
    case 515: return G[16];
    case 516: return G[14];
    case 517: return G[15];
    case 518: return G[16];
    case 519: return G[17];
    case 520: return G[14] * zij + G[21];
    case 521: return G[14] * zij + G[21];
    case 522: return G[15] * zij + G[22];
    case 523: return G[14] * zij + G[21];
    case 524: return G[15] * zij + G[22];
    case 525: return G[16] * zij + G[23];
    case 526: return G[14] * zij + G[21];
    case 527: return G[15] * zij + G[22];
    case 528: return G[16] * zij + G[23];
    case 529: return G[17] * zij + G[24];
    case 530: return G[14];
    case 531: return G[14];
    case 532: return G[15];
    case 533: return G[14];
    case 534: return G[15];
    case 535: return G[16];
    case 536: return G[14];
    case 537: return G[15];
    case 538: return G[16];
    case 539: return G[17];
    case 540: return G[14] * zij + G[21];
    case 541: return G[14] * zij + G[21];
    case 542: return G[15] * zij + G[22];
    case 543: return G[14] * zij + G[21];
    case 544: return G[15] * zij + G[22];
    case 545: return G[16] * zij + G[23];
    case 546: return G[14] * zij + G[21];
    case 547: return G[15] * zij + G[22];
    case 548: return G[16] * zij + G[23];
    case 549: return G[17] * zij + G[24];
    case 550: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 551: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 552: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 553: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 554: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 555: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 556: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 557: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 558: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 559: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 560: return G[14];
    case 561: return G[14];
    case 562: return G[15];
    case 563: return G[14];
    case 564: return G[15];
    case 565: return G[16];
    case 566: return G[14];
    case 567: return G[15];
    case 568: return G[16];
    case 569: return G[17];
    case 570: return G[14] * zij + G[21];
    case 571: return G[14] * zij + G[21];
    case 572: return G[15] * zij + G[22];
    case 573: return G[14] * zij + G[21];
    case 574: return G[15] * zij + G[22];
    case 575: return G[16] * zij + G[23];
    case 576: return G[14] * zij + G[21];
    case 577: return G[15] * zij + G[22];
    case 578: return G[16] * zij + G[23];
    case 579: return G[17] * zij + G[24];
    case 580: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 581: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 582: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 583: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 584: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 585: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 586: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 587: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 588: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 589: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 590: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 591: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 592: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 593: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 594: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 595: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 596: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 597: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 598: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 599: return G[17] * pow(zij, 3) + 3.0 * (G[24] * zij2) + 3.0 * (G[31] * zij) + G[38];
    case 600: return G[0];
    case 601: return G[0];
    case 602: return G[1];
    case 603: return G[0];
    case 604: return G[1];
    case 605: return G[2];
    case 606: return G[0];
    case 607: return G[1];
    case 608: return G[2];
    case 609: return G[3];
    case 610: return G[0];
    case 611: return G[0];
    case 612: return G[1];
    case 613: return G[0];
    case 614: return G[1];
    case 615: return G[2];
    case 616: return G[0];
    case 617: return G[1];
    case 618: return G[2];
    case 619: return G[3];
    case 620: return G[0] * zij + G[7];
    case 621: return G[0] * zij + G[7];
    case 622: return G[1] * zij + G[8];
    case 623: return G[0] * zij + G[7];
    case 624: return G[1] * zij + G[8];
    case 625: return G[2] * zij + G[9];
    case 626: return G[0] * zij + G[7];
    case 627: return G[1] * zij + G[8];
    case 628: return G[2] * zij + G[9];
    case 629: return G[3] * zij + G[10];
    case 630: return G[0];
    case 631: return G[0];
    case 632: return G[1];
    case 633: return G[0];
    case 634: return G[1];
    case 635: return G[2];
    case 636: return G[0];
    case 637: return G[1];
    case 638: return G[2];
    case 639: return G[3];
    case 640: return G[0] * zij + G[7];
    case 641: return G[0] * zij + G[7];
    case 642: return G[1] * zij + G[8];
    case 643: return G[0] * zij + G[7];
    case 644: return G[1] * zij + G[8];
    case 645: return G[2] * zij + G[9];
    case 646: return G[0] * zij + G[7];
    case 647: return G[1] * zij + G[8];
    case 648: return G[2] * zij + G[9];
    case 649: return G[3] * zij + G[10];
    case 650: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 651: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 652: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 653: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 654: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 655: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 656: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 657: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 658: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 659: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 660: return G[0];
    case 661: return G[0];
    case 662: return G[1];
    case 663: return G[0];
    case 664: return G[1];
    case 665: return G[2];
    case 666: return G[0];
    case 667: return G[1];
    case 668: return G[2];
    case 669: return G[3];
    case 670: return G[0] * zij + G[7];
    case 671: return G[0] * zij + G[7];
    case 672: return G[1] * zij + G[8];
    case 673: return G[0] * zij + G[7];
    case 674: return G[1] * zij + G[8];
    case 675: return G[2] * zij + G[9];
    case 676: return G[0] * zij + G[7];
    case 677: return G[1] * zij + G[8];
    case 678: return G[2] * zij + G[9];
    case 679: return G[3] * zij + G[10];
    case 680: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 681: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 682: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 683: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 684: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 685: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 686: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 687: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 688: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 689: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 690: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 691: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 692: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 693: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 694: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 695: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 696: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 697: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 698: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 699: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 700: return G[7];
    case 701: return G[7];
    case 702: return G[8];
    case 703: return G[7];
    case 704: return G[8];
    case 705: return G[9];
    case 706: return G[7];
    case 707: return G[8];
    case 708: return G[9];
    case 709: return G[10];
    case 710: return G[7];
    case 711: return G[7];
    case 712: return G[8];
    case 713: return G[7];
    case 714: return G[8];
    case 715: return G[9];
    case 716: return G[7];
    case 717: return G[8];
    case 718: return G[9];
    case 719: return G[10];
    case 720: return G[7] * zij + G[14];
    case 721: return G[7] * zij + G[14];
    case 722: return G[8] * zij + G[15];
    case 723: return G[7] * zij + G[14];
    case 724: return G[8] * zij + G[15];
    case 725: return G[9] * zij + G[16];
    case 726: return G[7] * zij + G[14];
    case 727: return G[8] * zij + G[15];
    case 728: return G[9] * zij + G[16];
    case 729: return G[10] * zij + G[17];
    case 730: return G[7];
    case 731: return G[7];
    case 732: return G[8];
    case 733: return G[7];
    case 734: return G[8];
    case 735: return G[9];
    case 736: return G[7];
    case 737: return G[8];
    case 738: return G[9];
    case 739: return G[10];
    case 740: return G[7] * zij + G[14];
    case 741: return G[7] * zij + G[14];
    case 742: return G[8] * zij + G[15];
    case 743: return G[7] * zij + G[14];
    case 744: return G[8] * zij + G[15];
    case 745: return G[9] * zij + G[16];
    case 746: return G[7] * zij + G[14];
    case 747: return G[8] * zij + G[15];
    case 748: return G[9] * zij + G[16];
    case 749: return G[10] * zij + G[17];
    case 750: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 751: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 752: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 753: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 754: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 755: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 756: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 757: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 758: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 759: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 760: return G[7];
    case 761: return G[7];
    case 762: return G[8];
    case 763: return G[7];
    case 764: return G[8];
    case 765: return G[9];
    case 766: return G[7];
    case 767: return G[8];
    case 768: return G[9];
    case 769: return G[10];
    case 770: return G[7] * zij + G[14];
    case 771: return G[7] * zij + G[14];
    case 772: return G[8] * zij + G[15];
    case 773: return G[7] * zij + G[14];
    case 774: return G[8] * zij + G[15];
    case 775: return G[9] * zij + G[16];
    case 776: return G[7] * zij + G[14];
    case 777: return G[8] * zij + G[15];
    case 778: return G[9] * zij + G[16];
    case 779: return G[10] * zij + G[17];
    case 780: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 781: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 782: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 783: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 784: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 785: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 786: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 787: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 788: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 789: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 790: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 791: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 792: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 793: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 794: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 795: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 796: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 797: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 798: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 799: return G[10] * pow(zij, 3) + 3.0 * (G[17] * zij2) + 3.0 * (G[24] * zij) + G[31];
    case 800: return G[14];
    case 801: return G[14];
    case 802: return G[15];
    case 803: return G[14];
    case 804: return G[15];
    case 805: return G[16];
    case 806: return G[14];
    case 807: return G[15];
    case 808: return G[16];
    case 809: return G[17];
    case 810: return G[14];
    case 811: return G[14];
    case 812: return G[15];
    case 813: return G[14];
    case 814: return G[15];
    case 815: return G[16];
    case 816: return G[14];
    case 817: return G[15];
    case 818: return G[16];
    case 819: return G[17];
    case 820: return G[14] * zij + G[21];
    case 821: return G[14] * zij + G[21];
    case 822: return G[15] * zij + G[22];
    case 823: return G[14] * zij + G[21];
    case 824: return G[15] * zij + G[22];
    case 825: return G[16] * zij + G[23];
    case 826: return G[14] * zij + G[21];
    case 827: return G[15] * zij + G[22];
    case 828: return G[16] * zij + G[23];
    case 829: return G[17] * zij + G[24];
    case 830: return G[14];
    case 831: return G[14];
    case 832: return G[15];
    case 833: return G[14];
    case 834: return G[15];
    case 835: return G[16];
    case 836: return G[14];
    case 837: return G[15];
    case 838: return G[16];
    case 839: return G[17];
    case 840: return G[14] * zij + G[21];
    case 841: return G[14] * zij + G[21];
    case 842: return G[15] * zij + G[22];
    case 843: return G[14] * zij + G[21];
    case 844: return G[15] * zij + G[22];
    case 845: return G[16] * zij + G[23];
    case 846: return G[14] * zij + G[21];
    case 847: return G[15] * zij + G[22];
    case 848: return G[16] * zij + G[23];
    case 849: return G[17] * zij + G[24];
    case 850: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 851: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 852: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 853: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 854: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 855: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 856: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 857: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 858: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 859: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 860: return G[14];
    case 861: return G[14];
    case 862: return G[15];
    case 863: return G[14];
    case 864: return G[15];
    case 865: return G[16];
    case 866: return G[14];
    case 867: return G[15];
    case 868: return G[16];
    case 869: return G[17];
    case 870: return G[14] * zij + G[21];
    case 871: return G[14] * zij + G[21];
    case 872: return G[15] * zij + G[22];
    case 873: return G[14] * zij + G[21];
    case 874: return G[15] * zij + G[22];
    case 875: return G[16] * zij + G[23];
    case 876: return G[14] * zij + G[21];
    case 877: return G[15] * zij + G[22];
    case 878: return G[16] * zij + G[23];
    case 879: return G[17] * zij + G[24];
    case 880: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 881: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 882: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 883: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 884: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 885: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 886: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 887: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 888: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 889: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 890: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 891: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 892: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 893: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 894: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 895: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 896: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 897: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 898: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 899: return G[17] * pow(zij, 3) + 3.0 * (G[24] * zij2) + 3.0 * (G[31] * zij) + G[38];
    case 900: return G[21];
    case 901: return G[21];
    case 902: return G[22];
    case 903: return G[21];
    case 904: return G[22];
    case 905: return G[23];
    case 906: return G[21];
    case 907: return G[22];
    case 908: return G[23];
    case 909: return G[24];
    case 910: return G[21];
    case 911: return G[21];
    case 912: return G[22];
    case 913: return G[21];
    case 914: return G[22];
    case 915: return G[23];
    case 916: return G[21];
    case 917: return G[22];
    case 918: return G[23];
    case 919: return G[24];
    case 920: return G[21] * zij + G[28];
    case 921: return G[21] * zij + G[28];
    case 922: return G[22] * zij + G[29];
    case 923: return G[21] * zij + G[28];
    case 924: return G[22] * zij + G[29];
    case 925: return G[23] * zij + G[30];
    case 926: return G[21] * zij + G[28];
    case 927: return G[22] * zij + G[29];
    case 928: return G[23] * zij + G[30];
    case 929: return G[24] * zij + G[31];
    case 930: return G[21];
    case 931: return G[21];
    case 932: return G[22];
    case 933: return G[21];
    case 934: return G[22];
    case 935: return G[23];
    case 936: return G[21];
    case 937: return G[22];
    case 938: return G[23];
    case 939: return G[24];
    case 940: return G[21] * zij + G[28];
    case 941: return G[21] * zij + G[28];
    case 942: return G[22] * zij + G[29];
    case 943: return G[21] * zij + G[28];
    case 944: return G[22] * zij + G[29];
    case 945: return G[23] * zij + G[30];
    case 946: return G[21] * zij + G[28];
    case 947: return G[22] * zij + G[29];
    case 948: return G[23] * zij + G[30];
    case 949: return G[24] * zij + G[31];
    case 950: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 951: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 952: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 953: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 954: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 955: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 956: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 957: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 958: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 959: return G[24] * zij2 + 2.0 * (G[31] * zij) + G[38];
    case 960: return G[21];
    case 961: return G[21];
    case 962: return G[22];
    case 963: return G[21];
    case 964: return G[22];
    case 965: return G[23];
    case 966: return G[21];
    case 967: return G[22];
    case 968: return G[23];
    case 969: return G[24];
    case 970: return G[21] * zij + G[28];
    case 971: return G[21] * zij + G[28];
    case 972: return G[22] * zij + G[29];
    case 973: return G[21] * zij + G[28];
    case 974: return G[22] * zij + G[29];
    case 975: return G[23] * zij + G[30];
    case 976: return G[21] * zij + G[28];
    case 977: return G[22] * zij + G[29];
    case 978: return G[23] * zij + G[30];
    case 979: return G[24] * zij + G[31];
    case 980: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 981: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 982: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 983: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 984: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 985: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 986: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 987: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 988: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 989: return G[24] * zij2 + 2.0 * (G[31] * zij) + G[38];
    case 990: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 991: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 992: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    case 993: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 994: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    case 995: return G[23] * pow(zij, 3) + 3.0 * (G[30] * zij2) + 3.0 * (G[37] * zij) + G[44];
    case 996: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 997: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    case 998: return G[23] * pow(zij, 3) + 3.0 * (G[30] * zij2) + 3.0 * (G[37] * zij) + G[44];
    case 999: return G[24] * pow(zij, 3) + 3.0 * (G[31] * zij2) + 3.0 * (G[38] * zij) + G[45];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fffs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 1000;
  constexpr int kNMax = 6;
  constexpr int kMMax = 3;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fffs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fffs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fffs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ssgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[4];
    case 1: return G[3];
    case 2: return G[3];
    case 3: return G[2];
    case 4: return G[2];
    case 5: return G[2];
    case 6: return G[1];
    case 7: return G[1];
    case 8: return G[1];
    case 9: return G[1];
    case 10: return G[0];
    case 11: return G[0];
    case 12: return G[0];
    case 13: return G[0];
    case 14: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ssgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ssgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ssgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 15;
  constexpr int kNMax = 0;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ssgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ssgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ssgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_psgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[11];
    case 1: return G[10];
    case 2: return G[10];
    case 3: return G[9];
    case 4: return G[9];
    case 5: return G[9];
    case 6: return G[8];
    case 7: return G[8];
    case 8: return G[8];
    case 9: return G[8];
    case 10: return G[7];
    case 11: return G[7];
    case 12: return G[7];
    case 13: return G[7];
    case 14: return G[7];
    case 15: return G[4];
    case 16: return G[3];
    case 17: return G[3];
    case 18: return G[2];
    case 19: return G[2];
    case 20: return G[2];
    case 21: return G[1];
    case 22: return G[1];
    case 23: return G[1];
    case 24: return G[1];
    case 25: return G[0];
    case 26: return G[0];
    case 27: return G[0];
    case 28: return G[0];
    case 29: return G[0];
    case 30: return G[4];
    case 31: return G[3];
    case 32: return G[3];
    case 33: return G[2];
    case 34: return G[2];
    case 35: return G[2];
    case 36: return G[1];
    case 37: return G[1];
    case 38: return G[1];
    case 39: return G[1];
    case 40: return G[0];
    case 41: return G[0];
    case 42: return G[0];
    case 43: return G[0];
    case 44: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_psgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[7];
    case 16: return G[8];
    case 17: return G[7];
    case 18: return G[9];
    case 19: return G[8];
    case 20: return G[7];
    case 21: return G[10];
    case 22: return G[9];
    case 23: return G[8];
    case 24: return G[7];
    case 25: return G[11];
    case 26: return G[10];
    case 27: return G[9];
    case 28: return G[8];
    case 29: return G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[3];
    case 37: return G[2];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[4];
    case 41: return G[3];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_psgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[2];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[3];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[2];
    case 28: return G[3];
    case 29: return G[4];
    case 30: return G[7];
    case 31: return G[7];
    case 32: return G[8];
    case 33: return G[7];
    case 34: return G[8];
    case 35: return G[9];
    case 36: return G[7];
    case 37: return G[8];
    case 38: return G[9];
    case 39: return G[10];
    case 40: return G[7];
    case 41: return G[8];
    case 42: return G[9];
    case 43: return G[10];
    case 44: return G[11];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_psgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 45;
  constexpr int kNMax = 1;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_psgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_psgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_psgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ppgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[11] * xij + G[18];
    case 1: return G[10] * xij + G[17];
    case 2: return G[10] * xij + G[17];
    case 3: return G[9] * xij + G[16];
    case 4: return G[9] * xij + G[16];
    case 5: return G[9] * xij + G[16];
    case 6: return G[8] * xij + G[15];
    case 7: return G[8] * xij + G[15];
    case 8: return G[8] * xij + G[15];
    case 9: return G[8] * xij + G[15];
    case 10: return G[7] * xij + G[14];
    case 11: return G[7] * xij + G[14];
    case 12: return G[7] * xij + G[14];
    case 13: return G[7] * xij + G[14];
    case 14: return G[7] * xij + G[14];
    case 15: return G[11];
    case 16: return G[10];
    case 17: return G[10];
    case 18: return G[9];
    case 19: return G[9];
    case 20: return G[9];
    case 21: return G[8];
    case 22: return G[8];
    case 23: return G[8];
    case 24: return G[8];
    case 25: return G[7];
    case 26: return G[7];
    case 27: return G[7];
    case 28: return G[7];
    case 29: return G[7];
    case 30: return G[11];
    case 31: return G[10];
    case 32: return G[10];
    case 33: return G[9];
    case 34: return G[9];
    case 35: return G[9];
    case 36: return G[8];
    case 37: return G[8];
    case 38: return G[8];
    case 39: return G[8];
    case 40: return G[7];
    case 41: return G[7];
    case 42: return G[7];
    case 43: return G[7];
    case 44: return G[7];
    case 45: return G[4] * xij + G[11];
    case 46: return G[3] * xij + G[10];
    case 47: return G[3] * xij + G[10];
    case 48: return G[2] * xij + G[9];
    case 49: return G[2] * xij + G[9];
    case 50: return G[2] * xij + G[9];
    case 51: return G[1] * xij + G[8];
    case 52: return G[1] * xij + G[8];
    case 53: return G[1] * xij + G[8];
    case 54: return G[1] * xij + G[8];
    case 55: return G[0] * xij + G[7];
    case 56: return G[0] * xij + G[7];
    case 57: return G[0] * xij + G[7];
    case 58: return G[0] * xij + G[7];
    case 59: return G[0] * xij + G[7];
    case 60: return G[4];
    case 61: return G[3];
    case 62: return G[3];
    case 63: return G[2];
    case 64: return G[2];
    case 65: return G[2];
    case 66: return G[1];
    case 67: return G[1];
    case 68: return G[1];
    case 69: return G[1];
    case 70: return G[0];
    case 71: return G[0];
    case 72: return G[0];
    case 73: return G[0];
    case 74: return G[0];
    case 75: return G[4];
    case 76: return G[3];
    case 77: return G[3];
    case 78: return G[2];
    case 79: return G[2];
    case 80: return G[2];
    case 81: return G[1];
    case 82: return G[1];
    case 83: return G[1];
    case 84: return G[1];
    case 85: return G[0];
    case 86: return G[0];
    case 87: return G[0];
    case 88: return G[0];
    case 89: return G[0];
    case 90: return G[4] * xij + G[11];
    case 91: return G[3] * xij + G[10];
    case 92: return G[3] * xij + G[10];
    case 93: return G[2] * xij + G[9];
    case 94: return G[2] * xij + G[9];
    case 95: return G[2] * xij + G[9];
    case 96: return G[1] * xij + G[8];
    case 97: return G[1] * xij + G[8];
    case 98: return G[1] * xij + G[8];
    case 99: return G[1] * xij + G[8];
    case 100: return G[0] * xij + G[7];
    case 101: return G[0] * xij + G[7];
    case 102: return G[0] * xij + G[7];
    case 103: return G[0] * xij + G[7];
    case 104: return G[0] * xij + G[7];
    case 105: return G[4];
    case 106: return G[3];
    case 107: return G[3];
    case 108: return G[2];
    case 109: return G[2];
    case 110: return G[2];
    case 111: return G[1];
    case 112: return G[1];
    case 113: return G[1];
    case 114: return G[1];
    case 115: return G[0];
    case 116: return G[0];
    case 117: return G[0];
    case 118: return G[0];
    case 119: return G[0];
    case 120: return G[4];
    case 121: return G[3];
    case 122: return G[3];
    case 123: return G[2];
    case 124: return G[2];
    case 125: return G[2];
    case 126: return G[1];
    case 127: return G[1];
    case 128: return G[1];
    case 129: return G[1];
    case 130: return G[0];
    case 131: return G[0];
    case 132: return G[0];
    case 133: return G[0];
    case 134: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ppgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[0] * yij + G[7];
    case 16: return G[1] * yij + G[8];
    case 17: return G[0] * yij + G[7];
    case 18: return G[2] * yij + G[9];
    case 19: return G[1] * yij + G[8];
    case 20: return G[0] * yij + G[7];
    case 21: return G[3] * yij + G[10];
    case 22: return G[2] * yij + G[9];
    case 23: return G[1] * yij + G[8];
    case 24: return G[0] * yij + G[7];
    case 25: return G[4] * yij + G[11];
    case 26: return G[3] * yij + G[10];
    case 27: return G[2] * yij + G[9];
    case 28: return G[1] * yij + G[8];
    case 29: return G[0] * yij + G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[3];
    case 37: return G[2];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[4];
    case 41: return G[3];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[0];
    case 45: return G[7];
    case 46: return G[8];
    case 47: return G[7];
    case 48: return G[9];
    case 49: return G[8];
    case 50: return G[7];
    case 51: return G[10];
    case 52: return G[9];
    case 53: return G[8];
    case 54: return G[7];
    case 55: return G[11];
    case 56: return G[10];
    case 57: return G[9];
    case 58: return G[8];
    case 59: return G[7];
    case 60: return G[7] * yij + G[14];
    case 61: return G[8] * yij + G[15];
    case 62: return G[7] * yij + G[14];
    case 63: return G[9] * yij + G[16];
    case 64: return G[8] * yij + G[15];
    case 65: return G[7] * yij + G[14];
    case 66: return G[10] * yij + G[17];
    case 67: return G[9] * yij + G[16];
    case 68: return G[8] * yij + G[15];
    case 69: return G[7] * yij + G[14];
    case 70: return G[11] * yij + G[18];
    case 71: return G[10] * yij + G[17];
    case 72: return G[9] * yij + G[16];
    case 73: return G[8] * yij + G[15];
    case 74: return G[7] * yij + G[14];
    case 75: return G[7];
    case 76: return G[8];
    case 77: return G[7];
    case 78: return G[9];
    case 79: return G[8];
    case 80: return G[7];
    case 81: return G[10];
    case 82: return G[9];
    case 83: return G[8];
    case 84: return G[7];
    case 85: return G[11];
    case 86: return G[10];
    case 87: return G[9];
    case 88: return G[8];
    case 89: return G[7];
    case 90: return G[0];
    case 91: return G[1];
    case 92: return G[0];
    case 93: return G[2];
    case 94: return G[1];
    case 95: return G[0];
    case 96: return G[3];
    case 97: return G[2];
    case 98: return G[1];
    case 99: return G[0];
    case 100: return G[4];
    case 101: return G[3];
    case 102: return G[2];
    case 103: return G[1];
    case 104: return G[0];
    case 105: return G[0] * yij + G[7];
    case 106: return G[1] * yij + G[8];
    case 107: return G[0] * yij + G[7];
    case 108: return G[2] * yij + G[9];
    case 109: return G[1] * yij + G[8];
    case 110: return G[0] * yij + G[7];
    case 111: return G[3] * yij + G[10];
    case 112: return G[2] * yij + G[9];
    case 113: return G[1] * yij + G[8];
    case 114: return G[0] * yij + G[7];
    case 115: return G[4] * yij + G[11];
    case 116: return G[3] * yij + G[10];
    case 117: return G[2] * yij + G[9];
    case 118: return G[1] * yij + G[8];
    case 119: return G[0] * yij + G[7];
    case 120: return G[0];
    case 121: return G[1];
    case 122: return G[0];
    case 123: return G[2];
    case 124: return G[1];
    case 125: return G[0];
    case 126: return G[3];
    case 127: return G[2];
    case 128: return G[1];
    case 129: return G[0];
    case 130: return G[4];
    case 131: return G[3];
    case 132: return G[2];
    case 133: return G[1];
    case 134: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ppgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[2];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[3];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[2];
    case 28: return G[3];
    case 29: return G[4];
    case 30: return G[0] * zij + G[7];
    case 31: return G[0] * zij + G[7];
    case 32: return G[1] * zij + G[8];
    case 33: return G[0] * zij + G[7];
    case 34: return G[1] * zij + G[8];
    case 35: return G[2] * zij + G[9];
    case 36: return G[0] * zij + G[7];
    case 37: return G[1] * zij + G[8];
    case 38: return G[2] * zij + G[9];
    case 39: return G[3] * zij + G[10];
    case 40: return G[0] * zij + G[7];
    case 41: return G[1] * zij + G[8];
    case 42: return G[2] * zij + G[9];
    case 43: return G[3] * zij + G[10];
    case 44: return G[4] * zij + G[11];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[2];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[2];
    case 54: return G[3];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[2];
    case 58: return G[3];
    case 59: return G[4];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[1];
    case 63: return G[0];
    case 64: return G[1];
    case 65: return G[2];
    case 66: return G[0];
    case 67: return G[1];
    case 68: return G[2];
    case 69: return G[3];
    case 70: return G[0];
    case 71: return G[1];
    case 72: return G[2];
    case 73: return G[3];
    case 74: return G[4];
    case 75: return G[0] * zij + G[7];
    case 76: return G[0] * zij + G[7];
    case 77: return G[1] * zij + G[8];
    case 78: return G[0] * zij + G[7];
    case 79: return G[1] * zij + G[8];
    case 80: return G[2] * zij + G[9];
    case 81: return G[0] * zij + G[7];
    case 82: return G[1] * zij + G[8];
    case 83: return G[2] * zij + G[9];
    case 84: return G[3] * zij + G[10];
    case 85: return G[0] * zij + G[7];
    case 86: return G[1] * zij + G[8];
    case 87: return G[2] * zij + G[9];
    case 88: return G[3] * zij + G[10];
    case 89: return G[4] * zij + G[11];
    case 90: return G[7];
    case 91: return G[7];
    case 92: return G[8];
    case 93: return G[7];
    case 94: return G[8];
    case 95: return G[9];
    case 96: return G[7];
    case 97: return G[8];
    case 98: return G[9];
    case 99: return G[10];
    case 100: return G[7];
    case 101: return G[8];
    case 102: return G[9];
    case 103: return G[10];
    case 104: return G[11];
    case 105: return G[7];
    case 106: return G[7];
    case 107: return G[8];
    case 108: return G[7];
    case 109: return G[8];
    case 110: return G[9];
    case 111: return G[7];
    case 112: return G[8];
    case 113: return G[9];
    case 114: return G[10];
    case 115: return G[7];
    case 116: return G[8];
    case 117: return G[9];
    case 118: return G[10];
    case 119: return G[11];
    case 120: return G[7] * zij + G[14];
    case 121: return G[7] * zij + G[14];
    case 122: return G[8] * zij + G[15];
    case 123: return G[7] * zij + G[14];
    case 124: return G[8] * zij + G[15];
    case 125: return G[9] * zij + G[16];
    case 126: return G[7] * zij + G[14];
    case 127: return G[8] * zij + G[15];
    case 128: return G[9] * zij + G[16];
    case 129: return G[10] * zij + G[17];
    case 130: return G[7] * zij + G[14];
    case 131: return G[8] * zij + G[15];
    case 132: return G[9] * zij + G[16];
    case 133: return G[10] * zij + G[17];
    case 134: return G[11] * zij + G[18];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ppgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 135;
  constexpr int kNMax = 2;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ppgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ppgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ppgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_dsgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[18];
    case 1: return G[17];
    case 2: return G[17];
    case 3: return G[16];
    case 4: return G[16];
    case 5: return G[16];
    case 6: return G[15];
    case 7: return G[15];
    case 8: return G[15];
    case 9: return G[15];
    case 10: return G[14];
    case 11: return G[14];
    case 12: return G[14];
    case 13: return G[14];
    case 14: return G[14];
    case 15: return G[11];
    case 16: return G[10];
    case 17: return G[10];
    case 18: return G[9];
    case 19: return G[9];
    case 20: return G[9];
    case 21: return G[8];
    case 22: return G[8];
    case 23: return G[8];
    case 24: return G[8];
    case 25: return G[7];
    case 26: return G[7];
    case 27: return G[7];
    case 28: return G[7];
    case 29: return G[7];
    case 30: return G[11];
    case 31: return G[10];
    case 32: return G[10];
    case 33: return G[9];
    case 34: return G[9];
    case 35: return G[9];
    case 36: return G[8];
    case 37: return G[8];
    case 38: return G[8];
    case 39: return G[8];
    case 40: return G[7];
    case 41: return G[7];
    case 42: return G[7];
    case 43: return G[7];
    case 44: return G[7];
    case 45: return G[4];
    case 46: return G[3];
    case 47: return G[3];
    case 48: return G[2];
    case 49: return G[2];
    case 50: return G[2];
    case 51: return G[1];
    case 52: return G[1];
    case 53: return G[1];
    case 54: return G[1];
    case 55: return G[0];
    case 56: return G[0];
    case 57: return G[0];
    case 58: return G[0];
    case 59: return G[0];
    case 60: return G[4];
    case 61: return G[3];
    case 62: return G[3];
    case 63: return G[2];
    case 64: return G[2];
    case 65: return G[2];
    case 66: return G[1];
    case 67: return G[1];
    case 68: return G[1];
    case 69: return G[1];
    case 70: return G[0];
    case 71: return G[0];
    case 72: return G[0];
    case 73: return G[0];
    case 74: return G[0];
    case 75: return G[4];
    case 76: return G[3];
    case 77: return G[3];
    case 78: return G[2];
    case 79: return G[2];
    case 80: return G[2];
    case 81: return G[1];
    case 82: return G[1];
    case 83: return G[1];
    case 84: return G[1];
    case 85: return G[0];
    case 86: return G[0];
    case 87: return G[0];
    case 88: return G[0];
    case 89: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[7];
    case 16: return G[8];
    case 17: return G[7];
    case 18: return G[9];
    case 19: return G[8];
    case 20: return G[7];
    case 21: return G[10];
    case 22: return G[9];
    case 23: return G[8];
    case 24: return G[7];
    case 25: return G[11];
    case 26: return G[10];
    case 27: return G[9];
    case 28: return G[8];
    case 29: return G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[3];
    case 37: return G[2];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[4];
    case 41: return G[3];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[0];
    case 45: return G[14];
    case 46: return G[15];
    case 47: return G[14];
    case 48: return G[16];
    case 49: return G[15];
    case 50: return G[14];
    case 51: return G[17];
    case 52: return G[16];
    case 53: return G[15];
    case 54: return G[14];
    case 55: return G[18];
    case 56: return G[17];
    case 57: return G[16];
    case 58: return G[15];
    case 59: return G[14];
    case 60: return G[7];
    case 61: return G[8];
    case 62: return G[7];
    case 63: return G[9];
    case 64: return G[8];
    case 65: return G[7];
    case 66: return G[10];
    case 67: return G[9];
    case 68: return G[8];
    case 69: return G[7];
    case 70: return G[11];
    case 71: return G[10];
    case 72: return G[9];
    case 73: return G[8];
    case 74: return G[7];
    case 75: return G[0];
    case 76: return G[1];
    case 77: return G[0];
    case 78: return G[2];
    case 79: return G[1];
    case 80: return G[0];
    case 81: return G[3];
    case 82: return G[2];
    case 83: return G[1];
    case 84: return G[0];
    case 85: return G[4];
    case 86: return G[3];
    case 87: return G[2];
    case 88: return G[1];
    case 89: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dsgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[2];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[3];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[2];
    case 28: return G[3];
    case 29: return G[4];
    case 30: return G[7];
    case 31: return G[7];
    case 32: return G[8];
    case 33: return G[7];
    case 34: return G[8];
    case 35: return G[9];
    case 36: return G[7];
    case 37: return G[8];
    case 38: return G[9];
    case 39: return G[10];
    case 40: return G[7];
    case 41: return G[8];
    case 42: return G[9];
    case 43: return G[10];
    case 44: return G[11];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[2];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[2];
    case 54: return G[3];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[2];
    case 58: return G[3];
    case 59: return G[4];
    case 60: return G[7];
    case 61: return G[7];
    case 62: return G[8];
    case 63: return G[7];
    case 64: return G[8];
    case 65: return G[9];
    case 66: return G[7];
    case 67: return G[8];
    case 68: return G[9];
    case 69: return G[10];
    case 70: return G[7];
    case 71: return G[8];
    case 72: return G[9];
    case 73: return G[10];
    case 74: return G[11];
    case 75: return G[14];
    case 76: return G[14];
    case 77: return G[15];
    case 78: return G[14];
    case 79: return G[15];
    case 80: return G[16];
    case 81: return G[14];
    case 82: return G[15];
    case 83: return G[16];
    case 84: return G[17];
    case 85: return G[14];
    case 86: return G[15];
    case 87: return G[16];
    case 88: return G[17];
    case 89: return G[18];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_dsgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 90;
  constexpr int kNMax = 2;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_dsgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_dsgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_dsgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fsgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[25];
    case 1: return G[24];
    case 2: return G[24];
    case 3: return G[23];
    case 4: return G[23];
    case 5: return G[23];
    case 6: return G[22];
    case 7: return G[22];
    case 8: return G[22];
    case 9: return G[22];
    case 10: return G[21];
    case 11: return G[21];
    case 12: return G[21];
    case 13: return G[21];
    case 14: return G[21];
    case 15: return G[18];
    case 16: return G[17];
    case 17: return G[17];
    case 18: return G[16];
    case 19: return G[16];
    case 20: return G[16];
    case 21: return G[15];
    case 22: return G[15];
    case 23: return G[15];
    case 24: return G[15];
    case 25: return G[14];
    case 26: return G[14];
    case 27: return G[14];
    case 28: return G[14];
    case 29: return G[14];
    case 30: return G[18];
    case 31: return G[17];
    case 32: return G[17];
    case 33: return G[16];
    case 34: return G[16];
    case 35: return G[16];
    case 36: return G[15];
    case 37: return G[15];
    case 38: return G[15];
    case 39: return G[15];
    case 40: return G[14];
    case 41: return G[14];
    case 42: return G[14];
    case 43: return G[14];
    case 44: return G[14];
    case 45: return G[11];
    case 46: return G[10];
    case 47: return G[10];
    case 48: return G[9];
    case 49: return G[9];
    case 50: return G[9];
    case 51: return G[8];
    case 52: return G[8];
    case 53: return G[8];
    case 54: return G[8];
    case 55: return G[7];
    case 56: return G[7];
    case 57: return G[7];
    case 58: return G[7];
    case 59: return G[7];
    case 60: return G[11];
    case 61: return G[10];
    case 62: return G[10];
    case 63: return G[9];
    case 64: return G[9];
    case 65: return G[9];
    case 66: return G[8];
    case 67: return G[8];
    case 68: return G[8];
    case 69: return G[8];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[7];
    case 73: return G[7];
    case 74: return G[7];
    case 75: return G[11];
    case 76: return G[10];
    case 77: return G[10];
    case 78: return G[9];
    case 79: return G[9];
    case 80: return G[9];
    case 81: return G[8];
    case 82: return G[8];
    case 83: return G[8];
    case 84: return G[8];
    case 85: return G[7];
    case 86: return G[7];
    case 87: return G[7];
    case 88: return G[7];
    case 89: return G[7];
    case 90: return G[4];
    case 91: return G[3];
    case 92: return G[3];
    case 93: return G[2];
    case 94: return G[2];
    case 95: return G[2];
    case 96: return G[1];
    case 97: return G[1];
    case 98: return G[1];
    case 99: return G[1];
    case 100: return G[0];
    case 101: return G[0];
    case 102: return G[0];
    case 103: return G[0];
    case 104: return G[0];
    case 105: return G[4];
    case 106: return G[3];
    case 107: return G[3];
    case 108: return G[2];
    case 109: return G[2];
    case 110: return G[2];
    case 111: return G[1];
    case 112: return G[1];
    case 113: return G[1];
    case 114: return G[1];
    case 115: return G[0];
    case 116: return G[0];
    case 117: return G[0];
    case 118: return G[0];
    case 119: return G[0];
    case 120: return G[4];
    case 121: return G[3];
    case 122: return G[3];
    case 123: return G[2];
    case 124: return G[2];
    case 125: return G[2];
    case 126: return G[1];
    case 127: return G[1];
    case 128: return G[1];
    case 129: return G[1];
    case 130: return G[0];
    case 131: return G[0];
    case 132: return G[0];
    case 133: return G[0];
    case 134: return G[0];
    case 135: return G[4];
    case 136: return G[3];
    case 137: return G[3];
    case 138: return G[2];
    case 139: return G[2];
    case 140: return G[2];
    case 141: return G[1];
    case 142: return G[1];
    case 143: return G[1];
    case 144: return G[1];
    case 145: return G[0];
    case 146: return G[0];
    case 147: return G[0];
    case 148: return G[0];
    case 149: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fsgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[7];
    case 16: return G[8];
    case 17: return G[7];
    case 18: return G[9];
    case 19: return G[8];
    case 20: return G[7];
    case 21: return G[10];
    case 22: return G[9];
    case 23: return G[8];
    case 24: return G[7];
    case 25: return G[11];
    case 26: return G[10];
    case 27: return G[9];
    case 28: return G[8];
    case 29: return G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[3];
    case 37: return G[2];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[4];
    case 41: return G[3];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[0];
    case 45: return G[14];
    case 46: return G[15];
    case 47: return G[14];
    case 48: return G[16];
    case 49: return G[15];
    case 50: return G[14];
    case 51: return G[17];
    case 52: return G[16];
    case 53: return G[15];
    case 54: return G[14];
    case 55: return G[18];
    case 56: return G[17];
    case 57: return G[16];
    case 58: return G[15];
    case 59: return G[14];
    case 60: return G[7];
    case 61: return G[8];
    case 62: return G[7];
    case 63: return G[9];
    case 64: return G[8];
    case 65: return G[7];
    case 66: return G[10];
    case 67: return G[9];
    case 68: return G[8];
    case 69: return G[7];
    case 70: return G[11];
    case 71: return G[10];
    case 72: return G[9];
    case 73: return G[8];
    case 74: return G[7];
    case 75: return G[0];
    case 76: return G[1];
    case 77: return G[0];
    case 78: return G[2];
    case 79: return G[1];
    case 80: return G[0];
    case 81: return G[3];
    case 82: return G[2];
    case 83: return G[1];
    case 84: return G[0];
    case 85: return G[4];
    case 86: return G[3];
    case 87: return G[2];
    case 88: return G[1];
    case 89: return G[0];
    case 90: return G[21];
    case 91: return G[22];
    case 92: return G[21];
    case 93: return G[23];
    case 94: return G[22];
    case 95: return G[21];
    case 96: return G[24];
    case 97: return G[23];
    case 98: return G[22];
    case 99: return G[21];
    case 100: return G[25];
    case 101: return G[24];
    case 102: return G[23];
    case 103: return G[22];
    case 104: return G[21];
    case 105: return G[14];
    case 106: return G[15];
    case 107: return G[14];
    case 108: return G[16];
    case 109: return G[15];
    case 110: return G[14];
    case 111: return G[17];
    case 112: return G[16];
    case 113: return G[15];
    case 114: return G[14];
    case 115: return G[18];
    case 116: return G[17];
    case 117: return G[16];
    case 118: return G[15];
    case 119: return G[14];
    case 120: return G[7];
    case 121: return G[8];
    case 122: return G[7];
    case 123: return G[9];
    case 124: return G[8];
    case 125: return G[7];
    case 126: return G[10];
    case 127: return G[9];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[11];
    case 131: return G[10];
    case 132: return G[9];
    case 133: return G[8];
    case 134: return G[7];
    case 135: return G[0];
    case 136: return G[1];
    case 137: return G[0];
    case 138: return G[2];
    case 139: return G[1];
    case 140: return G[0];
    case 141: return G[3];
    case 142: return G[2];
    case 143: return G[1];
    case 144: return G[0];
    case 145: return G[4];
    case 146: return G[3];
    case 147: return G[2];
    case 148: return G[1];
    case 149: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fsgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[2];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[3];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[2];
    case 28: return G[3];
    case 29: return G[4];
    case 30: return G[7];
    case 31: return G[7];
    case 32: return G[8];
    case 33: return G[7];
    case 34: return G[8];
    case 35: return G[9];
    case 36: return G[7];
    case 37: return G[8];
    case 38: return G[9];
    case 39: return G[10];
    case 40: return G[7];
    case 41: return G[8];
    case 42: return G[9];
    case 43: return G[10];
    case 44: return G[11];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[2];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[2];
    case 54: return G[3];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[2];
    case 58: return G[3];
    case 59: return G[4];
    case 60: return G[7];
    case 61: return G[7];
    case 62: return G[8];
    case 63: return G[7];
    case 64: return G[8];
    case 65: return G[9];
    case 66: return G[7];
    case 67: return G[8];
    case 68: return G[9];
    case 69: return G[10];
    case 70: return G[7];
    case 71: return G[8];
    case 72: return G[9];
    case 73: return G[10];
    case 74: return G[11];
    case 75: return G[14];
    case 76: return G[14];
    case 77: return G[15];
    case 78: return G[14];
    case 79: return G[15];
    case 80: return G[16];
    case 81: return G[14];
    case 82: return G[15];
    case 83: return G[16];
    case 84: return G[17];
    case 85: return G[14];
    case 86: return G[15];
    case 87: return G[16];
    case 88: return G[17];
    case 89: return G[18];
    case 90: return G[0];
    case 91: return G[0];
    case 92: return G[1];
    case 93: return G[0];
    case 94: return G[1];
    case 95: return G[2];
    case 96: return G[0];
    case 97: return G[1];
    case 98: return G[2];
    case 99: return G[3];
    case 100: return G[0];
    case 101: return G[1];
    case 102: return G[2];
    case 103: return G[3];
    case 104: return G[4];
    case 105: return G[7];
    case 106: return G[7];
    case 107: return G[8];
    case 108: return G[7];
    case 109: return G[8];
    case 110: return G[9];
    case 111: return G[7];
    case 112: return G[8];
    case 113: return G[9];
    case 114: return G[10];
    case 115: return G[7];
    case 116: return G[8];
    case 117: return G[9];
    case 118: return G[10];
    case 119: return G[11];
    case 120: return G[14];
    case 121: return G[14];
    case 122: return G[15];
    case 123: return G[14];
    case 124: return G[15];
    case 125: return G[16];
    case 126: return G[14];
    case 127: return G[15];
    case 128: return G[16];
    case 129: return G[17];
    case 130: return G[14];
    case 131: return G[15];
    case 132: return G[16];
    case 133: return G[17];
    case 134: return G[18];
    case 135: return G[21];
    case 136: return G[21];
    case 137: return G[22];
    case 138: return G[21];
    case 139: return G[22];
    case 140: return G[23];
    case 141: return G[21];
    case 142: return G[22];
    case 143: return G[23];
    case 144: return G[24];
    case 145: return G[21];
    case 146: return G[22];
    case 147: return G[23];
    case 148: return G[24];
    case 149: return G[25];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fsgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 150;
  constexpr int kNMax = 3;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fsgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fsgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fsgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_dpgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[18] * xij + G[25];
    case 1: return G[17] * xij + G[24];
    case 2: return G[17] * xij + G[24];
    case 3: return G[16] * xij + G[23];
    case 4: return G[16] * xij + G[23];
    case 5: return G[16] * xij + G[23];
    case 6: return G[15] * xij + G[22];
    case 7: return G[15] * xij + G[22];
    case 8: return G[15] * xij + G[22];
    case 9: return G[15] * xij + G[22];
    case 10: return G[14] * xij + G[21];
    case 11: return G[14] * xij + G[21];
    case 12: return G[14] * xij + G[21];
    case 13: return G[14] * xij + G[21];
    case 14: return G[14] * xij + G[21];
    case 15: return G[18];
    case 16: return G[17];
    case 17: return G[17];
    case 18: return G[16];
    case 19: return G[16];
    case 20: return G[16];
    case 21: return G[15];
    case 22: return G[15];
    case 23: return G[15];
    case 24: return G[15];
    case 25: return G[14];
    case 26: return G[14];
    case 27: return G[14];
    case 28: return G[14];
    case 29: return G[14];
    case 30: return G[18];
    case 31: return G[17];
    case 32: return G[17];
    case 33: return G[16];
    case 34: return G[16];
    case 35: return G[16];
    case 36: return G[15];
    case 37: return G[15];
    case 38: return G[15];
    case 39: return G[15];
    case 40: return G[14];
    case 41: return G[14];
    case 42: return G[14];
    case 43: return G[14];
    case 44: return G[14];
    case 45: return G[11] * xij + G[18];
    case 46: return G[10] * xij + G[17];
    case 47: return G[10] * xij + G[17];
    case 48: return G[9] * xij + G[16];
    case 49: return G[9] * xij + G[16];
    case 50: return G[9] * xij + G[16];
    case 51: return G[8] * xij + G[15];
    case 52: return G[8] * xij + G[15];
    case 53: return G[8] * xij + G[15];
    case 54: return G[8] * xij + G[15];
    case 55: return G[7] * xij + G[14];
    case 56: return G[7] * xij + G[14];
    case 57: return G[7] * xij + G[14];
    case 58: return G[7] * xij + G[14];
    case 59: return G[7] * xij + G[14];
    case 60: return G[11];
    case 61: return G[10];
    case 62: return G[10];
    case 63: return G[9];
    case 64: return G[9];
    case 65: return G[9];
    case 66: return G[8];
    case 67: return G[8];
    case 68: return G[8];
    case 69: return G[8];
    case 70: return G[7];
    case 71: return G[7];
    case 72: return G[7];
    case 73: return G[7];
    case 74: return G[7];
    case 75: return G[11];
    case 76: return G[10];
    case 77: return G[10];
    case 78: return G[9];
    case 79: return G[9];
    case 80: return G[9];
    case 81: return G[8];
    case 82: return G[8];
    case 83: return G[8];
    case 84: return G[8];
    case 85: return G[7];
    case 86: return G[7];
    case 87: return G[7];
    case 88: return G[7];
    case 89: return G[7];
    case 90: return G[11] * xij + G[18];
    case 91: return G[10] * xij + G[17];
    case 92: return G[10] * xij + G[17];
    case 93: return G[9] * xij + G[16];
    case 94: return G[9] * xij + G[16];
    case 95: return G[9] * xij + G[16];
    case 96: return G[8] * xij + G[15];
    case 97: return G[8] * xij + G[15];
    case 98: return G[8] * xij + G[15];
    case 99: return G[8] * xij + G[15];
    case 100: return G[7] * xij + G[14];
    case 101: return G[7] * xij + G[14];
    case 102: return G[7] * xij + G[14];
    case 103: return G[7] * xij + G[14];
    case 104: return G[7] * xij + G[14];
    case 105: return G[11];
    case 106: return G[10];
    case 107: return G[10];
    case 108: return G[9];
    case 109: return G[9];
    case 110: return G[9];
    case 111: return G[8];
    case 112: return G[8];
    case 113: return G[8];
    case 114: return G[8];
    case 115: return G[7];
    case 116: return G[7];
    case 117: return G[7];
    case 118: return G[7];
    case 119: return G[7];
    case 120: return G[11];
    case 121: return G[10];
    case 122: return G[10];
    case 123: return G[9];
    case 124: return G[9];
    case 125: return G[9];
    case 126: return G[8];
    case 127: return G[8];
    case 128: return G[8];
    case 129: return G[8];
    case 130: return G[7];
    case 131: return G[7];
    case 132: return G[7];
    case 133: return G[7];
    case 134: return G[7];
    case 135: return G[4] * xij + G[11];
    case 136: return G[3] * xij + G[10];
    case 137: return G[3] * xij + G[10];
    case 138: return G[2] * xij + G[9];
    case 139: return G[2] * xij + G[9];
    case 140: return G[2] * xij + G[9];
    case 141: return G[1] * xij + G[8];
    case 142: return G[1] * xij + G[8];
    case 143: return G[1] * xij + G[8];
    case 144: return G[1] * xij + G[8];
    case 145: return G[0] * xij + G[7];
    case 146: return G[0] * xij + G[7];
    case 147: return G[0] * xij + G[7];
    case 148: return G[0] * xij + G[7];
    case 149: return G[0] * xij + G[7];
    case 150: return G[4];
    case 151: return G[3];
    case 152: return G[3];
    case 153: return G[2];
    case 154: return G[2];
    case 155: return G[2];
    case 156: return G[1];
    case 157: return G[1];
    case 158: return G[1];
    case 159: return G[1];
    case 160: return G[0];
    case 161: return G[0];
    case 162: return G[0];
    case 163: return G[0];
    case 164: return G[0];
    case 165: return G[4];
    case 166: return G[3];
    case 167: return G[3];
    case 168: return G[2];
    case 169: return G[2];
    case 170: return G[2];
    case 171: return G[1];
    case 172: return G[1];
    case 173: return G[1];
    case 174: return G[1];
    case 175: return G[0];
    case 176: return G[0];
    case 177: return G[0];
    case 178: return G[0];
    case 179: return G[0];
    case 180: return G[4] * xij + G[11];
    case 181: return G[3] * xij + G[10];
    case 182: return G[3] * xij + G[10];
    case 183: return G[2] * xij + G[9];
    case 184: return G[2] * xij + G[9];
    case 185: return G[2] * xij + G[9];
    case 186: return G[1] * xij + G[8];
    case 187: return G[1] * xij + G[8];
    case 188: return G[1] * xij + G[8];
    case 189: return G[1] * xij + G[8];
    case 190: return G[0] * xij + G[7];
    case 191: return G[0] * xij + G[7];
    case 192: return G[0] * xij + G[7];
    case 193: return G[0] * xij + G[7];
    case 194: return G[0] * xij + G[7];
    case 195: return G[4];
    case 196: return G[3];
    case 197: return G[3];
    case 198: return G[2];
    case 199: return G[2];
    case 200: return G[2];
    case 201: return G[1];
    case 202: return G[1];
    case 203: return G[1];
    case 204: return G[1];
    case 205: return G[0];
    case 206: return G[0];
    case 207: return G[0];
    case 208: return G[0];
    case 209: return G[0];
    case 210: return G[4];
    case 211: return G[3];
    case 212: return G[3];
    case 213: return G[2];
    case 214: return G[2];
    case 215: return G[2];
    case 216: return G[1];
    case 217: return G[1];
    case 218: return G[1];
    case 219: return G[1];
    case 220: return G[0];
    case 221: return G[0];
    case 222: return G[0];
    case 223: return G[0];
    case 224: return G[0];
    case 225: return G[4] * xij + G[11];
    case 226: return G[3] * xij + G[10];
    case 227: return G[3] * xij + G[10];
    case 228: return G[2] * xij + G[9];
    case 229: return G[2] * xij + G[9];
    case 230: return G[2] * xij + G[9];
    case 231: return G[1] * xij + G[8];
    case 232: return G[1] * xij + G[8];
    case 233: return G[1] * xij + G[8];
    case 234: return G[1] * xij + G[8];
    case 235: return G[0] * xij + G[7];
    case 236: return G[0] * xij + G[7];
    case 237: return G[0] * xij + G[7];
    case 238: return G[0] * xij + G[7];
    case 239: return G[0] * xij + G[7];
    case 240: return G[4];
    case 241: return G[3];
    case 242: return G[3];
    case 243: return G[2];
    case 244: return G[2];
    case 245: return G[2];
    case 246: return G[1];
    case 247: return G[1];
    case 248: return G[1];
    case 249: return G[1];
    case 250: return G[0];
    case 251: return G[0];
    case 252: return G[0];
    case 253: return G[0];
    case 254: return G[0];
    case 255: return G[4];
    case 256: return G[3];
    case 257: return G[3];
    case 258: return G[2];
    case 259: return G[2];
    case 260: return G[2];
    case 261: return G[1];
    case 262: return G[1];
    case 263: return G[1];
    case 264: return G[1];
    case 265: return G[0];
    case 266: return G[0];
    case 267: return G[0];
    case 268: return G[0];
    case 269: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dpgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[0] * yij + G[7];
    case 16: return G[1] * yij + G[8];
    case 17: return G[0] * yij + G[7];
    case 18: return G[2] * yij + G[9];
    case 19: return G[1] * yij + G[8];
    case 20: return G[0] * yij + G[7];
    case 21: return G[3] * yij + G[10];
    case 22: return G[2] * yij + G[9];
    case 23: return G[1] * yij + G[8];
    case 24: return G[0] * yij + G[7];
    case 25: return G[4] * yij + G[11];
    case 26: return G[3] * yij + G[10];
    case 27: return G[2] * yij + G[9];
    case 28: return G[1] * yij + G[8];
    case 29: return G[0] * yij + G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[3];
    case 37: return G[2];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[4];
    case 41: return G[3];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[0];
    case 45: return G[7];
    case 46: return G[8];
    case 47: return G[7];
    case 48: return G[9];
    case 49: return G[8];
    case 50: return G[7];
    case 51: return G[10];
    case 52: return G[9];
    case 53: return G[8];
    case 54: return G[7];
    case 55: return G[11];
    case 56: return G[10];
    case 57: return G[9];
    case 58: return G[8];
    case 59: return G[7];
    case 60: return G[7] * yij + G[14];
    case 61: return G[8] * yij + G[15];
    case 62: return G[7] * yij + G[14];
    case 63: return G[9] * yij + G[16];
    case 64: return G[8] * yij + G[15];
    case 65: return G[7] * yij + G[14];
    case 66: return G[10] * yij + G[17];
    case 67: return G[9] * yij + G[16];
    case 68: return G[8] * yij + G[15];
    case 69: return G[7] * yij + G[14];
    case 70: return G[11] * yij + G[18];
    case 71: return G[10] * yij + G[17];
    case 72: return G[9] * yij + G[16];
    case 73: return G[8] * yij + G[15];
    case 74: return G[7] * yij + G[14];
    case 75: return G[7];
    case 76: return G[8];
    case 77: return G[7];
    case 78: return G[9];
    case 79: return G[8];
    case 80: return G[7];
    case 81: return G[10];
    case 82: return G[9];
    case 83: return G[8];
    case 84: return G[7];
    case 85: return G[11];
    case 86: return G[10];
    case 87: return G[9];
    case 88: return G[8];
    case 89: return G[7];
    case 90: return G[0];
    case 91: return G[1];
    case 92: return G[0];
    case 93: return G[2];
    case 94: return G[1];
    case 95: return G[0];
    case 96: return G[3];
    case 97: return G[2];
    case 98: return G[1];
    case 99: return G[0];
    case 100: return G[4];
    case 101: return G[3];
    case 102: return G[2];
    case 103: return G[1];
    case 104: return G[0];
    case 105: return G[0] * yij + G[7];
    case 106: return G[1] * yij + G[8];
    case 107: return G[0] * yij + G[7];
    case 108: return G[2] * yij + G[9];
    case 109: return G[1] * yij + G[8];
    case 110: return G[0] * yij + G[7];
    case 111: return G[3] * yij + G[10];
    case 112: return G[2] * yij + G[9];
    case 113: return G[1] * yij + G[8];
    case 114: return G[0] * yij + G[7];
    case 115: return G[4] * yij + G[11];
    case 116: return G[3] * yij + G[10];
    case 117: return G[2] * yij + G[9];
    case 118: return G[1] * yij + G[8];
    case 119: return G[0] * yij + G[7];
    case 120: return G[0];
    case 121: return G[1];
    case 122: return G[0];
    case 123: return G[2];
    case 124: return G[1];
    case 125: return G[0];
    case 126: return G[3];
    case 127: return G[2];
    case 128: return G[1];
    case 129: return G[0];
    case 130: return G[4];
    case 131: return G[3];
    case 132: return G[2];
    case 133: return G[1];
    case 134: return G[0];
    case 135: return G[14];
    case 136: return G[15];
    case 137: return G[14];
    case 138: return G[16];
    case 139: return G[15];
    case 140: return G[14];
    case 141: return G[17];
    case 142: return G[16];
    case 143: return G[15];
    case 144: return G[14];
    case 145: return G[18];
    case 146: return G[17];
    case 147: return G[16];
    case 148: return G[15];
    case 149: return G[14];
    case 150: return G[14] * yij + G[21];
    case 151: return G[15] * yij + G[22];
    case 152: return G[14] * yij + G[21];
    case 153: return G[16] * yij + G[23];
    case 154: return G[15] * yij + G[22];
    case 155: return G[14] * yij + G[21];
    case 156: return G[17] * yij + G[24];
    case 157: return G[16] * yij + G[23];
    case 158: return G[15] * yij + G[22];
    case 159: return G[14] * yij + G[21];
    case 160: return G[18] * yij + G[25];
    case 161: return G[17] * yij + G[24];
    case 162: return G[16] * yij + G[23];
    case 163: return G[15] * yij + G[22];
    case 164: return G[14] * yij + G[21];
    case 165: return G[14];
    case 166: return G[15];
    case 167: return G[14];
    case 168: return G[16];
    case 169: return G[15];
    case 170: return G[14];
    case 171: return G[17];
    case 172: return G[16];
    case 173: return G[15];
    case 174: return G[14];
    case 175: return G[18];
    case 176: return G[17];
    case 177: return G[16];
    case 178: return G[15];
    case 179: return G[14];
    case 180: return G[7];
    case 181: return G[8];
    case 182: return G[7];
    case 183: return G[9];
    case 184: return G[8];
    case 185: return G[7];
    case 186: return G[10];
    case 187: return G[9];
    case 188: return G[8];
    case 189: return G[7];
    case 190: return G[11];
    case 191: return G[10];
    case 192: return G[9];
    case 193: return G[8];
    case 194: return G[7];
    case 195: return G[7] * yij + G[14];
    case 196: return G[8] * yij + G[15];
    case 197: return G[7] * yij + G[14];
    case 198: return G[9] * yij + G[16];
    case 199: return G[8] * yij + G[15];
    case 200: return G[7] * yij + G[14];
    case 201: return G[10] * yij + G[17];
    case 202: return G[9] * yij + G[16];
    case 203: return G[8] * yij + G[15];
    case 204: return G[7] * yij + G[14];
    case 205: return G[11] * yij + G[18];
    case 206: return G[10] * yij + G[17];
    case 207: return G[9] * yij + G[16];
    case 208: return G[8] * yij + G[15];
    case 209: return G[7] * yij + G[14];
    case 210: return G[7];
    case 211: return G[8];
    case 212: return G[7];
    case 213: return G[9];
    case 214: return G[8];
    case 215: return G[7];
    case 216: return G[10];
    case 217: return G[9];
    case 218: return G[8];
    case 219: return G[7];
    case 220: return G[11];
    case 221: return G[10];
    case 222: return G[9];
    case 223: return G[8];
    case 224: return G[7];
    case 225: return G[0];
    case 226: return G[1];
    case 227: return G[0];
    case 228: return G[2];
    case 229: return G[1];
    case 230: return G[0];
    case 231: return G[3];
    case 232: return G[2];
    case 233: return G[1];
    case 234: return G[0];
    case 235: return G[4];
    case 236: return G[3];
    case 237: return G[2];
    case 238: return G[1];
    case 239: return G[0];
    case 240: return G[0] * yij + G[7];
    case 241: return G[1] * yij + G[8];
    case 242: return G[0] * yij + G[7];
    case 243: return G[2] * yij + G[9];
    case 244: return G[1] * yij + G[8];
    case 245: return G[0] * yij + G[7];
    case 246: return G[3] * yij + G[10];
    case 247: return G[2] * yij + G[9];
    case 248: return G[1] * yij + G[8];
    case 249: return G[0] * yij + G[7];
    case 250: return G[4] * yij + G[11];
    case 251: return G[3] * yij + G[10];
    case 252: return G[2] * yij + G[9];
    case 253: return G[1] * yij + G[8];
    case 254: return G[0] * yij + G[7];
    case 255: return G[0];
    case 256: return G[1];
    case 257: return G[0];
    case 258: return G[2];
    case 259: return G[1];
    case 260: return G[0];
    case 261: return G[3];
    case 262: return G[2];
    case 263: return G[1];
    case 264: return G[0];
    case 265: return G[4];
    case 266: return G[3];
    case 267: return G[2];
    case 268: return G[1];
    case 269: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_dpgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[2];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[3];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[2];
    case 28: return G[3];
    case 29: return G[4];
    case 30: return G[0] * zij + G[7];
    case 31: return G[0] * zij + G[7];
    case 32: return G[1] * zij + G[8];
    case 33: return G[0] * zij + G[7];
    case 34: return G[1] * zij + G[8];
    case 35: return G[2] * zij + G[9];
    case 36: return G[0] * zij + G[7];
    case 37: return G[1] * zij + G[8];
    case 38: return G[2] * zij + G[9];
    case 39: return G[3] * zij + G[10];
    case 40: return G[0] * zij + G[7];
    case 41: return G[1] * zij + G[8];
    case 42: return G[2] * zij + G[9];
    case 43: return G[3] * zij + G[10];
    case 44: return G[4] * zij + G[11];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[2];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[2];
    case 54: return G[3];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[2];
    case 58: return G[3];
    case 59: return G[4];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[1];
    case 63: return G[0];
    case 64: return G[1];
    case 65: return G[2];
    case 66: return G[0];
    case 67: return G[1];
    case 68: return G[2];
    case 69: return G[3];
    case 70: return G[0];
    case 71: return G[1];
    case 72: return G[2];
    case 73: return G[3];
    case 74: return G[4];
    case 75: return G[0] * zij + G[7];
    case 76: return G[0] * zij + G[7];
    case 77: return G[1] * zij + G[8];
    case 78: return G[0] * zij + G[7];
    case 79: return G[1] * zij + G[8];
    case 80: return G[2] * zij + G[9];
    case 81: return G[0] * zij + G[7];
    case 82: return G[1] * zij + G[8];
    case 83: return G[2] * zij + G[9];
    case 84: return G[3] * zij + G[10];
    case 85: return G[0] * zij + G[7];
    case 86: return G[1] * zij + G[8];
    case 87: return G[2] * zij + G[9];
    case 88: return G[3] * zij + G[10];
    case 89: return G[4] * zij + G[11];
    case 90: return G[7];
    case 91: return G[7];
    case 92: return G[8];
    case 93: return G[7];
    case 94: return G[8];
    case 95: return G[9];
    case 96: return G[7];
    case 97: return G[8];
    case 98: return G[9];
    case 99: return G[10];
    case 100: return G[7];
    case 101: return G[8];
    case 102: return G[9];
    case 103: return G[10];
    case 104: return G[11];
    case 105: return G[7];
    case 106: return G[7];
    case 107: return G[8];
    case 108: return G[7];
    case 109: return G[8];
    case 110: return G[9];
    case 111: return G[7];
    case 112: return G[8];
    case 113: return G[9];
    case 114: return G[10];
    case 115: return G[7];
    case 116: return G[8];
    case 117: return G[9];
    case 118: return G[10];
    case 119: return G[11];
    case 120: return G[7] * zij + G[14];
    case 121: return G[7] * zij + G[14];
    case 122: return G[8] * zij + G[15];
    case 123: return G[7] * zij + G[14];
    case 124: return G[8] * zij + G[15];
    case 125: return G[9] * zij + G[16];
    case 126: return G[7] * zij + G[14];
    case 127: return G[8] * zij + G[15];
    case 128: return G[9] * zij + G[16];
    case 129: return G[10] * zij + G[17];
    case 130: return G[7] * zij + G[14];
    case 131: return G[8] * zij + G[15];
    case 132: return G[9] * zij + G[16];
    case 133: return G[10] * zij + G[17];
    case 134: return G[11] * zij + G[18];
    case 135: return G[0];
    case 136: return G[0];
    case 137: return G[1];
    case 138: return G[0];
    case 139: return G[1];
    case 140: return G[2];
    case 141: return G[0];
    case 142: return G[1];
    case 143: return G[2];
    case 144: return G[3];
    case 145: return G[0];
    case 146: return G[1];
    case 147: return G[2];
    case 148: return G[3];
    case 149: return G[4];
    case 150: return G[0];
    case 151: return G[0];
    case 152: return G[1];
    case 153: return G[0];
    case 154: return G[1];
    case 155: return G[2];
    case 156: return G[0];
    case 157: return G[1];
    case 158: return G[2];
    case 159: return G[3];
    case 160: return G[0];
    case 161: return G[1];
    case 162: return G[2];
    case 163: return G[3];
    case 164: return G[4];
    case 165: return G[0] * zij + G[7];
    case 166: return G[0] * zij + G[7];
    case 167: return G[1] * zij + G[8];
    case 168: return G[0] * zij + G[7];
    case 169: return G[1] * zij + G[8];
    case 170: return G[2] * zij + G[9];
    case 171: return G[0] * zij + G[7];
    case 172: return G[1] * zij + G[8];
    case 173: return G[2] * zij + G[9];
    case 174: return G[3] * zij + G[10];
    case 175: return G[0] * zij + G[7];
    case 176: return G[1] * zij + G[8];
    case 177: return G[2] * zij + G[9];
    case 178: return G[3] * zij + G[10];
    case 179: return G[4] * zij + G[11];
    case 180: return G[7];
    case 181: return G[7];
    case 182: return G[8];
    case 183: return G[7];
    case 184: return G[8];
    case 185: return G[9];
    case 186: return G[7];
    case 187: return G[8];
    case 188: return G[9];
    case 189: return G[10];
    case 190: return G[7];
    case 191: return G[8];
    case 192: return G[9];
    case 193: return G[10];
    case 194: return G[11];
    case 195: return G[7];
    case 196: return G[7];
    case 197: return G[8];
    case 198: return G[7];
    case 199: return G[8];
    case 200: return G[9];
    case 201: return G[7];
    case 202: return G[8];
    case 203: return G[9];
    case 204: return G[10];
    case 205: return G[7];
    case 206: return G[8];
    case 207: return G[9];
    case 208: return G[10];
    case 209: return G[11];
    case 210: return G[7] * zij + G[14];
    case 211: return G[7] * zij + G[14];
    case 212: return G[8] * zij + G[15];
    case 213: return G[7] * zij + G[14];
    case 214: return G[8] * zij + G[15];
    case 215: return G[9] * zij + G[16];
    case 216: return G[7] * zij + G[14];
    case 217: return G[8] * zij + G[15];
    case 218: return G[9] * zij + G[16];
    case 219: return G[10] * zij + G[17];
    case 220: return G[7] * zij + G[14];
    case 221: return G[8] * zij + G[15];
    case 222: return G[9] * zij + G[16];
    case 223: return G[10] * zij + G[17];
    case 224: return G[11] * zij + G[18];
    case 225: return G[14];
    case 226: return G[14];
    case 227: return G[15];
    case 228: return G[14];
    case 229: return G[15];
    case 230: return G[16];
    case 231: return G[14];
    case 232: return G[15];
    case 233: return G[16];
    case 234: return G[17];
    case 235: return G[14];
    case 236: return G[15];
    case 237: return G[16];
    case 238: return G[17];
    case 239: return G[18];
    case 240: return G[14];
    case 241: return G[14];
    case 242: return G[15];
    case 243: return G[14];
    case 244: return G[15];
    case 245: return G[16];
    case 246: return G[14];
    case 247: return G[15];
    case 248: return G[16];
    case 249: return G[17];
    case 250: return G[14];
    case 251: return G[15];
    case 252: return G[16];
    case 253: return G[17];
    case 254: return G[18];
    case 255: return G[14] * zij + G[21];
    case 256: return G[14] * zij + G[21];
    case 257: return G[15] * zij + G[22];
    case 258: return G[14] * zij + G[21];
    case 259: return G[15] * zij + G[22];
    case 260: return G[16] * zij + G[23];
    case 261: return G[14] * zij + G[21];
    case 262: return G[15] * zij + G[22];
    case 263: return G[16] * zij + G[23];
    case 264: return G[17] * zij + G[24];
    case 265: return G[14] * zij + G[21];
    case 266: return G[15] * zij + G[22];
    case 267: return G[16] * zij + G[23];
    case 268: return G[17] * zij + G[24];
    case 269: return G[18] * zij + G[25];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_dpgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 270;
  constexpr int kNMax = 3;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_dpgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_dpgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_dpgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fpgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[25] * xij + G[32];
    case 1: return G[24] * xij + G[31];
    case 2: return G[24] * xij + G[31];
    case 3: return G[23] * xij + G[30];
    case 4: return G[23] * xij + G[30];
    case 5: return G[23] * xij + G[30];
    case 6: return G[22] * xij + G[29];
    case 7: return G[22] * xij + G[29];
    case 8: return G[22] * xij + G[29];
    case 9: return G[22] * xij + G[29];
    case 10: return G[21] * xij + G[28];
    case 11: return G[21] * xij + G[28];
    case 12: return G[21] * xij + G[28];
    case 13: return G[21] * xij + G[28];
    case 14: return G[21] * xij + G[28];
    case 15: return G[25];
    case 16: return G[24];
    case 17: return G[24];
    case 18: return G[23];
    case 19: return G[23];
    case 20: return G[23];
    case 21: return G[22];
    case 22: return G[22];
    case 23: return G[22];
    case 24: return G[22];
    case 25: return G[21];
    case 26: return G[21];
    case 27: return G[21];
    case 28: return G[21];
    case 29: return G[21];
    case 30: return G[25];
    case 31: return G[24];
    case 32: return G[24];
    case 33: return G[23];
    case 34: return G[23];
    case 35: return G[23];
    case 36: return G[22];
    case 37: return G[22];
    case 38: return G[22];
    case 39: return G[22];
    case 40: return G[21];
    case 41: return G[21];
    case 42: return G[21];
    case 43: return G[21];
    case 44: return G[21];
    case 45: return G[18] * xij + G[25];
    case 46: return G[17] * xij + G[24];
    case 47: return G[17] * xij + G[24];
    case 48: return G[16] * xij + G[23];
    case 49: return G[16] * xij + G[23];
    case 50: return G[16] * xij + G[23];
    case 51: return G[15] * xij + G[22];
    case 52: return G[15] * xij + G[22];
    case 53: return G[15] * xij + G[22];
    case 54: return G[15] * xij + G[22];
    case 55: return G[14] * xij + G[21];
    case 56: return G[14] * xij + G[21];
    case 57: return G[14] * xij + G[21];
    case 58: return G[14] * xij + G[21];
    case 59: return G[14] * xij + G[21];
    case 60: return G[18];
    case 61: return G[17];
    case 62: return G[17];
    case 63: return G[16];
    case 64: return G[16];
    case 65: return G[16];
    case 66: return G[15];
    case 67: return G[15];
    case 68: return G[15];
    case 69: return G[15];
    case 70: return G[14];
    case 71: return G[14];
    case 72: return G[14];
    case 73: return G[14];
    case 74: return G[14];
    case 75: return G[18];
    case 76: return G[17];
    case 77: return G[17];
    case 78: return G[16];
    case 79: return G[16];
    case 80: return G[16];
    case 81: return G[15];
    case 82: return G[15];
    case 83: return G[15];
    case 84: return G[15];
    case 85: return G[14];
    case 86: return G[14];
    case 87: return G[14];
    case 88: return G[14];
    case 89: return G[14];
    case 90: return G[18] * xij + G[25];
    case 91: return G[17] * xij + G[24];
    case 92: return G[17] * xij + G[24];
    case 93: return G[16] * xij + G[23];
    case 94: return G[16] * xij + G[23];
    case 95: return G[16] * xij + G[23];
    case 96: return G[15] * xij + G[22];
    case 97: return G[15] * xij + G[22];
    case 98: return G[15] * xij + G[22];
    case 99: return G[15] * xij + G[22];
    case 100: return G[14] * xij + G[21];
    case 101: return G[14] * xij + G[21];
    case 102: return G[14] * xij + G[21];
    case 103: return G[14] * xij + G[21];
    case 104: return G[14] * xij + G[21];
    case 105: return G[18];
    case 106: return G[17];
    case 107: return G[17];
    case 108: return G[16];
    case 109: return G[16];
    case 110: return G[16];
    case 111: return G[15];
    case 112: return G[15];
    case 113: return G[15];
    case 114: return G[15];
    case 115: return G[14];
    case 116: return G[14];
    case 117: return G[14];
    case 118: return G[14];
    case 119: return G[14];
    case 120: return G[18];
    case 121: return G[17];
    case 122: return G[17];
    case 123: return G[16];
    case 124: return G[16];
    case 125: return G[16];
    case 126: return G[15];
    case 127: return G[15];
    case 128: return G[15];
    case 129: return G[15];
    case 130: return G[14];
    case 131: return G[14];
    case 132: return G[14];
    case 133: return G[14];
    case 134: return G[14];
    case 135: return G[11] * xij + G[18];
    case 136: return G[10] * xij + G[17];
    case 137: return G[10] * xij + G[17];
    case 138: return G[9] * xij + G[16];
    case 139: return G[9] * xij + G[16];
    case 140: return G[9] * xij + G[16];
    case 141: return G[8] * xij + G[15];
    case 142: return G[8] * xij + G[15];
    case 143: return G[8] * xij + G[15];
    case 144: return G[8] * xij + G[15];
    case 145: return G[7] * xij + G[14];
    case 146: return G[7] * xij + G[14];
    case 147: return G[7] * xij + G[14];
    case 148: return G[7] * xij + G[14];
    case 149: return G[7] * xij + G[14];
    case 150: return G[11];
    case 151: return G[10];
    case 152: return G[10];
    case 153: return G[9];
    case 154: return G[9];
    case 155: return G[9];
    case 156: return G[8];
    case 157: return G[8];
    case 158: return G[8];
    case 159: return G[8];
    case 160: return G[7];
    case 161: return G[7];
    case 162: return G[7];
    case 163: return G[7];
    case 164: return G[7];
    case 165: return G[11];
    case 166: return G[10];
    case 167: return G[10];
    case 168: return G[9];
    case 169: return G[9];
    case 170: return G[9];
    case 171: return G[8];
    case 172: return G[8];
    case 173: return G[8];
    case 174: return G[8];
    case 175: return G[7];
    case 176: return G[7];
    case 177: return G[7];
    case 178: return G[7];
    case 179: return G[7];
    case 180: return G[11] * xij + G[18];
    case 181: return G[10] * xij + G[17];
    case 182: return G[10] * xij + G[17];
    case 183: return G[9] * xij + G[16];
    case 184: return G[9] * xij + G[16];
    case 185: return G[9] * xij + G[16];
    case 186: return G[8] * xij + G[15];
    case 187: return G[8] * xij + G[15];
    case 188: return G[8] * xij + G[15];
    case 189: return G[8] * xij + G[15];
    case 190: return G[7] * xij + G[14];
    case 191: return G[7] * xij + G[14];
    case 192: return G[7] * xij + G[14];
    case 193: return G[7] * xij + G[14];
    case 194: return G[7] * xij + G[14];
    case 195: return G[11];
    case 196: return G[10];
    case 197: return G[10];
    case 198: return G[9];
    case 199: return G[9];
    case 200: return G[9];
    case 201: return G[8];
    case 202: return G[8];
    case 203: return G[8];
    case 204: return G[8];
    case 205: return G[7];
    case 206: return G[7];
    case 207: return G[7];
    case 208: return G[7];
    case 209: return G[7];
    case 210: return G[11];
    case 211: return G[10];
    case 212: return G[10];
    case 213: return G[9];
    case 214: return G[9];
    case 215: return G[9];
    case 216: return G[8];
    case 217: return G[8];
    case 218: return G[8];
    case 219: return G[8];
    case 220: return G[7];
    case 221: return G[7];
    case 222: return G[7];
    case 223: return G[7];
    case 224: return G[7];
    case 225: return G[11] * xij + G[18];
    case 226: return G[10] * xij + G[17];
    case 227: return G[10] * xij + G[17];
    case 228: return G[9] * xij + G[16];
    case 229: return G[9] * xij + G[16];
    case 230: return G[9] * xij + G[16];
    case 231: return G[8] * xij + G[15];
    case 232: return G[8] * xij + G[15];
    case 233: return G[8] * xij + G[15];
    case 234: return G[8] * xij + G[15];
    case 235: return G[7] * xij + G[14];
    case 236: return G[7] * xij + G[14];
    case 237: return G[7] * xij + G[14];
    case 238: return G[7] * xij + G[14];
    case 239: return G[7] * xij + G[14];
    case 240: return G[11];
    case 241: return G[10];
    case 242: return G[10];
    case 243: return G[9];
    case 244: return G[9];
    case 245: return G[9];
    case 246: return G[8];
    case 247: return G[8];
    case 248: return G[8];
    case 249: return G[8];
    case 250: return G[7];
    case 251: return G[7];
    case 252: return G[7];
    case 253: return G[7];
    case 254: return G[7];
    case 255: return G[11];
    case 256: return G[10];
    case 257: return G[10];
    case 258: return G[9];
    case 259: return G[9];
    case 260: return G[9];
    case 261: return G[8];
    case 262: return G[8];
    case 263: return G[8];
    case 264: return G[8];
    case 265: return G[7];
    case 266: return G[7];
    case 267: return G[7];
    case 268: return G[7];
    case 269: return G[7];
    case 270: return G[4] * xij + G[11];
    case 271: return G[3] * xij + G[10];
    case 272: return G[3] * xij + G[10];
    case 273: return G[2] * xij + G[9];
    case 274: return G[2] * xij + G[9];
    case 275: return G[2] * xij + G[9];
    case 276: return G[1] * xij + G[8];
    case 277: return G[1] * xij + G[8];
    case 278: return G[1] * xij + G[8];
    case 279: return G[1] * xij + G[8];
    case 280: return G[0] * xij + G[7];
    case 281: return G[0] * xij + G[7];
    case 282: return G[0] * xij + G[7];
    case 283: return G[0] * xij + G[7];
    case 284: return G[0] * xij + G[7];
    case 285: return G[4];
    case 286: return G[3];
    case 287: return G[3];
    case 288: return G[2];
    case 289: return G[2];
    case 290: return G[2];
    case 291: return G[1];
    case 292: return G[1];
    case 293: return G[1];
    case 294: return G[1];
    case 295: return G[0];
    case 296: return G[0];
    case 297: return G[0];
    case 298: return G[0];
    case 299: return G[0];
    case 300: return G[4];
    case 301: return G[3];
    case 302: return G[3];
    case 303: return G[2];
    case 304: return G[2];
    case 305: return G[2];
    case 306: return G[1];
    case 307: return G[1];
    case 308: return G[1];
    case 309: return G[1];
    case 310: return G[0];
    case 311: return G[0];
    case 312: return G[0];
    case 313: return G[0];
    case 314: return G[0];
    case 315: return G[4] * xij + G[11];
    case 316: return G[3] * xij + G[10];
    case 317: return G[3] * xij + G[10];
    case 318: return G[2] * xij + G[9];
    case 319: return G[2] * xij + G[9];
    case 320: return G[2] * xij + G[9];
    case 321: return G[1] * xij + G[8];
    case 322: return G[1] * xij + G[8];
    case 323: return G[1] * xij + G[8];
    case 324: return G[1] * xij + G[8];
    case 325: return G[0] * xij + G[7];
    case 326: return G[0] * xij + G[7];
    case 327: return G[0] * xij + G[7];
    case 328: return G[0] * xij + G[7];
    case 329: return G[0] * xij + G[7];
    case 330: return G[4];
    case 331: return G[3];
    case 332: return G[3];
    case 333: return G[2];
    case 334: return G[2];
    case 335: return G[2];
    case 336: return G[1];
    case 337: return G[1];
    case 338: return G[1];
    case 339: return G[1];
    case 340: return G[0];
    case 341: return G[0];
    case 342: return G[0];
    case 343: return G[0];
    case 344: return G[0];
    case 345: return G[4];
    case 346: return G[3];
    case 347: return G[3];
    case 348: return G[2];
    case 349: return G[2];
    case 350: return G[2];
    case 351: return G[1];
    case 352: return G[1];
    case 353: return G[1];
    case 354: return G[1];
    case 355: return G[0];
    case 356: return G[0];
    case 357: return G[0];
    case 358: return G[0];
    case 359: return G[0];
    case 360: return G[4] * xij + G[11];
    case 361: return G[3] * xij + G[10];
    case 362: return G[3] * xij + G[10];
    case 363: return G[2] * xij + G[9];
    case 364: return G[2] * xij + G[9];
    case 365: return G[2] * xij + G[9];
    case 366: return G[1] * xij + G[8];
    case 367: return G[1] * xij + G[8];
    case 368: return G[1] * xij + G[8];
    case 369: return G[1] * xij + G[8];
    case 370: return G[0] * xij + G[7];
    case 371: return G[0] * xij + G[7];
    case 372: return G[0] * xij + G[7];
    case 373: return G[0] * xij + G[7];
    case 374: return G[0] * xij + G[7];
    case 375: return G[4];
    case 376: return G[3];
    case 377: return G[3];
    case 378: return G[2];
    case 379: return G[2];
    case 380: return G[2];
    case 381: return G[1];
    case 382: return G[1];
    case 383: return G[1];
    case 384: return G[1];
    case 385: return G[0];
    case 386: return G[0];
    case 387: return G[0];
    case 388: return G[0];
    case 389: return G[0];
    case 390: return G[4];
    case 391: return G[3];
    case 392: return G[3];
    case 393: return G[2];
    case 394: return G[2];
    case 395: return G[2];
    case 396: return G[1];
    case 397: return G[1];
    case 398: return G[1];
    case 399: return G[1];
    case 400: return G[0];
    case 401: return G[0];
    case 402: return G[0];
    case 403: return G[0];
    case 404: return G[0];
    case 405: return G[4] * xij + G[11];
    case 406: return G[3] * xij + G[10];
    case 407: return G[3] * xij + G[10];
    case 408: return G[2] * xij + G[9];
    case 409: return G[2] * xij + G[9];
    case 410: return G[2] * xij + G[9];
    case 411: return G[1] * xij + G[8];
    case 412: return G[1] * xij + G[8];
    case 413: return G[1] * xij + G[8];
    case 414: return G[1] * xij + G[8];
    case 415: return G[0] * xij + G[7];
    case 416: return G[0] * xij + G[7];
    case 417: return G[0] * xij + G[7];
    case 418: return G[0] * xij + G[7];
    case 419: return G[0] * xij + G[7];
    case 420: return G[4];
    case 421: return G[3];
    case 422: return G[3];
    case 423: return G[2];
    case 424: return G[2];
    case 425: return G[2];
    case 426: return G[1];
    case 427: return G[1];
    case 428: return G[1];
    case 429: return G[1];
    case 430: return G[0];
    case 431: return G[0];
    case 432: return G[0];
    case 433: return G[0];
    case 434: return G[0];
    case 435: return G[4];
    case 436: return G[3];
    case 437: return G[3];
    case 438: return G[2];
    case 439: return G[2];
    case 440: return G[2];
    case 441: return G[1];
    case 442: return G[1];
    case 443: return G[1];
    case 444: return G[1];
    case 445: return G[0];
    case 446: return G[0];
    case 447: return G[0];
    case 448: return G[0];
    case 449: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[0] * yij + G[7];
    case 16: return G[1] * yij + G[8];
    case 17: return G[0] * yij + G[7];
    case 18: return G[2] * yij + G[9];
    case 19: return G[1] * yij + G[8];
    case 20: return G[0] * yij + G[7];
    case 21: return G[3] * yij + G[10];
    case 22: return G[2] * yij + G[9];
    case 23: return G[1] * yij + G[8];
    case 24: return G[0] * yij + G[7];
    case 25: return G[4] * yij + G[11];
    case 26: return G[3] * yij + G[10];
    case 27: return G[2] * yij + G[9];
    case 28: return G[1] * yij + G[8];
    case 29: return G[0] * yij + G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[3];
    case 37: return G[2];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[4];
    case 41: return G[3];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[0];
    case 45: return G[7];
    case 46: return G[8];
    case 47: return G[7];
    case 48: return G[9];
    case 49: return G[8];
    case 50: return G[7];
    case 51: return G[10];
    case 52: return G[9];
    case 53: return G[8];
    case 54: return G[7];
    case 55: return G[11];
    case 56: return G[10];
    case 57: return G[9];
    case 58: return G[8];
    case 59: return G[7];
    case 60: return G[7] * yij + G[14];
    case 61: return G[8] * yij + G[15];
    case 62: return G[7] * yij + G[14];
    case 63: return G[9] * yij + G[16];
    case 64: return G[8] * yij + G[15];
    case 65: return G[7] * yij + G[14];
    case 66: return G[10] * yij + G[17];
    case 67: return G[9] * yij + G[16];
    case 68: return G[8] * yij + G[15];
    case 69: return G[7] * yij + G[14];
    case 70: return G[11] * yij + G[18];
    case 71: return G[10] * yij + G[17];
    case 72: return G[9] * yij + G[16];
    case 73: return G[8] * yij + G[15];
    case 74: return G[7] * yij + G[14];
    case 75: return G[7];
    case 76: return G[8];
    case 77: return G[7];
    case 78: return G[9];
    case 79: return G[8];
    case 80: return G[7];
    case 81: return G[10];
    case 82: return G[9];
    case 83: return G[8];
    case 84: return G[7];
    case 85: return G[11];
    case 86: return G[10];
    case 87: return G[9];
    case 88: return G[8];
    case 89: return G[7];
    case 90: return G[0];
    case 91: return G[1];
    case 92: return G[0];
    case 93: return G[2];
    case 94: return G[1];
    case 95: return G[0];
    case 96: return G[3];
    case 97: return G[2];
    case 98: return G[1];
    case 99: return G[0];
    case 100: return G[4];
    case 101: return G[3];
    case 102: return G[2];
    case 103: return G[1];
    case 104: return G[0];
    case 105: return G[0] * yij + G[7];
    case 106: return G[1] * yij + G[8];
    case 107: return G[0] * yij + G[7];
    case 108: return G[2] * yij + G[9];
    case 109: return G[1] * yij + G[8];
    case 110: return G[0] * yij + G[7];
    case 111: return G[3] * yij + G[10];
    case 112: return G[2] * yij + G[9];
    case 113: return G[1] * yij + G[8];
    case 114: return G[0] * yij + G[7];
    case 115: return G[4] * yij + G[11];
    case 116: return G[3] * yij + G[10];
    case 117: return G[2] * yij + G[9];
    case 118: return G[1] * yij + G[8];
    case 119: return G[0] * yij + G[7];
    case 120: return G[0];
    case 121: return G[1];
    case 122: return G[0];
    case 123: return G[2];
    case 124: return G[1];
    case 125: return G[0];
    case 126: return G[3];
    case 127: return G[2];
    case 128: return G[1];
    case 129: return G[0];
    case 130: return G[4];
    case 131: return G[3];
    case 132: return G[2];
    case 133: return G[1];
    case 134: return G[0];
    case 135: return G[14];
    case 136: return G[15];
    case 137: return G[14];
    case 138: return G[16];
    case 139: return G[15];
    case 140: return G[14];
    case 141: return G[17];
    case 142: return G[16];
    case 143: return G[15];
    case 144: return G[14];
    case 145: return G[18];
    case 146: return G[17];
    case 147: return G[16];
    case 148: return G[15];
    case 149: return G[14];
    case 150: return G[14] * yij + G[21];
    case 151: return G[15] * yij + G[22];
    case 152: return G[14] * yij + G[21];
    case 153: return G[16] * yij + G[23];
    case 154: return G[15] * yij + G[22];
    case 155: return G[14] * yij + G[21];
    case 156: return G[17] * yij + G[24];
    case 157: return G[16] * yij + G[23];
    case 158: return G[15] * yij + G[22];
    case 159: return G[14] * yij + G[21];
    case 160: return G[18] * yij + G[25];
    case 161: return G[17] * yij + G[24];
    case 162: return G[16] * yij + G[23];
    case 163: return G[15] * yij + G[22];
    case 164: return G[14] * yij + G[21];
    case 165: return G[14];
    case 166: return G[15];
    case 167: return G[14];
    case 168: return G[16];
    case 169: return G[15];
    case 170: return G[14];
    case 171: return G[17];
    case 172: return G[16];
    case 173: return G[15];
    case 174: return G[14];
    case 175: return G[18];
    case 176: return G[17];
    case 177: return G[16];
    case 178: return G[15];
    case 179: return G[14];
    case 180: return G[7];
    case 181: return G[8];
    case 182: return G[7];
    case 183: return G[9];
    case 184: return G[8];
    case 185: return G[7];
    case 186: return G[10];
    case 187: return G[9];
    case 188: return G[8];
    case 189: return G[7];
    case 190: return G[11];
    case 191: return G[10];
    case 192: return G[9];
    case 193: return G[8];
    case 194: return G[7];
    case 195: return G[7] * yij + G[14];
    case 196: return G[8] * yij + G[15];
    case 197: return G[7] * yij + G[14];
    case 198: return G[9] * yij + G[16];
    case 199: return G[8] * yij + G[15];
    case 200: return G[7] * yij + G[14];
    case 201: return G[10] * yij + G[17];
    case 202: return G[9] * yij + G[16];
    case 203: return G[8] * yij + G[15];
    case 204: return G[7] * yij + G[14];
    case 205: return G[11] * yij + G[18];
    case 206: return G[10] * yij + G[17];
    case 207: return G[9] * yij + G[16];
    case 208: return G[8] * yij + G[15];
    case 209: return G[7] * yij + G[14];
    case 210: return G[7];
    case 211: return G[8];
    case 212: return G[7];
    case 213: return G[9];
    case 214: return G[8];
    case 215: return G[7];
    case 216: return G[10];
    case 217: return G[9];
    case 218: return G[8];
    case 219: return G[7];
    case 220: return G[11];
    case 221: return G[10];
    case 222: return G[9];
    case 223: return G[8];
    case 224: return G[7];
    case 225: return G[0];
    case 226: return G[1];
    case 227: return G[0];
    case 228: return G[2];
    case 229: return G[1];
    case 230: return G[0];
    case 231: return G[3];
    case 232: return G[2];
    case 233: return G[1];
    case 234: return G[0];
    case 235: return G[4];
    case 236: return G[3];
    case 237: return G[2];
    case 238: return G[1];
    case 239: return G[0];
    case 240: return G[0] * yij + G[7];
    case 241: return G[1] * yij + G[8];
    case 242: return G[0] * yij + G[7];
    case 243: return G[2] * yij + G[9];
    case 244: return G[1] * yij + G[8];
    case 245: return G[0] * yij + G[7];
    case 246: return G[3] * yij + G[10];
    case 247: return G[2] * yij + G[9];
    case 248: return G[1] * yij + G[8];
    case 249: return G[0] * yij + G[7];
    case 250: return G[4] * yij + G[11];
    case 251: return G[3] * yij + G[10];
    case 252: return G[2] * yij + G[9];
    case 253: return G[1] * yij + G[8];
    case 254: return G[0] * yij + G[7];
    case 255: return G[0];
    case 256: return G[1];
    case 257: return G[0];
    case 258: return G[2];
    case 259: return G[1];
    case 260: return G[0];
    case 261: return G[3];
    case 262: return G[2];
    case 263: return G[1];
    case 264: return G[0];
    case 265: return G[4];
    case 266: return G[3];
    case 267: return G[2];
    case 268: return G[1];
    case 269: return G[0];
    case 270: return G[21];
    case 271: return G[22];
    case 272: return G[21];
    case 273: return G[23];
    case 274: return G[22];
    case 275: return G[21];
    case 276: return G[24];
    case 277: return G[23];
    case 278: return G[22];
    case 279: return G[21];
    case 280: return G[25];
    case 281: return G[24];
    case 282: return G[23];
    case 283: return G[22];
    case 284: return G[21];
    case 285: return G[21] * yij + G[28];
    case 286: return G[22] * yij + G[29];
    case 287: return G[21] * yij + G[28];
    case 288: return G[23] * yij + G[30];
    case 289: return G[22] * yij + G[29];
    case 290: return G[21] * yij + G[28];
    case 291: return G[24] * yij + G[31];
    case 292: return G[23] * yij + G[30];
    case 293: return G[22] * yij + G[29];
    case 294: return G[21] * yij + G[28];
    case 295: return G[25] * yij + G[32];
    case 296: return G[24] * yij + G[31];
    case 297: return G[23] * yij + G[30];
    case 298: return G[22] * yij + G[29];
    case 299: return G[21] * yij + G[28];
    case 300: return G[21];
    case 301: return G[22];
    case 302: return G[21];
    case 303: return G[23];
    case 304: return G[22];
    case 305: return G[21];
    case 306: return G[24];
    case 307: return G[23];
    case 308: return G[22];
    case 309: return G[21];
    case 310: return G[25];
    case 311: return G[24];
    case 312: return G[23];
    case 313: return G[22];
    case 314: return G[21];
    case 315: return G[14];
    case 316: return G[15];
    case 317: return G[14];
    case 318: return G[16];
    case 319: return G[15];
    case 320: return G[14];
    case 321: return G[17];
    case 322: return G[16];
    case 323: return G[15];
    case 324: return G[14];
    case 325: return G[18];
    case 326: return G[17];
    case 327: return G[16];
    case 328: return G[15];
    case 329: return G[14];
    case 330: return G[14] * yij + G[21];
    case 331: return G[15] * yij + G[22];
    case 332: return G[14] * yij + G[21];
    case 333: return G[16] * yij + G[23];
    case 334: return G[15] * yij + G[22];
    case 335: return G[14] * yij + G[21];
    case 336: return G[17] * yij + G[24];
    case 337: return G[16] * yij + G[23];
    case 338: return G[15] * yij + G[22];
    case 339: return G[14] * yij + G[21];
    case 340: return G[18] * yij + G[25];
    case 341: return G[17] * yij + G[24];
    case 342: return G[16] * yij + G[23];
    case 343: return G[15] * yij + G[22];
    case 344: return G[14] * yij + G[21];
    case 345: return G[14];
    case 346: return G[15];
    case 347: return G[14];
    case 348: return G[16];
    case 349: return G[15];
    case 350: return G[14];
    case 351: return G[17];
    case 352: return G[16];
    case 353: return G[15];
    case 354: return G[14];
    case 355: return G[18];
    case 356: return G[17];
    case 357: return G[16];
    case 358: return G[15];
    case 359: return G[14];
    case 360: return G[7];
    case 361: return G[8];
    case 362: return G[7];
    case 363: return G[9];
    case 364: return G[8];
    case 365: return G[7];
    case 366: return G[10];
    case 367: return G[9];
    case 368: return G[8];
    case 369: return G[7];
    case 370: return G[11];
    case 371: return G[10];
    case 372: return G[9];
    case 373: return G[8];
    case 374: return G[7];
    case 375: return G[7] * yij + G[14];
    case 376: return G[8] * yij + G[15];
    case 377: return G[7] * yij + G[14];
    case 378: return G[9] * yij + G[16];
    case 379: return G[8] * yij + G[15];
    case 380: return G[7] * yij + G[14];
    case 381: return G[10] * yij + G[17];
    case 382: return G[9] * yij + G[16];
    case 383: return G[8] * yij + G[15];
    case 384: return G[7] * yij + G[14];
    case 385: return G[11] * yij + G[18];
    case 386: return G[10] * yij + G[17];
    case 387: return G[9] * yij + G[16];
    case 388: return G[8] * yij + G[15];
    case 389: return G[7] * yij + G[14];
    case 390: return G[7];
    case 391: return G[8];
    case 392: return G[7];
    case 393: return G[9];
    case 394: return G[8];
    case 395: return G[7];
    case 396: return G[10];
    case 397: return G[9];
    case 398: return G[8];
    case 399: return G[7];
    case 400: return G[11];
    case 401: return G[10];
    case 402: return G[9];
    case 403: return G[8];
    case 404: return G[7];
    case 405: return G[0];
    case 406: return G[1];
    case 407: return G[0];
    case 408: return G[2];
    case 409: return G[1];
    case 410: return G[0];
    case 411: return G[3];
    case 412: return G[2];
    case 413: return G[1];
    case 414: return G[0];
    case 415: return G[4];
    case 416: return G[3];
    case 417: return G[2];
    case 418: return G[1];
    case 419: return G[0];
    case 420: return G[0] * yij + G[7];
    case 421: return G[1] * yij + G[8];
    case 422: return G[0] * yij + G[7];
    case 423: return G[2] * yij + G[9];
    case 424: return G[1] * yij + G[8];
    case 425: return G[0] * yij + G[7];
    case 426: return G[3] * yij + G[10];
    case 427: return G[2] * yij + G[9];
    case 428: return G[1] * yij + G[8];
    case 429: return G[0] * yij + G[7];
    case 430: return G[4] * yij + G[11];
    case 431: return G[3] * yij + G[10];
    case 432: return G[2] * yij + G[9];
    case 433: return G[1] * yij + G[8];
    case 434: return G[0] * yij + G[7];
    case 435: return G[0];
    case 436: return G[1];
    case 437: return G[0];
    case 438: return G[2];
    case 439: return G[1];
    case 440: return G[0];
    case 441: return G[3];
    case 442: return G[2];
    case 443: return G[1];
    case 444: return G[0];
    case 445: return G[4];
    case 446: return G[3];
    case 447: return G[2];
    case 448: return G[1];
    case 449: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fpgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[2];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[3];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[2];
    case 28: return G[3];
    case 29: return G[4];
    case 30: return G[0] * zij + G[7];
    case 31: return G[0] * zij + G[7];
    case 32: return G[1] * zij + G[8];
    case 33: return G[0] * zij + G[7];
    case 34: return G[1] * zij + G[8];
    case 35: return G[2] * zij + G[9];
    case 36: return G[0] * zij + G[7];
    case 37: return G[1] * zij + G[8];
    case 38: return G[2] * zij + G[9];
    case 39: return G[3] * zij + G[10];
    case 40: return G[0] * zij + G[7];
    case 41: return G[1] * zij + G[8];
    case 42: return G[2] * zij + G[9];
    case 43: return G[3] * zij + G[10];
    case 44: return G[4] * zij + G[11];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[2];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[2];
    case 54: return G[3];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[2];
    case 58: return G[3];
    case 59: return G[4];
    case 60: return G[0];
    case 61: return G[0];
    case 62: return G[1];
    case 63: return G[0];
    case 64: return G[1];
    case 65: return G[2];
    case 66: return G[0];
    case 67: return G[1];
    case 68: return G[2];
    case 69: return G[3];
    case 70: return G[0];
    case 71: return G[1];
    case 72: return G[2];
    case 73: return G[3];
    case 74: return G[4];
    case 75: return G[0] * zij + G[7];
    case 76: return G[0] * zij + G[7];
    case 77: return G[1] * zij + G[8];
    case 78: return G[0] * zij + G[7];
    case 79: return G[1] * zij + G[8];
    case 80: return G[2] * zij + G[9];
    case 81: return G[0] * zij + G[7];
    case 82: return G[1] * zij + G[8];
    case 83: return G[2] * zij + G[9];
    case 84: return G[3] * zij + G[10];
    case 85: return G[0] * zij + G[7];
    case 86: return G[1] * zij + G[8];
    case 87: return G[2] * zij + G[9];
    case 88: return G[3] * zij + G[10];
    case 89: return G[4] * zij + G[11];
    case 90: return G[7];
    case 91: return G[7];
    case 92: return G[8];
    case 93: return G[7];
    case 94: return G[8];
    case 95: return G[9];
    case 96: return G[7];
    case 97: return G[8];
    case 98: return G[9];
    case 99: return G[10];
    case 100: return G[7];
    case 101: return G[8];
    case 102: return G[9];
    case 103: return G[10];
    case 104: return G[11];
    case 105: return G[7];
    case 106: return G[7];
    case 107: return G[8];
    case 108: return G[7];
    case 109: return G[8];
    case 110: return G[9];
    case 111: return G[7];
    case 112: return G[8];
    case 113: return G[9];
    case 114: return G[10];
    case 115: return G[7];
    case 116: return G[8];
    case 117: return G[9];
    case 118: return G[10];
    case 119: return G[11];
    case 120: return G[7] * zij + G[14];
    case 121: return G[7] * zij + G[14];
    case 122: return G[8] * zij + G[15];
    case 123: return G[7] * zij + G[14];
    case 124: return G[8] * zij + G[15];
    case 125: return G[9] * zij + G[16];
    case 126: return G[7] * zij + G[14];
    case 127: return G[8] * zij + G[15];
    case 128: return G[9] * zij + G[16];
    case 129: return G[10] * zij + G[17];
    case 130: return G[7] * zij + G[14];
    case 131: return G[8] * zij + G[15];
    case 132: return G[9] * zij + G[16];
    case 133: return G[10] * zij + G[17];
    case 134: return G[11] * zij + G[18];
    case 135: return G[0];
    case 136: return G[0];
    case 137: return G[1];
    case 138: return G[0];
    case 139: return G[1];
    case 140: return G[2];
    case 141: return G[0];
    case 142: return G[1];
    case 143: return G[2];
    case 144: return G[3];
    case 145: return G[0];
    case 146: return G[1];
    case 147: return G[2];
    case 148: return G[3];
    case 149: return G[4];
    case 150: return G[0];
    case 151: return G[0];
    case 152: return G[1];
    case 153: return G[0];
    case 154: return G[1];
    case 155: return G[2];
    case 156: return G[0];
    case 157: return G[1];
    case 158: return G[2];
    case 159: return G[3];
    case 160: return G[0];
    case 161: return G[1];
    case 162: return G[2];
    case 163: return G[3];
    case 164: return G[4];
    case 165: return G[0] * zij + G[7];
    case 166: return G[0] * zij + G[7];
    case 167: return G[1] * zij + G[8];
    case 168: return G[0] * zij + G[7];
    case 169: return G[1] * zij + G[8];
    case 170: return G[2] * zij + G[9];
    case 171: return G[0] * zij + G[7];
    case 172: return G[1] * zij + G[8];
    case 173: return G[2] * zij + G[9];
    case 174: return G[3] * zij + G[10];
    case 175: return G[0] * zij + G[7];
    case 176: return G[1] * zij + G[8];
    case 177: return G[2] * zij + G[9];
    case 178: return G[3] * zij + G[10];
    case 179: return G[4] * zij + G[11];
    case 180: return G[7];
    case 181: return G[7];
    case 182: return G[8];
    case 183: return G[7];
    case 184: return G[8];
    case 185: return G[9];
    case 186: return G[7];
    case 187: return G[8];
    case 188: return G[9];
    case 189: return G[10];
    case 190: return G[7];
    case 191: return G[8];
    case 192: return G[9];
    case 193: return G[10];
    case 194: return G[11];
    case 195: return G[7];
    case 196: return G[7];
    case 197: return G[8];
    case 198: return G[7];
    case 199: return G[8];
    case 200: return G[9];
    case 201: return G[7];
    case 202: return G[8];
    case 203: return G[9];
    case 204: return G[10];
    case 205: return G[7];
    case 206: return G[8];
    case 207: return G[9];
    case 208: return G[10];
    case 209: return G[11];
    case 210: return G[7] * zij + G[14];
    case 211: return G[7] * zij + G[14];
    case 212: return G[8] * zij + G[15];
    case 213: return G[7] * zij + G[14];
    case 214: return G[8] * zij + G[15];
    case 215: return G[9] * zij + G[16];
    case 216: return G[7] * zij + G[14];
    case 217: return G[8] * zij + G[15];
    case 218: return G[9] * zij + G[16];
    case 219: return G[10] * zij + G[17];
    case 220: return G[7] * zij + G[14];
    case 221: return G[8] * zij + G[15];
    case 222: return G[9] * zij + G[16];
    case 223: return G[10] * zij + G[17];
    case 224: return G[11] * zij + G[18];
    case 225: return G[14];
    case 226: return G[14];
    case 227: return G[15];
    case 228: return G[14];
    case 229: return G[15];
    case 230: return G[16];
    case 231: return G[14];
    case 232: return G[15];
    case 233: return G[16];
    case 234: return G[17];
    case 235: return G[14];
    case 236: return G[15];
    case 237: return G[16];
    case 238: return G[17];
    case 239: return G[18];
    case 240: return G[14];
    case 241: return G[14];
    case 242: return G[15];
    case 243: return G[14];
    case 244: return G[15];
    case 245: return G[16];
    case 246: return G[14];
    case 247: return G[15];
    case 248: return G[16];
    case 249: return G[17];
    case 250: return G[14];
    case 251: return G[15];
    case 252: return G[16];
    case 253: return G[17];
    case 254: return G[18];
    case 255: return G[14] * zij + G[21];
    case 256: return G[14] * zij + G[21];
    case 257: return G[15] * zij + G[22];
    case 258: return G[14] * zij + G[21];
    case 259: return G[15] * zij + G[22];
    case 260: return G[16] * zij + G[23];
    case 261: return G[14] * zij + G[21];
    case 262: return G[15] * zij + G[22];
    case 263: return G[16] * zij + G[23];
    case 264: return G[17] * zij + G[24];
    case 265: return G[14] * zij + G[21];
    case 266: return G[15] * zij + G[22];
    case 267: return G[16] * zij + G[23];
    case 268: return G[17] * zij + G[24];
    case 269: return G[18] * zij + G[25];
    case 270: return G[0];
    case 271: return G[0];
    case 272: return G[1];
    case 273: return G[0];
    case 274: return G[1];
    case 275: return G[2];
    case 276: return G[0];
    case 277: return G[1];
    case 278: return G[2];
    case 279: return G[3];
    case 280: return G[0];
    case 281: return G[1];
    case 282: return G[2];
    case 283: return G[3];
    case 284: return G[4];
    case 285: return G[0];
    case 286: return G[0];
    case 287: return G[1];
    case 288: return G[0];
    case 289: return G[1];
    case 290: return G[2];
    case 291: return G[0];
    case 292: return G[1];
    case 293: return G[2];
    case 294: return G[3];
    case 295: return G[0];
    case 296: return G[1];
    case 297: return G[2];
    case 298: return G[3];
    case 299: return G[4];
    case 300: return G[0] * zij + G[7];
    case 301: return G[0] * zij + G[7];
    case 302: return G[1] * zij + G[8];
    case 303: return G[0] * zij + G[7];
    case 304: return G[1] * zij + G[8];
    case 305: return G[2] * zij + G[9];
    case 306: return G[0] * zij + G[7];
    case 307: return G[1] * zij + G[8];
    case 308: return G[2] * zij + G[9];
    case 309: return G[3] * zij + G[10];
    case 310: return G[0] * zij + G[7];
    case 311: return G[1] * zij + G[8];
    case 312: return G[2] * zij + G[9];
    case 313: return G[3] * zij + G[10];
    case 314: return G[4] * zij + G[11];
    case 315: return G[7];
    case 316: return G[7];
    case 317: return G[8];
    case 318: return G[7];
    case 319: return G[8];
    case 320: return G[9];
    case 321: return G[7];
    case 322: return G[8];
    case 323: return G[9];
    case 324: return G[10];
    case 325: return G[7];
    case 326: return G[8];
    case 327: return G[9];
    case 328: return G[10];
    case 329: return G[11];
    case 330: return G[7];
    case 331: return G[7];
    case 332: return G[8];
    case 333: return G[7];
    case 334: return G[8];
    case 335: return G[9];
    case 336: return G[7];
    case 337: return G[8];
    case 338: return G[9];
    case 339: return G[10];
    case 340: return G[7];
    case 341: return G[8];
    case 342: return G[9];
    case 343: return G[10];
    case 344: return G[11];
    case 345: return G[7] * zij + G[14];
    case 346: return G[7] * zij + G[14];
    case 347: return G[8] * zij + G[15];
    case 348: return G[7] * zij + G[14];
    case 349: return G[8] * zij + G[15];
    case 350: return G[9] * zij + G[16];
    case 351: return G[7] * zij + G[14];
    case 352: return G[8] * zij + G[15];
    case 353: return G[9] * zij + G[16];
    case 354: return G[10] * zij + G[17];
    case 355: return G[7] * zij + G[14];
    case 356: return G[8] * zij + G[15];
    case 357: return G[9] * zij + G[16];
    case 358: return G[10] * zij + G[17];
    case 359: return G[11] * zij + G[18];
    case 360: return G[14];
    case 361: return G[14];
    case 362: return G[15];
    case 363: return G[14];
    case 364: return G[15];
    case 365: return G[16];
    case 366: return G[14];
    case 367: return G[15];
    case 368: return G[16];
    case 369: return G[17];
    case 370: return G[14];
    case 371: return G[15];
    case 372: return G[16];
    case 373: return G[17];
    case 374: return G[18];
    case 375: return G[14];
    case 376: return G[14];
    case 377: return G[15];
    case 378: return G[14];
    case 379: return G[15];
    case 380: return G[16];
    case 381: return G[14];
    case 382: return G[15];
    case 383: return G[16];
    case 384: return G[17];
    case 385: return G[14];
    case 386: return G[15];
    case 387: return G[16];
    case 388: return G[17];
    case 389: return G[18];
    case 390: return G[14] * zij + G[21];
    case 391: return G[14] * zij + G[21];
    case 392: return G[15] * zij + G[22];
    case 393: return G[14] * zij + G[21];
    case 394: return G[15] * zij + G[22];
    case 395: return G[16] * zij + G[23];
    case 396: return G[14] * zij + G[21];
    case 397: return G[15] * zij + G[22];
    case 398: return G[16] * zij + G[23];
    case 399: return G[17] * zij + G[24];
    case 400: return G[14] * zij + G[21];
    case 401: return G[15] * zij + G[22];
    case 402: return G[16] * zij + G[23];
    case 403: return G[17] * zij + G[24];
    case 404: return G[18] * zij + G[25];
    case 405: return G[21];
    case 406: return G[21];
    case 407: return G[22];
    case 408: return G[21];
    case 409: return G[22];
    case 410: return G[23];
    case 411: return G[21];
    case 412: return G[22];
    case 413: return G[23];
    case 414: return G[24];
    case 415: return G[21];
    case 416: return G[22];
    case 417: return G[23];
    case 418: return G[24];
    case 419: return G[25];
    case 420: return G[21];
    case 421: return G[21];
    case 422: return G[22];
    case 423: return G[21];
    case 424: return G[22];
    case 425: return G[23];
    case 426: return G[21];
    case 427: return G[22];
    case 428: return G[23];
    case 429: return G[24];
    case 430: return G[21];
    case 431: return G[22];
    case 432: return G[23];
    case 433: return G[24];
    case 434: return G[25];
    case 435: return G[21] * zij + G[28];
    case 436: return G[21] * zij + G[28];
    case 437: return G[22] * zij + G[29];
    case 438: return G[21] * zij + G[28];
    case 439: return G[22] * zij + G[29];
    case 440: return G[23] * zij + G[30];
    case 441: return G[21] * zij + G[28];
    case 442: return G[22] * zij + G[29];
    case 443: return G[23] * zij + G[30];
    case 444: return G[24] * zij + G[31];
    case 445: return G[21] * zij + G[28];
    case 446: return G[22] * zij + G[29];
    case 447: return G[23] * zij + G[30];
    case 448: return G[24] * zij + G[31];
    case 449: return G[25] * zij + G[32];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fpgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 450;
  constexpr int kNMax = 4;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fpgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fpgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fpgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ddgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[18] * xij2 + 2.0 * (G[25] * xij) + G[32];
    case 1: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 2: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 3: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 4: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 5: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 6: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 7: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 8: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 9: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 10: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 11: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 12: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 13: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 14: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 15: return G[18] * xij + G[25];
    case 16: return G[17] * xij + G[24];
    case 17: return G[17] * xij + G[24];
    case 18: return G[16] * xij + G[23];
    case 19: return G[16] * xij + G[23];
    case 20: return G[16] * xij + G[23];
    case 21: return G[15] * xij + G[22];
    case 22: return G[15] * xij + G[22];
    case 23: return G[15] * xij + G[22];
    case 24: return G[15] * xij + G[22];
    case 25: return G[14] * xij + G[21];
    case 26: return G[14] * xij + G[21];
    case 27: return G[14] * xij + G[21];
    case 28: return G[14] * xij + G[21];
    case 29: return G[14] * xij + G[21];
    case 30: return G[18] * xij + G[25];
    case 31: return G[17] * xij + G[24];
    case 32: return G[17] * xij + G[24];
    case 33: return G[16] * xij + G[23];
    case 34: return G[16] * xij + G[23];
    case 35: return G[16] * xij + G[23];
    case 36: return G[15] * xij + G[22];
    case 37: return G[15] * xij + G[22];
    case 38: return G[15] * xij + G[22];
    case 39: return G[15] * xij + G[22];
    case 40: return G[14] * xij + G[21];
    case 41: return G[14] * xij + G[21];
    case 42: return G[14] * xij + G[21];
    case 43: return G[14] * xij + G[21];
    case 44: return G[14] * xij + G[21];
    case 45: return G[18];
    case 46: return G[17];
    case 47: return G[17];
    case 48: return G[16];
    case 49: return G[16];
    case 50: return G[16];
    case 51: return G[15];
    case 52: return G[15];
    case 53: return G[15];
    case 54: return G[15];
    case 55: return G[14];
    case 56: return G[14];
    case 57: return G[14];
    case 58: return G[14];
    case 59: return G[14];
    case 60: return G[18];
    case 61: return G[17];
    case 62: return G[17];
    case 63: return G[16];
    case 64: return G[16];
    case 65: return G[16];
    case 66: return G[15];
    case 67: return G[15];
    case 68: return G[15];
    case 69: return G[15];
    case 70: return G[14];
    case 71: return G[14];
    case 72: return G[14];
    case 73: return G[14];
    case 74: return G[14];
    case 75: return G[18];
    case 76: return G[17];
    case 77: return G[17];
    case 78: return G[16];
    case 79: return G[16];
    case 80: return G[16];
    case 81: return G[15];
    case 82: return G[15];
    case 83: return G[15];
    case 84: return G[15];
    case 85: return G[14];
    case 86: return G[14];
    case 87: return G[14];
    case 88: return G[14];
    case 89: return G[14];
    case 90: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 91: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 92: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 93: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 94: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 95: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 96: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 97: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 98: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 99: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 100: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 101: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 102: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 103: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 104: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 105: return G[11] * xij + G[18];
    case 106: return G[10] * xij + G[17];
    case 107: return G[10] * xij + G[17];
    case 108: return G[9] * xij + G[16];
    case 109: return G[9] * xij + G[16];
    case 110: return G[9] * xij + G[16];
    case 111: return G[8] * xij + G[15];
    case 112: return G[8] * xij + G[15];
    case 113: return G[8] * xij + G[15];
    case 114: return G[8] * xij + G[15];
    case 115: return G[7] * xij + G[14];
    case 116: return G[7] * xij + G[14];
    case 117: return G[7] * xij + G[14];
    case 118: return G[7] * xij + G[14];
    case 119: return G[7] * xij + G[14];
    case 120: return G[11] * xij + G[18];
    case 121: return G[10] * xij + G[17];
    case 122: return G[10] * xij + G[17];
    case 123: return G[9] * xij + G[16];
    case 124: return G[9] * xij + G[16];
    case 125: return G[9] * xij + G[16];
    case 126: return G[8] * xij + G[15];
    case 127: return G[8] * xij + G[15];
    case 128: return G[8] * xij + G[15];
    case 129: return G[8] * xij + G[15];
    case 130: return G[7] * xij + G[14];
    case 131: return G[7] * xij + G[14];
    case 132: return G[7] * xij + G[14];
    case 133: return G[7] * xij + G[14];
    case 134: return G[7] * xij + G[14];
    case 135: return G[11];
    case 136: return G[10];
    case 137: return G[10];
    case 138: return G[9];
    case 139: return G[9];
    case 140: return G[9];
    case 141: return G[8];
    case 142: return G[8];
    case 143: return G[8];
    case 144: return G[8];
    case 145: return G[7];
    case 146: return G[7];
    case 147: return G[7];
    case 148: return G[7];
    case 149: return G[7];
    case 150: return G[11];
    case 151: return G[10];
    case 152: return G[10];
    case 153: return G[9];
    case 154: return G[9];
    case 155: return G[9];
    case 156: return G[8];
    case 157: return G[8];
    case 158: return G[8];
    case 159: return G[8];
    case 160: return G[7];
    case 161: return G[7];
    case 162: return G[7];
    case 163: return G[7];
    case 164: return G[7];
    case 165: return G[11];
    case 166: return G[10];
    case 167: return G[10];
    case 168: return G[9];
    case 169: return G[9];
    case 170: return G[9];
    case 171: return G[8];
    case 172: return G[8];
    case 173: return G[8];
    case 174: return G[8];
    case 175: return G[7];
    case 176: return G[7];
    case 177: return G[7];
    case 178: return G[7];
    case 179: return G[7];
    case 180: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 181: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 182: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 183: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 184: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 185: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 186: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 187: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 188: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 189: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 190: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 191: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 192: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 193: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 194: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 195: return G[11] * xij + G[18];
    case 196: return G[10] * xij + G[17];
    case 197: return G[10] * xij + G[17];
    case 198: return G[9] * xij + G[16];
    case 199: return G[9] * xij + G[16];
    case 200: return G[9] * xij + G[16];
    case 201: return G[8] * xij + G[15];
    case 202: return G[8] * xij + G[15];
    case 203: return G[8] * xij + G[15];
    case 204: return G[8] * xij + G[15];
    case 205: return G[7] * xij + G[14];
    case 206: return G[7] * xij + G[14];
    case 207: return G[7] * xij + G[14];
    case 208: return G[7] * xij + G[14];
    case 209: return G[7] * xij + G[14];
    case 210: return G[11] * xij + G[18];
    case 211: return G[10] * xij + G[17];
    case 212: return G[10] * xij + G[17];
    case 213: return G[9] * xij + G[16];
    case 214: return G[9] * xij + G[16];
    case 215: return G[9] * xij + G[16];
    case 216: return G[8] * xij + G[15];
    case 217: return G[8] * xij + G[15];
    case 218: return G[8] * xij + G[15];
    case 219: return G[8] * xij + G[15];
    case 220: return G[7] * xij + G[14];
    case 221: return G[7] * xij + G[14];
    case 222: return G[7] * xij + G[14];
    case 223: return G[7] * xij + G[14];
    case 224: return G[7] * xij + G[14];
    case 225: return G[11];
    case 226: return G[10];
    case 227: return G[10];
    case 228: return G[9];
    case 229: return G[9];
    case 230: return G[9];
    case 231: return G[8];
    case 232: return G[8];
    case 233: return G[8];
    case 234: return G[8];
    case 235: return G[7];
    case 236: return G[7];
    case 237: return G[7];
    case 238: return G[7];
    case 239: return G[7];
    case 240: return G[11];
    case 241: return G[10];
    case 242: return G[10];
    case 243: return G[9];
    case 244: return G[9];
    case 245: return G[9];
    case 246: return G[8];
    case 247: return G[8];
    case 248: return G[8];
    case 249: return G[8];
    case 250: return G[7];
    case 251: return G[7];
    case 252: return G[7];
    case 253: return G[7];
    case 254: return G[7];
    case 255: return G[11];
    case 256: return G[10];
    case 257: return G[10];
    case 258: return G[9];
    case 259: return G[9];
    case 260: return G[9];
    case 261: return G[8];
    case 262: return G[8];
    case 263: return G[8];
    case 264: return G[8];
    case 265: return G[7];
    case 266: return G[7];
    case 267: return G[7];
    case 268: return G[7];
    case 269: return G[7];
    case 270: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 271: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 272: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 273: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 274: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 275: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 276: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 277: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 278: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 279: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 280: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 281: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 282: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 283: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 284: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 285: return G[4] * xij + G[11];
    case 286: return G[3] * xij + G[10];
    case 287: return G[3] * xij + G[10];
    case 288: return G[2] * xij + G[9];
    case 289: return G[2] * xij + G[9];
    case 290: return G[2] * xij + G[9];
    case 291: return G[1] * xij + G[8];
    case 292: return G[1] * xij + G[8];
    case 293: return G[1] * xij + G[8];
    case 294: return G[1] * xij + G[8];
    case 295: return G[0] * xij + G[7];
    case 296: return G[0] * xij + G[7];
    case 297: return G[0] * xij + G[7];
    case 298: return G[0] * xij + G[7];
    case 299: return G[0] * xij + G[7];
    case 300: return G[4] * xij + G[11];
    case 301: return G[3] * xij + G[10];
    case 302: return G[3] * xij + G[10];
    case 303: return G[2] * xij + G[9];
    case 304: return G[2] * xij + G[9];
    case 305: return G[2] * xij + G[9];
    case 306: return G[1] * xij + G[8];
    case 307: return G[1] * xij + G[8];
    case 308: return G[1] * xij + G[8];
    case 309: return G[1] * xij + G[8];
    case 310: return G[0] * xij + G[7];
    case 311: return G[0] * xij + G[7];
    case 312: return G[0] * xij + G[7];
    case 313: return G[0] * xij + G[7];
    case 314: return G[0] * xij + G[7];
    case 315: return G[4];
    case 316: return G[3];
    case 317: return G[3];
    case 318: return G[2];
    case 319: return G[2];
    case 320: return G[2];
    case 321: return G[1];
    case 322: return G[1];
    case 323: return G[1];
    case 324: return G[1];
    case 325: return G[0];
    case 326: return G[0];
    case 327: return G[0];
    case 328: return G[0];
    case 329: return G[0];
    case 330: return G[4];
    case 331: return G[3];
    case 332: return G[3];
    case 333: return G[2];
    case 334: return G[2];
    case 335: return G[2];
    case 336: return G[1];
    case 337: return G[1];
    case 338: return G[1];
    case 339: return G[1];
    case 340: return G[0];
    case 341: return G[0];
    case 342: return G[0];
    case 343: return G[0];
    case 344: return G[0];
    case 345: return G[4];
    case 346: return G[3];
    case 347: return G[3];
    case 348: return G[2];
    case 349: return G[2];
    case 350: return G[2];
    case 351: return G[1];
    case 352: return G[1];
    case 353: return G[1];
    case 354: return G[1];
    case 355: return G[0];
    case 356: return G[0];
    case 357: return G[0];
    case 358: return G[0];
    case 359: return G[0];
    case 360: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 361: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 362: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 363: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 364: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 365: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 366: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 367: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 368: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 369: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 370: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 371: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 372: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 373: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 374: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 375: return G[4] * xij + G[11];
    case 376: return G[3] * xij + G[10];
    case 377: return G[3] * xij + G[10];
    case 378: return G[2] * xij + G[9];
    case 379: return G[2] * xij + G[9];
    case 380: return G[2] * xij + G[9];
    case 381: return G[1] * xij + G[8];
    case 382: return G[1] * xij + G[8];
    case 383: return G[1] * xij + G[8];
    case 384: return G[1] * xij + G[8];
    case 385: return G[0] * xij + G[7];
    case 386: return G[0] * xij + G[7];
    case 387: return G[0] * xij + G[7];
    case 388: return G[0] * xij + G[7];
    case 389: return G[0] * xij + G[7];
    case 390: return G[4] * xij + G[11];
    case 391: return G[3] * xij + G[10];
    case 392: return G[3] * xij + G[10];
    case 393: return G[2] * xij + G[9];
    case 394: return G[2] * xij + G[9];
    case 395: return G[2] * xij + G[9];
    case 396: return G[1] * xij + G[8];
    case 397: return G[1] * xij + G[8];
    case 398: return G[1] * xij + G[8];
    case 399: return G[1] * xij + G[8];
    case 400: return G[0] * xij + G[7];
    case 401: return G[0] * xij + G[7];
    case 402: return G[0] * xij + G[7];
    case 403: return G[0] * xij + G[7];
    case 404: return G[0] * xij + G[7];
    case 405: return G[4];
    case 406: return G[3];
    case 407: return G[3];
    case 408: return G[2];
    case 409: return G[2];
    case 410: return G[2];
    case 411: return G[1];
    case 412: return G[1];
    case 413: return G[1];
    case 414: return G[1];
    case 415: return G[0];
    case 416: return G[0];
    case 417: return G[0];
    case 418: return G[0];
    case 419: return G[0];
    case 420: return G[4];
    case 421: return G[3];
    case 422: return G[3];
    case 423: return G[2];
    case 424: return G[2];
    case 425: return G[2];
    case 426: return G[1];
    case 427: return G[1];
    case 428: return G[1];
    case 429: return G[1];
    case 430: return G[0];
    case 431: return G[0];
    case 432: return G[0];
    case 433: return G[0];
    case 434: return G[0];
    case 435: return G[4];
    case 436: return G[3];
    case 437: return G[3];
    case 438: return G[2];
    case 439: return G[2];
    case 440: return G[2];
    case 441: return G[1];
    case 442: return G[1];
    case 443: return G[1];
    case 444: return G[1];
    case 445: return G[0];
    case 446: return G[0];
    case 447: return G[0];
    case 448: return G[0];
    case 449: return G[0];
    case 450: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 451: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 452: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 453: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 454: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 455: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 456: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 457: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 458: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 459: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 460: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 461: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 462: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 463: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 464: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 465: return G[4] * xij + G[11];
    case 466: return G[3] * xij + G[10];
    case 467: return G[3] * xij + G[10];
    case 468: return G[2] * xij + G[9];
    case 469: return G[2] * xij + G[9];
    case 470: return G[2] * xij + G[9];
    case 471: return G[1] * xij + G[8];
    case 472: return G[1] * xij + G[8];
    case 473: return G[1] * xij + G[8];
    case 474: return G[1] * xij + G[8];
    case 475: return G[0] * xij + G[7];
    case 476: return G[0] * xij + G[7];
    case 477: return G[0] * xij + G[7];
    case 478: return G[0] * xij + G[7];
    case 479: return G[0] * xij + G[7];
    case 480: return G[4] * xij + G[11];
    case 481: return G[3] * xij + G[10];
    case 482: return G[3] * xij + G[10];
    case 483: return G[2] * xij + G[9];
    case 484: return G[2] * xij + G[9];
    case 485: return G[2] * xij + G[9];
    case 486: return G[1] * xij + G[8];
    case 487: return G[1] * xij + G[8];
    case 488: return G[1] * xij + G[8];
    case 489: return G[1] * xij + G[8];
    case 490: return G[0] * xij + G[7];
    case 491: return G[0] * xij + G[7];
    case 492: return G[0] * xij + G[7];
    case 493: return G[0] * xij + G[7];
    case 494: return G[0] * xij + G[7];
    case 495: return G[4];
    case 496: return G[3];
    case 497: return G[3];
    case 498: return G[2];
    case 499: return G[2];
    case 500: return G[2];
    case 501: return G[1];
    case 502: return G[1];
    case 503: return G[1];
    case 504: return G[1];
    case 505: return G[0];
    case 506: return G[0];
    case 507: return G[0];
    case 508: return G[0];
    case 509: return G[0];
    case 510: return G[4];
    case 511: return G[3];
    case 512: return G[3];
    case 513: return G[2];
    case 514: return G[2];
    case 515: return G[2];
    case 516: return G[1];
    case 517: return G[1];
    case 518: return G[1];
    case 519: return G[1];
    case 520: return G[0];
    case 521: return G[0];
    case 522: return G[0];
    case 523: return G[0];
    case 524: return G[0];
    case 525: return G[4];
    case 526: return G[3];
    case 527: return G[3];
    case 528: return G[2];
    case 529: return G[2];
    case 530: return G[2];
    case 531: return G[1];
    case 532: return G[1];
    case 533: return G[1];
    case 534: return G[1];
    case 535: return G[0];
    case 536: return G[0];
    case 537: return G[0];
    case 538: return G[0];
    case 539: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ddgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[0] * yij + G[7];
    case 16: return G[1] * yij + G[8];
    case 17: return G[0] * yij + G[7];
    case 18: return G[2] * yij + G[9];
    case 19: return G[1] * yij + G[8];
    case 20: return G[0] * yij + G[7];
    case 21: return G[3] * yij + G[10];
    case 22: return G[2] * yij + G[9];
    case 23: return G[1] * yij + G[8];
    case 24: return G[0] * yij + G[7];
    case 25: return G[4] * yij + G[11];
    case 26: return G[3] * yij + G[10];
    case 27: return G[2] * yij + G[9];
    case 28: return G[1] * yij + G[8];
    case 29: return G[0] * yij + G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[3];
    case 37: return G[2];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[4];
    case 41: return G[3];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[0];
    case 45: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 46: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 47: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 48: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 49: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 50: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 51: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 52: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 53: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 54: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 55: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 56: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 57: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 58: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 59: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 60: return G[0] * yij + G[7];
    case 61: return G[1] * yij + G[8];
    case 62: return G[0] * yij + G[7];
    case 63: return G[2] * yij + G[9];
    case 64: return G[1] * yij + G[8];
    case 65: return G[0] * yij + G[7];
    case 66: return G[3] * yij + G[10];
    case 67: return G[2] * yij + G[9];
    case 68: return G[1] * yij + G[8];
    case 69: return G[0] * yij + G[7];
    case 70: return G[4] * yij + G[11];
    case 71: return G[3] * yij + G[10];
    case 72: return G[2] * yij + G[9];
    case 73: return G[1] * yij + G[8];
    case 74: return G[0] * yij + G[7];
    case 75: return G[0];
    case 76: return G[1];
    case 77: return G[0];
    case 78: return G[2];
    case 79: return G[1];
    case 80: return G[0];
    case 81: return G[3];
    case 82: return G[2];
    case 83: return G[1];
    case 84: return G[0];
    case 85: return G[4];
    case 86: return G[3];
    case 87: return G[2];
    case 88: return G[1];
    case 89: return G[0];
    case 90: return G[7];
    case 91: return G[8];
    case 92: return G[7];
    case 93: return G[9];
    case 94: return G[8];
    case 95: return G[7];
    case 96: return G[10];
    case 97: return G[9];
    case 98: return G[8];
    case 99: return G[7];
    case 100: return G[11];
    case 101: return G[10];
    case 102: return G[9];
    case 103: return G[8];
    case 104: return G[7];
    case 105: return G[7] * yij + G[14];
    case 106: return G[8] * yij + G[15];
    case 107: return G[7] * yij + G[14];
    case 108: return G[9] * yij + G[16];
    case 109: return G[8] * yij + G[15];
    case 110: return G[7] * yij + G[14];
    case 111: return G[10] * yij + G[17];
    case 112: return G[9] * yij + G[16];
    case 113: return G[8] * yij + G[15];
    case 114: return G[7] * yij + G[14];
    case 115: return G[11] * yij + G[18];
    case 116: return G[10] * yij + G[17];
    case 117: return G[9] * yij + G[16];
    case 118: return G[8] * yij + G[15];
    case 119: return G[7] * yij + G[14];
    case 120: return G[7];
    case 121: return G[8];
    case 122: return G[7];
    case 123: return G[9];
    case 124: return G[8];
    case 125: return G[7];
    case 126: return G[10];
    case 127: return G[9];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[11];
    case 131: return G[10];
    case 132: return G[9];
    case 133: return G[8];
    case 134: return G[7];
    case 135: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 136: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 137: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 138: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 139: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 140: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 141: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 142: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 143: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 144: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 145: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 146: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 147: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 148: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 149: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 150: return G[7] * yij + G[14];
    case 151: return G[8] * yij + G[15];
    case 152: return G[7] * yij + G[14];
    case 153: return G[9] * yij + G[16];
    case 154: return G[8] * yij + G[15];
    case 155: return G[7] * yij + G[14];
    case 156: return G[10] * yij + G[17];
    case 157: return G[9] * yij + G[16];
    case 158: return G[8] * yij + G[15];
    case 159: return G[7] * yij + G[14];
    case 160: return G[11] * yij + G[18];
    case 161: return G[10] * yij + G[17];
    case 162: return G[9] * yij + G[16];
    case 163: return G[8] * yij + G[15];
    case 164: return G[7] * yij + G[14];
    case 165: return G[7];
    case 166: return G[8];
    case 167: return G[7];
    case 168: return G[9];
    case 169: return G[8];
    case 170: return G[7];
    case 171: return G[10];
    case 172: return G[9];
    case 173: return G[8];
    case 174: return G[7];
    case 175: return G[11];
    case 176: return G[10];
    case 177: return G[9];
    case 178: return G[8];
    case 179: return G[7];
    case 180: return G[0];
    case 181: return G[1];
    case 182: return G[0];
    case 183: return G[2];
    case 184: return G[1];
    case 185: return G[0];
    case 186: return G[3];
    case 187: return G[2];
    case 188: return G[1];
    case 189: return G[0];
    case 190: return G[4];
    case 191: return G[3];
    case 192: return G[2];
    case 193: return G[1];
    case 194: return G[0];
    case 195: return G[0] * yij + G[7];
    case 196: return G[1] * yij + G[8];
    case 197: return G[0] * yij + G[7];
    case 198: return G[2] * yij + G[9];
    case 199: return G[1] * yij + G[8];
    case 200: return G[0] * yij + G[7];
    case 201: return G[3] * yij + G[10];
    case 202: return G[2] * yij + G[9];
    case 203: return G[1] * yij + G[8];
    case 204: return G[0] * yij + G[7];
    case 205: return G[4] * yij + G[11];
    case 206: return G[3] * yij + G[10];
    case 207: return G[2] * yij + G[9];
    case 208: return G[1] * yij + G[8];
    case 209: return G[0] * yij + G[7];
    case 210: return G[0];
    case 211: return G[1];
    case 212: return G[0];
    case 213: return G[2];
    case 214: return G[1];
    case 215: return G[0];
    case 216: return G[3];
    case 217: return G[2];
    case 218: return G[1];
    case 219: return G[0];
    case 220: return G[4];
    case 221: return G[3];
    case 222: return G[2];
    case 223: return G[1];
    case 224: return G[0];
    case 225: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 226: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 227: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 228: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 229: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 230: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 231: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 232: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 233: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 234: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 235: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 236: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 237: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 238: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 239: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 240: return G[0] * yij + G[7];
    case 241: return G[1] * yij + G[8];
    case 242: return G[0] * yij + G[7];
    case 243: return G[2] * yij + G[9];
    case 244: return G[1] * yij + G[8];
    case 245: return G[0] * yij + G[7];
    case 246: return G[3] * yij + G[10];
    case 247: return G[2] * yij + G[9];
    case 248: return G[1] * yij + G[8];
    case 249: return G[0] * yij + G[7];
    case 250: return G[4] * yij + G[11];
    case 251: return G[3] * yij + G[10];
    case 252: return G[2] * yij + G[9];
    case 253: return G[1] * yij + G[8];
    case 254: return G[0] * yij + G[7];
    case 255: return G[0];
    case 256: return G[1];
    case 257: return G[0];
    case 258: return G[2];
    case 259: return G[1];
    case 260: return G[0];
    case 261: return G[3];
    case 262: return G[2];
    case 263: return G[1];
    case 264: return G[0];
    case 265: return G[4];
    case 266: return G[3];
    case 267: return G[2];
    case 268: return G[1];
    case 269: return G[0];
    case 270: return G[14];
    case 271: return G[15];
    case 272: return G[14];
    case 273: return G[16];
    case 274: return G[15];
    case 275: return G[14];
    case 276: return G[17];
    case 277: return G[16];
    case 278: return G[15];
    case 279: return G[14];
    case 280: return G[18];
    case 281: return G[17];
    case 282: return G[16];
    case 283: return G[15];
    case 284: return G[14];
    case 285: return G[14] * yij + G[21];
    case 286: return G[15] * yij + G[22];
    case 287: return G[14] * yij + G[21];
    case 288: return G[16] * yij + G[23];
    case 289: return G[15] * yij + G[22];
    case 290: return G[14] * yij + G[21];
    case 291: return G[17] * yij + G[24];
    case 292: return G[16] * yij + G[23];
    case 293: return G[15] * yij + G[22];
    case 294: return G[14] * yij + G[21];
    case 295: return G[18] * yij + G[25];
    case 296: return G[17] * yij + G[24];
    case 297: return G[16] * yij + G[23];
    case 298: return G[15] * yij + G[22];
    case 299: return G[14] * yij + G[21];
    case 300: return G[14];
    case 301: return G[15];
    case 302: return G[14];
    case 303: return G[16];
    case 304: return G[15];
    case 305: return G[14];
    case 306: return G[17];
    case 307: return G[16];
    case 308: return G[15];
    case 309: return G[14];
    case 310: return G[18];
    case 311: return G[17];
    case 312: return G[16];
    case 313: return G[15];
    case 314: return G[14];
    case 315: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 316: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 317: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 318: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 319: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 320: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 321: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 322: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 323: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 324: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 325: return G[18] * yij2 + 2.0 * (G[25] * yij) + G[32];
    case 326: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 327: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 328: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 329: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 330: return G[14] * yij + G[21];
    case 331: return G[15] * yij + G[22];
    case 332: return G[14] * yij + G[21];
    case 333: return G[16] * yij + G[23];
    case 334: return G[15] * yij + G[22];
    case 335: return G[14] * yij + G[21];
    case 336: return G[17] * yij + G[24];
    case 337: return G[16] * yij + G[23];
    case 338: return G[15] * yij + G[22];
    case 339: return G[14] * yij + G[21];
    case 340: return G[18] * yij + G[25];
    case 341: return G[17] * yij + G[24];
    case 342: return G[16] * yij + G[23];
    case 343: return G[15] * yij + G[22];
    case 344: return G[14] * yij + G[21];
    case 345: return G[14];
    case 346: return G[15];
    case 347: return G[14];
    case 348: return G[16];
    case 349: return G[15];
    case 350: return G[14];
    case 351: return G[17];
    case 352: return G[16];
    case 353: return G[15];
    case 354: return G[14];
    case 355: return G[18];
    case 356: return G[17];
    case 357: return G[16];
    case 358: return G[15];
    case 359: return G[14];
    case 360: return G[7];
    case 361: return G[8];
    case 362: return G[7];
    case 363: return G[9];
    case 364: return G[8];
    case 365: return G[7];
    case 366: return G[10];
    case 367: return G[9];
    case 368: return G[8];
    case 369: return G[7];
    case 370: return G[11];
    case 371: return G[10];
    case 372: return G[9];
    case 373: return G[8];
    case 374: return G[7];
    case 375: return G[7] * yij + G[14];
    case 376: return G[8] * yij + G[15];
    case 377: return G[7] * yij + G[14];
    case 378: return G[9] * yij + G[16];
    case 379: return G[8] * yij + G[15];
    case 380: return G[7] * yij + G[14];
    case 381: return G[10] * yij + G[17];
    case 382: return G[9] * yij + G[16];
    case 383: return G[8] * yij + G[15];
    case 384: return G[7] * yij + G[14];
    case 385: return G[11] * yij + G[18];
    case 386: return G[10] * yij + G[17];
    case 387: return G[9] * yij + G[16];
    case 388: return G[8] * yij + G[15];
    case 389: return G[7] * yij + G[14];
    case 390: return G[7];
    case 391: return G[8];
    case 392: return G[7];
    case 393: return G[9];
    case 394: return G[8];
    case 395: return G[7];
    case 396: return G[10];
    case 397: return G[9];
    case 398: return G[8];
    case 399: return G[7];
    case 400: return G[11];
    case 401: return G[10];
    case 402: return G[9];
    case 403: return G[8];
    case 404: return G[7];
    case 405: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 406: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 407: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 408: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 409: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 410: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 411: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 412: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 413: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 414: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 415: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 416: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 417: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 418: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 419: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 420: return G[7] * yij + G[14];
    case 421: return G[8] * yij + G[15];
    case 422: return G[7] * yij + G[14];
    case 423: return G[9] * yij + G[16];
    case 424: return G[8] * yij + G[15];
    case 425: return G[7] * yij + G[14];
    case 426: return G[10] * yij + G[17];
    case 427: return G[9] * yij + G[16];
    case 428: return G[8] * yij + G[15];
    case 429: return G[7] * yij + G[14];
    case 430: return G[11] * yij + G[18];
    case 431: return G[10] * yij + G[17];
    case 432: return G[9] * yij + G[16];
    case 433: return G[8] * yij + G[15];
    case 434: return G[7] * yij + G[14];
    case 435: return G[7];
    case 436: return G[8];
    case 437: return G[7];
    case 438: return G[9];
    case 439: return G[8];
    case 440: return G[7];
    case 441: return G[10];
    case 442: return G[9];
    case 443: return G[8];
    case 444: return G[7];
    case 445: return G[11];
    case 446: return G[10];
    case 447: return G[9];
    case 448: return G[8];
    case 449: return G[7];
    case 450: return G[0];
    case 451: return G[1];
    case 452: return G[0];
    case 453: return G[2];
    case 454: return G[1];
    case 455: return G[0];
    case 456: return G[3];
    case 457: return G[2];
    case 458: return G[1];
    case 459: return G[0];
    case 460: return G[4];
    case 461: return G[3];
    case 462: return G[2];
    case 463: return G[1];
    case 464: return G[0];
    case 465: return G[0] * yij + G[7];
    case 466: return G[1] * yij + G[8];
    case 467: return G[0] * yij + G[7];
    case 468: return G[2] * yij + G[9];
    case 469: return G[1] * yij + G[8];
    case 470: return G[0] * yij + G[7];
    case 471: return G[3] * yij + G[10];
    case 472: return G[2] * yij + G[9];
    case 473: return G[1] * yij + G[8];
    case 474: return G[0] * yij + G[7];
    case 475: return G[4] * yij + G[11];
    case 476: return G[3] * yij + G[10];
    case 477: return G[2] * yij + G[9];
    case 478: return G[1] * yij + G[8];
    case 479: return G[0] * yij + G[7];
    case 480: return G[0];
    case 481: return G[1];
    case 482: return G[0];
    case 483: return G[2];
    case 484: return G[1];
    case 485: return G[0];
    case 486: return G[3];
    case 487: return G[2];
    case 488: return G[1];
    case 489: return G[0];
    case 490: return G[4];
    case 491: return G[3];
    case 492: return G[2];
    case 493: return G[1];
    case 494: return G[0];
    case 495: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 496: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 497: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 498: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 499: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 500: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 501: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 502: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 503: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 504: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 505: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 506: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 507: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 508: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 509: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 510: return G[0] * yij + G[7];
    case 511: return G[1] * yij + G[8];
    case 512: return G[0] * yij + G[7];
    case 513: return G[2] * yij + G[9];
    case 514: return G[1] * yij + G[8];
    case 515: return G[0] * yij + G[7];
    case 516: return G[3] * yij + G[10];
    case 517: return G[2] * yij + G[9];
    case 518: return G[1] * yij + G[8];
    case 519: return G[0] * yij + G[7];
    case 520: return G[4] * yij + G[11];
    case 521: return G[3] * yij + G[10];
    case 522: return G[2] * yij + G[9];
    case 523: return G[1] * yij + G[8];
    case 524: return G[0] * yij + G[7];
    case 525: return G[0];
    case 526: return G[1];
    case 527: return G[0];
    case 528: return G[2];
    case 529: return G[1];
    case 530: return G[0];
    case 531: return G[3];
    case 532: return G[2];
    case 533: return G[1];
    case 534: return G[0];
    case 535: return G[4];
    case 536: return G[3];
    case 537: return G[2];
    case 538: return G[1];
    case 539: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ddgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[2];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[3];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[2];
    case 28: return G[3];
    case 29: return G[4];
    case 30: return G[0] * zij + G[7];
    case 31: return G[0] * zij + G[7];
    case 32: return G[1] * zij + G[8];
    case 33: return G[0] * zij + G[7];
    case 34: return G[1] * zij + G[8];
    case 35: return G[2] * zij + G[9];
    case 36: return G[0] * zij + G[7];
    case 37: return G[1] * zij + G[8];
    case 38: return G[2] * zij + G[9];
    case 39: return G[3] * zij + G[10];
    case 40: return G[0] * zij + G[7];
    case 41: return G[1] * zij + G[8];
    case 42: return G[2] * zij + G[9];
    case 43: return G[3] * zij + G[10];
    case 44: return G[4] * zij + G[11];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[2];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[2];
    case 54: return G[3];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[2];
    case 58: return G[3];
    case 59: return G[4];
    case 60: return G[0] * zij + G[7];
    case 61: return G[0] * zij + G[7];
    case 62: return G[1] * zij + G[8];
    case 63: return G[0] * zij + G[7];
    case 64: return G[1] * zij + G[8];
    case 65: return G[2] * zij + G[9];
    case 66: return G[0] * zij + G[7];
    case 67: return G[1] * zij + G[8];
    case 68: return G[2] * zij + G[9];
    case 69: return G[3] * zij + G[10];
    case 70: return G[0] * zij + G[7];
    case 71: return G[1] * zij + G[8];
    case 72: return G[2] * zij + G[9];
    case 73: return G[3] * zij + G[10];
    case 74: return G[4] * zij + G[11];
    case 75: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 76: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 77: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 78: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 79: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 80: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 81: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 82: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 83: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 84: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 85: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 86: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 87: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 88: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 89: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 90: return G[0];
    case 91: return G[0];
    case 92: return G[1];
    case 93: return G[0];
    case 94: return G[1];
    case 95: return G[2];
    case 96: return G[0];
    case 97: return G[1];
    case 98: return G[2];
    case 99: return G[3];
    case 100: return G[0];
    case 101: return G[1];
    case 102: return G[2];
    case 103: return G[3];
    case 104: return G[4];
    case 105: return G[0];
    case 106: return G[0];
    case 107: return G[1];
    case 108: return G[0];
    case 109: return G[1];
    case 110: return G[2];
    case 111: return G[0];
    case 112: return G[1];
    case 113: return G[2];
    case 114: return G[3];
    case 115: return G[0];
    case 116: return G[1];
    case 117: return G[2];
    case 118: return G[3];
    case 119: return G[4];
    case 120: return G[0] * zij + G[7];
    case 121: return G[0] * zij + G[7];
    case 122: return G[1] * zij + G[8];
    case 123: return G[0] * zij + G[7];
    case 124: return G[1] * zij + G[8];
    case 125: return G[2] * zij + G[9];
    case 126: return G[0] * zij + G[7];
    case 127: return G[1] * zij + G[8];
    case 128: return G[2] * zij + G[9];
    case 129: return G[3] * zij + G[10];
    case 130: return G[0] * zij + G[7];
    case 131: return G[1] * zij + G[8];
    case 132: return G[2] * zij + G[9];
    case 133: return G[3] * zij + G[10];
    case 134: return G[4] * zij + G[11];
    case 135: return G[0];
    case 136: return G[0];
    case 137: return G[1];
    case 138: return G[0];
    case 139: return G[1];
    case 140: return G[2];
    case 141: return G[0];
    case 142: return G[1];
    case 143: return G[2];
    case 144: return G[3];
    case 145: return G[0];
    case 146: return G[1];
    case 147: return G[2];
    case 148: return G[3];
    case 149: return G[4];
    case 150: return G[0] * zij + G[7];
    case 151: return G[0] * zij + G[7];
    case 152: return G[1] * zij + G[8];
    case 153: return G[0] * zij + G[7];
    case 154: return G[1] * zij + G[8];
    case 155: return G[2] * zij + G[9];
    case 156: return G[0] * zij + G[7];
    case 157: return G[1] * zij + G[8];
    case 158: return G[2] * zij + G[9];
    case 159: return G[3] * zij + G[10];
    case 160: return G[0] * zij + G[7];
    case 161: return G[1] * zij + G[8];
    case 162: return G[2] * zij + G[9];
    case 163: return G[3] * zij + G[10];
    case 164: return G[4] * zij + G[11];
    case 165: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 166: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 167: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 168: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 169: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 170: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 171: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 172: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 173: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 174: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 175: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 176: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 177: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 178: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 179: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 180: return G[7];
    case 181: return G[7];
    case 182: return G[8];
    case 183: return G[7];
    case 184: return G[8];
    case 185: return G[9];
    case 186: return G[7];
    case 187: return G[8];
    case 188: return G[9];
    case 189: return G[10];
    case 190: return G[7];
    case 191: return G[8];
    case 192: return G[9];
    case 193: return G[10];
    case 194: return G[11];
    case 195: return G[7];
    case 196: return G[7];
    case 197: return G[8];
    case 198: return G[7];
    case 199: return G[8];
    case 200: return G[9];
    case 201: return G[7];
    case 202: return G[8];
    case 203: return G[9];
    case 204: return G[10];
    case 205: return G[7];
    case 206: return G[8];
    case 207: return G[9];
    case 208: return G[10];
    case 209: return G[11];
    case 210: return G[7] * zij + G[14];
    case 211: return G[7] * zij + G[14];
    case 212: return G[8] * zij + G[15];
    case 213: return G[7] * zij + G[14];
    case 214: return G[8] * zij + G[15];
    case 215: return G[9] * zij + G[16];
    case 216: return G[7] * zij + G[14];
    case 217: return G[8] * zij + G[15];
    case 218: return G[9] * zij + G[16];
    case 219: return G[10] * zij + G[17];
    case 220: return G[7] * zij + G[14];
    case 221: return G[8] * zij + G[15];
    case 222: return G[9] * zij + G[16];
    case 223: return G[10] * zij + G[17];
    case 224: return G[11] * zij + G[18];
    case 225: return G[7];
    case 226: return G[7];
    case 227: return G[8];
    case 228: return G[7];
    case 229: return G[8];
    case 230: return G[9];
    case 231: return G[7];
    case 232: return G[8];
    case 233: return G[9];
    case 234: return G[10];
    case 235: return G[7];
    case 236: return G[8];
    case 237: return G[9];
    case 238: return G[10];
    case 239: return G[11];
    case 240: return G[7] * zij + G[14];
    case 241: return G[7] * zij + G[14];
    case 242: return G[8] * zij + G[15];
    case 243: return G[7] * zij + G[14];
    case 244: return G[8] * zij + G[15];
    case 245: return G[9] * zij + G[16];
    case 246: return G[7] * zij + G[14];
    case 247: return G[8] * zij + G[15];
    case 248: return G[9] * zij + G[16];
    case 249: return G[10] * zij + G[17];
    case 250: return G[7] * zij + G[14];
    case 251: return G[8] * zij + G[15];
    case 252: return G[9] * zij + G[16];
    case 253: return G[10] * zij + G[17];
    case 254: return G[11] * zij + G[18];
    case 255: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 256: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 257: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 258: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 259: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 260: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 261: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 262: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 263: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 264: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 265: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 266: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 267: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 268: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 269: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 270: return G[0];
    case 271: return G[0];
    case 272: return G[1];
    case 273: return G[0];
    case 274: return G[1];
    case 275: return G[2];
    case 276: return G[0];
    case 277: return G[1];
    case 278: return G[2];
    case 279: return G[3];
    case 280: return G[0];
    case 281: return G[1];
    case 282: return G[2];
    case 283: return G[3];
    case 284: return G[4];
    case 285: return G[0];
    case 286: return G[0];
    case 287: return G[1];
    case 288: return G[0];
    case 289: return G[1];
    case 290: return G[2];
    case 291: return G[0];
    case 292: return G[1];
    case 293: return G[2];
    case 294: return G[3];
    case 295: return G[0];
    case 296: return G[1];
    case 297: return G[2];
    case 298: return G[3];
    case 299: return G[4];
    case 300: return G[0] * zij + G[7];
    case 301: return G[0] * zij + G[7];
    case 302: return G[1] * zij + G[8];
    case 303: return G[0] * zij + G[7];
    case 304: return G[1] * zij + G[8];
    case 305: return G[2] * zij + G[9];
    case 306: return G[0] * zij + G[7];
    case 307: return G[1] * zij + G[8];
    case 308: return G[2] * zij + G[9];
    case 309: return G[3] * zij + G[10];
    case 310: return G[0] * zij + G[7];
    case 311: return G[1] * zij + G[8];
    case 312: return G[2] * zij + G[9];
    case 313: return G[3] * zij + G[10];
    case 314: return G[4] * zij + G[11];
    case 315: return G[0];
    case 316: return G[0];
    case 317: return G[1];
    case 318: return G[0];
    case 319: return G[1];
    case 320: return G[2];
    case 321: return G[0];
    case 322: return G[1];
    case 323: return G[2];
    case 324: return G[3];
    case 325: return G[0];
    case 326: return G[1];
    case 327: return G[2];
    case 328: return G[3];
    case 329: return G[4];
    case 330: return G[0] * zij + G[7];
    case 331: return G[0] * zij + G[7];
    case 332: return G[1] * zij + G[8];
    case 333: return G[0] * zij + G[7];
    case 334: return G[1] * zij + G[8];
    case 335: return G[2] * zij + G[9];
    case 336: return G[0] * zij + G[7];
    case 337: return G[1] * zij + G[8];
    case 338: return G[2] * zij + G[9];
    case 339: return G[3] * zij + G[10];
    case 340: return G[0] * zij + G[7];
    case 341: return G[1] * zij + G[8];
    case 342: return G[2] * zij + G[9];
    case 343: return G[3] * zij + G[10];
    case 344: return G[4] * zij + G[11];
    case 345: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 346: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 347: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 348: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 349: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 350: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 351: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 352: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 353: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 354: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 355: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 356: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 357: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 358: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 359: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 360: return G[7];
    case 361: return G[7];
    case 362: return G[8];
    case 363: return G[7];
    case 364: return G[8];
    case 365: return G[9];
    case 366: return G[7];
    case 367: return G[8];
    case 368: return G[9];
    case 369: return G[10];
    case 370: return G[7];
    case 371: return G[8];
    case 372: return G[9];
    case 373: return G[10];
    case 374: return G[11];
    case 375: return G[7];
    case 376: return G[7];
    case 377: return G[8];
    case 378: return G[7];
    case 379: return G[8];
    case 380: return G[9];
    case 381: return G[7];
    case 382: return G[8];
    case 383: return G[9];
    case 384: return G[10];
    case 385: return G[7];
    case 386: return G[8];
    case 387: return G[9];
    case 388: return G[10];
    case 389: return G[11];
    case 390: return G[7] * zij + G[14];
    case 391: return G[7] * zij + G[14];
    case 392: return G[8] * zij + G[15];
    case 393: return G[7] * zij + G[14];
    case 394: return G[8] * zij + G[15];
    case 395: return G[9] * zij + G[16];
    case 396: return G[7] * zij + G[14];
    case 397: return G[8] * zij + G[15];
    case 398: return G[9] * zij + G[16];
    case 399: return G[10] * zij + G[17];
    case 400: return G[7] * zij + G[14];
    case 401: return G[8] * zij + G[15];
    case 402: return G[9] * zij + G[16];
    case 403: return G[10] * zij + G[17];
    case 404: return G[11] * zij + G[18];
    case 405: return G[7];
    case 406: return G[7];
    case 407: return G[8];
    case 408: return G[7];
    case 409: return G[8];
    case 410: return G[9];
    case 411: return G[7];
    case 412: return G[8];
    case 413: return G[9];
    case 414: return G[10];
    case 415: return G[7];
    case 416: return G[8];
    case 417: return G[9];
    case 418: return G[10];
    case 419: return G[11];
    case 420: return G[7] * zij + G[14];
    case 421: return G[7] * zij + G[14];
    case 422: return G[8] * zij + G[15];
    case 423: return G[7] * zij + G[14];
    case 424: return G[8] * zij + G[15];
    case 425: return G[9] * zij + G[16];
    case 426: return G[7] * zij + G[14];
    case 427: return G[8] * zij + G[15];
    case 428: return G[9] * zij + G[16];
    case 429: return G[10] * zij + G[17];
    case 430: return G[7] * zij + G[14];
    case 431: return G[8] * zij + G[15];
    case 432: return G[9] * zij + G[16];
    case 433: return G[10] * zij + G[17];
    case 434: return G[11] * zij + G[18];
    case 435: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 436: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 437: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 438: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 439: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 440: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 441: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 442: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 443: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 444: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 445: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 446: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 447: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 448: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 449: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 450: return G[14];
    case 451: return G[14];
    case 452: return G[15];
    case 453: return G[14];
    case 454: return G[15];
    case 455: return G[16];
    case 456: return G[14];
    case 457: return G[15];
    case 458: return G[16];
    case 459: return G[17];
    case 460: return G[14];
    case 461: return G[15];
    case 462: return G[16];
    case 463: return G[17];
    case 464: return G[18];
    case 465: return G[14];
    case 466: return G[14];
    case 467: return G[15];
    case 468: return G[14];
    case 469: return G[15];
    case 470: return G[16];
    case 471: return G[14];
    case 472: return G[15];
    case 473: return G[16];
    case 474: return G[17];
    case 475: return G[14];
    case 476: return G[15];
    case 477: return G[16];
    case 478: return G[17];
    case 479: return G[18];
    case 480: return G[14] * zij + G[21];
    case 481: return G[14] * zij + G[21];
    case 482: return G[15] * zij + G[22];
    case 483: return G[14] * zij + G[21];
    case 484: return G[15] * zij + G[22];
    case 485: return G[16] * zij + G[23];
    case 486: return G[14] * zij + G[21];
    case 487: return G[15] * zij + G[22];
    case 488: return G[16] * zij + G[23];
    case 489: return G[17] * zij + G[24];
    case 490: return G[14] * zij + G[21];
    case 491: return G[15] * zij + G[22];
    case 492: return G[16] * zij + G[23];
    case 493: return G[17] * zij + G[24];
    case 494: return G[18] * zij + G[25];
    case 495: return G[14];
    case 496: return G[14];
    case 497: return G[15];
    case 498: return G[14];
    case 499: return G[15];
    case 500: return G[16];
    case 501: return G[14];
    case 502: return G[15];
    case 503: return G[16];
    case 504: return G[17];
    case 505: return G[14];
    case 506: return G[15];
    case 507: return G[16];
    case 508: return G[17];
    case 509: return G[18];
    case 510: return G[14] * zij + G[21];
    case 511: return G[14] * zij + G[21];
    case 512: return G[15] * zij + G[22];
    case 513: return G[14] * zij + G[21];
    case 514: return G[15] * zij + G[22];
    case 515: return G[16] * zij + G[23];
    case 516: return G[14] * zij + G[21];
    case 517: return G[15] * zij + G[22];
    case 518: return G[16] * zij + G[23];
    case 519: return G[17] * zij + G[24];
    case 520: return G[14] * zij + G[21];
    case 521: return G[15] * zij + G[22];
    case 522: return G[16] * zij + G[23];
    case 523: return G[17] * zij + G[24];
    case 524: return G[18] * zij + G[25];
    case 525: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 526: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 527: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 528: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 529: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 530: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 531: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 532: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 533: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 534: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 535: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 536: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 537: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 538: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 539: return G[18] * zij2 + 2.0 * (G[25] * zij) + G[32];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ddgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 540;
  constexpr int kNMax = 4;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ddgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ddgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ddgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_fdgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[25] * xij2 + 2.0 * (G[32] * xij) + G[39];
    case 1: return G[24] * xij2 + 2.0 * (G[31] * xij) + G[38];
    case 2: return G[24] * xij2 + 2.0 * (G[31] * xij) + G[38];
    case 3: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 4: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 5: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 6: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 7: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 8: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 9: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 10: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 11: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 12: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 13: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 14: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 15: return G[25] * xij + G[32];
    case 16: return G[24] * xij + G[31];
    case 17: return G[24] * xij + G[31];
    case 18: return G[23] * xij + G[30];
    case 19: return G[23] * xij + G[30];
    case 20: return G[23] * xij + G[30];
    case 21: return G[22] * xij + G[29];
    case 22: return G[22] * xij + G[29];
    case 23: return G[22] * xij + G[29];
    case 24: return G[22] * xij + G[29];
    case 25: return G[21] * xij + G[28];
    case 26: return G[21] * xij + G[28];
    case 27: return G[21] * xij + G[28];
    case 28: return G[21] * xij + G[28];
    case 29: return G[21] * xij + G[28];
    case 30: return G[25] * xij + G[32];
    case 31: return G[24] * xij + G[31];
    case 32: return G[24] * xij + G[31];
    case 33: return G[23] * xij + G[30];
    case 34: return G[23] * xij + G[30];
    case 35: return G[23] * xij + G[30];
    case 36: return G[22] * xij + G[29];
    case 37: return G[22] * xij + G[29];
    case 38: return G[22] * xij + G[29];
    case 39: return G[22] * xij + G[29];
    case 40: return G[21] * xij + G[28];
    case 41: return G[21] * xij + G[28];
    case 42: return G[21] * xij + G[28];
    case 43: return G[21] * xij + G[28];
    case 44: return G[21] * xij + G[28];
    case 45: return G[25];
    case 46: return G[24];
    case 47: return G[24];
    case 48: return G[23];
    case 49: return G[23];
    case 50: return G[23];
    case 51: return G[22];
    case 52: return G[22];
    case 53: return G[22];
    case 54: return G[22];
    case 55: return G[21];
    case 56: return G[21];
    case 57: return G[21];
    case 58: return G[21];
    case 59: return G[21];
    case 60: return G[25];
    case 61: return G[24];
    case 62: return G[24];
    case 63: return G[23];
    case 64: return G[23];
    case 65: return G[23];
    case 66: return G[22];
    case 67: return G[22];
    case 68: return G[22];
    case 69: return G[22];
    case 70: return G[21];
    case 71: return G[21];
    case 72: return G[21];
    case 73: return G[21];
    case 74: return G[21];
    case 75: return G[25];
    case 76: return G[24];
    case 77: return G[24];
    case 78: return G[23];
    case 79: return G[23];
    case 80: return G[23];
    case 81: return G[22];
    case 82: return G[22];
    case 83: return G[22];
    case 84: return G[22];
    case 85: return G[21];
    case 86: return G[21];
    case 87: return G[21];
    case 88: return G[21];
    case 89: return G[21];
    case 90: return G[18] * xij2 + 2.0 * (G[25] * xij) + G[32];
    case 91: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 92: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 93: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 94: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 95: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 96: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 97: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 98: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 99: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 100: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 101: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 102: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 103: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 104: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 105: return G[18] * xij + G[25];
    case 106: return G[17] * xij + G[24];
    case 107: return G[17] * xij + G[24];
    case 108: return G[16] * xij + G[23];
    case 109: return G[16] * xij + G[23];
    case 110: return G[16] * xij + G[23];
    case 111: return G[15] * xij + G[22];
    case 112: return G[15] * xij + G[22];
    case 113: return G[15] * xij + G[22];
    case 114: return G[15] * xij + G[22];
    case 115: return G[14] * xij + G[21];
    case 116: return G[14] * xij + G[21];
    case 117: return G[14] * xij + G[21];
    case 118: return G[14] * xij + G[21];
    case 119: return G[14] * xij + G[21];
    case 120: return G[18] * xij + G[25];
    case 121: return G[17] * xij + G[24];
    case 122: return G[17] * xij + G[24];
    case 123: return G[16] * xij + G[23];
    case 124: return G[16] * xij + G[23];
    case 125: return G[16] * xij + G[23];
    case 126: return G[15] * xij + G[22];
    case 127: return G[15] * xij + G[22];
    case 128: return G[15] * xij + G[22];
    case 129: return G[15] * xij + G[22];
    case 130: return G[14] * xij + G[21];
    case 131: return G[14] * xij + G[21];
    case 132: return G[14] * xij + G[21];
    case 133: return G[14] * xij + G[21];
    case 134: return G[14] * xij + G[21];
    case 135: return G[18];
    case 136: return G[17];
    case 137: return G[17];
    case 138: return G[16];
    case 139: return G[16];
    case 140: return G[16];
    case 141: return G[15];
    case 142: return G[15];
    case 143: return G[15];
    case 144: return G[15];
    case 145: return G[14];
    case 146: return G[14];
    case 147: return G[14];
    case 148: return G[14];
    case 149: return G[14];
    case 150: return G[18];
    case 151: return G[17];
    case 152: return G[17];
    case 153: return G[16];
    case 154: return G[16];
    case 155: return G[16];
    case 156: return G[15];
    case 157: return G[15];
    case 158: return G[15];
    case 159: return G[15];
    case 160: return G[14];
    case 161: return G[14];
    case 162: return G[14];
    case 163: return G[14];
    case 164: return G[14];
    case 165: return G[18];
    case 166: return G[17];
    case 167: return G[17];
    case 168: return G[16];
    case 169: return G[16];
    case 170: return G[16];
    case 171: return G[15];
    case 172: return G[15];
    case 173: return G[15];
    case 174: return G[15];
    case 175: return G[14];
    case 176: return G[14];
    case 177: return G[14];
    case 178: return G[14];
    case 179: return G[14];
    case 180: return G[18] * xij2 + 2.0 * (G[25] * xij) + G[32];
    case 181: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 182: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 183: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 184: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 185: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 186: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 187: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 188: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 189: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 190: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 191: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 192: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 193: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 194: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 195: return G[18] * xij + G[25];
    case 196: return G[17] * xij + G[24];
    case 197: return G[17] * xij + G[24];
    case 198: return G[16] * xij + G[23];
    case 199: return G[16] * xij + G[23];
    case 200: return G[16] * xij + G[23];
    case 201: return G[15] * xij + G[22];
    case 202: return G[15] * xij + G[22];
    case 203: return G[15] * xij + G[22];
    case 204: return G[15] * xij + G[22];
    case 205: return G[14] * xij + G[21];
    case 206: return G[14] * xij + G[21];
    case 207: return G[14] * xij + G[21];
    case 208: return G[14] * xij + G[21];
    case 209: return G[14] * xij + G[21];
    case 210: return G[18] * xij + G[25];
    case 211: return G[17] * xij + G[24];
    case 212: return G[17] * xij + G[24];
    case 213: return G[16] * xij + G[23];
    case 214: return G[16] * xij + G[23];
    case 215: return G[16] * xij + G[23];
    case 216: return G[15] * xij + G[22];
    case 217: return G[15] * xij + G[22];
    case 218: return G[15] * xij + G[22];
    case 219: return G[15] * xij + G[22];
    case 220: return G[14] * xij + G[21];
    case 221: return G[14] * xij + G[21];
    case 222: return G[14] * xij + G[21];
    case 223: return G[14] * xij + G[21];
    case 224: return G[14] * xij + G[21];
    case 225: return G[18];
    case 226: return G[17];
    case 227: return G[17];
    case 228: return G[16];
    case 229: return G[16];
    case 230: return G[16];
    case 231: return G[15];
    case 232: return G[15];
    case 233: return G[15];
    case 234: return G[15];
    case 235: return G[14];
    case 236: return G[14];
    case 237: return G[14];
    case 238: return G[14];
    case 239: return G[14];
    case 240: return G[18];
    case 241: return G[17];
    case 242: return G[17];
    case 243: return G[16];
    case 244: return G[16];
    case 245: return G[16];
    case 246: return G[15];
    case 247: return G[15];
    case 248: return G[15];
    case 249: return G[15];
    case 250: return G[14];
    case 251: return G[14];
    case 252: return G[14];
    case 253: return G[14];
    case 254: return G[14];
    case 255: return G[18];
    case 256: return G[17];
    case 257: return G[17];
    case 258: return G[16];
    case 259: return G[16];
    case 260: return G[16];
    case 261: return G[15];
    case 262: return G[15];
    case 263: return G[15];
    case 264: return G[15];
    case 265: return G[14];
    case 266: return G[14];
    case 267: return G[14];
    case 268: return G[14];
    case 269: return G[14];
    case 270: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 271: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 272: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 273: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 274: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 275: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 276: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 277: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 278: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 279: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 280: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 281: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 282: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 283: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 284: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 285: return G[11] * xij + G[18];
    case 286: return G[10] * xij + G[17];
    case 287: return G[10] * xij + G[17];
    case 288: return G[9] * xij + G[16];
    case 289: return G[9] * xij + G[16];
    case 290: return G[9] * xij + G[16];
    case 291: return G[8] * xij + G[15];
    case 292: return G[8] * xij + G[15];
    case 293: return G[8] * xij + G[15];
    case 294: return G[8] * xij + G[15];
    case 295: return G[7] * xij + G[14];
    case 296: return G[7] * xij + G[14];
    case 297: return G[7] * xij + G[14];
    case 298: return G[7] * xij + G[14];
    case 299: return G[7] * xij + G[14];
    case 300: return G[11] * xij + G[18];
    case 301: return G[10] * xij + G[17];
    case 302: return G[10] * xij + G[17];
    case 303: return G[9] * xij + G[16];
    case 304: return G[9] * xij + G[16];
    case 305: return G[9] * xij + G[16];
    case 306: return G[8] * xij + G[15];
    case 307: return G[8] * xij + G[15];
    case 308: return G[8] * xij + G[15];
    case 309: return G[8] * xij + G[15];
    case 310: return G[7] * xij + G[14];
    case 311: return G[7] * xij + G[14];
    case 312: return G[7] * xij + G[14];
    case 313: return G[7] * xij + G[14];
    case 314: return G[7] * xij + G[14];
    case 315: return G[11];
    case 316: return G[10];
    case 317: return G[10];
    case 318: return G[9];
    case 319: return G[9];
    case 320: return G[9];
    case 321: return G[8];
    case 322: return G[8];
    case 323: return G[8];
    case 324: return G[8];
    case 325: return G[7];
    case 326: return G[7];
    case 327: return G[7];
    case 328: return G[7];
    case 329: return G[7];
    case 330: return G[11];
    case 331: return G[10];
    case 332: return G[10];
    case 333: return G[9];
    case 334: return G[9];
    case 335: return G[9];
    case 336: return G[8];
    case 337: return G[8];
    case 338: return G[8];
    case 339: return G[8];
    case 340: return G[7];
    case 341: return G[7];
    case 342: return G[7];
    case 343: return G[7];
    case 344: return G[7];
    case 345: return G[11];
    case 346: return G[10];
    case 347: return G[10];
    case 348: return G[9];
    case 349: return G[9];
    case 350: return G[9];
    case 351: return G[8];
    case 352: return G[8];
    case 353: return G[8];
    case 354: return G[8];
    case 355: return G[7];
    case 356: return G[7];
    case 357: return G[7];
    case 358: return G[7];
    case 359: return G[7];
    case 360: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 361: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 362: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 363: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 364: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 365: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 366: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 367: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 368: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 369: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 370: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 371: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 372: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 373: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 374: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 375: return G[11] * xij + G[18];
    case 376: return G[10] * xij + G[17];
    case 377: return G[10] * xij + G[17];
    case 378: return G[9] * xij + G[16];
    case 379: return G[9] * xij + G[16];
    case 380: return G[9] * xij + G[16];
    case 381: return G[8] * xij + G[15];
    case 382: return G[8] * xij + G[15];
    case 383: return G[8] * xij + G[15];
    case 384: return G[8] * xij + G[15];
    case 385: return G[7] * xij + G[14];
    case 386: return G[7] * xij + G[14];
    case 387: return G[7] * xij + G[14];
    case 388: return G[7] * xij + G[14];
    case 389: return G[7] * xij + G[14];
    case 390: return G[11] * xij + G[18];
    case 391: return G[10] * xij + G[17];
    case 392: return G[10] * xij + G[17];
    case 393: return G[9] * xij + G[16];
    case 394: return G[9] * xij + G[16];
    case 395: return G[9] * xij + G[16];
    case 396: return G[8] * xij + G[15];
    case 397: return G[8] * xij + G[15];
    case 398: return G[8] * xij + G[15];
    case 399: return G[8] * xij + G[15];
    case 400: return G[7] * xij + G[14];
    case 401: return G[7] * xij + G[14];
    case 402: return G[7] * xij + G[14];
    case 403: return G[7] * xij + G[14];
    case 404: return G[7] * xij + G[14];
    case 405: return G[11];
    case 406: return G[10];
    case 407: return G[10];
    case 408: return G[9];
    case 409: return G[9];
    case 410: return G[9];
    case 411: return G[8];
    case 412: return G[8];
    case 413: return G[8];
    case 414: return G[8];
    case 415: return G[7];
    case 416: return G[7];
    case 417: return G[7];
    case 418: return G[7];
    case 419: return G[7];
    case 420: return G[11];
    case 421: return G[10];
    case 422: return G[10];
    case 423: return G[9];
    case 424: return G[9];
    case 425: return G[9];
    case 426: return G[8];
    case 427: return G[8];
    case 428: return G[8];
    case 429: return G[8];
    case 430: return G[7];
    case 431: return G[7];
    case 432: return G[7];
    case 433: return G[7];
    case 434: return G[7];
    case 435: return G[11];
    case 436: return G[10];
    case 437: return G[10];
    case 438: return G[9];
    case 439: return G[9];
    case 440: return G[9];
    case 441: return G[8];
    case 442: return G[8];
    case 443: return G[8];
    case 444: return G[8];
    case 445: return G[7];
    case 446: return G[7];
    case 447: return G[7];
    case 448: return G[7];
    case 449: return G[7];
    case 450: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 451: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 452: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 453: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 454: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 455: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 456: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 457: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 458: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 459: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 460: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 461: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 462: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 463: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 464: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 465: return G[11] * xij + G[18];
    case 466: return G[10] * xij + G[17];
    case 467: return G[10] * xij + G[17];
    case 468: return G[9] * xij + G[16];
    case 469: return G[9] * xij + G[16];
    case 470: return G[9] * xij + G[16];
    case 471: return G[8] * xij + G[15];
    case 472: return G[8] * xij + G[15];
    case 473: return G[8] * xij + G[15];
    case 474: return G[8] * xij + G[15];
    case 475: return G[7] * xij + G[14];
    case 476: return G[7] * xij + G[14];
    case 477: return G[7] * xij + G[14];
    case 478: return G[7] * xij + G[14];
    case 479: return G[7] * xij + G[14];
    case 480: return G[11] * xij + G[18];
    case 481: return G[10] * xij + G[17];
    case 482: return G[10] * xij + G[17];
    case 483: return G[9] * xij + G[16];
    case 484: return G[9] * xij + G[16];
    case 485: return G[9] * xij + G[16];
    case 486: return G[8] * xij + G[15];
    case 487: return G[8] * xij + G[15];
    case 488: return G[8] * xij + G[15];
    case 489: return G[8] * xij + G[15];
    case 490: return G[7] * xij + G[14];
    case 491: return G[7] * xij + G[14];
    case 492: return G[7] * xij + G[14];
    case 493: return G[7] * xij + G[14];
    case 494: return G[7] * xij + G[14];
    case 495: return G[11];
    case 496: return G[10];
    case 497: return G[10];
    case 498: return G[9];
    case 499: return G[9];
    case 500: return G[9];
    case 501: return G[8];
    case 502: return G[8];
    case 503: return G[8];
    case 504: return G[8];
    case 505: return G[7];
    case 506: return G[7];
    case 507: return G[7];
    case 508: return G[7];
    case 509: return G[7];
    case 510: return G[11];
    case 511: return G[10];
    case 512: return G[10];
    case 513: return G[9];
    case 514: return G[9];
    case 515: return G[9];
    case 516: return G[8];
    case 517: return G[8];
    case 518: return G[8];
    case 519: return G[8];
    case 520: return G[7];
    case 521: return G[7];
    case 522: return G[7];
    case 523: return G[7];
    case 524: return G[7];
    case 525: return G[11];
    case 526: return G[10];
    case 527: return G[10];
    case 528: return G[9];
    case 529: return G[9];
    case 530: return G[9];
    case 531: return G[8];
    case 532: return G[8];
    case 533: return G[8];
    case 534: return G[8];
    case 535: return G[7];
    case 536: return G[7];
    case 537: return G[7];
    case 538: return G[7];
    case 539: return G[7];
    case 540: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 541: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 542: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 543: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 544: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 545: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 546: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 547: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 548: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 549: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 550: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 551: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 552: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 553: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 554: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 555: return G[4] * xij + G[11];
    case 556: return G[3] * xij + G[10];
    case 557: return G[3] * xij + G[10];
    case 558: return G[2] * xij + G[9];
    case 559: return G[2] * xij + G[9];
    case 560: return G[2] * xij + G[9];
    case 561: return G[1] * xij + G[8];
    case 562: return G[1] * xij + G[8];
    case 563: return G[1] * xij + G[8];
    case 564: return G[1] * xij + G[8];
    case 565: return G[0] * xij + G[7];
    case 566: return G[0] * xij + G[7];
    case 567: return G[0] * xij + G[7];
    case 568: return G[0] * xij + G[7];
    case 569: return G[0] * xij + G[7];
    case 570: return G[4] * xij + G[11];
    case 571: return G[3] * xij + G[10];
    case 572: return G[3] * xij + G[10];
    case 573: return G[2] * xij + G[9];
    case 574: return G[2] * xij + G[9];
    case 575: return G[2] * xij + G[9];
    case 576: return G[1] * xij + G[8];
    case 577: return G[1] * xij + G[8];
    case 578: return G[1] * xij + G[8];
    case 579: return G[1] * xij + G[8];
    case 580: return G[0] * xij + G[7];
    case 581: return G[0] * xij + G[7];
    case 582: return G[0] * xij + G[7];
    case 583: return G[0] * xij + G[7];
    case 584: return G[0] * xij + G[7];
    case 585: return G[4];
    case 586: return G[3];
    case 587: return G[3];
    case 588: return G[2];
    case 589: return G[2];
    case 590: return G[2];
    case 591: return G[1];
    case 592: return G[1];
    case 593: return G[1];
    case 594: return G[1];
    case 595: return G[0];
    case 596: return G[0];
    case 597: return G[0];
    case 598: return G[0];
    case 599: return G[0];
    case 600: return G[4];
    case 601: return G[3];
    case 602: return G[3];
    case 603: return G[2];
    case 604: return G[2];
    case 605: return G[2];
    case 606: return G[1];
    case 607: return G[1];
    case 608: return G[1];
    case 609: return G[1];
    case 610: return G[0];
    case 611: return G[0];
    case 612: return G[0];
    case 613: return G[0];
    case 614: return G[0];
    case 615: return G[4];
    case 616: return G[3];
    case 617: return G[3];
    case 618: return G[2];
    case 619: return G[2];
    case 620: return G[2];
    case 621: return G[1];
    case 622: return G[1];
    case 623: return G[1];
    case 624: return G[1];
    case 625: return G[0];
    case 626: return G[0];
    case 627: return G[0];
    case 628: return G[0];
    case 629: return G[0];
    case 630: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 631: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 632: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 633: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 634: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 635: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 636: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 637: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 638: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 639: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 640: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 641: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 642: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 643: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 644: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 645: return G[4] * xij + G[11];
    case 646: return G[3] * xij + G[10];
    case 647: return G[3] * xij + G[10];
    case 648: return G[2] * xij + G[9];
    case 649: return G[2] * xij + G[9];
    case 650: return G[2] * xij + G[9];
    case 651: return G[1] * xij + G[8];
    case 652: return G[1] * xij + G[8];
    case 653: return G[1] * xij + G[8];
    case 654: return G[1] * xij + G[8];
    case 655: return G[0] * xij + G[7];
    case 656: return G[0] * xij + G[7];
    case 657: return G[0] * xij + G[7];
    case 658: return G[0] * xij + G[7];
    case 659: return G[0] * xij + G[7];
    case 660: return G[4] * xij + G[11];
    case 661: return G[3] * xij + G[10];
    case 662: return G[3] * xij + G[10];
    case 663: return G[2] * xij + G[9];
    case 664: return G[2] * xij + G[9];
    case 665: return G[2] * xij + G[9];
    case 666: return G[1] * xij + G[8];
    case 667: return G[1] * xij + G[8];
    case 668: return G[1] * xij + G[8];
    case 669: return G[1] * xij + G[8];
    case 670: return G[0] * xij + G[7];
    case 671: return G[0] * xij + G[7];
    case 672: return G[0] * xij + G[7];
    case 673: return G[0] * xij + G[7];
    case 674: return G[0] * xij + G[7];
    case 675: return G[4];
    case 676: return G[3];
    case 677: return G[3];
    case 678: return G[2];
    case 679: return G[2];
    case 680: return G[2];
    case 681: return G[1];
    case 682: return G[1];
    case 683: return G[1];
    case 684: return G[1];
    case 685: return G[0];
    case 686: return G[0];
    case 687: return G[0];
    case 688: return G[0];
    case 689: return G[0];
    case 690: return G[4];
    case 691: return G[3];
    case 692: return G[3];
    case 693: return G[2];
    case 694: return G[2];
    case 695: return G[2];
    case 696: return G[1];
    case 697: return G[1];
    case 698: return G[1];
    case 699: return G[1];
    case 700: return G[0];
    case 701: return G[0];
    case 702: return G[0];
    case 703: return G[0];
    case 704: return G[0];
    case 705: return G[4];
    case 706: return G[3];
    case 707: return G[3];
    case 708: return G[2];
    case 709: return G[2];
    case 710: return G[2];
    case 711: return G[1];
    case 712: return G[1];
    case 713: return G[1];
    case 714: return G[1];
    case 715: return G[0];
    case 716: return G[0];
    case 717: return G[0];
    case 718: return G[0];
    case 719: return G[0];
    case 720: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 721: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 722: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 723: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 724: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 725: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 726: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 727: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 728: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 729: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 730: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 731: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 732: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 733: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 734: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 735: return G[4] * xij + G[11];
    case 736: return G[3] * xij + G[10];
    case 737: return G[3] * xij + G[10];
    case 738: return G[2] * xij + G[9];
    case 739: return G[2] * xij + G[9];
    case 740: return G[2] * xij + G[9];
    case 741: return G[1] * xij + G[8];
    case 742: return G[1] * xij + G[8];
    case 743: return G[1] * xij + G[8];
    case 744: return G[1] * xij + G[8];
    case 745: return G[0] * xij + G[7];
    case 746: return G[0] * xij + G[7];
    case 747: return G[0] * xij + G[7];
    case 748: return G[0] * xij + G[7];
    case 749: return G[0] * xij + G[7];
    case 750: return G[4] * xij + G[11];
    case 751: return G[3] * xij + G[10];
    case 752: return G[3] * xij + G[10];
    case 753: return G[2] * xij + G[9];
    case 754: return G[2] * xij + G[9];
    case 755: return G[2] * xij + G[9];
    case 756: return G[1] * xij + G[8];
    case 757: return G[1] * xij + G[8];
    case 758: return G[1] * xij + G[8];
    case 759: return G[1] * xij + G[8];
    case 760: return G[0] * xij + G[7];
    case 761: return G[0] * xij + G[7];
    case 762: return G[0] * xij + G[7];
    case 763: return G[0] * xij + G[7];
    case 764: return G[0] * xij + G[7];
    case 765: return G[4];
    case 766: return G[3];
    case 767: return G[3];
    case 768: return G[2];
    case 769: return G[2];
    case 770: return G[2];
    case 771: return G[1];
    case 772: return G[1];
    case 773: return G[1];
    case 774: return G[1];
    case 775: return G[0];
    case 776: return G[0];
    case 777: return G[0];
    case 778: return G[0];
    case 779: return G[0];
    case 780: return G[4];
    case 781: return G[3];
    case 782: return G[3];
    case 783: return G[2];
    case 784: return G[2];
    case 785: return G[2];
    case 786: return G[1];
    case 787: return G[1];
    case 788: return G[1];
    case 789: return G[1];
    case 790: return G[0];
    case 791: return G[0];
    case 792: return G[0];
    case 793: return G[0];
    case 794: return G[0];
    case 795: return G[4];
    case 796: return G[3];
    case 797: return G[3];
    case 798: return G[2];
    case 799: return G[2];
    case 800: return G[2];
    case 801: return G[1];
    case 802: return G[1];
    case 803: return G[1];
    case 804: return G[1];
    case 805: return G[0];
    case 806: return G[0];
    case 807: return G[0];
    case 808: return G[0];
    case 809: return G[0];
    case 810: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 811: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 812: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 813: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 814: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 815: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 816: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 817: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 818: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 819: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 820: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 821: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 822: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 823: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 824: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 825: return G[4] * xij + G[11];
    case 826: return G[3] * xij + G[10];
    case 827: return G[3] * xij + G[10];
    case 828: return G[2] * xij + G[9];
    case 829: return G[2] * xij + G[9];
    case 830: return G[2] * xij + G[9];
    case 831: return G[1] * xij + G[8];
    case 832: return G[1] * xij + G[8];
    case 833: return G[1] * xij + G[8];
    case 834: return G[1] * xij + G[8];
    case 835: return G[0] * xij + G[7];
    case 836: return G[0] * xij + G[7];
    case 837: return G[0] * xij + G[7];
    case 838: return G[0] * xij + G[7];
    case 839: return G[0] * xij + G[7];
    case 840: return G[4] * xij + G[11];
    case 841: return G[3] * xij + G[10];
    case 842: return G[3] * xij + G[10];
    case 843: return G[2] * xij + G[9];
    case 844: return G[2] * xij + G[9];
    case 845: return G[2] * xij + G[9];
    case 846: return G[1] * xij + G[8];
    case 847: return G[1] * xij + G[8];
    case 848: return G[1] * xij + G[8];
    case 849: return G[1] * xij + G[8];
    case 850: return G[0] * xij + G[7];
    case 851: return G[0] * xij + G[7];
    case 852: return G[0] * xij + G[7];
    case 853: return G[0] * xij + G[7];
    case 854: return G[0] * xij + G[7];
    case 855: return G[4];
    case 856: return G[3];
    case 857: return G[3];
    case 858: return G[2];
    case 859: return G[2];
    case 860: return G[2];
    case 861: return G[1];
    case 862: return G[1];
    case 863: return G[1];
    case 864: return G[1];
    case 865: return G[0];
    case 866: return G[0];
    case 867: return G[0];
    case 868: return G[0];
    case 869: return G[0];
    case 870: return G[4];
    case 871: return G[3];
    case 872: return G[3];
    case 873: return G[2];
    case 874: return G[2];
    case 875: return G[2];
    case 876: return G[1];
    case 877: return G[1];
    case 878: return G[1];
    case 879: return G[1];
    case 880: return G[0];
    case 881: return G[0];
    case 882: return G[0];
    case 883: return G[0];
    case 884: return G[0];
    case 885: return G[4];
    case 886: return G[3];
    case 887: return G[3];
    case 888: return G[2];
    case 889: return G[2];
    case 890: return G[2];
    case 891: return G[1];
    case 892: return G[1];
    case 893: return G[1];
    case 894: return G[1];
    case 895: return G[0];
    case 896: return G[0];
    case 897: return G[0];
    case 898: return G[0];
    case 899: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[0] * yij + G[7];
    case 16: return G[1] * yij + G[8];
    case 17: return G[0] * yij + G[7];
    case 18: return G[2] * yij + G[9];
    case 19: return G[1] * yij + G[8];
    case 20: return G[0] * yij + G[7];
    case 21: return G[3] * yij + G[10];
    case 22: return G[2] * yij + G[9];
    case 23: return G[1] * yij + G[8];
    case 24: return G[0] * yij + G[7];
    case 25: return G[4] * yij + G[11];
    case 26: return G[3] * yij + G[10];
    case 27: return G[2] * yij + G[9];
    case 28: return G[1] * yij + G[8];
    case 29: return G[0] * yij + G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[3];
    case 37: return G[2];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[4];
    case 41: return G[3];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[0];
    case 45: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 46: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 47: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 48: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 49: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 50: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 51: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 52: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 53: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 54: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 55: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 56: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 57: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 58: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 59: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 60: return G[0] * yij + G[7];
    case 61: return G[1] * yij + G[8];
    case 62: return G[0] * yij + G[7];
    case 63: return G[2] * yij + G[9];
    case 64: return G[1] * yij + G[8];
    case 65: return G[0] * yij + G[7];
    case 66: return G[3] * yij + G[10];
    case 67: return G[2] * yij + G[9];
    case 68: return G[1] * yij + G[8];
    case 69: return G[0] * yij + G[7];
    case 70: return G[4] * yij + G[11];
    case 71: return G[3] * yij + G[10];
    case 72: return G[2] * yij + G[9];
    case 73: return G[1] * yij + G[8];
    case 74: return G[0] * yij + G[7];
    case 75: return G[0];
    case 76: return G[1];
    case 77: return G[0];
    case 78: return G[2];
    case 79: return G[1];
    case 80: return G[0];
    case 81: return G[3];
    case 82: return G[2];
    case 83: return G[1];
    case 84: return G[0];
    case 85: return G[4];
    case 86: return G[3];
    case 87: return G[2];
    case 88: return G[1];
    case 89: return G[0];
    case 90: return G[7];
    case 91: return G[8];
    case 92: return G[7];
    case 93: return G[9];
    case 94: return G[8];
    case 95: return G[7];
    case 96: return G[10];
    case 97: return G[9];
    case 98: return G[8];
    case 99: return G[7];
    case 100: return G[11];
    case 101: return G[10];
    case 102: return G[9];
    case 103: return G[8];
    case 104: return G[7];
    case 105: return G[7] * yij + G[14];
    case 106: return G[8] * yij + G[15];
    case 107: return G[7] * yij + G[14];
    case 108: return G[9] * yij + G[16];
    case 109: return G[8] * yij + G[15];
    case 110: return G[7] * yij + G[14];
    case 111: return G[10] * yij + G[17];
    case 112: return G[9] * yij + G[16];
    case 113: return G[8] * yij + G[15];
    case 114: return G[7] * yij + G[14];
    case 115: return G[11] * yij + G[18];
    case 116: return G[10] * yij + G[17];
    case 117: return G[9] * yij + G[16];
    case 118: return G[8] * yij + G[15];
    case 119: return G[7] * yij + G[14];
    case 120: return G[7];
    case 121: return G[8];
    case 122: return G[7];
    case 123: return G[9];
    case 124: return G[8];
    case 125: return G[7];
    case 126: return G[10];
    case 127: return G[9];
    case 128: return G[8];
    case 129: return G[7];
    case 130: return G[11];
    case 131: return G[10];
    case 132: return G[9];
    case 133: return G[8];
    case 134: return G[7];
    case 135: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 136: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 137: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 138: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 139: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 140: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 141: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 142: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 143: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 144: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 145: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 146: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 147: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 148: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 149: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 150: return G[7] * yij + G[14];
    case 151: return G[8] * yij + G[15];
    case 152: return G[7] * yij + G[14];
    case 153: return G[9] * yij + G[16];
    case 154: return G[8] * yij + G[15];
    case 155: return G[7] * yij + G[14];
    case 156: return G[10] * yij + G[17];
    case 157: return G[9] * yij + G[16];
    case 158: return G[8] * yij + G[15];
    case 159: return G[7] * yij + G[14];
    case 160: return G[11] * yij + G[18];
    case 161: return G[10] * yij + G[17];
    case 162: return G[9] * yij + G[16];
    case 163: return G[8] * yij + G[15];
    case 164: return G[7] * yij + G[14];
    case 165: return G[7];
    case 166: return G[8];
    case 167: return G[7];
    case 168: return G[9];
    case 169: return G[8];
    case 170: return G[7];
    case 171: return G[10];
    case 172: return G[9];
    case 173: return G[8];
    case 174: return G[7];
    case 175: return G[11];
    case 176: return G[10];
    case 177: return G[9];
    case 178: return G[8];
    case 179: return G[7];
    case 180: return G[0];
    case 181: return G[1];
    case 182: return G[0];
    case 183: return G[2];
    case 184: return G[1];
    case 185: return G[0];
    case 186: return G[3];
    case 187: return G[2];
    case 188: return G[1];
    case 189: return G[0];
    case 190: return G[4];
    case 191: return G[3];
    case 192: return G[2];
    case 193: return G[1];
    case 194: return G[0];
    case 195: return G[0] * yij + G[7];
    case 196: return G[1] * yij + G[8];
    case 197: return G[0] * yij + G[7];
    case 198: return G[2] * yij + G[9];
    case 199: return G[1] * yij + G[8];
    case 200: return G[0] * yij + G[7];
    case 201: return G[3] * yij + G[10];
    case 202: return G[2] * yij + G[9];
    case 203: return G[1] * yij + G[8];
    case 204: return G[0] * yij + G[7];
    case 205: return G[4] * yij + G[11];
    case 206: return G[3] * yij + G[10];
    case 207: return G[2] * yij + G[9];
    case 208: return G[1] * yij + G[8];
    case 209: return G[0] * yij + G[7];
    case 210: return G[0];
    case 211: return G[1];
    case 212: return G[0];
    case 213: return G[2];
    case 214: return G[1];
    case 215: return G[0];
    case 216: return G[3];
    case 217: return G[2];
    case 218: return G[1];
    case 219: return G[0];
    case 220: return G[4];
    case 221: return G[3];
    case 222: return G[2];
    case 223: return G[1];
    case 224: return G[0];
    case 225: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 226: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 227: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 228: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 229: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 230: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 231: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 232: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 233: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 234: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 235: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 236: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 237: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 238: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 239: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 240: return G[0] * yij + G[7];
    case 241: return G[1] * yij + G[8];
    case 242: return G[0] * yij + G[7];
    case 243: return G[2] * yij + G[9];
    case 244: return G[1] * yij + G[8];
    case 245: return G[0] * yij + G[7];
    case 246: return G[3] * yij + G[10];
    case 247: return G[2] * yij + G[9];
    case 248: return G[1] * yij + G[8];
    case 249: return G[0] * yij + G[7];
    case 250: return G[4] * yij + G[11];
    case 251: return G[3] * yij + G[10];
    case 252: return G[2] * yij + G[9];
    case 253: return G[1] * yij + G[8];
    case 254: return G[0] * yij + G[7];
    case 255: return G[0];
    case 256: return G[1];
    case 257: return G[0];
    case 258: return G[2];
    case 259: return G[1];
    case 260: return G[0];
    case 261: return G[3];
    case 262: return G[2];
    case 263: return G[1];
    case 264: return G[0];
    case 265: return G[4];
    case 266: return G[3];
    case 267: return G[2];
    case 268: return G[1];
    case 269: return G[0];
    case 270: return G[14];
    case 271: return G[15];
    case 272: return G[14];
    case 273: return G[16];
    case 274: return G[15];
    case 275: return G[14];
    case 276: return G[17];
    case 277: return G[16];
    case 278: return G[15];
    case 279: return G[14];
    case 280: return G[18];
    case 281: return G[17];
    case 282: return G[16];
    case 283: return G[15];
    case 284: return G[14];
    case 285: return G[14] * yij + G[21];
    case 286: return G[15] * yij + G[22];
    case 287: return G[14] * yij + G[21];
    case 288: return G[16] * yij + G[23];
    case 289: return G[15] * yij + G[22];
    case 290: return G[14] * yij + G[21];
    case 291: return G[17] * yij + G[24];
    case 292: return G[16] * yij + G[23];
    case 293: return G[15] * yij + G[22];
    case 294: return G[14] * yij + G[21];
    case 295: return G[18] * yij + G[25];
    case 296: return G[17] * yij + G[24];
    case 297: return G[16] * yij + G[23];
    case 298: return G[15] * yij + G[22];
    case 299: return G[14] * yij + G[21];
    case 300: return G[14];
    case 301: return G[15];
    case 302: return G[14];
    case 303: return G[16];
    case 304: return G[15];
    case 305: return G[14];
    case 306: return G[17];
    case 307: return G[16];
    case 308: return G[15];
    case 309: return G[14];
    case 310: return G[18];
    case 311: return G[17];
    case 312: return G[16];
    case 313: return G[15];
    case 314: return G[14];
    case 315: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 316: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 317: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 318: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 319: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 320: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 321: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 322: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 323: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 324: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 325: return G[18] * yij2 + 2.0 * (G[25] * yij) + G[32];
    case 326: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 327: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 328: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 329: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 330: return G[14] * yij + G[21];
    case 331: return G[15] * yij + G[22];
    case 332: return G[14] * yij + G[21];
    case 333: return G[16] * yij + G[23];
    case 334: return G[15] * yij + G[22];
    case 335: return G[14] * yij + G[21];
    case 336: return G[17] * yij + G[24];
    case 337: return G[16] * yij + G[23];
    case 338: return G[15] * yij + G[22];
    case 339: return G[14] * yij + G[21];
    case 340: return G[18] * yij + G[25];
    case 341: return G[17] * yij + G[24];
    case 342: return G[16] * yij + G[23];
    case 343: return G[15] * yij + G[22];
    case 344: return G[14] * yij + G[21];
    case 345: return G[14];
    case 346: return G[15];
    case 347: return G[14];
    case 348: return G[16];
    case 349: return G[15];
    case 350: return G[14];
    case 351: return G[17];
    case 352: return G[16];
    case 353: return G[15];
    case 354: return G[14];
    case 355: return G[18];
    case 356: return G[17];
    case 357: return G[16];
    case 358: return G[15];
    case 359: return G[14];
    case 360: return G[7];
    case 361: return G[8];
    case 362: return G[7];
    case 363: return G[9];
    case 364: return G[8];
    case 365: return G[7];
    case 366: return G[10];
    case 367: return G[9];
    case 368: return G[8];
    case 369: return G[7];
    case 370: return G[11];
    case 371: return G[10];
    case 372: return G[9];
    case 373: return G[8];
    case 374: return G[7];
    case 375: return G[7] * yij + G[14];
    case 376: return G[8] * yij + G[15];
    case 377: return G[7] * yij + G[14];
    case 378: return G[9] * yij + G[16];
    case 379: return G[8] * yij + G[15];
    case 380: return G[7] * yij + G[14];
    case 381: return G[10] * yij + G[17];
    case 382: return G[9] * yij + G[16];
    case 383: return G[8] * yij + G[15];
    case 384: return G[7] * yij + G[14];
    case 385: return G[11] * yij + G[18];
    case 386: return G[10] * yij + G[17];
    case 387: return G[9] * yij + G[16];
    case 388: return G[8] * yij + G[15];
    case 389: return G[7] * yij + G[14];
    case 390: return G[7];
    case 391: return G[8];
    case 392: return G[7];
    case 393: return G[9];
    case 394: return G[8];
    case 395: return G[7];
    case 396: return G[10];
    case 397: return G[9];
    case 398: return G[8];
    case 399: return G[7];
    case 400: return G[11];
    case 401: return G[10];
    case 402: return G[9];
    case 403: return G[8];
    case 404: return G[7];
    case 405: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 406: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 407: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 408: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 409: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 410: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 411: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 412: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 413: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 414: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 415: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 416: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 417: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 418: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 419: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 420: return G[7] * yij + G[14];
    case 421: return G[8] * yij + G[15];
    case 422: return G[7] * yij + G[14];
    case 423: return G[9] * yij + G[16];
    case 424: return G[8] * yij + G[15];
    case 425: return G[7] * yij + G[14];
    case 426: return G[10] * yij + G[17];
    case 427: return G[9] * yij + G[16];
    case 428: return G[8] * yij + G[15];
    case 429: return G[7] * yij + G[14];
    case 430: return G[11] * yij + G[18];
    case 431: return G[10] * yij + G[17];
    case 432: return G[9] * yij + G[16];
    case 433: return G[8] * yij + G[15];
    case 434: return G[7] * yij + G[14];
    case 435: return G[7];
    case 436: return G[8];
    case 437: return G[7];
    case 438: return G[9];
    case 439: return G[8];
    case 440: return G[7];
    case 441: return G[10];
    case 442: return G[9];
    case 443: return G[8];
    case 444: return G[7];
    case 445: return G[11];
    case 446: return G[10];
    case 447: return G[9];
    case 448: return G[8];
    case 449: return G[7];
    case 450: return G[0];
    case 451: return G[1];
    case 452: return G[0];
    case 453: return G[2];
    case 454: return G[1];
    case 455: return G[0];
    case 456: return G[3];
    case 457: return G[2];
    case 458: return G[1];
    case 459: return G[0];
    case 460: return G[4];
    case 461: return G[3];
    case 462: return G[2];
    case 463: return G[1];
    case 464: return G[0];
    case 465: return G[0] * yij + G[7];
    case 466: return G[1] * yij + G[8];
    case 467: return G[0] * yij + G[7];
    case 468: return G[2] * yij + G[9];
    case 469: return G[1] * yij + G[8];
    case 470: return G[0] * yij + G[7];
    case 471: return G[3] * yij + G[10];
    case 472: return G[2] * yij + G[9];
    case 473: return G[1] * yij + G[8];
    case 474: return G[0] * yij + G[7];
    case 475: return G[4] * yij + G[11];
    case 476: return G[3] * yij + G[10];
    case 477: return G[2] * yij + G[9];
    case 478: return G[1] * yij + G[8];
    case 479: return G[0] * yij + G[7];
    case 480: return G[0];
    case 481: return G[1];
    case 482: return G[0];
    case 483: return G[2];
    case 484: return G[1];
    case 485: return G[0];
    case 486: return G[3];
    case 487: return G[2];
    case 488: return G[1];
    case 489: return G[0];
    case 490: return G[4];
    case 491: return G[3];
    case 492: return G[2];
    case 493: return G[1];
    case 494: return G[0];
    case 495: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 496: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 497: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 498: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 499: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 500: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 501: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 502: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 503: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 504: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 505: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 506: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 507: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 508: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 509: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 510: return G[0] * yij + G[7];
    case 511: return G[1] * yij + G[8];
    case 512: return G[0] * yij + G[7];
    case 513: return G[2] * yij + G[9];
    case 514: return G[1] * yij + G[8];
    case 515: return G[0] * yij + G[7];
    case 516: return G[3] * yij + G[10];
    case 517: return G[2] * yij + G[9];
    case 518: return G[1] * yij + G[8];
    case 519: return G[0] * yij + G[7];
    case 520: return G[4] * yij + G[11];
    case 521: return G[3] * yij + G[10];
    case 522: return G[2] * yij + G[9];
    case 523: return G[1] * yij + G[8];
    case 524: return G[0] * yij + G[7];
    case 525: return G[0];
    case 526: return G[1];
    case 527: return G[0];
    case 528: return G[2];
    case 529: return G[1];
    case 530: return G[0];
    case 531: return G[3];
    case 532: return G[2];
    case 533: return G[1];
    case 534: return G[0];
    case 535: return G[4];
    case 536: return G[3];
    case 537: return G[2];
    case 538: return G[1];
    case 539: return G[0];
    case 540: return G[21];
    case 541: return G[22];
    case 542: return G[21];
    case 543: return G[23];
    case 544: return G[22];
    case 545: return G[21];
    case 546: return G[24];
    case 547: return G[23];
    case 548: return G[22];
    case 549: return G[21];
    case 550: return G[25];
    case 551: return G[24];
    case 552: return G[23];
    case 553: return G[22];
    case 554: return G[21];
    case 555: return G[21] * yij + G[28];
    case 556: return G[22] * yij + G[29];
    case 557: return G[21] * yij + G[28];
    case 558: return G[23] * yij + G[30];
    case 559: return G[22] * yij + G[29];
    case 560: return G[21] * yij + G[28];
    case 561: return G[24] * yij + G[31];
    case 562: return G[23] * yij + G[30];
    case 563: return G[22] * yij + G[29];
    case 564: return G[21] * yij + G[28];
    case 565: return G[25] * yij + G[32];
    case 566: return G[24] * yij + G[31];
    case 567: return G[23] * yij + G[30];
    case 568: return G[22] * yij + G[29];
    case 569: return G[21] * yij + G[28];
    case 570: return G[21];
    case 571: return G[22];
    case 572: return G[21];
    case 573: return G[23];
    case 574: return G[22];
    case 575: return G[21];
    case 576: return G[24];
    case 577: return G[23];
    case 578: return G[22];
    case 579: return G[21];
    case 580: return G[25];
    case 581: return G[24];
    case 582: return G[23];
    case 583: return G[22];
    case 584: return G[21];
    case 585: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 586: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 587: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 588: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 589: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 590: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 591: return G[24] * yij2 + 2.0 * (G[31] * yij) + G[38];
    case 592: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 593: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 594: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 595: return G[25] * yij2 + 2.0 * (G[32] * yij) + G[39];
    case 596: return G[24] * yij2 + 2.0 * (G[31] * yij) + G[38];
    case 597: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 598: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 599: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 600: return G[21] * yij + G[28];
    case 601: return G[22] * yij + G[29];
    case 602: return G[21] * yij + G[28];
    case 603: return G[23] * yij + G[30];
    case 604: return G[22] * yij + G[29];
    case 605: return G[21] * yij + G[28];
    case 606: return G[24] * yij + G[31];
    case 607: return G[23] * yij + G[30];
    case 608: return G[22] * yij + G[29];
    case 609: return G[21] * yij + G[28];
    case 610: return G[25] * yij + G[32];
    case 611: return G[24] * yij + G[31];
    case 612: return G[23] * yij + G[30];
    case 613: return G[22] * yij + G[29];
    case 614: return G[21] * yij + G[28];
    case 615: return G[21];
    case 616: return G[22];
    case 617: return G[21];
    case 618: return G[23];
    case 619: return G[22];
    case 620: return G[21];
    case 621: return G[24];
    case 622: return G[23];
    case 623: return G[22];
    case 624: return G[21];
    case 625: return G[25];
    case 626: return G[24];
    case 627: return G[23];
    case 628: return G[22];
    case 629: return G[21];
    case 630: return G[14];
    case 631: return G[15];
    case 632: return G[14];
    case 633: return G[16];
    case 634: return G[15];
    case 635: return G[14];
    case 636: return G[17];
    case 637: return G[16];
    case 638: return G[15];
    case 639: return G[14];
    case 640: return G[18];
    case 641: return G[17];
    case 642: return G[16];
    case 643: return G[15];
    case 644: return G[14];
    case 645: return G[14] * yij + G[21];
    case 646: return G[15] * yij + G[22];
    case 647: return G[14] * yij + G[21];
    case 648: return G[16] * yij + G[23];
    case 649: return G[15] * yij + G[22];
    case 650: return G[14] * yij + G[21];
    case 651: return G[17] * yij + G[24];
    case 652: return G[16] * yij + G[23];
    case 653: return G[15] * yij + G[22];
    case 654: return G[14] * yij + G[21];
    case 655: return G[18] * yij + G[25];
    case 656: return G[17] * yij + G[24];
    case 657: return G[16] * yij + G[23];
    case 658: return G[15] * yij + G[22];
    case 659: return G[14] * yij + G[21];
    case 660: return G[14];
    case 661: return G[15];
    case 662: return G[14];
    case 663: return G[16];
    case 664: return G[15];
    case 665: return G[14];
    case 666: return G[17];
    case 667: return G[16];
    case 668: return G[15];
    case 669: return G[14];
    case 670: return G[18];
    case 671: return G[17];
    case 672: return G[16];
    case 673: return G[15];
    case 674: return G[14];
    case 675: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 676: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 677: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 678: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 679: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 680: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 681: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 682: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 683: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 684: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 685: return G[18] * yij2 + 2.0 * (G[25] * yij) + G[32];
    case 686: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 687: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 688: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 689: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 690: return G[14] * yij + G[21];
    case 691: return G[15] * yij + G[22];
    case 692: return G[14] * yij + G[21];
    case 693: return G[16] * yij + G[23];
    case 694: return G[15] * yij + G[22];
    case 695: return G[14] * yij + G[21];
    case 696: return G[17] * yij + G[24];
    case 697: return G[16] * yij + G[23];
    case 698: return G[15] * yij + G[22];
    case 699: return G[14] * yij + G[21];
    case 700: return G[18] * yij + G[25];
    case 701: return G[17] * yij + G[24];
    case 702: return G[16] * yij + G[23];
    case 703: return G[15] * yij + G[22];
    case 704: return G[14] * yij + G[21];
    case 705: return G[14];
    case 706: return G[15];
    case 707: return G[14];
    case 708: return G[16];
    case 709: return G[15];
    case 710: return G[14];
    case 711: return G[17];
    case 712: return G[16];
    case 713: return G[15];
    case 714: return G[14];
    case 715: return G[18];
    case 716: return G[17];
    case 717: return G[16];
    case 718: return G[15];
    case 719: return G[14];
    case 720: return G[7];
    case 721: return G[8];
    case 722: return G[7];
    case 723: return G[9];
    case 724: return G[8];
    case 725: return G[7];
    case 726: return G[10];
    case 727: return G[9];
    case 728: return G[8];
    case 729: return G[7];
    case 730: return G[11];
    case 731: return G[10];
    case 732: return G[9];
    case 733: return G[8];
    case 734: return G[7];
    case 735: return G[7] * yij + G[14];
    case 736: return G[8] * yij + G[15];
    case 737: return G[7] * yij + G[14];
    case 738: return G[9] * yij + G[16];
    case 739: return G[8] * yij + G[15];
    case 740: return G[7] * yij + G[14];
    case 741: return G[10] * yij + G[17];
    case 742: return G[9] * yij + G[16];
    case 743: return G[8] * yij + G[15];
    case 744: return G[7] * yij + G[14];
    case 745: return G[11] * yij + G[18];
    case 746: return G[10] * yij + G[17];
    case 747: return G[9] * yij + G[16];
    case 748: return G[8] * yij + G[15];
    case 749: return G[7] * yij + G[14];
    case 750: return G[7];
    case 751: return G[8];
    case 752: return G[7];
    case 753: return G[9];
    case 754: return G[8];
    case 755: return G[7];
    case 756: return G[10];
    case 757: return G[9];
    case 758: return G[8];
    case 759: return G[7];
    case 760: return G[11];
    case 761: return G[10];
    case 762: return G[9];
    case 763: return G[8];
    case 764: return G[7];
    case 765: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 766: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 767: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 768: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 769: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 770: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 771: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 772: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 773: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 774: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 775: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 776: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 777: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 778: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 779: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 780: return G[7] * yij + G[14];
    case 781: return G[8] * yij + G[15];
    case 782: return G[7] * yij + G[14];
    case 783: return G[9] * yij + G[16];
    case 784: return G[8] * yij + G[15];
    case 785: return G[7] * yij + G[14];
    case 786: return G[10] * yij + G[17];
    case 787: return G[9] * yij + G[16];
    case 788: return G[8] * yij + G[15];
    case 789: return G[7] * yij + G[14];
    case 790: return G[11] * yij + G[18];
    case 791: return G[10] * yij + G[17];
    case 792: return G[9] * yij + G[16];
    case 793: return G[8] * yij + G[15];
    case 794: return G[7] * yij + G[14];
    case 795: return G[7];
    case 796: return G[8];
    case 797: return G[7];
    case 798: return G[9];
    case 799: return G[8];
    case 800: return G[7];
    case 801: return G[10];
    case 802: return G[9];
    case 803: return G[8];
    case 804: return G[7];
    case 805: return G[11];
    case 806: return G[10];
    case 807: return G[9];
    case 808: return G[8];
    case 809: return G[7];
    case 810: return G[0];
    case 811: return G[1];
    case 812: return G[0];
    case 813: return G[2];
    case 814: return G[1];
    case 815: return G[0];
    case 816: return G[3];
    case 817: return G[2];
    case 818: return G[1];
    case 819: return G[0];
    case 820: return G[4];
    case 821: return G[3];
    case 822: return G[2];
    case 823: return G[1];
    case 824: return G[0];
    case 825: return G[0] * yij + G[7];
    case 826: return G[1] * yij + G[8];
    case 827: return G[0] * yij + G[7];
    case 828: return G[2] * yij + G[9];
    case 829: return G[1] * yij + G[8];
    case 830: return G[0] * yij + G[7];
    case 831: return G[3] * yij + G[10];
    case 832: return G[2] * yij + G[9];
    case 833: return G[1] * yij + G[8];
    case 834: return G[0] * yij + G[7];
    case 835: return G[4] * yij + G[11];
    case 836: return G[3] * yij + G[10];
    case 837: return G[2] * yij + G[9];
    case 838: return G[1] * yij + G[8];
    case 839: return G[0] * yij + G[7];
    case 840: return G[0];
    case 841: return G[1];
    case 842: return G[0];
    case 843: return G[2];
    case 844: return G[1];
    case 845: return G[0];
    case 846: return G[3];
    case 847: return G[2];
    case 848: return G[1];
    case 849: return G[0];
    case 850: return G[4];
    case 851: return G[3];
    case 852: return G[2];
    case 853: return G[1];
    case 854: return G[0];
    case 855: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 856: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 857: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 858: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 859: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 860: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 861: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 862: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 863: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 864: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 865: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 866: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 867: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 868: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 869: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 870: return G[0] * yij + G[7];
    case 871: return G[1] * yij + G[8];
    case 872: return G[0] * yij + G[7];
    case 873: return G[2] * yij + G[9];
    case 874: return G[1] * yij + G[8];
    case 875: return G[0] * yij + G[7];
    case 876: return G[3] * yij + G[10];
    case 877: return G[2] * yij + G[9];
    case 878: return G[1] * yij + G[8];
    case 879: return G[0] * yij + G[7];
    case 880: return G[4] * yij + G[11];
    case 881: return G[3] * yij + G[10];
    case 882: return G[2] * yij + G[9];
    case 883: return G[1] * yij + G[8];
    case 884: return G[0] * yij + G[7];
    case 885: return G[0];
    case 886: return G[1];
    case 887: return G[0];
    case 888: return G[2];
    case 889: return G[1];
    case 890: return G[0];
    case 891: return G[3];
    case 892: return G[2];
    case 893: return G[1];
    case 894: return G[0];
    case 895: return G[4];
    case 896: return G[3];
    case 897: return G[2];
    case 898: return G[1];
    case 899: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_fdgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[2];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[3];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[2];
    case 28: return G[3];
    case 29: return G[4];
    case 30: return G[0] * zij + G[7];
    case 31: return G[0] * zij + G[7];
    case 32: return G[1] * zij + G[8];
    case 33: return G[0] * zij + G[7];
    case 34: return G[1] * zij + G[8];
    case 35: return G[2] * zij + G[9];
    case 36: return G[0] * zij + G[7];
    case 37: return G[1] * zij + G[8];
    case 38: return G[2] * zij + G[9];
    case 39: return G[3] * zij + G[10];
    case 40: return G[0] * zij + G[7];
    case 41: return G[1] * zij + G[8];
    case 42: return G[2] * zij + G[9];
    case 43: return G[3] * zij + G[10];
    case 44: return G[4] * zij + G[11];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[2];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[2];
    case 54: return G[3];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[2];
    case 58: return G[3];
    case 59: return G[4];
    case 60: return G[0] * zij + G[7];
    case 61: return G[0] * zij + G[7];
    case 62: return G[1] * zij + G[8];
    case 63: return G[0] * zij + G[7];
    case 64: return G[1] * zij + G[8];
    case 65: return G[2] * zij + G[9];
    case 66: return G[0] * zij + G[7];
    case 67: return G[1] * zij + G[8];
    case 68: return G[2] * zij + G[9];
    case 69: return G[3] * zij + G[10];
    case 70: return G[0] * zij + G[7];
    case 71: return G[1] * zij + G[8];
    case 72: return G[2] * zij + G[9];
    case 73: return G[3] * zij + G[10];
    case 74: return G[4] * zij + G[11];
    case 75: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 76: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 77: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 78: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 79: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 80: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 81: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 82: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 83: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 84: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 85: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 86: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 87: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 88: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 89: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 90: return G[0];
    case 91: return G[0];
    case 92: return G[1];
    case 93: return G[0];
    case 94: return G[1];
    case 95: return G[2];
    case 96: return G[0];
    case 97: return G[1];
    case 98: return G[2];
    case 99: return G[3];
    case 100: return G[0];
    case 101: return G[1];
    case 102: return G[2];
    case 103: return G[3];
    case 104: return G[4];
    case 105: return G[0];
    case 106: return G[0];
    case 107: return G[1];
    case 108: return G[0];
    case 109: return G[1];
    case 110: return G[2];
    case 111: return G[0];
    case 112: return G[1];
    case 113: return G[2];
    case 114: return G[3];
    case 115: return G[0];
    case 116: return G[1];
    case 117: return G[2];
    case 118: return G[3];
    case 119: return G[4];
    case 120: return G[0] * zij + G[7];
    case 121: return G[0] * zij + G[7];
    case 122: return G[1] * zij + G[8];
    case 123: return G[0] * zij + G[7];
    case 124: return G[1] * zij + G[8];
    case 125: return G[2] * zij + G[9];
    case 126: return G[0] * zij + G[7];
    case 127: return G[1] * zij + G[8];
    case 128: return G[2] * zij + G[9];
    case 129: return G[3] * zij + G[10];
    case 130: return G[0] * zij + G[7];
    case 131: return G[1] * zij + G[8];
    case 132: return G[2] * zij + G[9];
    case 133: return G[3] * zij + G[10];
    case 134: return G[4] * zij + G[11];
    case 135: return G[0];
    case 136: return G[0];
    case 137: return G[1];
    case 138: return G[0];
    case 139: return G[1];
    case 140: return G[2];
    case 141: return G[0];
    case 142: return G[1];
    case 143: return G[2];
    case 144: return G[3];
    case 145: return G[0];
    case 146: return G[1];
    case 147: return G[2];
    case 148: return G[3];
    case 149: return G[4];
    case 150: return G[0] * zij + G[7];
    case 151: return G[0] * zij + G[7];
    case 152: return G[1] * zij + G[8];
    case 153: return G[0] * zij + G[7];
    case 154: return G[1] * zij + G[8];
    case 155: return G[2] * zij + G[9];
    case 156: return G[0] * zij + G[7];
    case 157: return G[1] * zij + G[8];
    case 158: return G[2] * zij + G[9];
    case 159: return G[3] * zij + G[10];
    case 160: return G[0] * zij + G[7];
    case 161: return G[1] * zij + G[8];
    case 162: return G[2] * zij + G[9];
    case 163: return G[3] * zij + G[10];
    case 164: return G[4] * zij + G[11];
    case 165: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 166: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 167: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 168: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 169: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 170: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 171: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 172: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 173: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 174: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 175: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 176: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 177: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 178: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 179: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 180: return G[7];
    case 181: return G[7];
    case 182: return G[8];
    case 183: return G[7];
    case 184: return G[8];
    case 185: return G[9];
    case 186: return G[7];
    case 187: return G[8];
    case 188: return G[9];
    case 189: return G[10];
    case 190: return G[7];
    case 191: return G[8];
    case 192: return G[9];
    case 193: return G[10];
    case 194: return G[11];
    case 195: return G[7];
    case 196: return G[7];
    case 197: return G[8];
    case 198: return G[7];
    case 199: return G[8];
    case 200: return G[9];
    case 201: return G[7];
    case 202: return G[8];
    case 203: return G[9];
    case 204: return G[10];
    case 205: return G[7];
    case 206: return G[8];
    case 207: return G[9];
    case 208: return G[10];
    case 209: return G[11];
    case 210: return G[7] * zij + G[14];
    case 211: return G[7] * zij + G[14];
    case 212: return G[8] * zij + G[15];
    case 213: return G[7] * zij + G[14];
    case 214: return G[8] * zij + G[15];
    case 215: return G[9] * zij + G[16];
    case 216: return G[7] * zij + G[14];
    case 217: return G[8] * zij + G[15];
    case 218: return G[9] * zij + G[16];
    case 219: return G[10] * zij + G[17];
    case 220: return G[7] * zij + G[14];
    case 221: return G[8] * zij + G[15];
    case 222: return G[9] * zij + G[16];
    case 223: return G[10] * zij + G[17];
    case 224: return G[11] * zij + G[18];
    case 225: return G[7];
    case 226: return G[7];
    case 227: return G[8];
    case 228: return G[7];
    case 229: return G[8];
    case 230: return G[9];
    case 231: return G[7];
    case 232: return G[8];
    case 233: return G[9];
    case 234: return G[10];
    case 235: return G[7];
    case 236: return G[8];
    case 237: return G[9];
    case 238: return G[10];
    case 239: return G[11];
    case 240: return G[7] * zij + G[14];
    case 241: return G[7] * zij + G[14];
    case 242: return G[8] * zij + G[15];
    case 243: return G[7] * zij + G[14];
    case 244: return G[8] * zij + G[15];
    case 245: return G[9] * zij + G[16];
    case 246: return G[7] * zij + G[14];
    case 247: return G[8] * zij + G[15];
    case 248: return G[9] * zij + G[16];
    case 249: return G[10] * zij + G[17];
    case 250: return G[7] * zij + G[14];
    case 251: return G[8] * zij + G[15];
    case 252: return G[9] * zij + G[16];
    case 253: return G[10] * zij + G[17];
    case 254: return G[11] * zij + G[18];
    case 255: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 256: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 257: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 258: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 259: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 260: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 261: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 262: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 263: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 264: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 265: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 266: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 267: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 268: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 269: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 270: return G[0];
    case 271: return G[0];
    case 272: return G[1];
    case 273: return G[0];
    case 274: return G[1];
    case 275: return G[2];
    case 276: return G[0];
    case 277: return G[1];
    case 278: return G[2];
    case 279: return G[3];
    case 280: return G[0];
    case 281: return G[1];
    case 282: return G[2];
    case 283: return G[3];
    case 284: return G[4];
    case 285: return G[0];
    case 286: return G[0];
    case 287: return G[1];
    case 288: return G[0];
    case 289: return G[1];
    case 290: return G[2];
    case 291: return G[0];
    case 292: return G[1];
    case 293: return G[2];
    case 294: return G[3];
    case 295: return G[0];
    case 296: return G[1];
    case 297: return G[2];
    case 298: return G[3];
    case 299: return G[4];
    case 300: return G[0] * zij + G[7];
    case 301: return G[0] * zij + G[7];
    case 302: return G[1] * zij + G[8];
    case 303: return G[0] * zij + G[7];
    case 304: return G[1] * zij + G[8];
    case 305: return G[2] * zij + G[9];
    case 306: return G[0] * zij + G[7];
    case 307: return G[1] * zij + G[8];
    case 308: return G[2] * zij + G[9];
    case 309: return G[3] * zij + G[10];
    case 310: return G[0] * zij + G[7];
    case 311: return G[1] * zij + G[8];
    case 312: return G[2] * zij + G[9];
    case 313: return G[3] * zij + G[10];
    case 314: return G[4] * zij + G[11];
    case 315: return G[0];
    case 316: return G[0];
    case 317: return G[1];
    case 318: return G[0];
    case 319: return G[1];
    case 320: return G[2];
    case 321: return G[0];
    case 322: return G[1];
    case 323: return G[2];
    case 324: return G[3];
    case 325: return G[0];
    case 326: return G[1];
    case 327: return G[2];
    case 328: return G[3];
    case 329: return G[4];
    case 330: return G[0] * zij + G[7];
    case 331: return G[0] * zij + G[7];
    case 332: return G[1] * zij + G[8];
    case 333: return G[0] * zij + G[7];
    case 334: return G[1] * zij + G[8];
    case 335: return G[2] * zij + G[9];
    case 336: return G[0] * zij + G[7];
    case 337: return G[1] * zij + G[8];
    case 338: return G[2] * zij + G[9];
    case 339: return G[3] * zij + G[10];
    case 340: return G[0] * zij + G[7];
    case 341: return G[1] * zij + G[8];
    case 342: return G[2] * zij + G[9];
    case 343: return G[3] * zij + G[10];
    case 344: return G[4] * zij + G[11];
    case 345: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 346: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 347: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 348: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 349: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 350: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 351: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 352: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 353: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 354: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 355: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 356: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 357: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 358: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 359: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 360: return G[7];
    case 361: return G[7];
    case 362: return G[8];
    case 363: return G[7];
    case 364: return G[8];
    case 365: return G[9];
    case 366: return G[7];
    case 367: return G[8];
    case 368: return G[9];
    case 369: return G[10];
    case 370: return G[7];
    case 371: return G[8];
    case 372: return G[9];
    case 373: return G[10];
    case 374: return G[11];
    case 375: return G[7];
    case 376: return G[7];
    case 377: return G[8];
    case 378: return G[7];
    case 379: return G[8];
    case 380: return G[9];
    case 381: return G[7];
    case 382: return G[8];
    case 383: return G[9];
    case 384: return G[10];
    case 385: return G[7];
    case 386: return G[8];
    case 387: return G[9];
    case 388: return G[10];
    case 389: return G[11];
    case 390: return G[7] * zij + G[14];
    case 391: return G[7] * zij + G[14];
    case 392: return G[8] * zij + G[15];
    case 393: return G[7] * zij + G[14];
    case 394: return G[8] * zij + G[15];
    case 395: return G[9] * zij + G[16];
    case 396: return G[7] * zij + G[14];
    case 397: return G[8] * zij + G[15];
    case 398: return G[9] * zij + G[16];
    case 399: return G[10] * zij + G[17];
    case 400: return G[7] * zij + G[14];
    case 401: return G[8] * zij + G[15];
    case 402: return G[9] * zij + G[16];
    case 403: return G[10] * zij + G[17];
    case 404: return G[11] * zij + G[18];
    case 405: return G[7];
    case 406: return G[7];
    case 407: return G[8];
    case 408: return G[7];
    case 409: return G[8];
    case 410: return G[9];
    case 411: return G[7];
    case 412: return G[8];
    case 413: return G[9];
    case 414: return G[10];
    case 415: return G[7];
    case 416: return G[8];
    case 417: return G[9];
    case 418: return G[10];
    case 419: return G[11];
    case 420: return G[7] * zij + G[14];
    case 421: return G[7] * zij + G[14];
    case 422: return G[8] * zij + G[15];
    case 423: return G[7] * zij + G[14];
    case 424: return G[8] * zij + G[15];
    case 425: return G[9] * zij + G[16];
    case 426: return G[7] * zij + G[14];
    case 427: return G[8] * zij + G[15];
    case 428: return G[9] * zij + G[16];
    case 429: return G[10] * zij + G[17];
    case 430: return G[7] * zij + G[14];
    case 431: return G[8] * zij + G[15];
    case 432: return G[9] * zij + G[16];
    case 433: return G[10] * zij + G[17];
    case 434: return G[11] * zij + G[18];
    case 435: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 436: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 437: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 438: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 439: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 440: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 441: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 442: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 443: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 444: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 445: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 446: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 447: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 448: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 449: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 450: return G[14];
    case 451: return G[14];
    case 452: return G[15];
    case 453: return G[14];
    case 454: return G[15];
    case 455: return G[16];
    case 456: return G[14];
    case 457: return G[15];
    case 458: return G[16];
    case 459: return G[17];
    case 460: return G[14];
    case 461: return G[15];
    case 462: return G[16];
    case 463: return G[17];
    case 464: return G[18];
    case 465: return G[14];
    case 466: return G[14];
    case 467: return G[15];
    case 468: return G[14];
    case 469: return G[15];
    case 470: return G[16];
    case 471: return G[14];
    case 472: return G[15];
    case 473: return G[16];
    case 474: return G[17];
    case 475: return G[14];
    case 476: return G[15];
    case 477: return G[16];
    case 478: return G[17];
    case 479: return G[18];
    case 480: return G[14] * zij + G[21];
    case 481: return G[14] * zij + G[21];
    case 482: return G[15] * zij + G[22];
    case 483: return G[14] * zij + G[21];
    case 484: return G[15] * zij + G[22];
    case 485: return G[16] * zij + G[23];
    case 486: return G[14] * zij + G[21];
    case 487: return G[15] * zij + G[22];
    case 488: return G[16] * zij + G[23];
    case 489: return G[17] * zij + G[24];
    case 490: return G[14] * zij + G[21];
    case 491: return G[15] * zij + G[22];
    case 492: return G[16] * zij + G[23];
    case 493: return G[17] * zij + G[24];
    case 494: return G[18] * zij + G[25];
    case 495: return G[14];
    case 496: return G[14];
    case 497: return G[15];
    case 498: return G[14];
    case 499: return G[15];
    case 500: return G[16];
    case 501: return G[14];
    case 502: return G[15];
    case 503: return G[16];
    case 504: return G[17];
    case 505: return G[14];
    case 506: return G[15];
    case 507: return G[16];
    case 508: return G[17];
    case 509: return G[18];
    case 510: return G[14] * zij + G[21];
    case 511: return G[14] * zij + G[21];
    case 512: return G[15] * zij + G[22];
    case 513: return G[14] * zij + G[21];
    case 514: return G[15] * zij + G[22];
    case 515: return G[16] * zij + G[23];
    case 516: return G[14] * zij + G[21];
    case 517: return G[15] * zij + G[22];
    case 518: return G[16] * zij + G[23];
    case 519: return G[17] * zij + G[24];
    case 520: return G[14] * zij + G[21];
    case 521: return G[15] * zij + G[22];
    case 522: return G[16] * zij + G[23];
    case 523: return G[17] * zij + G[24];
    case 524: return G[18] * zij + G[25];
    case 525: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 526: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 527: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 528: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 529: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 530: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 531: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 532: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 533: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 534: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 535: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 536: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 537: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 538: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 539: return G[18] * zij2 + 2.0 * (G[25] * zij) + G[32];
    case 540: return G[0];
    case 541: return G[0];
    case 542: return G[1];
    case 543: return G[0];
    case 544: return G[1];
    case 545: return G[2];
    case 546: return G[0];
    case 547: return G[1];
    case 548: return G[2];
    case 549: return G[3];
    case 550: return G[0];
    case 551: return G[1];
    case 552: return G[2];
    case 553: return G[3];
    case 554: return G[4];
    case 555: return G[0];
    case 556: return G[0];
    case 557: return G[1];
    case 558: return G[0];
    case 559: return G[1];
    case 560: return G[2];
    case 561: return G[0];
    case 562: return G[1];
    case 563: return G[2];
    case 564: return G[3];
    case 565: return G[0];
    case 566: return G[1];
    case 567: return G[2];
    case 568: return G[3];
    case 569: return G[4];
    case 570: return G[0] * zij + G[7];
    case 571: return G[0] * zij + G[7];
    case 572: return G[1] * zij + G[8];
    case 573: return G[0] * zij + G[7];
    case 574: return G[1] * zij + G[8];
    case 575: return G[2] * zij + G[9];
    case 576: return G[0] * zij + G[7];
    case 577: return G[1] * zij + G[8];
    case 578: return G[2] * zij + G[9];
    case 579: return G[3] * zij + G[10];
    case 580: return G[0] * zij + G[7];
    case 581: return G[1] * zij + G[8];
    case 582: return G[2] * zij + G[9];
    case 583: return G[3] * zij + G[10];
    case 584: return G[4] * zij + G[11];
    case 585: return G[0];
    case 586: return G[0];
    case 587: return G[1];
    case 588: return G[0];
    case 589: return G[1];
    case 590: return G[2];
    case 591: return G[0];
    case 592: return G[1];
    case 593: return G[2];
    case 594: return G[3];
    case 595: return G[0];
    case 596: return G[1];
    case 597: return G[2];
    case 598: return G[3];
    case 599: return G[4];
    case 600: return G[0] * zij + G[7];
    case 601: return G[0] * zij + G[7];
    case 602: return G[1] * zij + G[8];
    case 603: return G[0] * zij + G[7];
    case 604: return G[1] * zij + G[8];
    case 605: return G[2] * zij + G[9];
    case 606: return G[0] * zij + G[7];
    case 607: return G[1] * zij + G[8];
    case 608: return G[2] * zij + G[9];
    case 609: return G[3] * zij + G[10];
    case 610: return G[0] * zij + G[7];
    case 611: return G[1] * zij + G[8];
    case 612: return G[2] * zij + G[9];
    case 613: return G[3] * zij + G[10];
    case 614: return G[4] * zij + G[11];
    case 615: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 616: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 617: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 618: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 619: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 620: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 621: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 622: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 623: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 624: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 625: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 626: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 627: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 628: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 629: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 630: return G[7];
    case 631: return G[7];
    case 632: return G[8];
    case 633: return G[7];
    case 634: return G[8];
    case 635: return G[9];
    case 636: return G[7];
    case 637: return G[8];
    case 638: return G[9];
    case 639: return G[10];
    case 640: return G[7];
    case 641: return G[8];
    case 642: return G[9];
    case 643: return G[10];
    case 644: return G[11];
    case 645: return G[7];
    case 646: return G[7];
    case 647: return G[8];
    case 648: return G[7];
    case 649: return G[8];
    case 650: return G[9];
    case 651: return G[7];
    case 652: return G[8];
    case 653: return G[9];
    case 654: return G[10];
    case 655: return G[7];
    case 656: return G[8];
    case 657: return G[9];
    case 658: return G[10];
    case 659: return G[11];
    case 660: return G[7] * zij + G[14];
    case 661: return G[7] * zij + G[14];
    case 662: return G[8] * zij + G[15];
    case 663: return G[7] * zij + G[14];
    case 664: return G[8] * zij + G[15];
    case 665: return G[9] * zij + G[16];
    case 666: return G[7] * zij + G[14];
    case 667: return G[8] * zij + G[15];
    case 668: return G[9] * zij + G[16];
    case 669: return G[10] * zij + G[17];
    case 670: return G[7] * zij + G[14];
    case 671: return G[8] * zij + G[15];
    case 672: return G[9] * zij + G[16];
    case 673: return G[10] * zij + G[17];
    case 674: return G[11] * zij + G[18];
    case 675: return G[7];
    case 676: return G[7];
    case 677: return G[8];
    case 678: return G[7];
    case 679: return G[8];
    case 680: return G[9];
    case 681: return G[7];
    case 682: return G[8];
    case 683: return G[9];
    case 684: return G[10];
    case 685: return G[7];
    case 686: return G[8];
    case 687: return G[9];
    case 688: return G[10];
    case 689: return G[11];
    case 690: return G[7] * zij + G[14];
    case 691: return G[7] * zij + G[14];
    case 692: return G[8] * zij + G[15];
    case 693: return G[7] * zij + G[14];
    case 694: return G[8] * zij + G[15];
    case 695: return G[9] * zij + G[16];
    case 696: return G[7] * zij + G[14];
    case 697: return G[8] * zij + G[15];
    case 698: return G[9] * zij + G[16];
    case 699: return G[10] * zij + G[17];
    case 700: return G[7] * zij + G[14];
    case 701: return G[8] * zij + G[15];
    case 702: return G[9] * zij + G[16];
    case 703: return G[10] * zij + G[17];
    case 704: return G[11] * zij + G[18];
    case 705: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 706: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 707: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 708: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 709: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 710: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 711: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 712: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 713: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 714: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 715: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 716: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 717: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 718: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 719: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 720: return G[14];
    case 721: return G[14];
    case 722: return G[15];
    case 723: return G[14];
    case 724: return G[15];
    case 725: return G[16];
    case 726: return G[14];
    case 727: return G[15];
    case 728: return G[16];
    case 729: return G[17];
    case 730: return G[14];
    case 731: return G[15];
    case 732: return G[16];
    case 733: return G[17];
    case 734: return G[18];
    case 735: return G[14];
    case 736: return G[14];
    case 737: return G[15];
    case 738: return G[14];
    case 739: return G[15];
    case 740: return G[16];
    case 741: return G[14];
    case 742: return G[15];
    case 743: return G[16];
    case 744: return G[17];
    case 745: return G[14];
    case 746: return G[15];
    case 747: return G[16];
    case 748: return G[17];
    case 749: return G[18];
    case 750: return G[14] * zij + G[21];
    case 751: return G[14] * zij + G[21];
    case 752: return G[15] * zij + G[22];
    case 753: return G[14] * zij + G[21];
    case 754: return G[15] * zij + G[22];
    case 755: return G[16] * zij + G[23];
    case 756: return G[14] * zij + G[21];
    case 757: return G[15] * zij + G[22];
    case 758: return G[16] * zij + G[23];
    case 759: return G[17] * zij + G[24];
    case 760: return G[14] * zij + G[21];
    case 761: return G[15] * zij + G[22];
    case 762: return G[16] * zij + G[23];
    case 763: return G[17] * zij + G[24];
    case 764: return G[18] * zij + G[25];
    case 765: return G[14];
    case 766: return G[14];
    case 767: return G[15];
    case 768: return G[14];
    case 769: return G[15];
    case 770: return G[16];
    case 771: return G[14];
    case 772: return G[15];
    case 773: return G[16];
    case 774: return G[17];
    case 775: return G[14];
    case 776: return G[15];
    case 777: return G[16];
    case 778: return G[17];
    case 779: return G[18];
    case 780: return G[14] * zij + G[21];
    case 781: return G[14] * zij + G[21];
    case 782: return G[15] * zij + G[22];
    case 783: return G[14] * zij + G[21];
    case 784: return G[15] * zij + G[22];
    case 785: return G[16] * zij + G[23];
    case 786: return G[14] * zij + G[21];
    case 787: return G[15] * zij + G[22];
    case 788: return G[16] * zij + G[23];
    case 789: return G[17] * zij + G[24];
    case 790: return G[14] * zij + G[21];
    case 791: return G[15] * zij + G[22];
    case 792: return G[16] * zij + G[23];
    case 793: return G[17] * zij + G[24];
    case 794: return G[18] * zij + G[25];
    case 795: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 796: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 797: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 798: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 799: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 800: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 801: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 802: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 803: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 804: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 805: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 806: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 807: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 808: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 809: return G[18] * zij2 + 2.0 * (G[25] * zij) + G[32];
    case 810: return G[21];
    case 811: return G[21];
    case 812: return G[22];
    case 813: return G[21];
    case 814: return G[22];
    case 815: return G[23];
    case 816: return G[21];
    case 817: return G[22];
    case 818: return G[23];
    case 819: return G[24];
    case 820: return G[21];
    case 821: return G[22];
    case 822: return G[23];
    case 823: return G[24];
    case 824: return G[25];
    case 825: return G[21];
    case 826: return G[21];
    case 827: return G[22];
    case 828: return G[21];
    case 829: return G[22];
    case 830: return G[23];
    case 831: return G[21];
    case 832: return G[22];
    case 833: return G[23];
    case 834: return G[24];
    case 835: return G[21];
    case 836: return G[22];
    case 837: return G[23];
    case 838: return G[24];
    case 839: return G[25];
    case 840: return G[21] * zij + G[28];
    case 841: return G[21] * zij + G[28];
    case 842: return G[22] * zij + G[29];
    case 843: return G[21] * zij + G[28];
    case 844: return G[22] * zij + G[29];
    case 845: return G[23] * zij + G[30];
    case 846: return G[21] * zij + G[28];
    case 847: return G[22] * zij + G[29];
    case 848: return G[23] * zij + G[30];
    case 849: return G[24] * zij + G[31];
    case 850: return G[21] * zij + G[28];
    case 851: return G[22] * zij + G[29];
    case 852: return G[23] * zij + G[30];
    case 853: return G[24] * zij + G[31];
    case 854: return G[25] * zij + G[32];
    case 855: return G[21];
    case 856: return G[21];
    case 857: return G[22];
    case 858: return G[21];
    case 859: return G[22];
    case 860: return G[23];
    case 861: return G[21];
    case 862: return G[22];
    case 863: return G[23];
    case 864: return G[24];
    case 865: return G[21];
    case 866: return G[22];
    case 867: return G[23];
    case 868: return G[24];
    case 869: return G[25];
    case 870: return G[21] * zij + G[28];
    case 871: return G[21] * zij + G[28];
    case 872: return G[22] * zij + G[29];
    case 873: return G[21] * zij + G[28];
    case 874: return G[22] * zij + G[29];
    case 875: return G[23] * zij + G[30];
    case 876: return G[21] * zij + G[28];
    case 877: return G[22] * zij + G[29];
    case 878: return G[23] * zij + G[30];
    case 879: return G[24] * zij + G[31];
    case 880: return G[21] * zij + G[28];
    case 881: return G[22] * zij + G[29];
    case 882: return G[23] * zij + G[30];
    case 883: return G[24] * zij + G[31];
    case 884: return G[25] * zij + G[32];
    case 885: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 886: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 887: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 888: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 889: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 890: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 891: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 892: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 893: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 894: return G[24] * zij2 + 2.0 * (G[31] * zij) + G[38];
    case 895: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 896: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 897: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 898: return G[24] * zij2 + 2.0 * (G[31] * zij) + G[38];
    case 899: return G[25] * zij2 + 2.0 * (G[32] * zij) + G[39];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_fdgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 900;
  constexpr int kNMax = 5;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_fdgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_fdgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_fdgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

__device__ __forceinline__ double eval_ffgs_x(
    int e,
    const double* G,
    double xij,
    double xij2,
    double xkl,
    double xkl2) {
  switch (e) {
    case 0: return G[25] * pow(xij, 3) + 3.0 * (G[32] * xij2) + 3.0 * (G[39] * xij) + G[46];
    case 1: return G[24] * pow(xij, 3) + 3.0 * (G[31] * xij2) + 3.0 * (G[38] * xij) + G[45];
    case 2: return G[24] * pow(xij, 3) + 3.0 * (G[31] * xij2) + 3.0 * (G[38] * xij) + G[45];
    case 3: return G[23] * pow(xij, 3) + 3.0 * (G[30] * xij2) + 3.0 * (G[37] * xij) + G[44];
    case 4: return G[23] * pow(xij, 3) + 3.0 * (G[30] * xij2) + 3.0 * (G[37] * xij) + G[44];
    case 5: return G[23] * pow(xij, 3) + 3.0 * (G[30] * xij2) + 3.0 * (G[37] * xij) + G[44];
    case 6: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 7: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 8: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 9: return G[22] * pow(xij, 3) + 3.0 * (G[29] * xij2) + 3.0 * (G[36] * xij) + G[43];
    case 10: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 11: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 12: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 13: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 14: return G[21] * pow(xij, 3) + 3.0 * (G[28] * xij2) + 3.0 * (G[35] * xij) + G[42];
    case 15: return G[25] * xij2 + 2.0 * (G[32] * xij) + G[39];
    case 16: return G[24] * xij2 + 2.0 * (G[31] * xij) + G[38];
    case 17: return G[24] * xij2 + 2.0 * (G[31] * xij) + G[38];
    case 18: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 19: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 20: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 21: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 22: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 23: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 24: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 25: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 26: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 27: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 28: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 29: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 30: return G[25] * xij2 + 2.0 * (G[32] * xij) + G[39];
    case 31: return G[24] * xij2 + 2.0 * (G[31] * xij) + G[38];
    case 32: return G[24] * xij2 + 2.0 * (G[31] * xij) + G[38];
    case 33: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 34: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 35: return G[23] * xij2 + 2.0 * (G[30] * xij) + G[37];
    case 36: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 37: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 38: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 39: return G[22] * xij2 + 2.0 * (G[29] * xij) + G[36];
    case 40: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 41: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 42: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 43: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 44: return G[21] * xij2 + 2.0 * (G[28] * xij) + G[35];
    case 45: return G[25] * xij + G[32];
    case 46: return G[24] * xij + G[31];
    case 47: return G[24] * xij + G[31];
    case 48: return G[23] * xij + G[30];
    case 49: return G[23] * xij + G[30];
    case 50: return G[23] * xij + G[30];
    case 51: return G[22] * xij + G[29];
    case 52: return G[22] * xij + G[29];
    case 53: return G[22] * xij + G[29];
    case 54: return G[22] * xij + G[29];
    case 55: return G[21] * xij + G[28];
    case 56: return G[21] * xij + G[28];
    case 57: return G[21] * xij + G[28];
    case 58: return G[21] * xij + G[28];
    case 59: return G[21] * xij + G[28];
    case 60: return G[25] * xij + G[32];
    case 61: return G[24] * xij + G[31];
    case 62: return G[24] * xij + G[31];
    case 63: return G[23] * xij + G[30];
    case 64: return G[23] * xij + G[30];
    case 65: return G[23] * xij + G[30];
    case 66: return G[22] * xij + G[29];
    case 67: return G[22] * xij + G[29];
    case 68: return G[22] * xij + G[29];
    case 69: return G[22] * xij + G[29];
    case 70: return G[21] * xij + G[28];
    case 71: return G[21] * xij + G[28];
    case 72: return G[21] * xij + G[28];
    case 73: return G[21] * xij + G[28];
    case 74: return G[21] * xij + G[28];
    case 75: return G[25] * xij + G[32];
    case 76: return G[24] * xij + G[31];
    case 77: return G[24] * xij + G[31];
    case 78: return G[23] * xij + G[30];
    case 79: return G[23] * xij + G[30];
    case 80: return G[23] * xij + G[30];
    case 81: return G[22] * xij + G[29];
    case 82: return G[22] * xij + G[29];
    case 83: return G[22] * xij + G[29];
    case 84: return G[22] * xij + G[29];
    case 85: return G[21] * xij + G[28];
    case 86: return G[21] * xij + G[28];
    case 87: return G[21] * xij + G[28];
    case 88: return G[21] * xij + G[28];
    case 89: return G[21] * xij + G[28];
    case 90: return G[25];
    case 91: return G[24];
    case 92: return G[24];
    case 93: return G[23];
    case 94: return G[23];
    case 95: return G[23];
    case 96: return G[22];
    case 97: return G[22];
    case 98: return G[22];
    case 99: return G[22];
    case 100: return G[21];
    case 101: return G[21];
    case 102: return G[21];
    case 103: return G[21];
    case 104: return G[21];
    case 105: return G[25];
    case 106: return G[24];
    case 107: return G[24];
    case 108: return G[23];
    case 109: return G[23];
    case 110: return G[23];
    case 111: return G[22];
    case 112: return G[22];
    case 113: return G[22];
    case 114: return G[22];
    case 115: return G[21];
    case 116: return G[21];
    case 117: return G[21];
    case 118: return G[21];
    case 119: return G[21];
    case 120: return G[25];
    case 121: return G[24];
    case 122: return G[24];
    case 123: return G[23];
    case 124: return G[23];
    case 125: return G[23];
    case 126: return G[22];
    case 127: return G[22];
    case 128: return G[22];
    case 129: return G[22];
    case 130: return G[21];
    case 131: return G[21];
    case 132: return G[21];
    case 133: return G[21];
    case 134: return G[21];
    case 135: return G[25];
    case 136: return G[24];
    case 137: return G[24];
    case 138: return G[23];
    case 139: return G[23];
    case 140: return G[23];
    case 141: return G[22];
    case 142: return G[22];
    case 143: return G[22];
    case 144: return G[22];
    case 145: return G[21];
    case 146: return G[21];
    case 147: return G[21];
    case 148: return G[21];
    case 149: return G[21];
    case 150: return G[18] * pow(xij, 3) + 3.0 * (G[25] * xij2) + 3.0 * (G[32] * xij) + G[39];
    case 151: return G[17] * pow(xij, 3) + 3.0 * (G[24] * xij2) + 3.0 * (G[31] * xij) + G[38];
    case 152: return G[17] * pow(xij, 3) + 3.0 * (G[24] * xij2) + 3.0 * (G[31] * xij) + G[38];
    case 153: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 154: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 155: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 156: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 157: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 158: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 159: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 160: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 161: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 162: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 163: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 164: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 165: return G[18] * xij2 + 2.0 * (G[25] * xij) + G[32];
    case 166: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 167: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 168: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 169: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 170: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 171: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 172: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 173: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 174: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 175: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 176: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 177: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 178: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 179: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 180: return G[18] * xij2 + 2.0 * (G[25] * xij) + G[32];
    case 181: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 182: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 183: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 184: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 185: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 186: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 187: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 188: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 189: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 190: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 191: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 192: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 193: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 194: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 195: return G[18] * xij + G[25];
    case 196: return G[17] * xij + G[24];
    case 197: return G[17] * xij + G[24];
    case 198: return G[16] * xij + G[23];
    case 199: return G[16] * xij + G[23];
    case 200: return G[16] * xij + G[23];
    case 201: return G[15] * xij + G[22];
    case 202: return G[15] * xij + G[22];
    case 203: return G[15] * xij + G[22];
    case 204: return G[15] * xij + G[22];
    case 205: return G[14] * xij + G[21];
    case 206: return G[14] * xij + G[21];
    case 207: return G[14] * xij + G[21];
    case 208: return G[14] * xij + G[21];
    case 209: return G[14] * xij + G[21];
    case 210: return G[18] * xij + G[25];
    case 211: return G[17] * xij + G[24];
    case 212: return G[17] * xij + G[24];
    case 213: return G[16] * xij + G[23];
    case 214: return G[16] * xij + G[23];
    case 215: return G[16] * xij + G[23];
    case 216: return G[15] * xij + G[22];
    case 217: return G[15] * xij + G[22];
    case 218: return G[15] * xij + G[22];
    case 219: return G[15] * xij + G[22];
    case 220: return G[14] * xij + G[21];
    case 221: return G[14] * xij + G[21];
    case 222: return G[14] * xij + G[21];
    case 223: return G[14] * xij + G[21];
    case 224: return G[14] * xij + G[21];
    case 225: return G[18] * xij + G[25];
    case 226: return G[17] * xij + G[24];
    case 227: return G[17] * xij + G[24];
    case 228: return G[16] * xij + G[23];
    case 229: return G[16] * xij + G[23];
    case 230: return G[16] * xij + G[23];
    case 231: return G[15] * xij + G[22];
    case 232: return G[15] * xij + G[22];
    case 233: return G[15] * xij + G[22];
    case 234: return G[15] * xij + G[22];
    case 235: return G[14] * xij + G[21];
    case 236: return G[14] * xij + G[21];
    case 237: return G[14] * xij + G[21];
    case 238: return G[14] * xij + G[21];
    case 239: return G[14] * xij + G[21];
    case 240: return G[18];
    case 241: return G[17];
    case 242: return G[17];
    case 243: return G[16];
    case 244: return G[16];
    case 245: return G[16];
    case 246: return G[15];
    case 247: return G[15];
    case 248: return G[15];
    case 249: return G[15];
    case 250: return G[14];
    case 251: return G[14];
    case 252: return G[14];
    case 253: return G[14];
    case 254: return G[14];
    case 255: return G[18];
    case 256: return G[17];
    case 257: return G[17];
    case 258: return G[16];
    case 259: return G[16];
    case 260: return G[16];
    case 261: return G[15];
    case 262: return G[15];
    case 263: return G[15];
    case 264: return G[15];
    case 265: return G[14];
    case 266: return G[14];
    case 267: return G[14];
    case 268: return G[14];
    case 269: return G[14];
    case 270: return G[18];
    case 271: return G[17];
    case 272: return G[17];
    case 273: return G[16];
    case 274: return G[16];
    case 275: return G[16];
    case 276: return G[15];
    case 277: return G[15];
    case 278: return G[15];
    case 279: return G[15];
    case 280: return G[14];
    case 281: return G[14];
    case 282: return G[14];
    case 283: return G[14];
    case 284: return G[14];
    case 285: return G[18];
    case 286: return G[17];
    case 287: return G[17];
    case 288: return G[16];
    case 289: return G[16];
    case 290: return G[16];
    case 291: return G[15];
    case 292: return G[15];
    case 293: return G[15];
    case 294: return G[15];
    case 295: return G[14];
    case 296: return G[14];
    case 297: return G[14];
    case 298: return G[14];
    case 299: return G[14];
    case 300: return G[18] * pow(xij, 3) + 3.0 * (G[25] * xij2) + 3.0 * (G[32] * xij) + G[39];
    case 301: return G[17] * pow(xij, 3) + 3.0 * (G[24] * xij2) + 3.0 * (G[31] * xij) + G[38];
    case 302: return G[17] * pow(xij, 3) + 3.0 * (G[24] * xij2) + 3.0 * (G[31] * xij) + G[38];
    case 303: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 304: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 305: return G[16] * pow(xij, 3) + 3.0 * (G[23] * xij2) + 3.0 * (G[30] * xij) + G[37];
    case 306: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 307: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 308: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 309: return G[15] * pow(xij, 3) + 3.0 * (G[22] * xij2) + 3.0 * (G[29] * xij) + G[36];
    case 310: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 311: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 312: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 313: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 314: return G[14] * pow(xij, 3) + 3.0 * (G[21] * xij2) + 3.0 * (G[28] * xij) + G[35];
    case 315: return G[18] * xij2 + 2.0 * (G[25] * xij) + G[32];
    case 316: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 317: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 318: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 319: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 320: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 321: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 322: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 323: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 324: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 325: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 326: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 327: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 328: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 329: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 330: return G[18] * xij2 + 2.0 * (G[25] * xij) + G[32];
    case 331: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 332: return G[17] * xij2 + 2.0 * (G[24] * xij) + G[31];
    case 333: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 334: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 335: return G[16] * xij2 + 2.0 * (G[23] * xij) + G[30];
    case 336: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 337: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 338: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 339: return G[15] * xij2 + 2.0 * (G[22] * xij) + G[29];
    case 340: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 341: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 342: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 343: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 344: return G[14] * xij2 + 2.0 * (G[21] * xij) + G[28];
    case 345: return G[18] * xij + G[25];
    case 346: return G[17] * xij + G[24];
    case 347: return G[17] * xij + G[24];
    case 348: return G[16] * xij + G[23];
    case 349: return G[16] * xij + G[23];
    case 350: return G[16] * xij + G[23];
    case 351: return G[15] * xij + G[22];
    case 352: return G[15] * xij + G[22];
    case 353: return G[15] * xij + G[22];
    case 354: return G[15] * xij + G[22];
    case 355: return G[14] * xij + G[21];
    case 356: return G[14] * xij + G[21];
    case 357: return G[14] * xij + G[21];
    case 358: return G[14] * xij + G[21];
    case 359: return G[14] * xij + G[21];
    case 360: return G[18] * xij + G[25];
    case 361: return G[17] * xij + G[24];
    case 362: return G[17] * xij + G[24];
    case 363: return G[16] * xij + G[23];
    case 364: return G[16] * xij + G[23];
    case 365: return G[16] * xij + G[23];
    case 366: return G[15] * xij + G[22];
    case 367: return G[15] * xij + G[22];
    case 368: return G[15] * xij + G[22];
    case 369: return G[15] * xij + G[22];
    case 370: return G[14] * xij + G[21];
    case 371: return G[14] * xij + G[21];
    case 372: return G[14] * xij + G[21];
    case 373: return G[14] * xij + G[21];
    case 374: return G[14] * xij + G[21];
    case 375: return G[18] * xij + G[25];
    case 376: return G[17] * xij + G[24];
    case 377: return G[17] * xij + G[24];
    case 378: return G[16] * xij + G[23];
    case 379: return G[16] * xij + G[23];
    case 380: return G[16] * xij + G[23];
    case 381: return G[15] * xij + G[22];
    case 382: return G[15] * xij + G[22];
    case 383: return G[15] * xij + G[22];
    case 384: return G[15] * xij + G[22];
    case 385: return G[14] * xij + G[21];
    case 386: return G[14] * xij + G[21];
    case 387: return G[14] * xij + G[21];
    case 388: return G[14] * xij + G[21];
    case 389: return G[14] * xij + G[21];
    case 390: return G[18];
    case 391: return G[17];
    case 392: return G[17];
    case 393: return G[16];
    case 394: return G[16];
    case 395: return G[16];
    case 396: return G[15];
    case 397: return G[15];
    case 398: return G[15];
    case 399: return G[15];
    case 400: return G[14];
    case 401: return G[14];
    case 402: return G[14];
    case 403: return G[14];
    case 404: return G[14];
    case 405: return G[18];
    case 406: return G[17];
    case 407: return G[17];
    case 408: return G[16];
    case 409: return G[16];
    case 410: return G[16];
    case 411: return G[15];
    case 412: return G[15];
    case 413: return G[15];
    case 414: return G[15];
    case 415: return G[14];
    case 416: return G[14];
    case 417: return G[14];
    case 418: return G[14];
    case 419: return G[14];
    case 420: return G[18];
    case 421: return G[17];
    case 422: return G[17];
    case 423: return G[16];
    case 424: return G[16];
    case 425: return G[16];
    case 426: return G[15];
    case 427: return G[15];
    case 428: return G[15];
    case 429: return G[15];
    case 430: return G[14];
    case 431: return G[14];
    case 432: return G[14];
    case 433: return G[14];
    case 434: return G[14];
    case 435: return G[18];
    case 436: return G[17];
    case 437: return G[17];
    case 438: return G[16];
    case 439: return G[16];
    case 440: return G[16];
    case 441: return G[15];
    case 442: return G[15];
    case 443: return G[15];
    case 444: return G[15];
    case 445: return G[14];
    case 446: return G[14];
    case 447: return G[14];
    case 448: return G[14];
    case 449: return G[14];
    case 450: return G[11] * pow(xij, 3) + 3.0 * (G[18] * xij2) + 3.0 * (G[25] * xij) + G[32];
    case 451: return G[10] * pow(xij, 3) + 3.0 * (G[17] * xij2) + 3.0 * (G[24] * xij) + G[31];
    case 452: return G[10] * pow(xij, 3) + 3.0 * (G[17] * xij2) + 3.0 * (G[24] * xij) + G[31];
    case 453: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 454: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 455: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 456: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 457: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 458: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 459: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 460: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 461: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 462: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 463: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 464: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 465: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 466: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 467: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 468: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 469: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 470: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 471: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 472: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 473: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 474: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 475: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 476: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 477: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 478: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 479: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 480: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 481: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 482: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 483: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 484: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 485: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 486: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 487: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 488: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 489: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 490: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 491: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 492: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 493: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 494: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 495: return G[11] * xij + G[18];
    case 496: return G[10] * xij + G[17];
    case 497: return G[10] * xij + G[17];
    case 498: return G[9] * xij + G[16];
    case 499: return G[9] * xij + G[16];
    case 500: return G[9] * xij + G[16];
    case 501: return G[8] * xij + G[15];
    case 502: return G[8] * xij + G[15];
    case 503: return G[8] * xij + G[15];
    case 504: return G[8] * xij + G[15];
    case 505: return G[7] * xij + G[14];
    case 506: return G[7] * xij + G[14];
    case 507: return G[7] * xij + G[14];
    case 508: return G[7] * xij + G[14];
    case 509: return G[7] * xij + G[14];
    case 510: return G[11] * xij + G[18];
    case 511: return G[10] * xij + G[17];
    case 512: return G[10] * xij + G[17];
    case 513: return G[9] * xij + G[16];
    case 514: return G[9] * xij + G[16];
    case 515: return G[9] * xij + G[16];
    case 516: return G[8] * xij + G[15];
    case 517: return G[8] * xij + G[15];
    case 518: return G[8] * xij + G[15];
    case 519: return G[8] * xij + G[15];
    case 520: return G[7] * xij + G[14];
    case 521: return G[7] * xij + G[14];
    case 522: return G[7] * xij + G[14];
    case 523: return G[7] * xij + G[14];
    case 524: return G[7] * xij + G[14];
    case 525: return G[11] * xij + G[18];
    case 526: return G[10] * xij + G[17];
    case 527: return G[10] * xij + G[17];
    case 528: return G[9] * xij + G[16];
    case 529: return G[9] * xij + G[16];
    case 530: return G[9] * xij + G[16];
    case 531: return G[8] * xij + G[15];
    case 532: return G[8] * xij + G[15];
    case 533: return G[8] * xij + G[15];
    case 534: return G[8] * xij + G[15];
    case 535: return G[7] * xij + G[14];
    case 536: return G[7] * xij + G[14];
    case 537: return G[7] * xij + G[14];
    case 538: return G[7] * xij + G[14];
    case 539: return G[7] * xij + G[14];
    case 540: return G[11];
    case 541: return G[10];
    case 542: return G[10];
    case 543: return G[9];
    case 544: return G[9];
    case 545: return G[9];
    case 546: return G[8];
    case 547: return G[8];
    case 548: return G[8];
    case 549: return G[8];
    case 550: return G[7];
    case 551: return G[7];
    case 552: return G[7];
    case 553: return G[7];
    case 554: return G[7];
    case 555: return G[11];
    case 556: return G[10];
    case 557: return G[10];
    case 558: return G[9];
    case 559: return G[9];
    case 560: return G[9];
    case 561: return G[8];
    case 562: return G[8];
    case 563: return G[8];
    case 564: return G[8];
    case 565: return G[7];
    case 566: return G[7];
    case 567: return G[7];
    case 568: return G[7];
    case 569: return G[7];
    case 570: return G[11];
    case 571: return G[10];
    case 572: return G[10];
    case 573: return G[9];
    case 574: return G[9];
    case 575: return G[9];
    case 576: return G[8];
    case 577: return G[8];
    case 578: return G[8];
    case 579: return G[8];
    case 580: return G[7];
    case 581: return G[7];
    case 582: return G[7];
    case 583: return G[7];
    case 584: return G[7];
    case 585: return G[11];
    case 586: return G[10];
    case 587: return G[10];
    case 588: return G[9];
    case 589: return G[9];
    case 590: return G[9];
    case 591: return G[8];
    case 592: return G[8];
    case 593: return G[8];
    case 594: return G[8];
    case 595: return G[7];
    case 596: return G[7];
    case 597: return G[7];
    case 598: return G[7];
    case 599: return G[7];
    case 600: return G[11] * pow(xij, 3) + 3.0 * (G[18] * xij2) + 3.0 * (G[25] * xij) + G[32];
    case 601: return G[10] * pow(xij, 3) + 3.0 * (G[17] * xij2) + 3.0 * (G[24] * xij) + G[31];
    case 602: return G[10] * pow(xij, 3) + 3.0 * (G[17] * xij2) + 3.0 * (G[24] * xij) + G[31];
    case 603: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 604: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 605: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 606: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 607: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 608: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 609: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 610: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 611: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 612: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 613: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 614: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 615: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 616: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 617: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 618: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 619: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 620: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 621: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 622: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 623: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 624: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 625: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 626: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 627: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 628: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 629: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 630: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 631: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 632: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 633: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 634: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 635: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 636: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 637: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 638: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 639: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 640: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 641: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 642: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 643: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 644: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 645: return G[11] * xij + G[18];
    case 646: return G[10] * xij + G[17];
    case 647: return G[10] * xij + G[17];
    case 648: return G[9] * xij + G[16];
    case 649: return G[9] * xij + G[16];
    case 650: return G[9] * xij + G[16];
    case 651: return G[8] * xij + G[15];
    case 652: return G[8] * xij + G[15];
    case 653: return G[8] * xij + G[15];
    case 654: return G[8] * xij + G[15];
    case 655: return G[7] * xij + G[14];
    case 656: return G[7] * xij + G[14];
    case 657: return G[7] * xij + G[14];
    case 658: return G[7] * xij + G[14];
    case 659: return G[7] * xij + G[14];
    case 660: return G[11] * xij + G[18];
    case 661: return G[10] * xij + G[17];
    case 662: return G[10] * xij + G[17];
    case 663: return G[9] * xij + G[16];
    case 664: return G[9] * xij + G[16];
    case 665: return G[9] * xij + G[16];
    case 666: return G[8] * xij + G[15];
    case 667: return G[8] * xij + G[15];
    case 668: return G[8] * xij + G[15];
    case 669: return G[8] * xij + G[15];
    case 670: return G[7] * xij + G[14];
    case 671: return G[7] * xij + G[14];
    case 672: return G[7] * xij + G[14];
    case 673: return G[7] * xij + G[14];
    case 674: return G[7] * xij + G[14];
    case 675: return G[11] * xij + G[18];
    case 676: return G[10] * xij + G[17];
    case 677: return G[10] * xij + G[17];
    case 678: return G[9] * xij + G[16];
    case 679: return G[9] * xij + G[16];
    case 680: return G[9] * xij + G[16];
    case 681: return G[8] * xij + G[15];
    case 682: return G[8] * xij + G[15];
    case 683: return G[8] * xij + G[15];
    case 684: return G[8] * xij + G[15];
    case 685: return G[7] * xij + G[14];
    case 686: return G[7] * xij + G[14];
    case 687: return G[7] * xij + G[14];
    case 688: return G[7] * xij + G[14];
    case 689: return G[7] * xij + G[14];
    case 690: return G[11];
    case 691: return G[10];
    case 692: return G[10];
    case 693: return G[9];
    case 694: return G[9];
    case 695: return G[9];
    case 696: return G[8];
    case 697: return G[8];
    case 698: return G[8];
    case 699: return G[8];
    case 700: return G[7];
    case 701: return G[7];
    case 702: return G[7];
    case 703: return G[7];
    case 704: return G[7];
    case 705: return G[11];
    case 706: return G[10];
    case 707: return G[10];
    case 708: return G[9];
    case 709: return G[9];
    case 710: return G[9];
    case 711: return G[8];
    case 712: return G[8];
    case 713: return G[8];
    case 714: return G[8];
    case 715: return G[7];
    case 716: return G[7];
    case 717: return G[7];
    case 718: return G[7];
    case 719: return G[7];
    case 720: return G[11];
    case 721: return G[10];
    case 722: return G[10];
    case 723: return G[9];
    case 724: return G[9];
    case 725: return G[9];
    case 726: return G[8];
    case 727: return G[8];
    case 728: return G[8];
    case 729: return G[8];
    case 730: return G[7];
    case 731: return G[7];
    case 732: return G[7];
    case 733: return G[7];
    case 734: return G[7];
    case 735: return G[11];
    case 736: return G[10];
    case 737: return G[10];
    case 738: return G[9];
    case 739: return G[9];
    case 740: return G[9];
    case 741: return G[8];
    case 742: return G[8];
    case 743: return G[8];
    case 744: return G[8];
    case 745: return G[7];
    case 746: return G[7];
    case 747: return G[7];
    case 748: return G[7];
    case 749: return G[7];
    case 750: return G[11] * pow(xij, 3) + 3.0 * (G[18] * xij2) + 3.0 * (G[25] * xij) + G[32];
    case 751: return G[10] * pow(xij, 3) + 3.0 * (G[17] * xij2) + 3.0 * (G[24] * xij) + G[31];
    case 752: return G[10] * pow(xij, 3) + 3.0 * (G[17] * xij2) + 3.0 * (G[24] * xij) + G[31];
    case 753: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 754: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 755: return G[9] * pow(xij, 3) + 3.0 * (G[16] * xij2) + 3.0 * (G[23] * xij) + G[30];
    case 756: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 757: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 758: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 759: return G[8] * pow(xij, 3) + 3.0 * (G[15] * xij2) + 3.0 * (G[22] * xij) + G[29];
    case 760: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 761: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 762: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 763: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 764: return G[7] * pow(xij, 3) + 3.0 * (G[14] * xij2) + 3.0 * (G[21] * xij) + G[28];
    case 765: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 766: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 767: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 768: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 769: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 770: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 771: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 772: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 773: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 774: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 775: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 776: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 777: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 778: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 779: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 780: return G[11] * xij2 + 2.0 * (G[18] * xij) + G[25];
    case 781: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 782: return G[10] * xij2 + 2.0 * (G[17] * xij) + G[24];
    case 783: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 784: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 785: return G[9] * xij2 + 2.0 * (G[16] * xij) + G[23];
    case 786: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 787: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 788: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 789: return G[8] * xij2 + 2.0 * (G[15] * xij) + G[22];
    case 790: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 791: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 792: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 793: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 794: return G[7] * xij2 + 2.0 * (G[14] * xij) + G[21];
    case 795: return G[11] * xij + G[18];
    case 796: return G[10] * xij + G[17];
    case 797: return G[10] * xij + G[17];
    case 798: return G[9] * xij + G[16];
    case 799: return G[9] * xij + G[16];
    case 800: return G[9] * xij + G[16];
    case 801: return G[8] * xij + G[15];
    case 802: return G[8] * xij + G[15];
    case 803: return G[8] * xij + G[15];
    case 804: return G[8] * xij + G[15];
    case 805: return G[7] * xij + G[14];
    case 806: return G[7] * xij + G[14];
    case 807: return G[7] * xij + G[14];
    case 808: return G[7] * xij + G[14];
    case 809: return G[7] * xij + G[14];
    case 810: return G[11] * xij + G[18];
    case 811: return G[10] * xij + G[17];
    case 812: return G[10] * xij + G[17];
    case 813: return G[9] * xij + G[16];
    case 814: return G[9] * xij + G[16];
    case 815: return G[9] * xij + G[16];
    case 816: return G[8] * xij + G[15];
    case 817: return G[8] * xij + G[15];
    case 818: return G[8] * xij + G[15];
    case 819: return G[8] * xij + G[15];
    case 820: return G[7] * xij + G[14];
    case 821: return G[7] * xij + G[14];
    case 822: return G[7] * xij + G[14];
    case 823: return G[7] * xij + G[14];
    case 824: return G[7] * xij + G[14];
    case 825: return G[11] * xij + G[18];
    case 826: return G[10] * xij + G[17];
    case 827: return G[10] * xij + G[17];
    case 828: return G[9] * xij + G[16];
    case 829: return G[9] * xij + G[16];
    case 830: return G[9] * xij + G[16];
    case 831: return G[8] * xij + G[15];
    case 832: return G[8] * xij + G[15];
    case 833: return G[8] * xij + G[15];
    case 834: return G[8] * xij + G[15];
    case 835: return G[7] * xij + G[14];
    case 836: return G[7] * xij + G[14];
    case 837: return G[7] * xij + G[14];
    case 838: return G[7] * xij + G[14];
    case 839: return G[7] * xij + G[14];
    case 840: return G[11];
    case 841: return G[10];
    case 842: return G[10];
    case 843: return G[9];
    case 844: return G[9];
    case 845: return G[9];
    case 846: return G[8];
    case 847: return G[8];
    case 848: return G[8];
    case 849: return G[8];
    case 850: return G[7];
    case 851: return G[7];
    case 852: return G[7];
    case 853: return G[7];
    case 854: return G[7];
    case 855: return G[11];
    case 856: return G[10];
    case 857: return G[10];
    case 858: return G[9];
    case 859: return G[9];
    case 860: return G[9];
    case 861: return G[8];
    case 862: return G[8];
    case 863: return G[8];
    case 864: return G[8];
    case 865: return G[7];
    case 866: return G[7];
    case 867: return G[7];
    case 868: return G[7];
    case 869: return G[7];
    case 870: return G[11];
    case 871: return G[10];
    case 872: return G[10];
    case 873: return G[9];
    case 874: return G[9];
    case 875: return G[9];
    case 876: return G[8];
    case 877: return G[8];
    case 878: return G[8];
    case 879: return G[8];
    case 880: return G[7];
    case 881: return G[7];
    case 882: return G[7];
    case 883: return G[7];
    case 884: return G[7];
    case 885: return G[11];
    case 886: return G[10];
    case 887: return G[10];
    case 888: return G[9];
    case 889: return G[9];
    case 890: return G[9];
    case 891: return G[8];
    case 892: return G[8];
    case 893: return G[8];
    case 894: return G[8];
    case 895: return G[7];
    case 896: return G[7];
    case 897: return G[7];
    case 898: return G[7];
    case 899: return G[7];
    case 900: return G[4] * pow(xij, 3) + 3.0 * (G[11] * xij2) + 3.0 * (G[18] * xij) + G[25];
    case 901: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 902: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 903: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 904: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 905: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 906: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 907: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 908: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 909: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 910: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 911: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 912: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 913: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 914: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 915: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 916: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 917: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 918: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 919: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 920: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 921: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 922: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 923: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 924: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 925: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 926: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 927: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 928: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 929: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 930: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 931: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 932: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 933: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 934: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 935: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 936: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 937: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 938: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 939: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 940: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 941: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 942: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 943: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 944: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 945: return G[4] * xij + G[11];
    case 946: return G[3] * xij + G[10];
    case 947: return G[3] * xij + G[10];
    case 948: return G[2] * xij + G[9];
    case 949: return G[2] * xij + G[9];
    case 950: return G[2] * xij + G[9];
    case 951: return G[1] * xij + G[8];
    case 952: return G[1] * xij + G[8];
    case 953: return G[1] * xij + G[8];
    case 954: return G[1] * xij + G[8];
    case 955: return G[0] * xij + G[7];
    case 956: return G[0] * xij + G[7];
    case 957: return G[0] * xij + G[7];
    case 958: return G[0] * xij + G[7];
    case 959: return G[0] * xij + G[7];
    case 960: return G[4] * xij + G[11];
    case 961: return G[3] * xij + G[10];
    case 962: return G[3] * xij + G[10];
    case 963: return G[2] * xij + G[9];
    case 964: return G[2] * xij + G[9];
    case 965: return G[2] * xij + G[9];
    case 966: return G[1] * xij + G[8];
    case 967: return G[1] * xij + G[8];
    case 968: return G[1] * xij + G[8];
    case 969: return G[1] * xij + G[8];
    case 970: return G[0] * xij + G[7];
    case 971: return G[0] * xij + G[7];
    case 972: return G[0] * xij + G[7];
    case 973: return G[0] * xij + G[7];
    case 974: return G[0] * xij + G[7];
    case 975: return G[4] * xij + G[11];
    case 976: return G[3] * xij + G[10];
    case 977: return G[3] * xij + G[10];
    case 978: return G[2] * xij + G[9];
    case 979: return G[2] * xij + G[9];
    case 980: return G[2] * xij + G[9];
    case 981: return G[1] * xij + G[8];
    case 982: return G[1] * xij + G[8];
    case 983: return G[1] * xij + G[8];
    case 984: return G[1] * xij + G[8];
    case 985: return G[0] * xij + G[7];
    case 986: return G[0] * xij + G[7];
    case 987: return G[0] * xij + G[7];
    case 988: return G[0] * xij + G[7];
    case 989: return G[0] * xij + G[7];
    case 990: return G[4];
    case 991: return G[3];
    case 992: return G[3];
    case 993: return G[2];
    case 994: return G[2];
    case 995: return G[2];
    case 996: return G[1];
    case 997: return G[1];
    case 998: return G[1];
    case 999: return G[1];
    case 1000: return G[0];
    case 1001: return G[0];
    case 1002: return G[0];
    case 1003: return G[0];
    case 1004: return G[0];
    case 1005: return G[4];
    case 1006: return G[3];
    case 1007: return G[3];
    case 1008: return G[2];
    case 1009: return G[2];
    case 1010: return G[2];
    case 1011: return G[1];
    case 1012: return G[1];
    case 1013: return G[1];
    case 1014: return G[1];
    case 1015: return G[0];
    case 1016: return G[0];
    case 1017: return G[0];
    case 1018: return G[0];
    case 1019: return G[0];
    case 1020: return G[4];
    case 1021: return G[3];
    case 1022: return G[3];
    case 1023: return G[2];
    case 1024: return G[2];
    case 1025: return G[2];
    case 1026: return G[1];
    case 1027: return G[1];
    case 1028: return G[1];
    case 1029: return G[1];
    case 1030: return G[0];
    case 1031: return G[0];
    case 1032: return G[0];
    case 1033: return G[0];
    case 1034: return G[0];
    case 1035: return G[4];
    case 1036: return G[3];
    case 1037: return G[3];
    case 1038: return G[2];
    case 1039: return G[2];
    case 1040: return G[2];
    case 1041: return G[1];
    case 1042: return G[1];
    case 1043: return G[1];
    case 1044: return G[1];
    case 1045: return G[0];
    case 1046: return G[0];
    case 1047: return G[0];
    case 1048: return G[0];
    case 1049: return G[0];
    case 1050: return G[4] * pow(xij, 3) + 3.0 * (G[11] * xij2) + 3.0 * (G[18] * xij) + G[25];
    case 1051: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 1052: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 1053: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 1054: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 1055: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 1056: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1057: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1058: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1059: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1060: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1061: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1062: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1063: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1064: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1065: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 1066: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1067: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1068: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1069: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1070: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1071: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1072: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1073: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1074: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1075: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1076: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1077: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1078: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1079: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1080: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 1081: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1082: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1083: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1084: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1085: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1086: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1087: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1088: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1089: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1090: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1091: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1092: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1093: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1094: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1095: return G[4] * xij + G[11];
    case 1096: return G[3] * xij + G[10];
    case 1097: return G[3] * xij + G[10];
    case 1098: return G[2] * xij + G[9];
    case 1099: return G[2] * xij + G[9];
    case 1100: return G[2] * xij + G[9];
    case 1101: return G[1] * xij + G[8];
    case 1102: return G[1] * xij + G[8];
    case 1103: return G[1] * xij + G[8];
    case 1104: return G[1] * xij + G[8];
    case 1105: return G[0] * xij + G[7];
    case 1106: return G[0] * xij + G[7];
    case 1107: return G[0] * xij + G[7];
    case 1108: return G[0] * xij + G[7];
    case 1109: return G[0] * xij + G[7];
    case 1110: return G[4] * xij + G[11];
    case 1111: return G[3] * xij + G[10];
    case 1112: return G[3] * xij + G[10];
    case 1113: return G[2] * xij + G[9];
    case 1114: return G[2] * xij + G[9];
    case 1115: return G[2] * xij + G[9];
    case 1116: return G[1] * xij + G[8];
    case 1117: return G[1] * xij + G[8];
    case 1118: return G[1] * xij + G[8];
    case 1119: return G[1] * xij + G[8];
    case 1120: return G[0] * xij + G[7];
    case 1121: return G[0] * xij + G[7];
    case 1122: return G[0] * xij + G[7];
    case 1123: return G[0] * xij + G[7];
    case 1124: return G[0] * xij + G[7];
    case 1125: return G[4] * xij + G[11];
    case 1126: return G[3] * xij + G[10];
    case 1127: return G[3] * xij + G[10];
    case 1128: return G[2] * xij + G[9];
    case 1129: return G[2] * xij + G[9];
    case 1130: return G[2] * xij + G[9];
    case 1131: return G[1] * xij + G[8];
    case 1132: return G[1] * xij + G[8];
    case 1133: return G[1] * xij + G[8];
    case 1134: return G[1] * xij + G[8];
    case 1135: return G[0] * xij + G[7];
    case 1136: return G[0] * xij + G[7];
    case 1137: return G[0] * xij + G[7];
    case 1138: return G[0] * xij + G[7];
    case 1139: return G[0] * xij + G[7];
    case 1140: return G[4];
    case 1141: return G[3];
    case 1142: return G[3];
    case 1143: return G[2];
    case 1144: return G[2];
    case 1145: return G[2];
    case 1146: return G[1];
    case 1147: return G[1];
    case 1148: return G[1];
    case 1149: return G[1];
    case 1150: return G[0];
    case 1151: return G[0];
    case 1152: return G[0];
    case 1153: return G[0];
    case 1154: return G[0];
    case 1155: return G[4];
    case 1156: return G[3];
    case 1157: return G[3];
    case 1158: return G[2];
    case 1159: return G[2];
    case 1160: return G[2];
    case 1161: return G[1];
    case 1162: return G[1];
    case 1163: return G[1];
    case 1164: return G[1];
    case 1165: return G[0];
    case 1166: return G[0];
    case 1167: return G[0];
    case 1168: return G[0];
    case 1169: return G[0];
    case 1170: return G[4];
    case 1171: return G[3];
    case 1172: return G[3];
    case 1173: return G[2];
    case 1174: return G[2];
    case 1175: return G[2];
    case 1176: return G[1];
    case 1177: return G[1];
    case 1178: return G[1];
    case 1179: return G[1];
    case 1180: return G[0];
    case 1181: return G[0];
    case 1182: return G[0];
    case 1183: return G[0];
    case 1184: return G[0];
    case 1185: return G[4];
    case 1186: return G[3];
    case 1187: return G[3];
    case 1188: return G[2];
    case 1189: return G[2];
    case 1190: return G[2];
    case 1191: return G[1];
    case 1192: return G[1];
    case 1193: return G[1];
    case 1194: return G[1];
    case 1195: return G[0];
    case 1196: return G[0];
    case 1197: return G[0];
    case 1198: return G[0];
    case 1199: return G[0];
    case 1200: return G[4] * pow(xij, 3) + 3.0 * (G[11] * xij2) + 3.0 * (G[18] * xij) + G[25];
    case 1201: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 1202: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 1203: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 1204: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 1205: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 1206: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1207: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1208: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1209: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1210: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1211: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1212: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1213: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1214: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1215: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 1216: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1217: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1218: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1219: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1220: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1221: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1222: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1223: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1224: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1225: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1226: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1227: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1228: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1229: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1230: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 1231: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1232: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1233: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1234: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1235: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1236: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1237: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1238: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1239: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1240: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1241: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1242: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1243: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1244: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1245: return G[4] * xij + G[11];
    case 1246: return G[3] * xij + G[10];
    case 1247: return G[3] * xij + G[10];
    case 1248: return G[2] * xij + G[9];
    case 1249: return G[2] * xij + G[9];
    case 1250: return G[2] * xij + G[9];
    case 1251: return G[1] * xij + G[8];
    case 1252: return G[1] * xij + G[8];
    case 1253: return G[1] * xij + G[8];
    case 1254: return G[1] * xij + G[8];
    case 1255: return G[0] * xij + G[7];
    case 1256: return G[0] * xij + G[7];
    case 1257: return G[0] * xij + G[7];
    case 1258: return G[0] * xij + G[7];
    case 1259: return G[0] * xij + G[7];
    case 1260: return G[4] * xij + G[11];
    case 1261: return G[3] * xij + G[10];
    case 1262: return G[3] * xij + G[10];
    case 1263: return G[2] * xij + G[9];
    case 1264: return G[2] * xij + G[9];
    case 1265: return G[2] * xij + G[9];
    case 1266: return G[1] * xij + G[8];
    case 1267: return G[1] * xij + G[8];
    case 1268: return G[1] * xij + G[8];
    case 1269: return G[1] * xij + G[8];
    case 1270: return G[0] * xij + G[7];
    case 1271: return G[0] * xij + G[7];
    case 1272: return G[0] * xij + G[7];
    case 1273: return G[0] * xij + G[7];
    case 1274: return G[0] * xij + G[7];
    case 1275: return G[4] * xij + G[11];
    case 1276: return G[3] * xij + G[10];
    case 1277: return G[3] * xij + G[10];
    case 1278: return G[2] * xij + G[9];
    case 1279: return G[2] * xij + G[9];
    case 1280: return G[2] * xij + G[9];
    case 1281: return G[1] * xij + G[8];
    case 1282: return G[1] * xij + G[8];
    case 1283: return G[1] * xij + G[8];
    case 1284: return G[1] * xij + G[8];
    case 1285: return G[0] * xij + G[7];
    case 1286: return G[0] * xij + G[7];
    case 1287: return G[0] * xij + G[7];
    case 1288: return G[0] * xij + G[7];
    case 1289: return G[0] * xij + G[7];
    case 1290: return G[4];
    case 1291: return G[3];
    case 1292: return G[3];
    case 1293: return G[2];
    case 1294: return G[2];
    case 1295: return G[2];
    case 1296: return G[1];
    case 1297: return G[1];
    case 1298: return G[1];
    case 1299: return G[1];
    case 1300: return G[0];
    case 1301: return G[0];
    case 1302: return G[0];
    case 1303: return G[0];
    case 1304: return G[0];
    case 1305: return G[4];
    case 1306: return G[3];
    case 1307: return G[3];
    case 1308: return G[2];
    case 1309: return G[2];
    case 1310: return G[2];
    case 1311: return G[1];
    case 1312: return G[1];
    case 1313: return G[1];
    case 1314: return G[1];
    case 1315: return G[0];
    case 1316: return G[0];
    case 1317: return G[0];
    case 1318: return G[0];
    case 1319: return G[0];
    case 1320: return G[4];
    case 1321: return G[3];
    case 1322: return G[3];
    case 1323: return G[2];
    case 1324: return G[2];
    case 1325: return G[2];
    case 1326: return G[1];
    case 1327: return G[1];
    case 1328: return G[1];
    case 1329: return G[1];
    case 1330: return G[0];
    case 1331: return G[0];
    case 1332: return G[0];
    case 1333: return G[0];
    case 1334: return G[0];
    case 1335: return G[4];
    case 1336: return G[3];
    case 1337: return G[3];
    case 1338: return G[2];
    case 1339: return G[2];
    case 1340: return G[2];
    case 1341: return G[1];
    case 1342: return G[1];
    case 1343: return G[1];
    case 1344: return G[1];
    case 1345: return G[0];
    case 1346: return G[0];
    case 1347: return G[0];
    case 1348: return G[0];
    case 1349: return G[0];
    case 1350: return G[4] * pow(xij, 3) + 3.0 * (G[11] * xij2) + 3.0 * (G[18] * xij) + G[25];
    case 1351: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 1352: return G[3] * pow(xij, 3) + 3.0 * (G[10] * xij2) + 3.0 * (G[17] * xij) + G[24];
    case 1353: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 1354: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 1355: return G[2] * pow(xij, 3) + 3.0 * (G[9] * xij2) + 3.0 * (G[16] * xij) + G[23];
    case 1356: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1357: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1358: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1359: return G[1] * pow(xij, 3) + 3.0 * (G[8] * xij2) + 3.0 * (G[15] * xij) + G[22];
    case 1360: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1361: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1362: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1363: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1364: return G[0] * pow(xij, 3) + 3.0 * (G[7] * xij2) + 3.0 * (G[14] * xij) + G[21];
    case 1365: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 1366: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1367: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1368: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1369: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1370: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1371: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1372: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1373: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1374: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1375: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1376: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1377: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1378: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1379: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1380: return G[4] * xij2 + 2.0 * (G[11] * xij) + G[18];
    case 1381: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1382: return G[3] * xij2 + 2.0 * (G[10] * xij) + G[17];
    case 1383: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1384: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1385: return G[2] * xij2 + 2.0 * (G[9] * xij) + G[16];
    case 1386: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1387: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1388: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1389: return G[1] * xij2 + 2.0 * (G[8] * xij) + G[15];
    case 1390: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1391: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1392: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1393: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1394: return G[0] * xij2 + 2.0 * (G[7] * xij) + G[14];
    case 1395: return G[4] * xij + G[11];
    case 1396: return G[3] * xij + G[10];
    case 1397: return G[3] * xij + G[10];
    case 1398: return G[2] * xij + G[9];
    case 1399: return G[2] * xij + G[9];
    case 1400: return G[2] * xij + G[9];
    case 1401: return G[1] * xij + G[8];
    case 1402: return G[1] * xij + G[8];
    case 1403: return G[1] * xij + G[8];
    case 1404: return G[1] * xij + G[8];
    case 1405: return G[0] * xij + G[7];
    case 1406: return G[0] * xij + G[7];
    case 1407: return G[0] * xij + G[7];
    case 1408: return G[0] * xij + G[7];
    case 1409: return G[0] * xij + G[7];
    case 1410: return G[4] * xij + G[11];
    case 1411: return G[3] * xij + G[10];
    case 1412: return G[3] * xij + G[10];
    case 1413: return G[2] * xij + G[9];
    case 1414: return G[2] * xij + G[9];
    case 1415: return G[2] * xij + G[9];
    case 1416: return G[1] * xij + G[8];
    case 1417: return G[1] * xij + G[8];
    case 1418: return G[1] * xij + G[8];
    case 1419: return G[1] * xij + G[8];
    case 1420: return G[0] * xij + G[7];
    case 1421: return G[0] * xij + G[7];
    case 1422: return G[0] * xij + G[7];
    case 1423: return G[0] * xij + G[7];
    case 1424: return G[0] * xij + G[7];
    case 1425: return G[4] * xij + G[11];
    case 1426: return G[3] * xij + G[10];
    case 1427: return G[3] * xij + G[10];
    case 1428: return G[2] * xij + G[9];
    case 1429: return G[2] * xij + G[9];
    case 1430: return G[2] * xij + G[9];
    case 1431: return G[1] * xij + G[8];
    case 1432: return G[1] * xij + G[8];
    case 1433: return G[1] * xij + G[8];
    case 1434: return G[1] * xij + G[8];
    case 1435: return G[0] * xij + G[7];
    case 1436: return G[0] * xij + G[7];
    case 1437: return G[0] * xij + G[7];
    case 1438: return G[0] * xij + G[7];
    case 1439: return G[0] * xij + G[7];
    case 1440: return G[4];
    case 1441: return G[3];
    case 1442: return G[3];
    case 1443: return G[2];
    case 1444: return G[2];
    case 1445: return G[2];
    case 1446: return G[1];
    case 1447: return G[1];
    case 1448: return G[1];
    case 1449: return G[1];
    case 1450: return G[0];
    case 1451: return G[0];
    case 1452: return G[0];
    case 1453: return G[0];
    case 1454: return G[0];
    case 1455: return G[4];
    case 1456: return G[3];
    case 1457: return G[3];
    case 1458: return G[2];
    case 1459: return G[2];
    case 1460: return G[2];
    case 1461: return G[1];
    case 1462: return G[1];
    case 1463: return G[1];
    case 1464: return G[1];
    case 1465: return G[0];
    case 1466: return G[0];
    case 1467: return G[0];
    case 1468: return G[0];
    case 1469: return G[0];
    case 1470: return G[4];
    case 1471: return G[3];
    case 1472: return G[3];
    case 1473: return G[2];
    case 1474: return G[2];
    case 1475: return G[2];
    case 1476: return G[1];
    case 1477: return G[1];
    case 1478: return G[1];
    case 1479: return G[1];
    case 1480: return G[0];
    case 1481: return G[0];
    case 1482: return G[0];
    case 1483: return G[0];
    case 1484: return G[0];
    case 1485: return G[4];
    case 1486: return G[3];
    case 1487: return G[3];
    case 1488: return G[2];
    case 1489: return G[2];
    case 1490: return G[2];
    case 1491: return G[1];
    case 1492: return G[1];
    case 1493: return G[1];
    case 1494: return G[1];
    case 1495: return G[0];
    case 1496: return G[0];
    case 1497: return G[0];
    case 1498: return G[0];
    case 1499: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ffgs_y(
    int e,
    const double* G,
    double yij,
    double yij2,
    double ykl,
    double ykl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[1];
    case 2: return G[0];
    case 3: return G[2];
    case 4: return G[1];
    case 5: return G[0];
    case 6: return G[3];
    case 7: return G[2];
    case 8: return G[1];
    case 9: return G[0];
    case 10: return G[4];
    case 11: return G[3];
    case 12: return G[2];
    case 13: return G[1];
    case 14: return G[0];
    case 15: return G[0] * yij + G[7];
    case 16: return G[1] * yij + G[8];
    case 17: return G[0] * yij + G[7];
    case 18: return G[2] * yij + G[9];
    case 19: return G[1] * yij + G[8];
    case 20: return G[0] * yij + G[7];
    case 21: return G[3] * yij + G[10];
    case 22: return G[2] * yij + G[9];
    case 23: return G[1] * yij + G[8];
    case 24: return G[0] * yij + G[7];
    case 25: return G[4] * yij + G[11];
    case 26: return G[3] * yij + G[10];
    case 27: return G[2] * yij + G[9];
    case 28: return G[1] * yij + G[8];
    case 29: return G[0] * yij + G[7];
    case 30: return G[0];
    case 31: return G[1];
    case 32: return G[0];
    case 33: return G[2];
    case 34: return G[1];
    case 35: return G[0];
    case 36: return G[3];
    case 37: return G[2];
    case 38: return G[1];
    case 39: return G[0];
    case 40: return G[4];
    case 41: return G[3];
    case 42: return G[2];
    case 43: return G[1];
    case 44: return G[0];
    case 45: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 46: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 47: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 48: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 49: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 50: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 51: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 52: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 53: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 54: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 55: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 56: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 57: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 58: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 59: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 60: return G[0] * yij + G[7];
    case 61: return G[1] * yij + G[8];
    case 62: return G[0] * yij + G[7];
    case 63: return G[2] * yij + G[9];
    case 64: return G[1] * yij + G[8];
    case 65: return G[0] * yij + G[7];
    case 66: return G[3] * yij + G[10];
    case 67: return G[2] * yij + G[9];
    case 68: return G[1] * yij + G[8];
    case 69: return G[0] * yij + G[7];
    case 70: return G[4] * yij + G[11];
    case 71: return G[3] * yij + G[10];
    case 72: return G[2] * yij + G[9];
    case 73: return G[1] * yij + G[8];
    case 74: return G[0] * yij + G[7];
    case 75: return G[0];
    case 76: return G[1];
    case 77: return G[0];
    case 78: return G[2];
    case 79: return G[1];
    case 80: return G[0];
    case 81: return G[3];
    case 82: return G[2];
    case 83: return G[1];
    case 84: return G[0];
    case 85: return G[4];
    case 86: return G[3];
    case 87: return G[2];
    case 88: return G[1];
    case 89: return G[0];
    case 90: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 91: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 92: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 93: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 94: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 95: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 96: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 97: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 98: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 99: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 100: return G[4] * pow(yij, 3) + 3.0 * (G[11] * yij2) + 3.0 * (G[18] * yij) + G[25];
    case 101: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 102: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 103: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 104: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 105: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 106: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 107: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 108: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 109: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 110: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 111: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 112: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 113: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 114: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 115: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 116: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 117: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 118: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 119: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 120: return G[0] * yij + G[7];
    case 121: return G[1] * yij + G[8];
    case 122: return G[0] * yij + G[7];
    case 123: return G[2] * yij + G[9];
    case 124: return G[1] * yij + G[8];
    case 125: return G[0] * yij + G[7];
    case 126: return G[3] * yij + G[10];
    case 127: return G[2] * yij + G[9];
    case 128: return G[1] * yij + G[8];
    case 129: return G[0] * yij + G[7];
    case 130: return G[4] * yij + G[11];
    case 131: return G[3] * yij + G[10];
    case 132: return G[2] * yij + G[9];
    case 133: return G[1] * yij + G[8];
    case 134: return G[0] * yij + G[7];
    case 135: return G[0];
    case 136: return G[1];
    case 137: return G[0];
    case 138: return G[2];
    case 139: return G[1];
    case 140: return G[0];
    case 141: return G[3];
    case 142: return G[2];
    case 143: return G[1];
    case 144: return G[0];
    case 145: return G[4];
    case 146: return G[3];
    case 147: return G[2];
    case 148: return G[1];
    case 149: return G[0];
    case 150: return G[7];
    case 151: return G[8];
    case 152: return G[7];
    case 153: return G[9];
    case 154: return G[8];
    case 155: return G[7];
    case 156: return G[10];
    case 157: return G[9];
    case 158: return G[8];
    case 159: return G[7];
    case 160: return G[11];
    case 161: return G[10];
    case 162: return G[9];
    case 163: return G[8];
    case 164: return G[7];
    case 165: return G[7] * yij + G[14];
    case 166: return G[8] * yij + G[15];
    case 167: return G[7] * yij + G[14];
    case 168: return G[9] * yij + G[16];
    case 169: return G[8] * yij + G[15];
    case 170: return G[7] * yij + G[14];
    case 171: return G[10] * yij + G[17];
    case 172: return G[9] * yij + G[16];
    case 173: return G[8] * yij + G[15];
    case 174: return G[7] * yij + G[14];
    case 175: return G[11] * yij + G[18];
    case 176: return G[10] * yij + G[17];
    case 177: return G[9] * yij + G[16];
    case 178: return G[8] * yij + G[15];
    case 179: return G[7] * yij + G[14];
    case 180: return G[7];
    case 181: return G[8];
    case 182: return G[7];
    case 183: return G[9];
    case 184: return G[8];
    case 185: return G[7];
    case 186: return G[10];
    case 187: return G[9];
    case 188: return G[8];
    case 189: return G[7];
    case 190: return G[11];
    case 191: return G[10];
    case 192: return G[9];
    case 193: return G[8];
    case 194: return G[7];
    case 195: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 196: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 197: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 198: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 199: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 200: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 201: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 202: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 203: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 204: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 205: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 206: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 207: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 208: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 209: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 210: return G[7] * yij + G[14];
    case 211: return G[8] * yij + G[15];
    case 212: return G[7] * yij + G[14];
    case 213: return G[9] * yij + G[16];
    case 214: return G[8] * yij + G[15];
    case 215: return G[7] * yij + G[14];
    case 216: return G[10] * yij + G[17];
    case 217: return G[9] * yij + G[16];
    case 218: return G[8] * yij + G[15];
    case 219: return G[7] * yij + G[14];
    case 220: return G[11] * yij + G[18];
    case 221: return G[10] * yij + G[17];
    case 222: return G[9] * yij + G[16];
    case 223: return G[8] * yij + G[15];
    case 224: return G[7] * yij + G[14];
    case 225: return G[7];
    case 226: return G[8];
    case 227: return G[7];
    case 228: return G[9];
    case 229: return G[8];
    case 230: return G[7];
    case 231: return G[10];
    case 232: return G[9];
    case 233: return G[8];
    case 234: return G[7];
    case 235: return G[11];
    case 236: return G[10];
    case 237: return G[9];
    case 238: return G[8];
    case 239: return G[7];
    case 240: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 241: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 242: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 243: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 244: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 245: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 246: return G[10] * pow(yij, 3) + 3.0 * (G[17] * yij2) + 3.0 * (G[24] * yij) + G[31];
    case 247: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 248: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 249: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 250: return G[11] * pow(yij, 3) + 3.0 * (G[18] * yij2) + 3.0 * (G[25] * yij) + G[32];
    case 251: return G[10] * pow(yij, 3) + 3.0 * (G[17] * yij2) + 3.0 * (G[24] * yij) + G[31];
    case 252: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 253: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 254: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 255: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 256: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 257: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 258: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 259: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 260: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 261: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 262: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 263: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 264: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 265: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 266: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 267: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 268: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 269: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 270: return G[7] * yij + G[14];
    case 271: return G[8] * yij + G[15];
    case 272: return G[7] * yij + G[14];
    case 273: return G[9] * yij + G[16];
    case 274: return G[8] * yij + G[15];
    case 275: return G[7] * yij + G[14];
    case 276: return G[10] * yij + G[17];
    case 277: return G[9] * yij + G[16];
    case 278: return G[8] * yij + G[15];
    case 279: return G[7] * yij + G[14];
    case 280: return G[11] * yij + G[18];
    case 281: return G[10] * yij + G[17];
    case 282: return G[9] * yij + G[16];
    case 283: return G[8] * yij + G[15];
    case 284: return G[7] * yij + G[14];
    case 285: return G[7];
    case 286: return G[8];
    case 287: return G[7];
    case 288: return G[9];
    case 289: return G[8];
    case 290: return G[7];
    case 291: return G[10];
    case 292: return G[9];
    case 293: return G[8];
    case 294: return G[7];
    case 295: return G[11];
    case 296: return G[10];
    case 297: return G[9];
    case 298: return G[8];
    case 299: return G[7];
    case 300: return G[0];
    case 301: return G[1];
    case 302: return G[0];
    case 303: return G[2];
    case 304: return G[1];
    case 305: return G[0];
    case 306: return G[3];
    case 307: return G[2];
    case 308: return G[1];
    case 309: return G[0];
    case 310: return G[4];
    case 311: return G[3];
    case 312: return G[2];
    case 313: return G[1];
    case 314: return G[0];
    case 315: return G[0] * yij + G[7];
    case 316: return G[1] * yij + G[8];
    case 317: return G[0] * yij + G[7];
    case 318: return G[2] * yij + G[9];
    case 319: return G[1] * yij + G[8];
    case 320: return G[0] * yij + G[7];
    case 321: return G[3] * yij + G[10];
    case 322: return G[2] * yij + G[9];
    case 323: return G[1] * yij + G[8];
    case 324: return G[0] * yij + G[7];
    case 325: return G[4] * yij + G[11];
    case 326: return G[3] * yij + G[10];
    case 327: return G[2] * yij + G[9];
    case 328: return G[1] * yij + G[8];
    case 329: return G[0] * yij + G[7];
    case 330: return G[0];
    case 331: return G[1];
    case 332: return G[0];
    case 333: return G[2];
    case 334: return G[1];
    case 335: return G[0];
    case 336: return G[3];
    case 337: return G[2];
    case 338: return G[1];
    case 339: return G[0];
    case 340: return G[4];
    case 341: return G[3];
    case 342: return G[2];
    case 343: return G[1];
    case 344: return G[0];
    case 345: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 346: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 347: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 348: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 349: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 350: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 351: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 352: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 353: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 354: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 355: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 356: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 357: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 358: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 359: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 360: return G[0] * yij + G[7];
    case 361: return G[1] * yij + G[8];
    case 362: return G[0] * yij + G[7];
    case 363: return G[2] * yij + G[9];
    case 364: return G[1] * yij + G[8];
    case 365: return G[0] * yij + G[7];
    case 366: return G[3] * yij + G[10];
    case 367: return G[2] * yij + G[9];
    case 368: return G[1] * yij + G[8];
    case 369: return G[0] * yij + G[7];
    case 370: return G[4] * yij + G[11];
    case 371: return G[3] * yij + G[10];
    case 372: return G[2] * yij + G[9];
    case 373: return G[1] * yij + G[8];
    case 374: return G[0] * yij + G[7];
    case 375: return G[0];
    case 376: return G[1];
    case 377: return G[0];
    case 378: return G[2];
    case 379: return G[1];
    case 380: return G[0];
    case 381: return G[3];
    case 382: return G[2];
    case 383: return G[1];
    case 384: return G[0];
    case 385: return G[4];
    case 386: return G[3];
    case 387: return G[2];
    case 388: return G[1];
    case 389: return G[0];
    case 390: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 391: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 392: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 393: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 394: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 395: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 396: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 397: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 398: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 399: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 400: return G[4] * pow(yij, 3) + 3.0 * (G[11] * yij2) + 3.0 * (G[18] * yij) + G[25];
    case 401: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 402: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 403: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 404: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 405: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 406: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 407: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 408: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 409: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 410: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 411: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 412: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 413: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 414: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 415: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 416: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 417: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 418: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 419: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 420: return G[0] * yij + G[7];
    case 421: return G[1] * yij + G[8];
    case 422: return G[0] * yij + G[7];
    case 423: return G[2] * yij + G[9];
    case 424: return G[1] * yij + G[8];
    case 425: return G[0] * yij + G[7];
    case 426: return G[3] * yij + G[10];
    case 427: return G[2] * yij + G[9];
    case 428: return G[1] * yij + G[8];
    case 429: return G[0] * yij + G[7];
    case 430: return G[4] * yij + G[11];
    case 431: return G[3] * yij + G[10];
    case 432: return G[2] * yij + G[9];
    case 433: return G[1] * yij + G[8];
    case 434: return G[0] * yij + G[7];
    case 435: return G[0];
    case 436: return G[1];
    case 437: return G[0];
    case 438: return G[2];
    case 439: return G[1];
    case 440: return G[0];
    case 441: return G[3];
    case 442: return G[2];
    case 443: return G[1];
    case 444: return G[0];
    case 445: return G[4];
    case 446: return G[3];
    case 447: return G[2];
    case 448: return G[1];
    case 449: return G[0];
    case 450: return G[14];
    case 451: return G[15];
    case 452: return G[14];
    case 453: return G[16];
    case 454: return G[15];
    case 455: return G[14];
    case 456: return G[17];
    case 457: return G[16];
    case 458: return G[15];
    case 459: return G[14];
    case 460: return G[18];
    case 461: return G[17];
    case 462: return G[16];
    case 463: return G[15];
    case 464: return G[14];
    case 465: return G[14] * yij + G[21];
    case 466: return G[15] * yij + G[22];
    case 467: return G[14] * yij + G[21];
    case 468: return G[16] * yij + G[23];
    case 469: return G[15] * yij + G[22];
    case 470: return G[14] * yij + G[21];
    case 471: return G[17] * yij + G[24];
    case 472: return G[16] * yij + G[23];
    case 473: return G[15] * yij + G[22];
    case 474: return G[14] * yij + G[21];
    case 475: return G[18] * yij + G[25];
    case 476: return G[17] * yij + G[24];
    case 477: return G[16] * yij + G[23];
    case 478: return G[15] * yij + G[22];
    case 479: return G[14] * yij + G[21];
    case 480: return G[14];
    case 481: return G[15];
    case 482: return G[14];
    case 483: return G[16];
    case 484: return G[15];
    case 485: return G[14];
    case 486: return G[17];
    case 487: return G[16];
    case 488: return G[15];
    case 489: return G[14];
    case 490: return G[18];
    case 491: return G[17];
    case 492: return G[16];
    case 493: return G[15];
    case 494: return G[14];
    case 495: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 496: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 497: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 498: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 499: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 500: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 501: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 502: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 503: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 504: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 505: return G[18] * yij2 + 2.0 * (G[25] * yij) + G[32];
    case 506: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 507: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 508: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 509: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 510: return G[14] * yij + G[21];
    case 511: return G[15] * yij + G[22];
    case 512: return G[14] * yij + G[21];
    case 513: return G[16] * yij + G[23];
    case 514: return G[15] * yij + G[22];
    case 515: return G[14] * yij + G[21];
    case 516: return G[17] * yij + G[24];
    case 517: return G[16] * yij + G[23];
    case 518: return G[15] * yij + G[22];
    case 519: return G[14] * yij + G[21];
    case 520: return G[18] * yij + G[25];
    case 521: return G[17] * yij + G[24];
    case 522: return G[16] * yij + G[23];
    case 523: return G[15] * yij + G[22];
    case 524: return G[14] * yij + G[21];
    case 525: return G[14];
    case 526: return G[15];
    case 527: return G[14];
    case 528: return G[16];
    case 529: return G[15];
    case 530: return G[14];
    case 531: return G[17];
    case 532: return G[16];
    case 533: return G[15];
    case 534: return G[14];
    case 535: return G[18];
    case 536: return G[17];
    case 537: return G[16];
    case 538: return G[15];
    case 539: return G[14];
    case 540: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 541: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 542: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 543: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 544: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 545: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 546: return G[17] * pow(yij, 3) + 3.0 * (G[24] * yij2) + 3.0 * (G[31] * yij) + G[38];
    case 547: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 548: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 549: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 550: return G[18] * pow(yij, 3) + 3.0 * (G[25] * yij2) + 3.0 * (G[32] * yij) + G[39];
    case 551: return G[17] * pow(yij, 3) + 3.0 * (G[24] * yij2) + 3.0 * (G[31] * yij) + G[38];
    case 552: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 553: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 554: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 555: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 556: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 557: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 558: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 559: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 560: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 561: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 562: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 563: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 564: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 565: return G[18] * yij2 + 2.0 * (G[25] * yij) + G[32];
    case 566: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 567: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 568: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 569: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 570: return G[14] * yij + G[21];
    case 571: return G[15] * yij + G[22];
    case 572: return G[14] * yij + G[21];
    case 573: return G[16] * yij + G[23];
    case 574: return G[15] * yij + G[22];
    case 575: return G[14] * yij + G[21];
    case 576: return G[17] * yij + G[24];
    case 577: return G[16] * yij + G[23];
    case 578: return G[15] * yij + G[22];
    case 579: return G[14] * yij + G[21];
    case 580: return G[18] * yij + G[25];
    case 581: return G[17] * yij + G[24];
    case 582: return G[16] * yij + G[23];
    case 583: return G[15] * yij + G[22];
    case 584: return G[14] * yij + G[21];
    case 585: return G[14];
    case 586: return G[15];
    case 587: return G[14];
    case 588: return G[16];
    case 589: return G[15];
    case 590: return G[14];
    case 591: return G[17];
    case 592: return G[16];
    case 593: return G[15];
    case 594: return G[14];
    case 595: return G[18];
    case 596: return G[17];
    case 597: return G[16];
    case 598: return G[15];
    case 599: return G[14];
    case 600: return G[7];
    case 601: return G[8];
    case 602: return G[7];
    case 603: return G[9];
    case 604: return G[8];
    case 605: return G[7];
    case 606: return G[10];
    case 607: return G[9];
    case 608: return G[8];
    case 609: return G[7];
    case 610: return G[11];
    case 611: return G[10];
    case 612: return G[9];
    case 613: return G[8];
    case 614: return G[7];
    case 615: return G[7] * yij + G[14];
    case 616: return G[8] * yij + G[15];
    case 617: return G[7] * yij + G[14];
    case 618: return G[9] * yij + G[16];
    case 619: return G[8] * yij + G[15];
    case 620: return G[7] * yij + G[14];
    case 621: return G[10] * yij + G[17];
    case 622: return G[9] * yij + G[16];
    case 623: return G[8] * yij + G[15];
    case 624: return G[7] * yij + G[14];
    case 625: return G[11] * yij + G[18];
    case 626: return G[10] * yij + G[17];
    case 627: return G[9] * yij + G[16];
    case 628: return G[8] * yij + G[15];
    case 629: return G[7] * yij + G[14];
    case 630: return G[7];
    case 631: return G[8];
    case 632: return G[7];
    case 633: return G[9];
    case 634: return G[8];
    case 635: return G[7];
    case 636: return G[10];
    case 637: return G[9];
    case 638: return G[8];
    case 639: return G[7];
    case 640: return G[11];
    case 641: return G[10];
    case 642: return G[9];
    case 643: return G[8];
    case 644: return G[7];
    case 645: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 646: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 647: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 648: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 649: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 650: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 651: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 652: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 653: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 654: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 655: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 656: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 657: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 658: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 659: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 660: return G[7] * yij + G[14];
    case 661: return G[8] * yij + G[15];
    case 662: return G[7] * yij + G[14];
    case 663: return G[9] * yij + G[16];
    case 664: return G[8] * yij + G[15];
    case 665: return G[7] * yij + G[14];
    case 666: return G[10] * yij + G[17];
    case 667: return G[9] * yij + G[16];
    case 668: return G[8] * yij + G[15];
    case 669: return G[7] * yij + G[14];
    case 670: return G[11] * yij + G[18];
    case 671: return G[10] * yij + G[17];
    case 672: return G[9] * yij + G[16];
    case 673: return G[8] * yij + G[15];
    case 674: return G[7] * yij + G[14];
    case 675: return G[7];
    case 676: return G[8];
    case 677: return G[7];
    case 678: return G[9];
    case 679: return G[8];
    case 680: return G[7];
    case 681: return G[10];
    case 682: return G[9];
    case 683: return G[8];
    case 684: return G[7];
    case 685: return G[11];
    case 686: return G[10];
    case 687: return G[9];
    case 688: return G[8];
    case 689: return G[7];
    case 690: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 691: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 692: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 693: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 694: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 695: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 696: return G[10] * pow(yij, 3) + 3.0 * (G[17] * yij2) + 3.0 * (G[24] * yij) + G[31];
    case 697: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 698: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 699: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 700: return G[11] * pow(yij, 3) + 3.0 * (G[18] * yij2) + 3.0 * (G[25] * yij) + G[32];
    case 701: return G[10] * pow(yij, 3) + 3.0 * (G[17] * yij2) + 3.0 * (G[24] * yij) + G[31];
    case 702: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 703: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 704: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 705: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 706: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 707: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 708: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 709: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 710: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 711: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 712: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 713: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 714: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 715: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 716: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 717: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 718: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 719: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 720: return G[7] * yij + G[14];
    case 721: return G[8] * yij + G[15];
    case 722: return G[7] * yij + G[14];
    case 723: return G[9] * yij + G[16];
    case 724: return G[8] * yij + G[15];
    case 725: return G[7] * yij + G[14];
    case 726: return G[10] * yij + G[17];
    case 727: return G[9] * yij + G[16];
    case 728: return G[8] * yij + G[15];
    case 729: return G[7] * yij + G[14];
    case 730: return G[11] * yij + G[18];
    case 731: return G[10] * yij + G[17];
    case 732: return G[9] * yij + G[16];
    case 733: return G[8] * yij + G[15];
    case 734: return G[7] * yij + G[14];
    case 735: return G[7];
    case 736: return G[8];
    case 737: return G[7];
    case 738: return G[9];
    case 739: return G[8];
    case 740: return G[7];
    case 741: return G[10];
    case 742: return G[9];
    case 743: return G[8];
    case 744: return G[7];
    case 745: return G[11];
    case 746: return G[10];
    case 747: return G[9];
    case 748: return G[8];
    case 749: return G[7];
    case 750: return G[0];
    case 751: return G[1];
    case 752: return G[0];
    case 753: return G[2];
    case 754: return G[1];
    case 755: return G[0];
    case 756: return G[3];
    case 757: return G[2];
    case 758: return G[1];
    case 759: return G[0];
    case 760: return G[4];
    case 761: return G[3];
    case 762: return G[2];
    case 763: return G[1];
    case 764: return G[0];
    case 765: return G[0] * yij + G[7];
    case 766: return G[1] * yij + G[8];
    case 767: return G[0] * yij + G[7];
    case 768: return G[2] * yij + G[9];
    case 769: return G[1] * yij + G[8];
    case 770: return G[0] * yij + G[7];
    case 771: return G[3] * yij + G[10];
    case 772: return G[2] * yij + G[9];
    case 773: return G[1] * yij + G[8];
    case 774: return G[0] * yij + G[7];
    case 775: return G[4] * yij + G[11];
    case 776: return G[3] * yij + G[10];
    case 777: return G[2] * yij + G[9];
    case 778: return G[1] * yij + G[8];
    case 779: return G[0] * yij + G[7];
    case 780: return G[0];
    case 781: return G[1];
    case 782: return G[0];
    case 783: return G[2];
    case 784: return G[1];
    case 785: return G[0];
    case 786: return G[3];
    case 787: return G[2];
    case 788: return G[1];
    case 789: return G[0];
    case 790: return G[4];
    case 791: return G[3];
    case 792: return G[2];
    case 793: return G[1];
    case 794: return G[0];
    case 795: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 796: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 797: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 798: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 799: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 800: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 801: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 802: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 803: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 804: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 805: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 806: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 807: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 808: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 809: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 810: return G[0] * yij + G[7];
    case 811: return G[1] * yij + G[8];
    case 812: return G[0] * yij + G[7];
    case 813: return G[2] * yij + G[9];
    case 814: return G[1] * yij + G[8];
    case 815: return G[0] * yij + G[7];
    case 816: return G[3] * yij + G[10];
    case 817: return G[2] * yij + G[9];
    case 818: return G[1] * yij + G[8];
    case 819: return G[0] * yij + G[7];
    case 820: return G[4] * yij + G[11];
    case 821: return G[3] * yij + G[10];
    case 822: return G[2] * yij + G[9];
    case 823: return G[1] * yij + G[8];
    case 824: return G[0] * yij + G[7];
    case 825: return G[0];
    case 826: return G[1];
    case 827: return G[0];
    case 828: return G[2];
    case 829: return G[1];
    case 830: return G[0];
    case 831: return G[3];
    case 832: return G[2];
    case 833: return G[1];
    case 834: return G[0];
    case 835: return G[4];
    case 836: return G[3];
    case 837: return G[2];
    case 838: return G[1];
    case 839: return G[0];
    case 840: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 841: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 842: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 843: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 844: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 845: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 846: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 847: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 848: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 849: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 850: return G[4] * pow(yij, 3) + 3.0 * (G[11] * yij2) + 3.0 * (G[18] * yij) + G[25];
    case 851: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 852: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 853: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 854: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 855: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 856: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 857: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 858: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 859: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 860: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 861: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 862: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 863: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 864: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 865: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 866: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 867: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 868: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 869: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 870: return G[0] * yij + G[7];
    case 871: return G[1] * yij + G[8];
    case 872: return G[0] * yij + G[7];
    case 873: return G[2] * yij + G[9];
    case 874: return G[1] * yij + G[8];
    case 875: return G[0] * yij + G[7];
    case 876: return G[3] * yij + G[10];
    case 877: return G[2] * yij + G[9];
    case 878: return G[1] * yij + G[8];
    case 879: return G[0] * yij + G[7];
    case 880: return G[4] * yij + G[11];
    case 881: return G[3] * yij + G[10];
    case 882: return G[2] * yij + G[9];
    case 883: return G[1] * yij + G[8];
    case 884: return G[0] * yij + G[7];
    case 885: return G[0];
    case 886: return G[1];
    case 887: return G[0];
    case 888: return G[2];
    case 889: return G[1];
    case 890: return G[0];
    case 891: return G[3];
    case 892: return G[2];
    case 893: return G[1];
    case 894: return G[0];
    case 895: return G[4];
    case 896: return G[3];
    case 897: return G[2];
    case 898: return G[1];
    case 899: return G[0];
    case 900: return G[21];
    case 901: return G[22];
    case 902: return G[21];
    case 903: return G[23];
    case 904: return G[22];
    case 905: return G[21];
    case 906: return G[24];
    case 907: return G[23];
    case 908: return G[22];
    case 909: return G[21];
    case 910: return G[25];
    case 911: return G[24];
    case 912: return G[23];
    case 913: return G[22];
    case 914: return G[21];
    case 915: return G[21] * yij + G[28];
    case 916: return G[22] * yij + G[29];
    case 917: return G[21] * yij + G[28];
    case 918: return G[23] * yij + G[30];
    case 919: return G[22] * yij + G[29];
    case 920: return G[21] * yij + G[28];
    case 921: return G[24] * yij + G[31];
    case 922: return G[23] * yij + G[30];
    case 923: return G[22] * yij + G[29];
    case 924: return G[21] * yij + G[28];
    case 925: return G[25] * yij + G[32];
    case 926: return G[24] * yij + G[31];
    case 927: return G[23] * yij + G[30];
    case 928: return G[22] * yij + G[29];
    case 929: return G[21] * yij + G[28];
    case 930: return G[21];
    case 931: return G[22];
    case 932: return G[21];
    case 933: return G[23];
    case 934: return G[22];
    case 935: return G[21];
    case 936: return G[24];
    case 937: return G[23];
    case 938: return G[22];
    case 939: return G[21];
    case 940: return G[25];
    case 941: return G[24];
    case 942: return G[23];
    case 943: return G[22];
    case 944: return G[21];
    case 945: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 946: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 947: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 948: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 949: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 950: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 951: return G[24] * yij2 + 2.0 * (G[31] * yij) + G[38];
    case 952: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 953: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 954: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 955: return G[25] * yij2 + 2.0 * (G[32] * yij) + G[39];
    case 956: return G[24] * yij2 + 2.0 * (G[31] * yij) + G[38];
    case 957: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 958: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 959: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 960: return G[21] * yij + G[28];
    case 961: return G[22] * yij + G[29];
    case 962: return G[21] * yij + G[28];
    case 963: return G[23] * yij + G[30];
    case 964: return G[22] * yij + G[29];
    case 965: return G[21] * yij + G[28];
    case 966: return G[24] * yij + G[31];
    case 967: return G[23] * yij + G[30];
    case 968: return G[22] * yij + G[29];
    case 969: return G[21] * yij + G[28];
    case 970: return G[25] * yij + G[32];
    case 971: return G[24] * yij + G[31];
    case 972: return G[23] * yij + G[30];
    case 973: return G[22] * yij + G[29];
    case 974: return G[21] * yij + G[28];
    case 975: return G[21];
    case 976: return G[22];
    case 977: return G[21];
    case 978: return G[23];
    case 979: return G[22];
    case 980: return G[21];
    case 981: return G[24];
    case 982: return G[23];
    case 983: return G[22];
    case 984: return G[21];
    case 985: return G[25];
    case 986: return G[24];
    case 987: return G[23];
    case 988: return G[22];
    case 989: return G[21];
    case 990: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 991: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 992: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 993: return G[23] * pow(yij, 3) + 3.0 * (G[30] * yij2) + 3.0 * (G[37] * yij) + G[44];
    case 994: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 995: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 996: return G[24] * pow(yij, 3) + 3.0 * (G[31] * yij2) + 3.0 * (G[38] * yij) + G[45];
    case 997: return G[23] * pow(yij, 3) + 3.0 * (G[30] * yij2) + 3.0 * (G[37] * yij) + G[44];
    case 998: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 999: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 1000: return G[25] * pow(yij, 3) + 3.0 * (G[32] * yij2) + 3.0 * (G[39] * yij) + G[46];
    case 1001: return G[24] * pow(yij, 3) + 3.0 * (G[31] * yij2) + 3.0 * (G[38] * yij) + G[45];
    case 1002: return G[23] * pow(yij, 3) + 3.0 * (G[30] * yij2) + 3.0 * (G[37] * yij) + G[44];
    case 1003: return G[22] * pow(yij, 3) + 3.0 * (G[29] * yij2) + 3.0 * (G[36] * yij) + G[43];
    case 1004: return G[21] * pow(yij, 3) + 3.0 * (G[28] * yij2) + 3.0 * (G[35] * yij) + G[42];
    case 1005: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 1006: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 1007: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 1008: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 1009: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 1010: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 1011: return G[24] * yij2 + 2.0 * (G[31] * yij) + G[38];
    case 1012: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 1013: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 1014: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 1015: return G[25] * yij2 + 2.0 * (G[32] * yij) + G[39];
    case 1016: return G[24] * yij2 + 2.0 * (G[31] * yij) + G[38];
    case 1017: return G[23] * yij2 + 2.0 * (G[30] * yij) + G[37];
    case 1018: return G[22] * yij2 + 2.0 * (G[29] * yij) + G[36];
    case 1019: return G[21] * yij2 + 2.0 * (G[28] * yij) + G[35];
    case 1020: return G[21] * yij + G[28];
    case 1021: return G[22] * yij + G[29];
    case 1022: return G[21] * yij + G[28];
    case 1023: return G[23] * yij + G[30];
    case 1024: return G[22] * yij + G[29];
    case 1025: return G[21] * yij + G[28];
    case 1026: return G[24] * yij + G[31];
    case 1027: return G[23] * yij + G[30];
    case 1028: return G[22] * yij + G[29];
    case 1029: return G[21] * yij + G[28];
    case 1030: return G[25] * yij + G[32];
    case 1031: return G[24] * yij + G[31];
    case 1032: return G[23] * yij + G[30];
    case 1033: return G[22] * yij + G[29];
    case 1034: return G[21] * yij + G[28];
    case 1035: return G[21];
    case 1036: return G[22];
    case 1037: return G[21];
    case 1038: return G[23];
    case 1039: return G[22];
    case 1040: return G[21];
    case 1041: return G[24];
    case 1042: return G[23];
    case 1043: return G[22];
    case 1044: return G[21];
    case 1045: return G[25];
    case 1046: return G[24];
    case 1047: return G[23];
    case 1048: return G[22];
    case 1049: return G[21];
    case 1050: return G[14];
    case 1051: return G[15];
    case 1052: return G[14];
    case 1053: return G[16];
    case 1054: return G[15];
    case 1055: return G[14];
    case 1056: return G[17];
    case 1057: return G[16];
    case 1058: return G[15];
    case 1059: return G[14];
    case 1060: return G[18];
    case 1061: return G[17];
    case 1062: return G[16];
    case 1063: return G[15];
    case 1064: return G[14];
    case 1065: return G[14] * yij + G[21];
    case 1066: return G[15] * yij + G[22];
    case 1067: return G[14] * yij + G[21];
    case 1068: return G[16] * yij + G[23];
    case 1069: return G[15] * yij + G[22];
    case 1070: return G[14] * yij + G[21];
    case 1071: return G[17] * yij + G[24];
    case 1072: return G[16] * yij + G[23];
    case 1073: return G[15] * yij + G[22];
    case 1074: return G[14] * yij + G[21];
    case 1075: return G[18] * yij + G[25];
    case 1076: return G[17] * yij + G[24];
    case 1077: return G[16] * yij + G[23];
    case 1078: return G[15] * yij + G[22];
    case 1079: return G[14] * yij + G[21];
    case 1080: return G[14];
    case 1081: return G[15];
    case 1082: return G[14];
    case 1083: return G[16];
    case 1084: return G[15];
    case 1085: return G[14];
    case 1086: return G[17];
    case 1087: return G[16];
    case 1088: return G[15];
    case 1089: return G[14];
    case 1090: return G[18];
    case 1091: return G[17];
    case 1092: return G[16];
    case 1093: return G[15];
    case 1094: return G[14];
    case 1095: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1096: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 1097: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1098: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 1099: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 1100: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1101: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 1102: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 1103: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 1104: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1105: return G[18] * yij2 + 2.0 * (G[25] * yij) + G[32];
    case 1106: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 1107: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 1108: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 1109: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1110: return G[14] * yij + G[21];
    case 1111: return G[15] * yij + G[22];
    case 1112: return G[14] * yij + G[21];
    case 1113: return G[16] * yij + G[23];
    case 1114: return G[15] * yij + G[22];
    case 1115: return G[14] * yij + G[21];
    case 1116: return G[17] * yij + G[24];
    case 1117: return G[16] * yij + G[23];
    case 1118: return G[15] * yij + G[22];
    case 1119: return G[14] * yij + G[21];
    case 1120: return G[18] * yij + G[25];
    case 1121: return G[17] * yij + G[24];
    case 1122: return G[16] * yij + G[23];
    case 1123: return G[15] * yij + G[22];
    case 1124: return G[14] * yij + G[21];
    case 1125: return G[14];
    case 1126: return G[15];
    case 1127: return G[14];
    case 1128: return G[16];
    case 1129: return G[15];
    case 1130: return G[14];
    case 1131: return G[17];
    case 1132: return G[16];
    case 1133: return G[15];
    case 1134: return G[14];
    case 1135: return G[18];
    case 1136: return G[17];
    case 1137: return G[16];
    case 1138: return G[15];
    case 1139: return G[14];
    case 1140: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 1141: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 1142: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 1143: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 1144: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 1145: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 1146: return G[17] * pow(yij, 3) + 3.0 * (G[24] * yij2) + 3.0 * (G[31] * yij) + G[38];
    case 1147: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 1148: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 1149: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 1150: return G[18] * pow(yij, 3) + 3.0 * (G[25] * yij2) + 3.0 * (G[32] * yij) + G[39];
    case 1151: return G[17] * pow(yij, 3) + 3.0 * (G[24] * yij2) + 3.0 * (G[31] * yij) + G[38];
    case 1152: return G[16] * pow(yij, 3) + 3.0 * (G[23] * yij2) + 3.0 * (G[30] * yij) + G[37];
    case 1153: return G[15] * pow(yij, 3) + 3.0 * (G[22] * yij2) + 3.0 * (G[29] * yij) + G[36];
    case 1154: return G[14] * pow(yij, 3) + 3.0 * (G[21] * yij2) + 3.0 * (G[28] * yij) + G[35];
    case 1155: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1156: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 1157: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1158: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 1159: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 1160: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1161: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 1162: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 1163: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 1164: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1165: return G[18] * yij2 + 2.0 * (G[25] * yij) + G[32];
    case 1166: return G[17] * yij2 + 2.0 * (G[24] * yij) + G[31];
    case 1167: return G[16] * yij2 + 2.0 * (G[23] * yij) + G[30];
    case 1168: return G[15] * yij2 + 2.0 * (G[22] * yij) + G[29];
    case 1169: return G[14] * yij2 + 2.0 * (G[21] * yij) + G[28];
    case 1170: return G[14] * yij + G[21];
    case 1171: return G[15] * yij + G[22];
    case 1172: return G[14] * yij + G[21];
    case 1173: return G[16] * yij + G[23];
    case 1174: return G[15] * yij + G[22];
    case 1175: return G[14] * yij + G[21];
    case 1176: return G[17] * yij + G[24];
    case 1177: return G[16] * yij + G[23];
    case 1178: return G[15] * yij + G[22];
    case 1179: return G[14] * yij + G[21];
    case 1180: return G[18] * yij + G[25];
    case 1181: return G[17] * yij + G[24];
    case 1182: return G[16] * yij + G[23];
    case 1183: return G[15] * yij + G[22];
    case 1184: return G[14] * yij + G[21];
    case 1185: return G[14];
    case 1186: return G[15];
    case 1187: return G[14];
    case 1188: return G[16];
    case 1189: return G[15];
    case 1190: return G[14];
    case 1191: return G[17];
    case 1192: return G[16];
    case 1193: return G[15];
    case 1194: return G[14];
    case 1195: return G[18];
    case 1196: return G[17];
    case 1197: return G[16];
    case 1198: return G[15];
    case 1199: return G[14];
    case 1200: return G[7];
    case 1201: return G[8];
    case 1202: return G[7];
    case 1203: return G[9];
    case 1204: return G[8];
    case 1205: return G[7];
    case 1206: return G[10];
    case 1207: return G[9];
    case 1208: return G[8];
    case 1209: return G[7];
    case 1210: return G[11];
    case 1211: return G[10];
    case 1212: return G[9];
    case 1213: return G[8];
    case 1214: return G[7];
    case 1215: return G[7] * yij + G[14];
    case 1216: return G[8] * yij + G[15];
    case 1217: return G[7] * yij + G[14];
    case 1218: return G[9] * yij + G[16];
    case 1219: return G[8] * yij + G[15];
    case 1220: return G[7] * yij + G[14];
    case 1221: return G[10] * yij + G[17];
    case 1222: return G[9] * yij + G[16];
    case 1223: return G[8] * yij + G[15];
    case 1224: return G[7] * yij + G[14];
    case 1225: return G[11] * yij + G[18];
    case 1226: return G[10] * yij + G[17];
    case 1227: return G[9] * yij + G[16];
    case 1228: return G[8] * yij + G[15];
    case 1229: return G[7] * yij + G[14];
    case 1230: return G[7];
    case 1231: return G[8];
    case 1232: return G[7];
    case 1233: return G[9];
    case 1234: return G[8];
    case 1235: return G[7];
    case 1236: return G[10];
    case 1237: return G[9];
    case 1238: return G[8];
    case 1239: return G[7];
    case 1240: return G[11];
    case 1241: return G[10];
    case 1242: return G[9];
    case 1243: return G[8];
    case 1244: return G[7];
    case 1245: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1246: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 1247: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1248: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 1249: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 1250: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1251: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 1252: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 1253: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 1254: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1255: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 1256: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 1257: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 1258: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 1259: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1260: return G[7] * yij + G[14];
    case 1261: return G[8] * yij + G[15];
    case 1262: return G[7] * yij + G[14];
    case 1263: return G[9] * yij + G[16];
    case 1264: return G[8] * yij + G[15];
    case 1265: return G[7] * yij + G[14];
    case 1266: return G[10] * yij + G[17];
    case 1267: return G[9] * yij + G[16];
    case 1268: return G[8] * yij + G[15];
    case 1269: return G[7] * yij + G[14];
    case 1270: return G[11] * yij + G[18];
    case 1271: return G[10] * yij + G[17];
    case 1272: return G[9] * yij + G[16];
    case 1273: return G[8] * yij + G[15];
    case 1274: return G[7] * yij + G[14];
    case 1275: return G[7];
    case 1276: return G[8];
    case 1277: return G[7];
    case 1278: return G[9];
    case 1279: return G[8];
    case 1280: return G[7];
    case 1281: return G[10];
    case 1282: return G[9];
    case 1283: return G[8];
    case 1284: return G[7];
    case 1285: return G[11];
    case 1286: return G[10];
    case 1287: return G[9];
    case 1288: return G[8];
    case 1289: return G[7];
    case 1290: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 1291: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 1292: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 1293: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 1294: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 1295: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 1296: return G[10] * pow(yij, 3) + 3.0 * (G[17] * yij2) + 3.0 * (G[24] * yij) + G[31];
    case 1297: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 1298: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 1299: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 1300: return G[11] * pow(yij, 3) + 3.0 * (G[18] * yij2) + 3.0 * (G[25] * yij) + G[32];
    case 1301: return G[10] * pow(yij, 3) + 3.0 * (G[17] * yij2) + 3.0 * (G[24] * yij) + G[31];
    case 1302: return G[9] * pow(yij, 3) + 3.0 * (G[16] * yij2) + 3.0 * (G[23] * yij) + G[30];
    case 1303: return G[8] * pow(yij, 3) + 3.0 * (G[15] * yij2) + 3.0 * (G[22] * yij) + G[29];
    case 1304: return G[7] * pow(yij, 3) + 3.0 * (G[14] * yij2) + 3.0 * (G[21] * yij) + G[28];
    case 1305: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1306: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 1307: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1308: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 1309: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 1310: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1311: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 1312: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 1313: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 1314: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1315: return G[11] * yij2 + 2.0 * (G[18] * yij) + G[25];
    case 1316: return G[10] * yij2 + 2.0 * (G[17] * yij) + G[24];
    case 1317: return G[9] * yij2 + 2.0 * (G[16] * yij) + G[23];
    case 1318: return G[8] * yij2 + 2.0 * (G[15] * yij) + G[22];
    case 1319: return G[7] * yij2 + 2.0 * (G[14] * yij) + G[21];
    case 1320: return G[7] * yij + G[14];
    case 1321: return G[8] * yij + G[15];
    case 1322: return G[7] * yij + G[14];
    case 1323: return G[9] * yij + G[16];
    case 1324: return G[8] * yij + G[15];
    case 1325: return G[7] * yij + G[14];
    case 1326: return G[10] * yij + G[17];
    case 1327: return G[9] * yij + G[16];
    case 1328: return G[8] * yij + G[15];
    case 1329: return G[7] * yij + G[14];
    case 1330: return G[11] * yij + G[18];
    case 1331: return G[10] * yij + G[17];
    case 1332: return G[9] * yij + G[16];
    case 1333: return G[8] * yij + G[15];
    case 1334: return G[7] * yij + G[14];
    case 1335: return G[7];
    case 1336: return G[8];
    case 1337: return G[7];
    case 1338: return G[9];
    case 1339: return G[8];
    case 1340: return G[7];
    case 1341: return G[10];
    case 1342: return G[9];
    case 1343: return G[8];
    case 1344: return G[7];
    case 1345: return G[11];
    case 1346: return G[10];
    case 1347: return G[9];
    case 1348: return G[8];
    case 1349: return G[7];
    case 1350: return G[0];
    case 1351: return G[1];
    case 1352: return G[0];
    case 1353: return G[2];
    case 1354: return G[1];
    case 1355: return G[0];
    case 1356: return G[3];
    case 1357: return G[2];
    case 1358: return G[1];
    case 1359: return G[0];
    case 1360: return G[4];
    case 1361: return G[3];
    case 1362: return G[2];
    case 1363: return G[1];
    case 1364: return G[0];
    case 1365: return G[0] * yij + G[7];
    case 1366: return G[1] * yij + G[8];
    case 1367: return G[0] * yij + G[7];
    case 1368: return G[2] * yij + G[9];
    case 1369: return G[1] * yij + G[8];
    case 1370: return G[0] * yij + G[7];
    case 1371: return G[3] * yij + G[10];
    case 1372: return G[2] * yij + G[9];
    case 1373: return G[1] * yij + G[8];
    case 1374: return G[0] * yij + G[7];
    case 1375: return G[4] * yij + G[11];
    case 1376: return G[3] * yij + G[10];
    case 1377: return G[2] * yij + G[9];
    case 1378: return G[1] * yij + G[8];
    case 1379: return G[0] * yij + G[7];
    case 1380: return G[0];
    case 1381: return G[1];
    case 1382: return G[0];
    case 1383: return G[2];
    case 1384: return G[1];
    case 1385: return G[0];
    case 1386: return G[3];
    case 1387: return G[2];
    case 1388: return G[1];
    case 1389: return G[0];
    case 1390: return G[4];
    case 1391: return G[3];
    case 1392: return G[2];
    case 1393: return G[1];
    case 1394: return G[0];
    case 1395: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1396: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 1397: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1398: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 1399: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 1400: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1401: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 1402: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 1403: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 1404: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1405: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 1406: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 1407: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 1408: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 1409: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1410: return G[0] * yij + G[7];
    case 1411: return G[1] * yij + G[8];
    case 1412: return G[0] * yij + G[7];
    case 1413: return G[2] * yij + G[9];
    case 1414: return G[1] * yij + G[8];
    case 1415: return G[0] * yij + G[7];
    case 1416: return G[3] * yij + G[10];
    case 1417: return G[2] * yij + G[9];
    case 1418: return G[1] * yij + G[8];
    case 1419: return G[0] * yij + G[7];
    case 1420: return G[4] * yij + G[11];
    case 1421: return G[3] * yij + G[10];
    case 1422: return G[2] * yij + G[9];
    case 1423: return G[1] * yij + G[8];
    case 1424: return G[0] * yij + G[7];
    case 1425: return G[0];
    case 1426: return G[1];
    case 1427: return G[0];
    case 1428: return G[2];
    case 1429: return G[1];
    case 1430: return G[0];
    case 1431: return G[3];
    case 1432: return G[2];
    case 1433: return G[1];
    case 1434: return G[0];
    case 1435: return G[4];
    case 1436: return G[3];
    case 1437: return G[2];
    case 1438: return G[1];
    case 1439: return G[0];
    case 1440: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 1441: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 1442: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 1443: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 1444: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 1445: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 1446: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 1447: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 1448: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 1449: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 1450: return G[4] * pow(yij, 3) + 3.0 * (G[11] * yij2) + 3.0 * (G[18] * yij) + G[25];
    case 1451: return G[3] * pow(yij, 3) + 3.0 * (G[10] * yij2) + 3.0 * (G[17] * yij) + G[24];
    case 1452: return G[2] * pow(yij, 3) + 3.0 * (G[9] * yij2) + 3.0 * (G[16] * yij) + G[23];
    case 1453: return G[1] * pow(yij, 3) + 3.0 * (G[8] * yij2) + 3.0 * (G[15] * yij) + G[22];
    case 1454: return G[0] * pow(yij, 3) + 3.0 * (G[7] * yij2) + 3.0 * (G[14] * yij) + G[21];
    case 1455: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1456: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 1457: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1458: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 1459: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 1460: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1461: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 1462: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 1463: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 1464: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1465: return G[4] * yij2 + 2.0 * (G[11] * yij) + G[18];
    case 1466: return G[3] * yij2 + 2.0 * (G[10] * yij) + G[17];
    case 1467: return G[2] * yij2 + 2.0 * (G[9] * yij) + G[16];
    case 1468: return G[1] * yij2 + 2.0 * (G[8] * yij) + G[15];
    case 1469: return G[0] * yij2 + 2.0 * (G[7] * yij) + G[14];
    case 1470: return G[0] * yij + G[7];
    case 1471: return G[1] * yij + G[8];
    case 1472: return G[0] * yij + G[7];
    case 1473: return G[2] * yij + G[9];
    case 1474: return G[1] * yij + G[8];
    case 1475: return G[0] * yij + G[7];
    case 1476: return G[3] * yij + G[10];
    case 1477: return G[2] * yij + G[9];
    case 1478: return G[1] * yij + G[8];
    case 1479: return G[0] * yij + G[7];
    case 1480: return G[4] * yij + G[11];
    case 1481: return G[3] * yij + G[10];
    case 1482: return G[2] * yij + G[9];
    case 1483: return G[1] * yij + G[8];
    case 1484: return G[0] * yij + G[7];
    case 1485: return G[0];
    case 1486: return G[1];
    case 1487: return G[0];
    case 1488: return G[2];
    case 1489: return G[1];
    case 1490: return G[0];
    case 1491: return G[3];
    case 1492: return G[2];
    case 1493: return G[1];
    case 1494: return G[0];
    case 1495: return G[4];
    case 1496: return G[3];
    case 1497: return G[2];
    case 1498: return G[1];
    case 1499: return G[0];
    default: return 0.0;
  }
}

__device__ __forceinline__ double eval_ffgs_z(
    int e,
    const double* G,
    double zij,
    double zij2,
    double zkl,
    double zkl2) {
  switch (e) {
    case 0: return G[0];
    case 1: return G[0];
    case 2: return G[1];
    case 3: return G[0];
    case 4: return G[1];
    case 5: return G[2];
    case 6: return G[0];
    case 7: return G[1];
    case 8: return G[2];
    case 9: return G[3];
    case 10: return G[0];
    case 11: return G[1];
    case 12: return G[2];
    case 13: return G[3];
    case 14: return G[4];
    case 15: return G[0];
    case 16: return G[0];
    case 17: return G[1];
    case 18: return G[0];
    case 19: return G[1];
    case 20: return G[2];
    case 21: return G[0];
    case 22: return G[1];
    case 23: return G[2];
    case 24: return G[3];
    case 25: return G[0];
    case 26: return G[1];
    case 27: return G[2];
    case 28: return G[3];
    case 29: return G[4];
    case 30: return G[0] * zij + G[7];
    case 31: return G[0] * zij + G[7];
    case 32: return G[1] * zij + G[8];
    case 33: return G[0] * zij + G[7];
    case 34: return G[1] * zij + G[8];
    case 35: return G[2] * zij + G[9];
    case 36: return G[0] * zij + G[7];
    case 37: return G[1] * zij + G[8];
    case 38: return G[2] * zij + G[9];
    case 39: return G[3] * zij + G[10];
    case 40: return G[0] * zij + G[7];
    case 41: return G[1] * zij + G[8];
    case 42: return G[2] * zij + G[9];
    case 43: return G[3] * zij + G[10];
    case 44: return G[4] * zij + G[11];
    case 45: return G[0];
    case 46: return G[0];
    case 47: return G[1];
    case 48: return G[0];
    case 49: return G[1];
    case 50: return G[2];
    case 51: return G[0];
    case 52: return G[1];
    case 53: return G[2];
    case 54: return G[3];
    case 55: return G[0];
    case 56: return G[1];
    case 57: return G[2];
    case 58: return G[3];
    case 59: return G[4];
    case 60: return G[0] * zij + G[7];
    case 61: return G[0] * zij + G[7];
    case 62: return G[1] * zij + G[8];
    case 63: return G[0] * zij + G[7];
    case 64: return G[1] * zij + G[8];
    case 65: return G[2] * zij + G[9];
    case 66: return G[0] * zij + G[7];
    case 67: return G[1] * zij + G[8];
    case 68: return G[2] * zij + G[9];
    case 69: return G[3] * zij + G[10];
    case 70: return G[0] * zij + G[7];
    case 71: return G[1] * zij + G[8];
    case 72: return G[2] * zij + G[9];
    case 73: return G[3] * zij + G[10];
    case 74: return G[4] * zij + G[11];
    case 75: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 76: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 77: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 78: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 79: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 80: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 81: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 82: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 83: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 84: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 85: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 86: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 87: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 88: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 89: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 90: return G[0];
    case 91: return G[0];
    case 92: return G[1];
    case 93: return G[0];
    case 94: return G[1];
    case 95: return G[2];
    case 96: return G[0];
    case 97: return G[1];
    case 98: return G[2];
    case 99: return G[3];
    case 100: return G[0];
    case 101: return G[1];
    case 102: return G[2];
    case 103: return G[3];
    case 104: return G[4];
    case 105: return G[0] * zij + G[7];
    case 106: return G[0] * zij + G[7];
    case 107: return G[1] * zij + G[8];
    case 108: return G[0] * zij + G[7];
    case 109: return G[1] * zij + G[8];
    case 110: return G[2] * zij + G[9];
    case 111: return G[0] * zij + G[7];
    case 112: return G[1] * zij + G[8];
    case 113: return G[2] * zij + G[9];
    case 114: return G[3] * zij + G[10];
    case 115: return G[0] * zij + G[7];
    case 116: return G[1] * zij + G[8];
    case 117: return G[2] * zij + G[9];
    case 118: return G[3] * zij + G[10];
    case 119: return G[4] * zij + G[11];
    case 120: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 121: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 122: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 123: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 124: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 125: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 126: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 127: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 128: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 129: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 130: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 131: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 132: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 133: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 134: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 135: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 136: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 137: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 138: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 139: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 140: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 141: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 142: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 143: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 144: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 145: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 146: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 147: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 148: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 149: return G[4] * pow(zij, 3) + 3.0 * (G[11] * zij2) + 3.0 * (G[18] * zij) + G[25];
    case 150: return G[0];
    case 151: return G[0];
    case 152: return G[1];
    case 153: return G[0];
    case 154: return G[1];
    case 155: return G[2];
    case 156: return G[0];
    case 157: return G[1];
    case 158: return G[2];
    case 159: return G[3];
    case 160: return G[0];
    case 161: return G[1];
    case 162: return G[2];
    case 163: return G[3];
    case 164: return G[4];
    case 165: return G[0];
    case 166: return G[0];
    case 167: return G[1];
    case 168: return G[0];
    case 169: return G[1];
    case 170: return G[2];
    case 171: return G[0];
    case 172: return G[1];
    case 173: return G[2];
    case 174: return G[3];
    case 175: return G[0];
    case 176: return G[1];
    case 177: return G[2];
    case 178: return G[3];
    case 179: return G[4];
    case 180: return G[0] * zij + G[7];
    case 181: return G[0] * zij + G[7];
    case 182: return G[1] * zij + G[8];
    case 183: return G[0] * zij + G[7];
    case 184: return G[1] * zij + G[8];
    case 185: return G[2] * zij + G[9];
    case 186: return G[0] * zij + G[7];
    case 187: return G[1] * zij + G[8];
    case 188: return G[2] * zij + G[9];
    case 189: return G[3] * zij + G[10];
    case 190: return G[0] * zij + G[7];
    case 191: return G[1] * zij + G[8];
    case 192: return G[2] * zij + G[9];
    case 193: return G[3] * zij + G[10];
    case 194: return G[4] * zij + G[11];
    case 195: return G[0];
    case 196: return G[0];
    case 197: return G[1];
    case 198: return G[0];
    case 199: return G[1];
    case 200: return G[2];
    case 201: return G[0];
    case 202: return G[1];
    case 203: return G[2];
    case 204: return G[3];
    case 205: return G[0];
    case 206: return G[1];
    case 207: return G[2];
    case 208: return G[3];
    case 209: return G[4];
    case 210: return G[0] * zij + G[7];
    case 211: return G[0] * zij + G[7];
    case 212: return G[1] * zij + G[8];
    case 213: return G[0] * zij + G[7];
    case 214: return G[1] * zij + G[8];
    case 215: return G[2] * zij + G[9];
    case 216: return G[0] * zij + G[7];
    case 217: return G[1] * zij + G[8];
    case 218: return G[2] * zij + G[9];
    case 219: return G[3] * zij + G[10];
    case 220: return G[0] * zij + G[7];
    case 221: return G[1] * zij + G[8];
    case 222: return G[2] * zij + G[9];
    case 223: return G[3] * zij + G[10];
    case 224: return G[4] * zij + G[11];
    case 225: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 226: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 227: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 228: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 229: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 230: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 231: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 232: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 233: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 234: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 235: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 236: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 237: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 238: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 239: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 240: return G[0];
    case 241: return G[0];
    case 242: return G[1];
    case 243: return G[0];
    case 244: return G[1];
    case 245: return G[2];
    case 246: return G[0];
    case 247: return G[1];
    case 248: return G[2];
    case 249: return G[3];
    case 250: return G[0];
    case 251: return G[1];
    case 252: return G[2];
    case 253: return G[3];
    case 254: return G[4];
    case 255: return G[0] * zij + G[7];
    case 256: return G[0] * zij + G[7];
    case 257: return G[1] * zij + G[8];
    case 258: return G[0] * zij + G[7];
    case 259: return G[1] * zij + G[8];
    case 260: return G[2] * zij + G[9];
    case 261: return G[0] * zij + G[7];
    case 262: return G[1] * zij + G[8];
    case 263: return G[2] * zij + G[9];
    case 264: return G[3] * zij + G[10];
    case 265: return G[0] * zij + G[7];
    case 266: return G[1] * zij + G[8];
    case 267: return G[2] * zij + G[9];
    case 268: return G[3] * zij + G[10];
    case 269: return G[4] * zij + G[11];
    case 270: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 271: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 272: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 273: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 274: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 275: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 276: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 277: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 278: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 279: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 280: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 281: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 282: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 283: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 284: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 285: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 286: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 287: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 288: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 289: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 290: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 291: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 292: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 293: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 294: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 295: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 296: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 297: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 298: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 299: return G[4] * pow(zij, 3) + 3.0 * (G[11] * zij2) + 3.0 * (G[18] * zij) + G[25];
    case 300: return G[7];
    case 301: return G[7];
    case 302: return G[8];
    case 303: return G[7];
    case 304: return G[8];
    case 305: return G[9];
    case 306: return G[7];
    case 307: return G[8];
    case 308: return G[9];
    case 309: return G[10];
    case 310: return G[7];
    case 311: return G[8];
    case 312: return G[9];
    case 313: return G[10];
    case 314: return G[11];
    case 315: return G[7];
    case 316: return G[7];
    case 317: return G[8];
    case 318: return G[7];
    case 319: return G[8];
    case 320: return G[9];
    case 321: return G[7];
    case 322: return G[8];
    case 323: return G[9];
    case 324: return G[10];
    case 325: return G[7];
    case 326: return G[8];
    case 327: return G[9];
    case 328: return G[10];
    case 329: return G[11];
    case 330: return G[7] * zij + G[14];
    case 331: return G[7] * zij + G[14];
    case 332: return G[8] * zij + G[15];
    case 333: return G[7] * zij + G[14];
    case 334: return G[8] * zij + G[15];
    case 335: return G[9] * zij + G[16];
    case 336: return G[7] * zij + G[14];
    case 337: return G[8] * zij + G[15];
    case 338: return G[9] * zij + G[16];
    case 339: return G[10] * zij + G[17];
    case 340: return G[7] * zij + G[14];
    case 341: return G[8] * zij + G[15];
    case 342: return G[9] * zij + G[16];
    case 343: return G[10] * zij + G[17];
    case 344: return G[11] * zij + G[18];
    case 345: return G[7];
    case 346: return G[7];
    case 347: return G[8];
    case 348: return G[7];
    case 349: return G[8];
    case 350: return G[9];
    case 351: return G[7];
    case 352: return G[8];
    case 353: return G[9];
    case 354: return G[10];
    case 355: return G[7];
    case 356: return G[8];
    case 357: return G[9];
    case 358: return G[10];
    case 359: return G[11];
    case 360: return G[7] * zij + G[14];
    case 361: return G[7] * zij + G[14];
    case 362: return G[8] * zij + G[15];
    case 363: return G[7] * zij + G[14];
    case 364: return G[8] * zij + G[15];
    case 365: return G[9] * zij + G[16];
    case 366: return G[7] * zij + G[14];
    case 367: return G[8] * zij + G[15];
    case 368: return G[9] * zij + G[16];
    case 369: return G[10] * zij + G[17];
    case 370: return G[7] * zij + G[14];
    case 371: return G[8] * zij + G[15];
    case 372: return G[9] * zij + G[16];
    case 373: return G[10] * zij + G[17];
    case 374: return G[11] * zij + G[18];
    case 375: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 376: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 377: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 378: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 379: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 380: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 381: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 382: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 383: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 384: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 385: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 386: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 387: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 388: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 389: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 390: return G[7];
    case 391: return G[7];
    case 392: return G[8];
    case 393: return G[7];
    case 394: return G[8];
    case 395: return G[9];
    case 396: return G[7];
    case 397: return G[8];
    case 398: return G[9];
    case 399: return G[10];
    case 400: return G[7];
    case 401: return G[8];
    case 402: return G[9];
    case 403: return G[10];
    case 404: return G[11];
    case 405: return G[7] * zij + G[14];
    case 406: return G[7] * zij + G[14];
    case 407: return G[8] * zij + G[15];
    case 408: return G[7] * zij + G[14];
    case 409: return G[8] * zij + G[15];
    case 410: return G[9] * zij + G[16];
    case 411: return G[7] * zij + G[14];
    case 412: return G[8] * zij + G[15];
    case 413: return G[9] * zij + G[16];
    case 414: return G[10] * zij + G[17];
    case 415: return G[7] * zij + G[14];
    case 416: return G[8] * zij + G[15];
    case 417: return G[9] * zij + G[16];
    case 418: return G[10] * zij + G[17];
    case 419: return G[11] * zij + G[18];
    case 420: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 421: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 422: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 423: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 424: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 425: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 426: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 427: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 428: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 429: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 430: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 431: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 432: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 433: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 434: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 435: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 436: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 437: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 438: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 439: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 440: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 441: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 442: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 443: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 444: return G[10] * pow(zij, 3) + 3.0 * (G[17] * zij2) + 3.0 * (G[24] * zij) + G[31];
    case 445: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 446: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 447: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 448: return G[10] * pow(zij, 3) + 3.0 * (G[17] * zij2) + 3.0 * (G[24] * zij) + G[31];
    case 449: return G[11] * pow(zij, 3) + 3.0 * (G[18] * zij2) + 3.0 * (G[25] * zij) + G[32];
    case 450: return G[0];
    case 451: return G[0];
    case 452: return G[1];
    case 453: return G[0];
    case 454: return G[1];
    case 455: return G[2];
    case 456: return G[0];
    case 457: return G[1];
    case 458: return G[2];
    case 459: return G[3];
    case 460: return G[0];
    case 461: return G[1];
    case 462: return G[2];
    case 463: return G[3];
    case 464: return G[4];
    case 465: return G[0];
    case 466: return G[0];
    case 467: return G[1];
    case 468: return G[0];
    case 469: return G[1];
    case 470: return G[2];
    case 471: return G[0];
    case 472: return G[1];
    case 473: return G[2];
    case 474: return G[3];
    case 475: return G[0];
    case 476: return G[1];
    case 477: return G[2];
    case 478: return G[3];
    case 479: return G[4];
    case 480: return G[0] * zij + G[7];
    case 481: return G[0] * zij + G[7];
    case 482: return G[1] * zij + G[8];
    case 483: return G[0] * zij + G[7];
    case 484: return G[1] * zij + G[8];
    case 485: return G[2] * zij + G[9];
    case 486: return G[0] * zij + G[7];
    case 487: return G[1] * zij + G[8];
    case 488: return G[2] * zij + G[9];
    case 489: return G[3] * zij + G[10];
    case 490: return G[0] * zij + G[7];
    case 491: return G[1] * zij + G[8];
    case 492: return G[2] * zij + G[9];
    case 493: return G[3] * zij + G[10];
    case 494: return G[4] * zij + G[11];
    case 495: return G[0];
    case 496: return G[0];
    case 497: return G[1];
    case 498: return G[0];
    case 499: return G[1];
    case 500: return G[2];
    case 501: return G[0];
    case 502: return G[1];
    case 503: return G[2];
    case 504: return G[3];
    case 505: return G[0];
    case 506: return G[1];
    case 507: return G[2];
    case 508: return G[3];
    case 509: return G[4];
    case 510: return G[0] * zij + G[7];
    case 511: return G[0] * zij + G[7];
    case 512: return G[1] * zij + G[8];
    case 513: return G[0] * zij + G[7];
    case 514: return G[1] * zij + G[8];
    case 515: return G[2] * zij + G[9];
    case 516: return G[0] * zij + G[7];
    case 517: return G[1] * zij + G[8];
    case 518: return G[2] * zij + G[9];
    case 519: return G[3] * zij + G[10];
    case 520: return G[0] * zij + G[7];
    case 521: return G[1] * zij + G[8];
    case 522: return G[2] * zij + G[9];
    case 523: return G[3] * zij + G[10];
    case 524: return G[4] * zij + G[11];
    case 525: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 526: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 527: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 528: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 529: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 530: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 531: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 532: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 533: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 534: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 535: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 536: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 537: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 538: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 539: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 540: return G[0];
    case 541: return G[0];
    case 542: return G[1];
    case 543: return G[0];
    case 544: return G[1];
    case 545: return G[2];
    case 546: return G[0];
    case 547: return G[1];
    case 548: return G[2];
    case 549: return G[3];
    case 550: return G[0];
    case 551: return G[1];
    case 552: return G[2];
    case 553: return G[3];
    case 554: return G[4];
    case 555: return G[0] * zij + G[7];
    case 556: return G[0] * zij + G[7];
    case 557: return G[1] * zij + G[8];
    case 558: return G[0] * zij + G[7];
    case 559: return G[1] * zij + G[8];
    case 560: return G[2] * zij + G[9];
    case 561: return G[0] * zij + G[7];
    case 562: return G[1] * zij + G[8];
    case 563: return G[2] * zij + G[9];
    case 564: return G[3] * zij + G[10];
    case 565: return G[0] * zij + G[7];
    case 566: return G[1] * zij + G[8];
    case 567: return G[2] * zij + G[9];
    case 568: return G[3] * zij + G[10];
    case 569: return G[4] * zij + G[11];
    case 570: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 571: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 572: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 573: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 574: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 575: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 576: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 577: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 578: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 579: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 580: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 581: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 582: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 583: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 584: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 585: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 586: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 587: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 588: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 589: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 590: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 591: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 592: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 593: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 594: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 595: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 596: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 597: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 598: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 599: return G[4] * pow(zij, 3) + 3.0 * (G[11] * zij2) + 3.0 * (G[18] * zij) + G[25];
    case 600: return G[7];
    case 601: return G[7];
    case 602: return G[8];
    case 603: return G[7];
    case 604: return G[8];
    case 605: return G[9];
    case 606: return G[7];
    case 607: return G[8];
    case 608: return G[9];
    case 609: return G[10];
    case 610: return G[7];
    case 611: return G[8];
    case 612: return G[9];
    case 613: return G[10];
    case 614: return G[11];
    case 615: return G[7];
    case 616: return G[7];
    case 617: return G[8];
    case 618: return G[7];
    case 619: return G[8];
    case 620: return G[9];
    case 621: return G[7];
    case 622: return G[8];
    case 623: return G[9];
    case 624: return G[10];
    case 625: return G[7];
    case 626: return G[8];
    case 627: return G[9];
    case 628: return G[10];
    case 629: return G[11];
    case 630: return G[7] * zij + G[14];
    case 631: return G[7] * zij + G[14];
    case 632: return G[8] * zij + G[15];
    case 633: return G[7] * zij + G[14];
    case 634: return G[8] * zij + G[15];
    case 635: return G[9] * zij + G[16];
    case 636: return G[7] * zij + G[14];
    case 637: return G[8] * zij + G[15];
    case 638: return G[9] * zij + G[16];
    case 639: return G[10] * zij + G[17];
    case 640: return G[7] * zij + G[14];
    case 641: return G[8] * zij + G[15];
    case 642: return G[9] * zij + G[16];
    case 643: return G[10] * zij + G[17];
    case 644: return G[11] * zij + G[18];
    case 645: return G[7];
    case 646: return G[7];
    case 647: return G[8];
    case 648: return G[7];
    case 649: return G[8];
    case 650: return G[9];
    case 651: return G[7];
    case 652: return G[8];
    case 653: return G[9];
    case 654: return G[10];
    case 655: return G[7];
    case 656: return G[8];
    case 657: return G[9];
    case 658: return G[10];
    case 659: return G[11];
    case 660: return G[7] * zij + G[14];
    case 661: return G[7] * zij + G[14];
    case 662: return G[8] * zij + G[15];
    case 663: return G[7] * zij + G[14];
    case 664: return G[8] * zij + G[15];
    case 665: return G[9] * zij + G[16];
    case 666: return G[7] * zij + G[14];
    case 667: return G[8] * zij + G[15];
    case 668: return G[9] * zij + G[16];
    case 669: return G[10] * zij + G[17];
    case 670: return G[7] * zij + G[14];
    case 671: return G[8] * zij + G[15];
    case 672: return G[9] * zij + G[16];
    case 673: return G[10] * zij + G[17];
    case 674: return G[11] * zij + G[18];
    case 675: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 676: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 677: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 678: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 679: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 680: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 681: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 682: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 683: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 684: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 685: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 686: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 687: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 688: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 689: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 690: return G[7];
    case 691: return G[7];
    case 692: return G[8];
    case 693: return G[7];
    case 694: return G[8];
    case 695: return G[9];
    case 696: return G[7];
    case 697: return G[8];
    case 698: return G[9];
    case 699: return G[10];
    case 700: return G[7];
    case 701: return G[8];
    case 702: return G[9];
    case 703: return G[10];
    case 704: return G[11];
    case 705: return G[7] * zij + G[14];
    case 706: return G[7] * zij + G[14];
    case 707: return G[8] * zij + G[15];
    case 708: return G[7] * zij + G[14];
    case 709: return G[8] * zij + G[15];
    case 710: return G[9] * zij + G[16];
    case 711: return G[7] * zij + G[14];
    case 712: return G[8] * zij + G[15];
    case 713: return G[9] * zij + G[16];
    case 714: return G[10] * zij + G[17];
    case 715: return G[7] * zij + G[14];
    case 716: return G[8] * zij + G[15];
    case 717: return G[9] * zij + G[16];
    case 718: return G[10] * zij + G[17];
    case 719: return G[11] * zij + G[18];
    case 720: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 721: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 722: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 723: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 724: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 725: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 726: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 727: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 728: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 729: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 730: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 731: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 732: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 733: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 734: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 735: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 736: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 737: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 738: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 739: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 740: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 741: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 742: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 743: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 744: return G[10] * pow(zij, 3) + 3.0 * (G[17] * zij2) + 3.0 * (G[24] * zij) + G[31];
    case 745: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 746: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 747: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 748: return G[10] * pow(zij, 3) + 3.0 * (G[17] * zij2) + 3.0 * (G[24] * zij) + G[31];
    case 749: return G[11] * pow(zij, 3) + 3.0 * (G[18] * zij2) + 3.0 * (G[25] * zij) + G[32];
    case 750: return G[14];
    case 751: return G[14];
    case 752: return G[15];
    case 753: return G[14];
    case 754: return G[15];
    case 755: return G[16];
    case 756: return G[14];
    case 757: return G[15];
    case 758: return G[16];
    case 759: return G[17];
    case 760: return G[14];
    case 761: return G[15];
    case 762: return G[16];
    case 763: return G[17];
    case 764: return G[18];
    case 765: return G[14];
    case 766: return G[14];
    case 767: return G[15];
    case 768: return G[14];
    case 769: return G[15];
    case 770: return G[16];
    case 771: return G[14];
    case 772: return G[15];
    case 773: return G[16];
    case 774: return G[17];
    case 775: return G[14];
    case 776: return G[15];
    case 777: return G[16];
    case 778: return G[17];
    case 779: return G[18];
    case 780: return G[14] * zij + G[21];
    case 781: return G[14] * zij + G[21];
    case 782: return G[15] * zij + G[22];
    case 783: return G[14] * zij + G[21];
    case 784: return G[15] * zij + G[22];
    case 785: return G[16] * zij + G[23];
    case 786: return G[14] * zij + G[21];
    case 787: return G[15] * zij + G[22];
    case 788: return G[16] * zij + G[23];
    case 789: return G[17] * zij + G[24];
    case 790: return G[14] * zij + G[21];
    case 791: return G[15] * zij + G[22];
    case 792: return G[16] * zij + G[23];
    case 793: return G[17] * zij + G[24];
    case 794: return G[18] * zij + G[25];
    case 795: return G[14];
    case 796: return G[14];
    case 797: return G[15];
    case 798: return G[14];
    case 799: return G[15];
    case 800: return G[16];
    case 801: return G[14];
    case 802: return G[15];
    case 803: return G[16];
    case 804: return G[17];
    case 805: return G[14];
    case 806: return G[15];
    case 807: return G[16];
    case 808: return G[17];
    case 809: return G[18];
    case 810: return G[14] * zij + G[21];
    case 811: return G[14] * zij + G[21];
    case 812: return G[15] * zij + G[22];
    case 813: return G[14] * zij + G[21];
    case 814: return G[15] * zij + G[22];
    case 815: return G[16] * zij + G[23];
    case 816: return G[14] * zij + G[21];
    case 817: return G[15] * zij + G[22];
    case 818: return G[16] * zij + G[23];
    case 819: return G[17] * zij + G[24];
    case 820: return G[14] * zij + G[21];
    case 821: return G[15] * zij + G[22];
    case 822: return G[16] * zij + G[23];
    case 823: return G[17] * zij + G[24];
    case 824: return G[18] * zij + G[25];
    case 825: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 826: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 827: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 828: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 829: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 830: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 831: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 832: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 833: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 834: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 835: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 836: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 837: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 838: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 839: return G[18] * zij2 + 2.0 * (G[25] * zij) + G[32];
    case 840: return G[14];
    case 841: return G[14];
    case 842: return G[15];
    case 843: return G[14];
    case 844: return G[15];
    case 845: return G[16];
    case 846: return G[14];
    case 847: return G[15];
    case 848: return G[16];
    case 849: return G[17];
    case 850: return G[14];
    case 851: return G[15];
    case 852: return G[16];
    case 853: return G[17];
    case 854: return G[18];
    case 855: return G[14] * zij + G[21];
    case 856: return G[14] * zij + G[21];
    case 857: return G[15] * zij + G[22];
    case 858: return G[14] * zij + G[21];
    case 859: return G[15] * zij + G[22];
    case 860: return G[16] * zij + G[23];
    case 861: return G[14] * zij + G[21];
    case 862: return G[15] * zij + G[22];
    case 863: return G[16] * zij + G[23];
    case 864: return G[17] * zij + G[24];
    case 865: return G[14] * zij + G[21];
    case 866: return G[15] * zij + G[22];
    case 867: return G[16] * zij + G[23];
    case 868: return G[17] * zij + G[24];
    case 869: return G[18] * zij + G[25];
    case 870: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 871: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 872: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 873: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 874: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 875: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 876: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 877: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 878: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 879: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 880: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 881: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 882: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 883: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 884: return G[18] * zij2 + 2.0 * (G[25] * zij) + G[32];
    case 885: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 886: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 887: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 888: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 889: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 890: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 891: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 892: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 893: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 894: return G[17] * pow(zij, 3) + 3.0 * (G[24] * zij2) + 3.0 * (G[31] * zij) + G[38];
    case 895: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 896: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 897: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 898: return G[17] * pow(zij, 3) + 3.0 * (G[24] * zij2) + 3.0 * (G[31] * zij) + G[38];
    case 899: return G[18] * pow(zij, 3) + 3.0 * (G[25] * zij2) + 3.0 * (G[32] * zij) + G[39];
    case 900: return G[0];
    case 901: return G[0];
    case 902: return G[1];
    case 903: return G[0];
    case 904: return G[1];
    case 905: return G[2];
    case 906: return G[0];
    case 907: return G[1];
    case 908: return G[2];
    case 909: return G[3];
    case 910: return G[0];
    case 911: return G[1];
    case 912: return G[2];
    case 913: return G[3];
    case 914: return G[4];
    case 915: return G[0];
    case 916: return G[0];
    case 917: return G[1];
    case 918: return G[0];
    case 919: return G[1];
    case 920: return G[2];
    case 921: return G[0];
    case 922: return G[1];
    case 923: return G[2];
    case 924: return G[3];
    case 925: return G[0];
    case 926: return G[1];
    case 927: return G[2];
    case 928: return G[3];
    case 929: return G[4];
    case 930: return G[0] * zij + G[7];
    case 931: return G[0] * zij + G[7];
    case 932: return G[1] * zij + G[8];
    case 933: return G[0] * zij + G[7];
    case 934: return G[1] * zij + G[8];
    case 935: return G[2] * zij + G[9];
    case 936: return G[0] * zij + G[7];
    case 937: return G[1] * zij + G[8];
    case 938: return G[2] * zij + G[9];
    case 939: return G[3] * zij + G[10];
    case 940: return G[0] * zij + G[7];
    case 941: return G[1] * zij + G[8];
    case 942: return G[2] * zij + G[9];
    case 943: return G[3] * zij + G[10];
    case 944: return G[4] * zij + G[11];
    case 945: return G[0];
    case 946: return G[0];
    case 947: return G[1];
    case 948: return G[0];
    case 949: return G[1];
    case 950: return G[2];
    case 951: return G[0];
    case 952: return G[1];
    case 953: return G[2];
    case 954: return G[3];
    case 955: return G[0];
    case 956: return G[1];
    case 957: return G[2];
    case 958: return G[3];
    case 959: return G[4];
    case 960: return G[0] * zij + G[7];
    case 961: return G[0] * zij + G[7];
    case 962: return G[1] * zij + G[8];
    case 963: return G[0] * zij + G[7];
    case 964: return G[1] * zij + G[8];
    case 965: return G[2] * zij + G[9];
    case 966: return G[0] * zij + G[7];
    case 967: return G[1] * zij + G[8];
    case 968: return G[2] * zij + G[9];
    case 969: return G[3] * zij + G[10];
    case 970: return G[0] * zij + G[7];
    case 971: return G[1] * zij + G[8];
    case 972: return G[2] * zij + G[9];
    case 973: return G[3] * zij + G[10];
    case 974: return G[4] * zij + G[11];
    case 975: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 976: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 977: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 978: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 979: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 980: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 981: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 982: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 983: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 984: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 985: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 986: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 987: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 988: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 989: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 990: return G[0];
    case 991: return G[0];
    case 992: return G[1];
    case 993: return G[0];
    case 994: return G[1];
    case 995: return G[2];
    case 996: return G[0];
    case 997: return G[1];
    case 998: return G[2];
    case 999: return G[3];
    case 1000: return G[0];
    case 1001: return G[1];
    case 1002: return G[2];
    case 1003: return G[3];
    case 1004: return G[4];
    case 1005: return G[0] * zij + G[7];
    case 1006: return G[0] * zij + G[7];
    case 1007: return G[1] * zij + G[8];
    case 1008: return G[0] * zij + G[7];
    case 1009: return G[1] * zij + G[8];
    case 1010: return G[2] * zij + G[9];
    case 1011: return G[0] * zij + G[7];
    case 1012: return G[1] * zij + G[8];
    case 1013: return G[2] * zij + G[9];
    case 1014: return G[3] * zij + G[10];
    case 1015: return G[0] * zij + G[7];
    case 1016: return G[1] * zij + G[8];
    case 1017: return G[2] * zij + G[9];
    case 1018: return G[3] * zij + G[10];
    case 1019: return G[4] * zij + G[11];
    case 1020: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 1021: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 1022: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 1023: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 1024: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 1025: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 1026: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 1027: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 1028: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 1029: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 1030: return G[0] * zij2 + 2.0 * (G[7] * zij) + G[14];
    case 1031: return G[1] * zij2 + 2.0 * (G[8] * zij) + G[15];
    case 1032: return G[2] * zij2 + 2.0 * (G[9] * zij) + G[16];
    case 1033: return G[3] * zij2 + 2.0 * (G[10] * zij) + G[17];
    case 1034: return G[4] * zij2 + 2.0 * (G[11] * zij) + G[18];
    case 1035: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 1036: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 1037: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 1038: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 1039: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 1040: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 1041: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 1042: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 1043: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 1044: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 1045: return G[0] * pow(zij, 3) + 3.0 * (G[7] * zij2) + 3.0 * (G[14] * zij) + G[21];
    case 1046: return G[1] * pow(zij, 3) + 3.0 * (G[8] * zij2) + 3.0 * (G[15] * zij) + G[22];
    case 1047: return G[2] * pow(zij, 3) + 3.0 * (G[9] * zij2) + 3.0 * (G[16] * zij) + G[23];
    case 1048: return G[3] * pow(zij, 3) + 3.0 * (G[10] * zij2) + 3.0 * (G[17] * zij) + G[24];
    case 1049: return G[4] * pow(zij, 3) + 3.0 * (G[11] * zij2) + 3.0 * (G[18] * zij) + G[25];
    case 1050: return G[7];
    case 1051: return G[7];
    case 1052: return G[8];
    case 1053: return G[7];
    case 1054: return G[8];
    case 1055: return G[9];
    case 1056: return G[7];
    case 1057: return G[8];
    case 1058: return G[9];
    case 1059: return G[10];
    case 1060: return G[7];
    case 1061: return G[8];
    case 1062: return G[9];
    case 1063: return G[10];
    case 1064: return G[11];
    case 1065: return G[7];
    case 1066: return G[7];
    case 1067: return G[8];
    case 1068: return G[7];
    case 1069: return G[8];
    case 1070: return G[9];
    case 1071: return G[7];
    case 1072: return G[8];
    case 1073: return G[9];
    case 1074: return G[10];
    case 1075: return G[7];
    case 1076: return G[8];
    case 1077: return G[9];
    case 1078: return G[10];
    case 1079: return G[11];
    case 1080: return G[7] * zij + G[14];
    case 1081: return G[7] * zij + G[14];
    case 1082: return G[8] * zij + G[15];
    case 1083: return G[7] * zij + G[14];
    case 1084: return G[8] * zij + G[15];
    case 1085: return G[9] * zij + G[16];
    case 1086: return G[7] * zij + G[14];
    case 1087: return G[8] * zij + G[15];
    case 1088: return G[9] * zij + G[16];
    case 1089: return G[10] * zij + G[17];
    case 1090: return G[7] * zij + G[14];
    case 1091: return G[8] * zij + G[15];
    case 1092: return G[9] * zij + G[16];
    case 1093: return G[10] * zij + G[17];
    case 1094: return G[11] * zij + G[18];
    case 1095: return G[7];
    case 1096: return G[7];
    case 1097: return G[8];
    case 1098: return G[7];
    case 1099: return G[8];
    case 1100: return G[9];
    case 1101: return G[7];
    case 1102: return G[8];
    case 1103: return G[9];
    case 1104: return G[10];
    case 1105: return G[7];
    case 1106: return G[8];
    case 1107: return G[9];
    case 1108: return G[10];
    case 1109: return G[11];
    case 1110: return G[7] * zij + G[14];
    case 1111: return G[7] * zij + G[14];
    case 1112: return G[8] * zij + G[15];
    case 1113: return G[7] * zij + G[14];
    case 1114: return G[8] * zij + G[15];
    case 1115: return G[9] * zij + G[16];
    case 1116: return G[7] * zij + G[14];
    case 1117: return G[8] * zij + G[15];
    case 1118: return G[9] * zij + G[16];
    case 1119: return G[10] * zij + G[17];
    case 1120: return G[7] * zij + G[14];
    case 1121: return G[8] * zij + G[15];
    case 1122: return G[9] * zij + G[16];
    case 1123: return G[10] * zij + G[17];
    case 1124: return G[11] * zij + G[18];
    case 1125: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1126: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1127: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 1128: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1129: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 1130: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 1131: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1132: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 1133: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 1134: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 1135: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1136: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 1137: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 1138: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 1139: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 1140: return G[7];
    case 1141: return G[7];
    case 1142: return G[8];
    case 1143: return G[7];
    case 1144: return G[8];
    case 1145: return G[9];
    case 1146: return G[7];
    case 1147: return G[8];
    case 1148: return G[9];
    case 1149: return G[10];
    case 1150: return G[7];
    case 1151: return G[8];
    case 1152: return G[9];
    case 1153: return G[10];
    case 1154: return G[11];
    case 1155: return G[7] * zij + G[14];
    case 1156: return G[7] * zij + G[14];
    case 1157: return G[8] * zij + G[15];
    case 1158: return G[7] * zij + G[14];
    case 1159: return G[8] * zij + G[15];
    case 1160: return G[9] * zij + G[16];
    case 1161: return G[7] * zij + G[14];
    case 1162: return G[8] * zij + G[15];
    case 1163: return G[9] * zij + G[16];
    case 1164: return G[10] * zij + G[17];
    case 1165: return G[7] * zij + G[14];
    case 1166: return G[8] * zij + G[15];
    case 1167: return G[9] * zij + G[16];
    case 1168: return G[10] * zij + G[17];
    case 1169: return G[11] * zij + G[18];
    case 1170: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1171: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1172: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 1173: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1174: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 1175: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 1176: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1177: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 1178: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 1179: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 1180: return G[7] * zij2 + 2.0 * (G[14] * zij) + G[21];
    case 1181: return G[8] * zij2 + 2.0 * (G[15] * zij) + G[22];
    case 1182: return G[9] * zij2 + 2.0 * (G[16] * zij) + G[23];
    case 1183: return G[10] * zij2 + 2.0 * (G[17] * zij) + G[24];
    case 1184: return G[11] * zij2 + 2.0 * (G[18] * zij) + G[25];
    case 1185: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 1186: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 1187: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 1188: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 1189: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 1190: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 1191: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 1192: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 1193: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 1194: return G[10] * pow(zij, 3) + 3.0 * (G[17] * zij2) + 3.0 * (G[24] * zij) + G[31];
    case 1195: return G[7] * pow(zij, 3) + 3.0 * (G[14] * zij2) + 3.0 * (G[21] * zij) + G[28];
    case 1196: return G[8] * pow(zij, 3) + 3.0 * (G[15] * zij2) + 3.0 * (G[22] * zij) + G[29];
    case 1197: return G[9] * pow(zij, 3) + 3.0 * (G[16] * zij2) + 3.0 * (G[23] * zij) + G[30];
    case 1198: return G[10] * pow(zij, 3) + 3.0 * (G[17] * zij2) + 3.0 * (G[24] * zij) + G[31];
    case 1199: return G[11] * pow(zij, 3) + 3.0 * (G[18] * zij2) + 3.0 * (G[25] * zij) + G[32];
    case 1200: return G[14];
    case 1201: return G[14];
    case 1202: return G[15];
    case 1203: return G[14];
    case 1204: return G[15];
    case 1205: return G[16];
    case 1206: return G[14];
    case 1207: return G[15];
    case 1208: return G[16];
    case 1209: return G[17];
    case 1210: return G[14];
    case 1211: return G[15];
    case 1212: return G[16];
    case 1213: return G[17];
    case 1214: return G[18];
    case 1215: return G[14];
    case 1216: return G[14];
    case 1217: return G[15];
    case 1218: return G[14];
    case 1219: return G[15];
    case 1220: return G[16];
    case 1221: return G[14];
    case 1222: return G[15];
    case 1223: return G[16];
    case 1224: return G[17];
    case 1225: return G[14];
    case 1226: return G[15];
    case 1227: return G[16];
    case 1228: return G[17];
    case 1229: return G[18];
    case 1230: return G[14] * zij + G[21];
    case 1231: return G[14] * zij + G[21];
    case 1232: return G[15] * zij + G[22];
    case 1233: return G[14] * zij + G[21];
    case 1234: return G[15] * zij + G[22];
    case 1235: return G[16] * zij + G[23];
    case 1236: return G[14] * zij + G[21];
    case 1237: return G[15] * zij + G[22];
    case 1238: return G[16] * zij + G[23];
    case 1239: return G[17] * zij + G[24];
    case 1240: return G[14] * zij + G[21];
    case 1241: return G[15] * zij + G[22];
    case 1242: return G[16] * zij + G[23];
    case 1243: return G[17] * zij + G[24];
    case 1244: return G[18] * zij + G[25];
    case 1245: return G[14];
    case 1246: return G[14];
    case 1247: return G[15];
    case 1248: return G[14];
    case 1249: return G[15];
    case 1250: return G[16];
    case 1251: return G[14];
    case 1252: return G[15];
    case 1253: return G[16];
    case 1254: return G[17];
    case 1255: return G[14];
    case 1256: return G[15];
    case 1257: return G[16];
    case 1258: return G[17];
    case 1259: return G[18];
    case 1260: return G[14] * zij + G[21];
    case 1261: return G[14] * zij + G[21];
    case 1262: return G[15] * zij + G[22];
    case 1263: return G[14] * zij + G[21];
    case 1264: return G[15] * zij + G[22];
    case 1265: return G[16] * zij + G[23];
    case 1266: return G[14] * zij + G[21];
    case 1267: return G[15] * zij + G[22];
    case 1268: return G[16] * zij + G[23];
    case 1269: return G[17] * zij + G[24];
    case 1270: return G[14] * zij + G[21];
    case 1271: return G[15] * zij + G[22];
    case 1272: return G[16] * zij + G[23];
    case 1273: return G[17] * zij + G[24];
    case 1274: return G[18] * zij + G[25];
    case 1275: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1276: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1277: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 1278: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1279: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 1280: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 1281: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1282: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 1283: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 1284: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 1285: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1286: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 1287: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 1288: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 1289: return G[18] * zij2 + 2.0 * (G[25] * zij) + G[32];
    case 1290: return G[14];
    case 1291: return G[14];
    case 1292: return G[15];
    case 1293: return G[14];
    case 1294: return G[15];
    case 1295: return G[16];
    case 1296: return G[14];
    case 1297: return G[15];
    case 1298: return G[16];
    case 1299: return G[17];
    case 1300: return G[14];
    case 1301: return G[15];
    case 1302: return G[16];
    case 1303: return G[17];
    case 1304: return G[18];
    case 1305: return G[14] * zij + G[21];
    case 1306: return G[14] * zij + G[21];
    case 1307: return G[15] * zij + G[22];
    case 1308: return G[14] * zij + G[21];
    case 1309: return G[15] * zij + G[22];
    case 1310: return G[16] * zij + G[23];
    case 1311: return G[14] * zij + G[21];
    case 1312: return G[15] * zij + G[22];
    case 1313: return G[16] * zij + G[23];
    case 1314: return G[17] * zij + G[24];
    case 1315: return G[14] * zij + G[21];
    case 1316: return G[15] * zij + G[22];
    case 1317: return G[16] * zij + G[23];
    case 1318: return G[17] * zij + G[24];
    case 1319: return G[18] * zij + G[25];
    case 1320: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1321: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1322: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 1323: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1324: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 1325: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 1326: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1327: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 1328: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 1329: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 1330: return G[14] * zij2 + 2.0 * (G[21] * zij) + G[28];
    case 1331: return G[15] * zij2 + 2.0 * (G[22] * zij) + G[29];
    case 1332: return G[16] * zij2 + 2.0 * (G[23] * zij) + G[30];
    case 1333: return G[17] * zij2 + 2.0 * (G[24] * zij) + G[31];
    case 1334: return G[18] * zij2 + 2.0 * (G[25] * zij) + G[32];
    case 1335: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 1336: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 1337: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 1338: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 1339: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 1340: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 1341: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 1342: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 1343: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 1344: return G[17] * pow(zij, 3) + 3.0 * (G[24] * zij2) + 3.0 * (G[31] * zij) + G[38];
    case 1345: return G[14] * pow(zij, 3) + 3.0 * (G[21] * zij2) + 3.0 * (G[28] * zij) + G[35];
    case 1346: return G[15] * pow(zij, 3) + 3.0 * (G[22] * zij2) + 3.0 * (G[29] * zij) + G[36];
    case 1347: return G[16] * pow(zij, 3) + 3.0 * (G[23] * zij2) + 3.0 * (G[30] * zij) + G[37];
    case 1348: return G[17] * pow(zij, 3) + 3.0 * (G[24] * zij2) + 3.0 * (G[31] * zij) + G[38];
    case 1349: return G[18] * pow(zij, 3) + 3.0 * (G[25] * zij2) + 3.0 * (G[32] * zij) + G[39];
    case 1350: return G[21];
    case 1351: return G[21];
    case 1352: return G[22];
    case 1353: return G[21];
    case 1354: return G[22];
    case 1355: return G[23];
    case 1356: return G[21];
    case 1357: return G[22];
    case 1358: return G[23];
    case 1359: return G[24];
    case 1360: return G[21];
    case 1361: return G[22];
    case 1362: return G[23];
    case 1363: return G[24];
    case 1364: return G[25];
    case 1365: return G[21];
    case 1366: return G[21];
    case 1367: return G[22];
    case 1368: return G[21];
    case 1369: return G[22];
    case 1370: return G[23];
    case 1371: return G[21];
    case 1372: return G[22];
    case 1373: return G[23];
    case 1374: return G[24];
    case 1375: return G[21];
    case 1376: return G[22];
    case 1377: return G[23];
    case 1378: return G[24];
    case 1379: return G[25];
    case 1380: return G[21] * zij + G[28];
    case 1381: return G[21] * zij + G[28];
    case 1382: return G[22] * zij + G[29];
    case 1383: return G[21] * zij + G[28];
    case 1384: return G[22] * zij + G[29];
    case 1385: return G[23] * zij + G[30];
    case 1386: return G[21] * zij + G[28];
    case 1387: return G[22] * zij + G[29];
    case 1388: return G[23] * zij + G[30];
    case 1389: return G[24] * zij + G[31];
    case 1390: return G[21] * zij + G[28];
    case 1391: return G[22] * zij + G[29];
    case 1392: return G[23] * zij + G[30];
    case 1393: return G[24] * zij + G[31];
    case 1394: return G[25] * zij + G[32];
    case 1395: return G[21];
    case 1396: return G[21];
    case 1397: return G[22];
    case 1398: return G[21];
    case 1399: return G[22];
    case 1400: return G[23];
    case 1401: return G[21];
    case 1402: return G[22];
    case 1403: return G[23];
    case 1404: return G[24];
    case 1405: return G[21];
    case 1406: return G[22];
    case 1407: return G[23];
    case 1408: return G[24];
    case 1409: return G[25];
    case 1410: return G[21] * zij + G[28];
    case 1411: return G[21] * zij + G[28];
    case 1412: return G[22] * zij + G[29];
    case 1413: return G[21] * zij + G[28];
    case 1414: return G[22] * zij + G[29];
    case 1415: return G[23] * zij + G[30];
    case 1416: return G[21] * zij + G[28];
    case 1417: return G[22] * zij + G[29];
    case 1418: return G[23] * zij + G[30];
    case 1419: return G[24] * zij + G[31];
    case 1420: return G[21] * zij + G[28];
    case 1421: return G[22] * zij + G[29];
    case 1422: return G[23] * zij + G[30];
    case 1423: return G[24] * zij + G[31];
    case 1424: return G[25] * zij + G[32];
    case 1425: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1426: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1427: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 1428: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1429: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 1430: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 1431: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1432: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 1433: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 1434: return G[24] * zij2 + 2.0 * (G[31] * zij) + G[38];
    case 1435: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1436: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 1437: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 1438: return G[24] * zij2 + 2.0 * (G[31] * zij) + G[38];
    case 1439: return G[25] * zij2 + 2.0 * (G[32] * zij) + G[39];
    case 1440: return G[21];
    case 1441: return G[21];
    case 1442: return G[22];
    case 1443: return G[21];
    case 1444: return G[22];
    case 1445: return G[23];
    case 1446: return G[21];
    case 1447: return G[22];
    case 1448: return G[23];
    case 1449: return G[24];
    case 1450: return G[21];
    case 1451: return G[22];
    case 1452: return G[23];
    case 1453: return G[24];
    case 1454: return G[25];
    case 1455: return G[21] * zij + G[28];
    case 1456: return G[21] * zij + G[28];
    case 1457: return G[22] * zij + G[29];
    case 1458: return G[21] * zij + G[28];
    case 1459: return G[22] * zij + G[29];
    case 1460: return G[23] * zij + G[30];
    case 1461: return G[21] * zij + G[28];
    case 1462: return G[22] * zij + G[29];
    case 1463: return G[23] * zij + G[30];
    case 1464: return G[24] * zij + G[31];
    case 1465: return G[21] * zij + G[28];
    case 1466: return G[22] * zij + G[29];
    case 1467: return G[23] * zij + G[30];
    case 1468: return G[24] * zij + G[31];
    case 1469: return G[25] * zij + G[32];
    case 1470: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1471: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1472: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 1473: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1474: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 1475: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 1476: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1477: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 1478: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 1479: return G[24] * zij2 + 2.0 * (G[31] * zij) + G[38];
    case 1480: return G[21] * zij2 + 2.0 * (G[28] * zij) + G[35];
    case 1481: return G[22] * zij2 + 2.0 * (G[29] * zij) + G[36];
    case 1482: return G[23] * zij2 + 2.0 * (G[30] * zij) + G[37];
    case 1483: return G[24] * zij2 + 2.0 * (G[31] * zij) + G[38];
    case 1484: return G[25] * zij2 + 2.0 * (G[32] * zij) + G[39];
    case 1485: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 1486: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 1487: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    case 1488: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 1489: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    case 1490: return G[23] * pow(zij, 3) + 3.0 * (G[30] * zij2) + 3.0 * (G[37] * zij) + G[44];
    case 1491: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 1492: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    case 1493: return G[23] * pow(zij, 3) + 3.0 * (G[30] * zij2) + 3.0 * (G[37] * zij) + G[44];
    case 1494: return G[24] * pow(zij, 3) + 3.0 * (G[31] * zij2) + 3.0 * (G[38] * zij) + G[45];
    case 1495: return G[21] * pow(zij, 3) + 3.0 * (G[28] * zij2) + 3.0 * (G[35] * zij) + G[42];
    case 1496: return G[22] * pow(zij, 3) + 3.0 * (G[29] * zij2) + 3.0 * (G[36] * zij) + G[43];
    case 1497: return G[23] * pow(zij, 3) + 3.0 * (G[30] * zij2) + 3.0 * (G[37] * zij) + G[44];
    case 1498: return G[24] * pow(zij, 3) + 3.0 * (G[31] * zij2) + 3.0 * (G[38] * zij) + G[45];
    case 1499: return G[25] * pow(zij, 3) + 3.0 * (G[32] * zij2) + 3.0 * (G[39] * zij) + G[46];
    default: return 0.0;
  }
}

template <int NROOTS>
__global__ void KernelERI_ffgs_fixed(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out) {
  const int t = static_cast<int>(blockIdx.x);
  if (t >= ntasks) return;

  const int spAB = static_cast<int>(task_spAB[t]);
  const int spCD = static_cast<int>(task_spCD[t]);
  const int A = static_cast<int>(sp_A[spAB]);
  const int B = static_cast<int>(sp_B[spAB]);
  const int C = static_cast<int>(sp_A[spCD]);
  const int D = static_cast<int>(sp_B[spCD]);

  const double Ax = shell_cx[A];
  const double Ay = shell_cy[A];
  const double Az = shell_cz[A];
  const double Bx = shell_cx[B];
  const double By = shell_cy[B];
  const double Bz = shell_cz[B];
  const double Cx = shell_cx[C];
  const double Cy = shell_cy[C];
  const double Cz = shell_cz[C];
  const double Dx = shell_cx[D];
  const double Dy = shell_cy[D];
  const double Dz = shell_cz[D];

  const double xij = Ax - Bx;
  const double yij = Ay - By;
  const double zij = Az - Bz;
  const double xkl = Cx - Dx;
  const double ykl = Cy - Dy;
  const double zkl = Cz - Dz;
  const double xij2 = xij * xij;
  const double yij2 = yij * yij;
  const double zij2 = zij * zij;
  const double xkl2 = xkl * xkl;
  const double ykl2 = ykl * ykl;
  const double zkl2 = zkl * zkl;

  const int baseAB = static_cast<int>(sp_pair_start[spAB]);
  const int baseCD = static_cast<int>(sp_pair_start[spCD]);
  const int nPairAB = static_cast<int>(sp_npair[spAB]);
  const int nPairCD = static_cast<int>(sp_npair[spCD]);

  constexpr int kStride = 7;
  constexpr int kNComp = 1500;
  constexpr int kNMax = 6;
  constexpr int kMMax = 4;

  __shared__ double Gx[kStride * kStride];
  __shared__ double Gy[kStride * kStride];
  __shared__ double Gz[kStride * kStride];
  __shared__ double sh_scale;
  __shared__ double sh_roots[NROOTS];
  __shared__ double sh_weights[NROOTS];
  __shared__ double sh_p;
  __shared__ double sh_q;
  __shared__ double sh_Px;
  __shared__ double sh_Py;
  __shared__ double sh_Pz;
  __shared__ double sh_Qx;
  __shared__ double sh_Qy;
  __shared__ double sh_Qz;
  __shared__ double sh_denom;
  __shared__ double sh_base;

  for (int ebase = 0; ebase < kNComp; ebase += static_cast<int>(blockDim.x)) {
    const int e = ebase + static_cast<int>(threadIdx.x);
    const bool active = (e < kNComp);
    double val = 0.0;
    for (int ip = 0; ip < nPairAB; ++ip) {
      const int ki = baseAB + ip;
      for (int jp = 0; jp < nPairCD; ++jp) {
        const int kj = baseCD + jp;
        if (threadIdx.x == 0) {
          sh_p = pair_eta[ki];
          sh_q = pair_eta[kj];
          sh_Px = pair_Px[ki];
          sh_Py = pair_Py[ki];
          sh_Pz = pair_Pz[ki];
          sh_Qx = pair_Px[kj];
          sh_Qy = pair_Py[kj];
          sh_Qz = pair_Pz[kj];
          const double dx = sh_Px - sh_Qx;
          const double dy = sh_Py - sh_Qy;
          const double dz = sh_Pz - sh_Qz;
          const double PQ2 = dx * dx + dy * dy + dz * dz;
          sh_denom = sh_p + sh_q;
          const double omega = sh_p * sh_q / sh_denom;
          const double T = omega * PQ2;
          sh_base = kTwoPiToFiveHalves / (sh_p * sh_q * ::sqrt(sh_denom)) * pair_cK[ki] * pair_cK[kj];
          cueri_rys::rys_roots_weights<NROOTS>(T, sh_roots, sh_weights);
        }
        __syncthreads();
        for (int u = 0; u < NROOTS; ++u) {
          if (threadIdx.x == 0) {
            const double x = sh_roots[u];
            const double w = sh_weights[u];
            const double inv_denom = 1.0 / sh_denom;
            const double B0 = x * 0.5 * inv_denom;
            const double B1 = (1.0 - x) * 0.5 / sh_p + B0;
            const double B1p = (1.0 - x) * 0.5 / sh_q + B0;

            const double Cx_ = (sh_Px - Ax) + (sh_q * inv_denom) * x * (sh_Qx - sh_Px);
            const double Cy_ = (sh_Py - Ay) + (sh_q * inv_denom) * x * (sh_Qy - sh_Py);
            const double Cz_ = (sh_Pz - Az) + (sh_q * inv_denom) * x * (sh_Qz - sh_Pz);
            const double Cpx_ = (sh_Qx - Cx) + (sh_p * inv_denom) * x * (sh_Px - sh_Qx);
            const double Cpy_ = (sh_Qy - Cy) + (sh_p * inv_denom) * x * (sh_Py - sh_Qy);
            const double Cpz_ = (sh_Qz - Cz) + (sh_p * inv_denom) * x * (sh_Pz - sh_Qz);

            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gx, Cx_, Cpx_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gy, Cy_, Cpy_, B0, B1, B1p);
            compute_G_stride_fixed<kStride, kNMax, kMMax>(Gz, Cz_, Cpz_, B0, B1, B1p);
            sh_scale = sh_base * w;
          }
          __syncthreads();
          if (active) {
            const double Ix = eval_ffgs_x(e, Gx, xij, xij2, xkl, xkl2);
            const double Iy = eval_ffgs_y(e, Gy, yij, yij2, ykl, ykl2);
            const double Iz = eval_ffgs_z(e, Gz, zij, zij2, zkl, zkl2);
            val += sh_scale * (Ix * Iy * Iz);
          }
          __syncthreads();
        }
      }
    }
    if (active) {
      eri_out[static_cast<int64_t>(t) * static_cast<int64_t>(kNComp) + static_cast<int64_t>(e)] = val;
    }
  }
}

}  // namespace

extern "C" cudaError_t cueri_eri_psds_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 64;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_psds_fixed<2><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_psds_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_psds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_psds_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_psds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ppds_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 64;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ppds_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ppds_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ppds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ppds_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ppds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsds_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 64;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_dsds_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_dsds_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_dsds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsds_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_dsds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsdp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_dsdp_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_dsdp_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_dsdp_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsdp_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_dsdp_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsdd_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 224;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_dsdd_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_dsdd_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_dsdd_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsdd_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_dsdd_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpss_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 64;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fpss_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fpss_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fpss_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpss_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fpss_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdss_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 64;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fdss_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fdss_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fdss_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdss_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fdss_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ffss_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ffss_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ffss_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ffss_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ffss_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ffss_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpps_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 96;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fpps_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fpps_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fpps_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpps_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fpps_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdps_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fdps_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fdps_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fdps_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdps_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fdps_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ffps_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ffps_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ffps_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ffps_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ffps_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ffps_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpds_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fpds_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fpds_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fpds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpds_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fpds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdds_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fdds_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fdds_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fdds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdds_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fdds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ffds_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ffds_fixed<5><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ffds_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ffds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ffds_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ffds_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ssfs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 64;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ssfs_fixed<2><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ssfs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ssfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ssfs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ssfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_psfs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 96;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_psfs_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_psfs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_psfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_psfs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_psfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ppfs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ppfs_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ppfs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ppfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ppfs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ppfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsfs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_dsfs_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_dsfs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_dsfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsfs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_dsfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fsfs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fsfs_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fsfs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fsfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fsfs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fsfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dpfs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_dpfs_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_dpfs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_dpfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dpfs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_dpfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpfs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 160;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fpfs_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fpfs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fpfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpfs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fpfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ddfs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 192;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ddfs_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ddfs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ddfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ddfs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ddfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdfs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 224;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fdfs_fixed<5><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fdfs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fdfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdfs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fdfs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fffs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fffs_fixed<5><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fffs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fffs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fffs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fffs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ssgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 64;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ssgs_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ssgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ssgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ssgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ssgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_psgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 96;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_psgs_fixed<3><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_psgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_psgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_psgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_psgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ppgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ppgs_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ppgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ppgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ppgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ppgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 96;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_dsgs_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_dsgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_dsgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dsgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_dsgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fsgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fsgs_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fsgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fsgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fsgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fsgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dpgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 160;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_dpgs_fixed<4><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_dpgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_dpgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_dpgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_dpgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 224;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fpgs_fixed<5><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fpgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fpgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fpgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fpgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ddgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 224;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ddgs_fixed<5><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ddgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ddgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ddgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ddgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 256;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_fdgs_fixed<5><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_fdgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_fdgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_fdgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_fdgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ffgs_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  if (ntasks < 0) return cudaErrorInvalidValue;
  constexpr int kDefaultThreads = 128;
  int launch_threads = (threads > 0) ? threads : kDefaultThreads;
  if (launch_threads > 1024) launch_threads = 1024;
  if (launch_threads < 32) launch_threads = 32;
  launch_threads = (launch_threads / 32) * 32;
  if (launch_threads < 32) launch_threads = 32;
  const int blocks = ntasks;
  KernelERI_ffgs_fixed<6><<<blocks, launch_threads, 0, stream>>>(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out);
  return cudaGetLastError();
}

extern "C" cudaError_t cueri_eri_ffgs_warp_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  return cueri_eri_ffgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}

extern "C" cudaError_t cueri_eri_ffgs_multiblock_launch_stream(
    const int32_t* task_spAB,
    const int32_t* task_spCD,
    int ntasks,
    const int32_t* sp_A,
    const int32_t* sp_B,
    const int32_t* sp_pair_start,
    const int32_t* sp_npair,
    const double* shell_cx,
    const double* shell_cy,
    const double* shell_cz,
    const double* pair_eta,
    const double* pair_Px,
    const double* pair_Py,
    const double* pair_Pz,
    const double* pair_cK,
    double* partial_sums,
    int blocks_per_task,
    double* eri_out,
    cudaStream_t stream,
    int threads) {
  (void)partial_sums;
  (void)blocks_per_task;
  return cueri_eri_ffgs_launch_stream(
      task_spAB, task_spCD, ntasks, sp_A, sp_B, sp_pair_start, sp_npair, shell_cx, shell_cy, shell_cz,
      pair_eta, pair_Px, pair_Py, pair_Pz, pair_cK, eri_out, stream, threads);
}
